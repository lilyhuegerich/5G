<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="499px" preserveAspectRatio="none" style="width:843px;height:499px;" version="1.1" viewBox="0 0 843 499" width="843px" zoomAndPan="magnify"><defs/><g><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="85" x2="85" y1="34.2969" y2="459.0234"/><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="189" x2="189" y1="34.2969" y2="459.0234"/><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="237" x2="237" y1="34.2969" y2="459.0234"/><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="290" x2="290" y1="34.2969" y2="459.0234"/><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="553" x2="553" y1="34.2969" y2="459.0234"/><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="700.5" x2="700.5" y1="34.2969" y2="459.0234"/><rect fill="#E6E6E6" height="30.2969" style="stroke: #FFFFFF; stroke-width: 1.5;" width="155" x="8" y="3"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="141" x="15" y="22.9951">Spoofed IPs 10.*.0.1</text><rect fill="#E6E6E6" height="30.2969" style="stroke: #FFFFFF; stroke-width: 1.5;" width="155" x="8" y="458.0234"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="141" x="15" y="478.0186">Spoofed IPs 10.*.0.1</text><rect fill="#E6E6E6" height="30.2969" style="stroke: #FFFFFF; stroke-width: 1.5;" width="33" x="173" y="3"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="19" x="180" y="22.9951">UE</text><rect fill="#E6E6E6" height="30.2969" style="stroke: #FFFFFF; stroke-width: 1.5;" width="33" x="173" y="458.0234"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="19" x="180" y="478.0186">UE</text><rect fill="#E6E6E6" height="30.2969" style="stroke: #FFFFFF; stroke-width: 1.5;" width="43" x="216" y="3"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="29" x="223" y="22.9951">gNB</text><rect fill="#E6E6E6" height="30.2969" style="stroke: #FFFFFF; stroke-width: 1.5;" width="43" x="216" y="458.0234"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="29" x="223" y="478.0186">gNB</text><rect fill="#E6E6E6" height="30.2969" style="stroke: #FFFFFF; stroke-width: 1.5;" width="43" x="269" y="3"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="29" x="276" y="22.9951">SMF</text><rect fill="#E6E6E6" height="30.2969" style="stroke: #FFFFFF; stroke-width: 1.5;" width="43" x="269" y="458.0234"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="29" x="276" y="478.0186">SMF</text><rect fill="#E6E6E6" height="30.2969" style="stroke: #FFFFFF; stroke-width: 1.5;" width="41" x="533" y="3"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="27" x="540" y="22.9951">UPF</text><rect fill="#E6E6E6" height="30.2969" style="stroke: #FFFFFF; stroke-width: 1.5;" width="41" x="533" y="458.0234"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="27" x="540" y="478.0186">UPF</text><rect fill="#E6E6E6" height="30.2969" style="stroke: #FFFFFF; stroke-width: 1.5;" width="62" x="669.5" y="3"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="48" x="676.5" y="22.9951">8.8.8.8</text><rect fill="#E6E6E6" height="30.2969" style="stroke: #FFFFFF; stroke-width: 1.5;" width="62" x="669.5" y="458.0234"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="48" x="676.5" y="478.0186">8.8.8.8</text><polygon fill="#000000" points="541.5,64.4297,551.5,68.4297,541.5,72.4297,545.5,68.4297" style="stroke: #000000; stroke-width: 1.0;"/><line style="stroke: #000000; stroke-width: 1.0;" x1="237.5" x2="547.5" y1="68.4297" y2="68.4297"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="170" x="244.5" y="63.3638">164, GTP&lt;ICMP&gt; ping req.</text><path d="M558,49.2969 L558,74.2969 L664,74.2969 L664,59.2969 L654,49.2969 L558,49.2969 " fill="#5C8001" style="stroke: #FFFFFF; stroke-width: 1.0;"/><path d="M654,49.2969 L654,59.2969 L664,59.2969 L654,49.2969 " fill="#5C8001" style="stroke: #FFFFFF; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="85" x="564" y="66.3638">gNB to UPF</text><polygon fill="#000000" points="688.5,99.5625,698.5,103.5625,688.5,107.5625,692.5,103.5625" style="stroke: #000000; stroke-width: 1.0;"/><line style="stroke: #000000; stroke-width: 1.0;" x1="189.5" x2="694.5" y1="103.5625" y2="103.5625"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="123" x="196.5" y="98.4966">165, ICMP ping req.</text><path d="M705,84.4297 L705,109.4297 L821,109.4297 L821,94.4297 L811,84.4297 L705,84.4297 " fill="#5C8001" style="stroke: #FFFFFF; stroke-width: 1.0;"/><path d="M811,84.4297 L811,94.4297 L821,94.4297 L811,84.4297 " fill="#5C8001" style="stroke: #FFFFFF; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="95" x="711" y="101.4966">UE to 8.8.8.8</text><polygon fill="#000000" points="688.5,134.6953,698.5,138.6953,688.5,142.6953,692.5,138.6953" style="stroke: #000000; stroke-width: 1.0;"/><line style="stroke: #000000; stroke-width: 1.0;" x1="553.5" x2="694.5" y1="138.6953" y2="138.6953"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="123" x="560.5" y="133.6294">166, ICMP ping req.</text><path d="M705,119.5625 L705,144.5625 L831,144.5625 L831,129.5625 L821,119.5625 L705,119.5625 " fill="#5C8001" style="stroke: #FFFFFF; stroke-width: 1.0;"/><path d="M821,119.5625 L821,129.5625 L831,129.5625 L821,119.5625 " fill="#5C8001" style="stroke: #FFFFFF; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="105" x="711" y="136.6294">UPF to 8.8.8.8</text><polygon fill="#000000" points="564.5,169.8281,554.5,173.8281,564.5,177.8281,560.5,173.8281" style="stroke: #000000; stroke-width: 1.0;"/><line style="stroke: #000000; stroke-width: 1.0;" x1="558.5" x2="699.5" y1="173.8281" y2="173.8281"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="122" x="570.5" y="168.7622">167, ICMP ping rsp.</text><path d="M705,154.6953 L705,179.6953 L831,179.6953 L831,164.6953 L821,154.6953 L705,154.6953 " fill="#EDFEC2" style="stroke: #FFFFFF; stroke-width: 1.0;"/><path d="M821,154.6953 L821,164.6953 L831,164.6953 L821,154.6953 " fill="#EDFEC2" style="stroke: #FFFFFF; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="105" x="711" y="171.7622">8.8.8.8 to UPF</text><polygon fill="#000000" points="200.5,204.9609,190.5,208.9609,200.5,212.9609,196.5,208.9609" style="stroke: #000000; stroke-width: 1.0;"/><line style="stroke: #000000; stroke-width: 1.0;" x1="194.5" x2="699.5" y1="208.9609" y2="208.9609"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="122" x="206.5" y="203.895">168, ICMP ping rsp.</text><path d="M705,189.8281 L705,214.8281 L821,214.8281 L821,199.8281 L811,189.8281 L705,189.8281 " fill="#EDFEC2" style="stroke: #FFFFFF; stroke-width: 1.0;"/><path d="M811,189.8281 L811,199.8281 L821,199.8281 L811,189.8281 " fill="#EDFEC2" style="stroke: #FFFFFF; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="95" x="711" y="206.895">8.8.8.8 to UE</text><polygon fill="#000000" points="248.5,240.0938,238.5,244.0938,248.5,248.0938,244.5,244.0938" style="stroke: #000000; stroke-width: 1.0;"/><line style="stroke: #000000; stroke-width: 1.0;" x1="242.5" x2="552.5" y1="244.0938" y2="244.0938"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="169" x="254.5" y="239.0278">169, GTP&lt;ICMP&gt; ping rsp.</text><path d="M558,224.9609 L558,249.9609 L664,249.9609 L664,234.9609 L654,224.9609 L558,224.9609 " fill="#EDFEC2" style="stroke: #FFFFFF; stroke-width: 1.0;"/><path d="M654,224.9609 L654,234.9609 L664,234.9609 L654,224.9609 " fill="#EDFEC2" style="stroke: #FFFFFF; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="85" x="564" y="242.0278">UPF to gNB</text><polygon fill="#000000" points="541.5,275.2266,551.5,279.2266,541.5,283.2266,545.5,279.2266" style="stroke: #000000; stroke-width: 1.0;"/><line style="stroke: #000000; stroke-width: 1.0;" x1="85.5" x2="547.5" y1="279.2266" y2="279.2266"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="93" x="92.5" y="274.1606">717, PFCP req.</text><path d="M558,260.0938 L558,285.0938 L785,285.0938 L785,270.0938 L775,260.0938 L558,260.0938 " fill="#FFC2D9" style="stroke: #FFFFFF; stroke-width: 1.0;"/><path d="M775,260.0938 L775,270.0938 L785,270.0938 L775,260.0938 " fill="#FFC2D9" style="stroke: #FFFFFF; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="206" x="564" y="277.1606">Spoofed IPs 10.*.0.1 to UPF</text><polygon fill="#000000" points="96.5,310.3594,86.5,314.3594,96.5,318.3594,92.5,314.3594" style="stroke: #000000; stroke-width: 1.0;"/><line style="stroke: #000000; stroke-width: 1.0;" x1="90.5" x2="552.5" y1="314.3594" y2="314.3594"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="92" x="102.5" y="309.2935">718, PFCP rsp.</text><path d="M558,295.2266 L558,320.2266 L785,320.2266 L785,305.2266 L775,295.2266 L558,295.2266 " fill="#FFEAC2" style="stroke: #FFFFFF; stroke-width: 1.0;"/><path d="M775,295.2266 L775,305.2266 L785,305.2266 L775,295.2266 " fill="#FFEAC2" style="stroke: #FFFFFF; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="206" x="564" y="312.2935">UPF to Spoofed IPs 10.*.0.1</text><polygon fill="#000000" points="301.5,357.625,291.5,361.625,301.5,365.625,297.5,361.625" style="stroke: #000000; stroke-width: 1.0;"/><line style="stroke: #000000; stroke-width: 1.0;" x1="295.5" x2="552.5" y1="361.625" y2="361.625"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="101" x="307.5" y="341.4263">1110, PFCP req.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="229" x="307.5" y="356.5591">PFCP Association Setup Request (5)</text><path d="M558,334.9258 L558,359.9258 L664,359.9258 L664,344.9258 L654,334.9258 L558,334.9258 " fill="#03B5AA" style="stroke: #FFFFFF; stroke-width: 1.0;"/><path d="M654,334.9258 L654,344.9258 L664,344.9258 L654,334.9258 " fill="#03B5AA" style="stroke: #FFFFFF; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="85" x="564" y="351.9927">UPF to SMF</text><polygon fill="#000000" points="541.5,401.8906,551.5,405.8906,541.5,409.8906,545.5,405.8906" style="stroke: #000000; stroke-width: 1.0;"/><line style="stroke: #000000; stroke-width: 1.0;" x1="290.5" x2="547.5" y1="405.8906" y2="405.8906"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="100" x="297.5" y="385.6919">1111, PFCP rsp.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="239" x="297.5" y="400.8247">PFCP Association Setup Response (6)</text><path d="M558,379.1914 L558,404.1914 L664,404.1914 L664,389.1914 L654,379.1914 L558,379.1914 " fill="#D7FEFC" style="stroke: #FFFFFF; stroke-width: 1.0;"/><path d="M654,379.1914 L654,389.1914 L664,389.1914 L654,379.1914 " fill="#D7FEFC" style="stroke: #FFFFFF; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="85" x="564" y="396.2583">SMF to UPF</text><polygon fill="#000000" points="541.5,434.0234,551.5,438.0234,541.5,442.0234,545.5,438.0234" style="stroke: #000000; stroke-width: 1.0;"/><line style="stroke: #000000; stroke-width: 1.0;" x1="237.5" x2="547.5" y1="438.0234" y2="438.0234"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="178" x="244.5" y="432.9575">1296, GTP&lt;ICMP&gt; ping req.</text><path d="M558,418.8906 L558,443.8906 L664,443.8906 L664,428.8906 L654,418.8906 L558,418.8906 " fill="#5C8001" style="stroke: #FFFFFF; stroke-width: 1.0;"/><path d="M654,418.8906 L654,428.8906 L664,428.8906 L654,418.8906 " fill="#5C8001" style="stroke: #FFFFFF; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="85" x="564" y="435.9575">gNB to UPF</text><!--MD5=[86edf24c30527f95bc09f736ca5d66b8]
@startuml
skinparam shadowing false
skinparam NoteBorderColor white
skinparam sequence {
    ArrowColor black
    LifeLineBorderColor black
    LifeLineBackgroundColor black
    ParticipantBorderColor white
    ParticipantBackgroundColor #e6e6e6
}
participant "Spoofed IPs 10.*.0.1"
participant "UE"
participant "gNB"
participant "SMF"
participant "UPF"

"gNB" -> "UPF": 164, GTP<ICMP> ping req.

note right #5C8001
**gNB to UPF**
end note

"UE" -> "8.8.8.8": 165, ICMP ping req.

note right #5C8001
**UE to 8.8.8.8**
end note

"UPF" -> "8.8.8.8": 166, ICMP ping req.

note right #5C8001
**UPF to 8.8.8.8**
end note

"8.8.8.8" -> "UPF": 167, ICMP ping rsp.

note right #EDFEC2
**8.8.8.8 to UPF**
end note

"8.8.8.8" -> "UE": 168, ICMP ping rsp.

note right #EDFEC2
**8.8.8.8 to UE**
end note

"UPF" -> "gNB": 169, GTP<ICMP> ping rsp.

note right #EDFEC2
**UPF to gNB**
end note
"Spoofed IPs 10.*.0.1" -> "UPF": 717, PFCP req.

note right #FFC2D9
**Spoofed IPs 10.*.0.1 to UPF**
end note

"UPF" -> "Spoofed IPs 10.*.0.1": 718, PFCP rsp.

note right #FFEAC2
**UPF to Spoofed IPs 10.*.0.1**
end note

"UPF" -> "SMF": 1110, PFCP req.\nPFCP Association Setup Request (5)

note right #03B5AA
**UPF to SMF**
end note

"SMF" -> "UPF": 1111, PFCP rsp.\nPFCP Association Setup Response (6)

note right #D7FEFC
**SMF to UPF**
end note

"gNB" -> "UPF": 1296, GTP<ICMP> ping req.

note right #5C8001
**gNB to UPF**
end note

@enduml

PlantUML version 1.2019.12(Sun Nov 03 11:24:54 CET 2019)
(APACHE source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Java Version: 11.0.18+10-post-Ubuntu-0ubuntu120.04.1
Operating System: Linux
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>