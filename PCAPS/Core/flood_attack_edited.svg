<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="642px" preserveAspectRatio="none" style="width:900px;height:642px;" version="1.1" viewBox="0 0 900 642" width="900px" zoomAndPan="magnify"><defs/><g><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="85" x2="85" y1="34.2969" y2="601.75"/><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="189" x2="189" y1="34.2969" y2="601.75"/><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="237" x2="237" y1="34.2969" y2="601.75"/><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="290" x2="290" y1="34.2969" y2="601.75"/><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="553" x2="553" y1="34.2969" y2="601.75"/><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="757.5" x2="757.5" y1="34.2969" y2="601.75"/><rect fill="#E6E6E6" height="30.2969" style="stroke: #FFFFFF; stroke-width: 1.5;" width="155" x="8" y="3"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="141" x="15" y="22.9951">Spoofed IPs 10.*.0.1</text><rect fill="#E6E6E6" height="30.2969" style="stroke: #FFFFFF; stroke-width: 1.5;" width="155" x="8" y="600.75"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="141" x="15" y="620.7451">Spoofed IPs 10.*.0.1</text><rect fill="#E6E6E6" height="30.2969" style="stroke: #FFFFFF; stroke-width: 1.5;" width="33" x="173" y="3"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="19" x="180" y="22.9951">UE</text><rect fill="#E6E6E6" height="30.2969" style="stroke: #FFFFFF; stroke-width: 1.5;" width="33" x="173" y="600.75"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="19" x="180" y="620.7451">UE</text><rect fill="#E6E6E6" height="30.2969" style="stroke: #FFFFFF; stroke-width: 1.5;" width="43" x="216" y="3"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="29" x="223" y="22.9951">gNB</text><rect fill="#E6E6E6" height="30.2969" style="stroke: #FFFFFF; stroke-width: 1.5;" width="43" x="216" y="600.75"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="29" x="223" y="620.7451">gNB</text><rect fill="#E6E6E6" height="30.2969" style="stroke: #FFFFFF; stroke-width: 1.5;" width="43" x="269" y="3"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="29" x="276" y="22.9951">SMF</text><rect fill="#E6E6E6" height="30.2969" style="stroke: #FFFFFF; stroke-width: 1.5;" width="43" x="269" y="600.75"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="29" x="276" y="620.7451">SMF</text><rect fill="#E6E6E6" height="30.2969" style="stroke: #FFFFFF; stroke-width: 1.5;" width="41" x="533" y="3"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="27" x="540" y="22.9951">UPF</text><rect fill="#E6E6E6" height="30.2969" style="stroke: #FFFFFF; stroke-width: 1.5;" width="41" x="533" y="600.75"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="27" x="540" y="620.7451">UPF</text><rect fill="#E6E6E6" height="30.2969" style="stroke: #FFFFFF; stroke-width: 1.5;" width="62" x="726.5" y="3"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="48" x="733.5" y="22.9951">8.8.8.8</text><rect fill="#E6E6E6" height="30.2969" style="stroke: #FFFFFF; stroke-width: 1.5;" width="62" x="726.5" y="600.75"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="48" x="733.5" y="620.7451">8.8.8.8</text><polygon fill="#000000" points="541.5,76.5625,551.5,80.5625,541.5,84.5625,545.5,80.5625" style="stroke: #000000; stroke-width: 1.0;"/><line style="stroke: #000000; stroke-width: 1.0;" x1="237.5" x2="547.5" y1="80.5625" y2="80.5625"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="170" x="244.5" y="60.3638">164, GTP&lt;ICMP&gt; ping req.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="180" x="244.5" y="75.4966">+21.451s (16:1:23.602.934)</text><path d="M558,53.8633 L558,78.8633 L664,78.8633 L664,63.8633 L654,53.8633 L558,53.8633 " fill="#5C8001" style="stroke: #FFFFFF; stroke-width: 1.0;"/><path d="M654,53.8633 L654,63.8633 L664,63.8633 L654,53.8633 " fill="#5C8001" style="stroke: #FFFFFF; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="85" x="564" y="70.9302">gNB to UPF</text><polygon fill="#000000" points="745.5,120.8281,755.5,124.8281,745.5,128.8281,749.5,124.8281" style="stroke: #000000; stroke-width: 1.0;"/><line style="stroke: #000000; stroke-width: 1.0;" x1="189.5" x2="751.5" y1="124.8281" y2="124.8281"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="123" x="196.5" y="104.6294">165, ICMP ping req.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="180" x="196.5" y="119.7622">+21.452s (16:1:23.604.018)</text><path d="M762,98.1289 L762,123.1289 L878,123.1289 L878,108.1289 L868,98.1289 L762,98.1289 " fill="#5C8001" style="stroke: #FFFFFF; stroke-width: 1.0;"/><path d="M868,98.1289 L868,108.1289 L878,108.1289 L868,98.1289 " fill="#5C8001" style="stroke: #FFFFFF; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="95" x="768" y="115.1958">UE to 8.8.8.8</text><polygon fill="#000000" points="745.5,165.0938,755.5,169.0938,745.5,173.0938,749.5,169.0938" style="stroke: #000000; stroke-width: 1.0;"/><line style="stroke: #000000; stroke-width: 1.0;" x1="553.5" x2="751.5" y1="169.0938" y2="169.0938"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="123" x="560.5" y="148.895">166, ICMP ping req.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="180" x="560.5" y="164.0278">+21.452s (16:1:23.604.057)</text><path d="M762,142.3945 L762,167.3945 L888,167.3945 L888,152.3945 L878,142.3945 L762,142.3945 " fill="#5C8001" style="stroke: #FFFFFF; stroke-width: 1.0;"/><path d="M878,142.3945 L878,152.3945 L888,152.3945 L878,142.3945 " fill="#5C8001" style="stroke: #FFFFFF; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="105" x="768" y="159.4614">UPF to 8.8.8.8</text><polygon fill="#000000" points="564.5,209.3594,554.5,213.3594,564.5,217.3594,560.5,213.3594" style="stroke: #000000; stroke-width: 1.0;"/><line style="stroke: #000000; stroke-width: 1.0;" x1="558.5" x2="756.5" y1="213.3594" y2="213.3594"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="122" x="570.5" y="193.1606">167, ICMP ping rsp.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="180" x="570.5" y="208.2935">+21.476s (16:1:23.627.574)</text><path d="M762,186.6602 L762,211.6602 L888,211.6602 L888,196.6602 L878,186.6602 L762,186.6602 " fill="#EDFEC2" style="stroke: #FFFFFF; stroke-width: 1.0;"/><path d="M878,186.6602 L878,196.6602 L888,196.6602 L878,186.6602 " fill="#EDFEC2" style="stroke: #FFFFFF; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="105" x="768" y="203.7271">8.8.8.8 to UPF</text><polygon fill="#000000" points="200.5,253.625,190.5,257.625,200.5,261.625,196.5,257.625" style="stroke: #000000; stroke-width: 1.0;"/><line style="stroke: #000000; stroke-width: 1.0;" x1="194.5" x2="756.5" y1="257.625" y2="257.625"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="122" x="206.5" y="237.4263">168, ICMP ping rsp.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="180" x="206.5" y="252.5591">+21.476s (16:1:23.627.602)</text><path d="M762,230.9258 L762,255.9258 L878,255.9258 L878,240.9258 L868,230.9258 L762,230.9258 " fill="#EDFEC2" style="stroke: #FFFFFF; stroke-width: 1.0;"/><path d="M868,230.9258 L868,240.9258 L878,240.9258 L868,230.9258 " fill="#EDFEC2" style="stroke: #FFFFFF; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="95" x="768" y="247.9927">8.8.8.8 to UE</text><polygon fill="#000000" points="248.5,297.8906,238.5,301.8906,248.5,305.8906,244.5,301.8906" style="stroke: #000000; stroke-width: 1.0;"/><line style="stroke: #000000; stroke-width: 1.0;" x1="242.5" x2="552.5" y1="301.8906" y2="301.8906"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="169" x="254.5" y="281.6919">169, GTP&lt;ICMP&gt; ping rsp.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="180" x="254.5" y="296.8247">+21.476s (16:1:23.627.928)</text><path d="M558,275.1914 L558,300.1914 L664,300.1914 L664,285.1914 L654,275.1914 L558,275.1914 " fill="#EDFEC2" style="stroke: #FFFFFF; stroke-width: 1.0;"/><path d="M654,275.1914 L654,285.1914 L664,285.1914 L654,275.1914 " fill="#EDFEC2" style="stroke: #FFFFFF; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="85" x="564" y="292.2583">UPF to gNB</text><polygon fill="#000000" points="541.5,357.2891,551.5,361.2891,541.5,365.2891,545.5,361.2891" style="stroke: #000000; stroke-width: 1.0;"/><line style="stroke: #000000; stroke-width: 1.0;" x1="85.5" x2="547.5" y1="361.2891" y2="361.2891"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="93" x="92.5" y="325.9575">717, PFCP req.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="229" x="92.5" y="341.0903">PFCP Association Setup Request (5)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="180" x="92.5" y="356.2231">+78.542s (16:2:20.693.785)</text><path d="M558,327.0234 L558,352.0234 L785,352.0234 L785,337.0234 L775,327.0234 L558,327.0234 " fill="#FFC2D9" style="stroke: #FFFFFF; stroke-width: 1.0;"/><path d="M775,327.0234 L775,337.0234 L785,337.0234 L775,327.0234 " fill="#FFC2D9" style="stroke: #FFFFFF; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="206" x="564" y="344.0903">Spoofed IPs 10.*.0.1 to UPF</text><polygon fill="#000000" points="96.5,416.6875,86.5,420.6875,96.5,424.6875,92.5,420.6875" style="stroke: #000000; stroke-width: 1.0;"/><line style="stroke: #000000; stroke-width: 1.0;" x1="90.5" x2="552.5" y1="420.6875" y2="420.6875"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="92" x="102.5" y="385.356">718, PFCP rsp.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="239" x="102.5" y="400.4888">PFCP Association Setup Response (6)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="180" x="102.5" y="415.6216">+78.547s (16:2:20.698.402)</text><path d="M558,386.4219 L558,411.4219 L785,411.4219 L785,396.4219 L775,386.4219 L558,386.4219 " fill="#FFEAC2" style="stroke: #FFFFFF; stroke-width: 1.0;"/><path d="M775,386.4219 L775,396.4219 L785,396.4219 L775,386.4219 " fill="#FFEAC2" style="stroke: #FFFFFF; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="206" x="564" y="403.4888">UPF to Spoofed IPs 10.*.0.1</text><polygon fill="#000000" points="301.5,476.0859,291.5,480.0859,301.5,484.0859,297.5,480.0859" style="stroke: #000000; stroke-width: 1.0;"/><line style="stroke: #000000; stroke-width: 1.0;" x1="295.5" x2="552.5" y1="480.0859" y2="480.0859"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="101" x="307.5" y="444.7544">1110, PFCP req.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="229" x="307.5" y="459.8872">PFCP Association Setup Request (5)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="180" x="307.5" y="475.02">+88.259s (16:2:30.410.702)</text><path d="M558,445.8203 L558,470.8203 L664,470.8203 L664,455.8203 L654,445.8203 L558,445.8203 " fill="#03B5AA" style="stroke: #FFFFFF; stroke-width: 1.0;"/><path d="M654,445.8203 L654,455.8203 L664,455.8203 L654,445.8203 " fill="#03B5AA" style="stroke: #FFFFFF; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="85" x="564" y="462.8872">UPF to SMF</text><polygon fill="#000000" points="541.5,535.4844,551.5,539.4844,541.5,543.4844,545.5,539.4844" style="stroke: #000000; stroke-width: 1.0;"/><line style="stroke: #000000; stroke-width: 1.0;" x1="290.5" x2="547.5" y1="539.4844" y2="539.4844"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="100" x="297.5" y="504.1528">1111, PFCP rsp.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="239" x="297.5" y="519.2856">PFCP Association Setup Response (6)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="180" x="297.5" y="534.4185">+88.267s (16:2:30.419.111)</text><path d="M558,505.2188 L558,530.2188 L664,530.2188 L664,515.2188 L654,505.2188 L558,505.2188 " fill="#D7FEFC" style="stroke: #FFFFFF; stroke-width: 1.0;"/><path d="M654,505.2188 L654,515.2188 L664,515.2188 L654,505.2188 " fill="#D7FEFC" style="stroke: #FFFFFF; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="85" x="564" y="522.2856">SMF to UPF</text><polygon fill="#000000" points="541.5,579.75,551.5,583.75,541.5,587.75,545.5,583.75" style="stroke: #000000; stroke-width: 1.0;"/><line style="stroke: #000000; stroke-width: 1.0;" x1="237.5" x2="547.5" y1="583.75" y2="583.75"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="178" x="244.5" y="563.5513">1296, GTP&lt;ICMP&gt; ping req.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="180" x="244.5" y="578.6841">+92.766s (16:2:34.918.138)</text><path d="M558,557.0508 L558,582.0508 L664,582.0508 L664,567.0508 L654,557.0508 L558,557.0508 " fill="#5C8001" style="stroke: #FFFFFF; stroke-width: 1.0;"/><path d="M654,557.0508 L654,567.0508 L664,567.0508 L654,557.0508 " fill="#5C8001" style="stroke: #FFFFFF; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="85" x="564" y="574.1177">gNB to UPF</text><!--MD5=[bf9aff0e010e23a7a467d5c0a0ab4b7c]
@startuml
skinparam shadowing false
skinparam NoteBorderColor white
skinparam sequence {
    ArrowColor black
    LifeLineBorderColor black
    LifeLineBackgroundColor black
    ParticipantBorderColor white
    ParticipantBackgroundColor #e6e6e6
}
participant "Spoofed IPs 10.*.0.1"
participant "UE"
participant "gNB"
participant "SMF"
participant "UPF"

"gNB" -> "UPF": 164, GTP<ICMP> ping req.\n+21.451s (16:1:23.602.934)

note right #5C8001
**gNB to UPF**
end note

"UE" -> "8.8.8.8": 165, ICMP ping req.\n+21.452s (16:1:23.604.018)

note right #5C8001
**UE to 8.8.8.8**
end note

"UPF" -> "8.8.8.8": 166, ICMP ping req.\n+21.452s (16:1:23.604.057)

note right #5C8001
**UPF to 8.8.8.8**
end note

"8.8.8.8" -> "UPF": 167, ICMP ping rsp.\n+21.476s (16:1:23.627.574)

note right #EDFEC2
**8.8.8.8 to UPF**
end note

"8.8.8.8" -> "UE": 168, ICMP ping rsp.\n+21.476s (16:1:23.627.602)

note right #EDFEC2
**8.8.8.8 to UE**
end note

"UPF" -> "gNB": 169, GTP<ICMP> ping rsp.\n+21.476s (16:1:23.627.928)

note right #EDFEC2
**UPF to gNB**
end note
"Spoofed IPs 10.*.0.1" -> "UPF": 717, PFCP req.\nPFCP Association Setup Request (5)\n+78.542s (16:2:20.693.785)

note right #FFC2D9
**Spoofed IPs 10.*.0.1 to UPF**
end note

"UPF" -> "Spoofed IPs 10.*.0.1": 718, PFCP rsp.\nPFCP Association Setup Response (6)\n+78.547s (16:2:20.698.402)

note right #FFEAC2
**UPF to Spoofed IPs 10.*.0.1**
end note

"UPF" -> "SMF": 1110, PFCP req.\nPFCP Association Setup Request (5)\n+88.259s (16:2:30.410.702)

note right #03B5AA
**UPF to SMF**
end note

"SMF" -> "UPF": 1111, PFCP rsp.\nPFCP Association Setup Response (6)\n+88.267s (16:2:30.419.111)

note right #D7FEFC
**SMF to UPF**
end note

"gNB" -> "UPF": 1296, GTP<ICMP> ping req.\n+92.766s (16:2:34.918.138)

note right #5C8001
**gNB to UPF**
end note

@enduml

PlantUML version 1.2019.12(Sun Nov 03 11:24:54 CET 2019)
(APACHE source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Java Version: 11.0.17+8-post-Ubuntu-1ubuntu220.04
Operating System: Linux
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>