<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="523px" preserveAspectRatio="none" style="width:788px;height:523px;" version="1.1" viewBox="0 0 788 523" width="788px" zoomAndPan="magnify"><defs/><g><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="85" x2="85" y1="34.2969" y2="482.9531"/><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="189" x2="189" y1="34.2969" y2="482.9531"/><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="237" x2="237" y1="34.2969" y2="482.9531"/><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="290" x2="290" y1="34.2969" y2="482.9531"/><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="441" x2="441" y1="34.2969" y2="482.9531"/><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="645.5" x2="645.5" y1="34.2969" y2="482.9531"/><rect fill="#E6E6E6" height="30.2969" style="stroke: #FFFFFF; stroke-width: 1.5;" width="155" x="8" y="3"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="141" x="15" y="22.9951">Spoofed IPs 10.*.0.1</text><rect fill="#E6E6E6" height="30.2969" style="stroke: #FFFFFF; stroke-width: 1.5;" width="155" x="8" y="481.9531"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="141" x="15" y="501.9482">Spoofed IPs 10.*.0.1</text><rect fill="#E6E6E6" height="30.2969" style="stroke: #FFFFFF; stroke-width: 1.5;" width="33" x="173" y="3"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="19" x="180" y="22.9951">UE</text><rect fill="#E6E6E6" height="30.2969" style="stroke: #FFFFFF; stroke-width: 1.5;" width="33" x="173" y="481.9531"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="19" x="180" y="501.9482">UE</text><rect fill="#E6E6E6" height="30.2969" style="stroke: #FFFFFF; stroke-width: 1.5;" width="43" x="216" y="3"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="29" x="223" y="22.9951">gNB</text><rect fill="#E6E6E6" height="30.2969" style="stroke: #FFFFFF; stroke-width: 1.5;" width="43" x="216" y="481.9531"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="29" x="223" y="501.9482">gNB</text><rect fill="#E6E6E6" height="30.2969" style="stroke: #FFFFFF; stroke-width: 1.5;" width="43" x="269" y="3"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="29" x="276" y="22.9951">SMF</text><rect fill="#E6E6E6" height="30.2969" style="stroke: #FFFFFF; stroke-width: 1.5;" width="43" x="269" y="481.9531"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="29" x="276" y="501.9482">SMF</text><rect fill="#E6E6E6" height="30.2969" style="stroke: #FFFFFF; stroke-width: 1.5;" width="41" x="421" y="3"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="27" x="428" y="22.9951">UPF</text><rect fill="#E6E6E6" height="30.2969" style="stroke: #FFFFFF; stroke-width: 1.5;" width="41" x="421" y="481.9531"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="27" x="428" y="501.9482">UPF</text><rect fill="#E6E6E6" height="30.2969" style="stroke: #FFFFFF; stroke-width: 1.5;" width="62" x="614.5" y="3"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="48" x="621.5" y="22.9951">8.8.8.8</text><rect fill="#E6E6E6" height="30.2969" style="stroke: #FFFFFF; stroke-width: 1.5;" width="62" x="614.5" y="481.9531"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="48" x="621.5" y="501.9482">8.8.8.8</text><polygon fill="#000000" points="429.5,76.5625,439.5,80.5625,429.5,84.5625,433.5,80.5625" style="stroke: #000000; stroke-width: 1.0;"/><line style="stroke: #000000; stroke-width: 1.0;" x1="237.5" x2="435.5" y1="80.5625" y2="80.5625"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="170" x="244.5" y="60.3638">164, GTP&lt;ICMP&gt; ping req.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="180" x="244.5" y="75.4966">+21.451s (16:1:23.602.934)</text><path d="M446,53.8633 L446,78.8633 L552,78.8633 L552,63.8633 L542,53.8633 L446,53.8633 " fill="#5C8001" style="stroke: #FFFFFF; stroke-width: 1.0;"/><path d="M542,53.8633 L542,63.8633 L552,63.8633 L542,53.8633 " fill="#5C8001" style="stroke: #FFFFFF; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="85" x="452" y="70.9302">gNB to UPF</text><polygon fill="#000000" points="633.5,120.8281,643.5,124.8281,633.5,128.8281,637.5,124.8281" style="stroke: #000000; stroke-width: 1.0;"/><line style="stroke: #000000; stroke-width: 1.0;" x1="189.5" x2="639.5" y1="124.8281" y2="124.8281"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="123" x="196.5" y="104.6294">165, ICMP ping req.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="180" x="196.5" y="119.7622">+21.452s (16:1:23.604.018)</text><path d="M650,98.1289 L650,123.1289 L766,123.1289 L766,108.1289 L756,98.1289 L650,98.1289 " fill="#5C8001" style="stroke: #FFFFFF; stroke-width: 1.0;"/><path d="M756,98.1289 L756,108.1289 L766,108.1289 L756,98.1289 " fill="#5C8001" style="stroke: #FFFFFF; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="95" x="656" y="115.1958">UE to 8.8.8.8</text><polygon fill="#000000" points="633.5,165.0938,643.5,169.0938,633.5,173.0938,637.5,169.0938" style="stroke: #000000; stroke-width: 1.0;"/><line style="stroke: #000000; stroke-width: 1.0;" x1="441.5" x2="639.5" y1="169.0938" y2="169.0938"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="123" x="448.5" y="148.895">166, ICMP ping req.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="180" x="448.5" y="164.0278">+21.452s (16:1:23.604.057)</text><path d="M650,142.3945 L650,167.3945 L776,167.3945 L776,152.3945 L766,142.3945 L650,142.3945 " fill="#5C8001" style="stroke: #FFFFFF; stroke-width: 1.0;"/><path d="M766,142.3945 L766,152.3945 L776,152.3945 L766,142.3945 " fill="#5C8001" style="stroke: #FFFFFF; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="105" x="656" y="159.4614">UPF to 8.8.8.8</text><polygon fill="#000000" points="452.5,209.3594,442.5,213.3594,452.5,217.3594,448.5,213.3594" style="stroke: #000000; stroke-width: 1.0;"/><line style="stroke: #000000; stroke-width: 1.0;" x1="446.5" x2="644.5" y1="213.3594" y2="213.3594"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="122" x="458.5" y="193.1606">167, ICMP ping rsp.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="180" x="458.5" y="208.2935">+21.476s (16:1:23.627.574)</text><path d="M650,186.6602 L650,211.6602 L776,211.6602 L776,196.6602 L766,186.6602 L650,186.6602 " fill="#EDFEC2" style="stroke: #FFFFFF; stroke-width: 1.0;"/><path d="M766,186.6602 L766,196.6602 L776,196.6602 L766,186.6602 " fill="#EDFEC2" style="stroke: #FFFFFF; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="105" x="656" y="203.7271">8.8.8.8 to UPF</text><polygon fill="#000000" points="200.5,253.625,190.5,257.625,200.5,261.625,196.5,257.625" style="stroke: #000000; stroke-width: 1.0;"/><line style="stroke: #000000; stroke-width: 1.0;" x1="194.5" x2="644.5" y1="257.625" y2="257.625"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="122" x="206.5" y="237.4263">168, ICMP ping rsp.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="180" x="206.5" y="252.5591">+21.476s (16:1:23.627.602)</text><path d="M650,230.9258 L650,255.9258 L766,255.9258 L766,240.9258 L756,230.9258 L650,230.9258 " fill="#EDFEC2" style="stroke: #FFFFFF; stroke-width: 1.0;"/><path d="M756,230.9258 L756,240.9258 L766,240.9258 L756,230.9258 " fill="#EDFEC2" style="stroke: #FFFFFF; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="95" x="656" y="247.9927">8.8.8.8 to UE</text><polygon fill="#000000" points="248.5,297.8906,238.5,301.8906,248.5,305.8906,244.5,301.8906" style="stroke: #000000; stroke-width: 1.0;"/><line style="stroke: #000000; stroke-width: 1.0;" x1="242.5" x2="440.5" y1="301.8906" y2="301.8906"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="169" x="254.5" y="281.6919">169, GTP&lt;ICMP&gt; ping rsp.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="180" x="254.5" y="296.8247">+21.476s (16:1:23.627.928)</text><path d="M446,275.1914 L446,300.1914 L552,300.1914 L552,285.1914 L542,275.1914 L446,275.1914 " fill="#EDFEC2" style="stroke: #FFFFFF; stroke-width: 1.0;"/><path d="M542,275.1914 L542,285.1914 L552,285.1914 L542,275.1914 " fill="#EDFEC2" style="stroke: #FFFFFF; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="85" x="452" y="292.2583">UPF to gNB</text><polygon fill="#000000" points="429.5,357.2891,439.5,361.2891,429.5,365.2891,433.5,361.2891" style="stroke: #000000; stroke-width: 1.0;"/><line style="stroke: #000000; stroke-width: 1.0;" x1="85.5" x2="435.5" y1="361.2891" y2="361.2891"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="93" x="92.5" y="325.9575">717, PFCP req.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="229" x="92.5" y="341.0903">PFCP Association Setup Request (5)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="180" x="92.5" y="356.2231">+78.542s (16:2:20.693.785)</text><path d="M446,327.0234 L446,352.0234 L673,352.0234 L673,337.0234 L663,327.0234 L446,327.0234 " fill="#FFC2D9" style="stroke: #FFFFFF; stroke-width: 1.0;"/><path d="M663,327.0234 L663,337.0234 L673,337.0234 L663,327.0234 " fill="#FFC2D9" style="stroke: #FFFFFF; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="206" x="452" y="344.0903">Spoofed IPs 10.*.0.1 to UPF</text><polygon fill="#000000" points="96.5,416.6875,86.5,420.6875,96.5,424.6875,92.5,420.6875" style="stroke: #000000; stroke-width: 1.0;"/><line style="stroke: #000000; stroke-width: 1.0;" x1="90.5" x2="440.5" y1="420.6875" y2="420.6875"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="92" x="102.5" y="385.356">718, PFCP rsp.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="239" x="102.5" y="400.4888">PFCP Association Setup Response (6)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="180" x="102.5" y="415.6216">+78.547s (16:2:20.698.402)</text><path d="M446,386.4219 L446,411.4219 L673,411.4219 L673,396.4219 L663,386.4219 L446,386.4219 " fill="#FFEAC2" style="stroke: #FFFFFF; stroke-width: 1.0;"/><path d="M663,386.4219 L663,396.4219 L673,396.4219 L663,386.4219 " fill="#FFEAC2" style="stroke: #FFFFFF; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="206" x="452" y="403.4888">UPF to Spoofed IPs 10.*.0.1</text><polygon fill="#000000" points="429.5,460.9531,439.5,464.9531,429.5,468.9531,433.5,464.9531" style="stroke: #000000; stroke-width: 1.0;"/><line style="stroke: #000000; stroke-width: 1.0;" x1="237.5" x2="435.5" y1="464.9531" y2="464.9531"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="178" x="244.5" y="444.7544">1296, GTP&lt;ICMP&gt; ping req.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="180" x="244.5" y="459.8872">+92.766s (16:2:34.918.138)</text><path d="M446,438.2539 L446,463.2539 L552,463.2539 L552,448.2539 L542,438.2539 L446,438.2539 " fill="#5C8001" style="stroke: #FFFFFF; stroke-width: 1.0;"/><path d="M542,438.2539 L542,448.2539 L552,448.2539 L542,438.2539 " fill="#5C8001" style="stroke: #FFFFFF; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="85" x="452" y="455.3208">gNB to UPF</text><!--MD5=[d2fa3fea25dcd4fc983835055109671b]
@startuml
skinparam shadowing false
skinparam NoteBorderColor white
skinparam sequence {
    ArrowColor black
    LifeLineBorderColor black
    LifeLineBackgroundColor black
    ParticipantBorderColor white
    ParticipantBackgroundColor #e6e6e6
}
participant "Spoofed IPs 10.*.0.1"
participant "UE"
participant "gNB"
participant "SMF"
participant "UPF"

"gNB" -> "UPF": 164, GTP<ICMP> ping req.\n+21.451s (16:1:23.602.934)

note right #5C8001
**gNB to UPF**
end note

"UE" -> "8.8.8.8": 165, ICMP ping req.\n+21.452s (16:1:23.604.018)

note right #5C8001
**UE to 8.8.8.8**
end note

"UPF" -> "8.8.8.8": 166, ICMP ping req.\n+21.452s (16:1:23.604.057)

note right #5C8001
**UPF to 8.8.8.8**
end note

"8.8.8.8" -> "UPF": 167, ICMP ping rsp.\n+21.476s (16:1:23.627.574)

note right #EDFEC2
**8.8.8.8 to UPF**
end note

"8.8.8.8" -> "UE": 168, ICMP ping rsp.\n+21.476s (16:1:23.627.602)

note right #EDFEC2
**8.8.8.8 to UE**
end note

"UPF" -> "gNB": 169, GTP<ICMP> ping rsp.\n+21.476s (16:1:23.627.928)

note right #EDFEC2
**UPF to gNB**
end note
"Spoofed IPs 10.*.0.1" -> "UPF": 717, PFCP req.\nPFCP Association Setup Request (5)\n+78.542s (16:2:20.693.785)

note right #FFC2D9
**Spoofed IPs 10.*.0.1 to UPF**
end note

"UPF" -> "Spoofed IPs 10.*.0.1": 718, PFCP rsp.\nPFCP Association Setup Response (6)\n+78.547s (16:2:20.698.402)

note right #FFEAC2
**UPF to Spoofed IPs 10.*.0.1**
end note

"gNB" -> "UPF": 1296, GTP<ICMP> ping req.\n+92.766s (16:2:34.918.138)

note right #5C8001
**gNB to UPF**
end note

@enduml

PlantUML version 1.2019.12(Sun Nov 03 11:24:54 CET 2019)
(APACHE source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Java Version: 11.0.17+8-post-Ubuntu-1ubuntu220.04
Operating System: Linux
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>