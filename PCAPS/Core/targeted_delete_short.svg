<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="537px" preserveAspectRatio="none" style="width:802px;height:537px;" version="1.1" viewBox="0 0 802 537" width="802px" zoomAndPan="magnify"><defs/><g><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="58" x2="58" y1="34.2969" y2="496.9531"/><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="168" x2="168" y1="34.2969" y2="496.9531"/><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="249" x2="249" y1="34.2969" y2="496.9531"/><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="302" x2="302" y1="34.2969" y2="496.9531"/><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="355" x2="355" y1="34.2969" y2="496.9531"/><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="618" x2="618" y1="34.2969" y2="496.9531"/><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="677" x2="677" y1="34.2969" y2="496.9531"/><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="744" x2="744" y1="34.2969" y2="496.9531"/><rect fill="#E6E6E6" height="30.2969" style="stroke: #FFFFFF; stroke-width: 1.5;" width="100" x="8" y="3"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="86" x="15" y="22.9951">Malicious UE</text><rect fill="#E6E6E6" height="30.2969" style="stroke: #FFFFFF; stroke-width: 1.5;" width="100" x="8" y="495.9531"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="86" x="15" y="515.9482">Malicious UE</text><rect fill="#E6E6E6" height="30.2969" style="stroke: #FFFFFF; stroke-width: 1.5;" width="100" x="118" y="3"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="86" x="125" y="22.9951">Targeted UE</text><rect fill="#E6E6E6" height="30.2969" style="stroke: #FFFFFF; stroke-width: 1.5;" width="100" x="118" y="495.9531"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="86" x="125" y="515.9482">Targeted UE</text><rect fill="#E6E6E6" height="30.2969" style="stroke: #FFFFFF; stroke-width: 1.5;" width="43" x="228" y="3"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="29" x="235" y="22.9951">gNB</text><rect fill="#E6E6E6" height="30.2969" style="stroke: #FFFFFF; stroke-width: 1.5;" width="43" x="228" y="495.9531"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="29" x="235" y="515.9482">gNB</text><rect fill="#E6E6E6" height="30.2969" style="stroke: #FFFFFF; stroke-width: 1.5;" width="43" x="281" y="3"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="29" x="288" y="22.9951">AMF</text><rect fill="#E6E6E6" height="30.2969" style="stroke: #FFFFFF; stroke-width: 1.5;" width="43" x="281" y="495.9531"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="29" x="288" y="515.9482">AMF</text><rect fill="#E6E6E6" height="30.2969" style="stroke: #FFFFFF; stroke-width: 1.5;" width="43" x="334" y="3"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="29" x="341" y="22.9951">SMF</text><rect fill="#E6E6E6" height="30.2969" style="stroke: #FFFFFF; stroke-width: 1.5;" width="43" x="334" y="495.9531"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="29" x="341" y="515.9482">SMF</text><rect fill="#E6E6E6" height="30.2969" style="stroke: #FFFFFF; stroke-width: 1.5;" width="41" x="598" y="3"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="27" x="605" y="22.9951">UPF</text><rect fill="#E6E6E6" height="30.2969" style="stroke: #FFFFFF; stroke-width: 1.5;" width="41" x="598" y="495.9531"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="27" x="605" y="515.9482">UPF</text><rect fill="#E6E6E6" height="30.2969" style="stroke: #FFFFFF; stroke-width: 1.5;" width="57" x="649" y="3"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="43" x="656" y="22.9951">SGWU</text><rect fill="#E6E6E6" height="30.2969" style="stroke: #FFFFFF; stroke-width: 1.5;" width="57" x="649" y="495.9531"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="43" x="656" y="515.9482">SGWU</text><rect fill="#E6E6E6" height="30.2969" style="stroke: #FFFFFF; stroke-width: 1.5;" width="57" x="716" y="3"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="43" x="723" y="22.9951">SGWC</text><rect fill="#E6E6E6" height="30.2969" style="stroke: #FFFFFF; stroke-width: 1.5;" width="57" x="716" y="495.9531"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="43" x="723" y="515.9482">SGWC</text><polygon fill="#000000" points="606.5,76.5625,616.5,80.5625,606.5,84.5625,610.5,80.5625" style="stroke: #000000; stroke-width: 1.0;"/><line style="stroke: #000000; stroke-width: 1.0;" x1="249.5" x2="612.5" y1="80.5625" y2="80.5625"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="101" x="256.5" y="60.3638">4335, PFCP req.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="229" x="256.5" y="75.4966">PFCP Association Setup Request (5)</text><path d="M623,53.8633 L623,78.8633 L729,78.8633 L729,63.8633 L719,53.8633 L623,53.8633 " fill="#03B5AA" style="stroke: #FFFFFF; stroke-width: 1.0;"/><path d="M719,53.8633 L719,63.8633 L729,63.8633 L719,53.8633 " fill="#03B5AA" style="stroke: #FFFFFF; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="85" x="629" y="70.9302">gNB to UPF</text><polygon fill="#000000" points="606.5,120.8281,616.5,124.8281,606.5,128.8281,610.5,124.8281" style="stroke: #000000; stroke-width: 1.0;"/><line style="stroke: #000000; stroke-width: 1.0;" x1="58" x2="612.5" y1="124.8281" y2="124.8281"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="101" x="65" y="104.6294">4335, PFCP req.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="229" x="65" y="119.7622">PFCP Association Setup Request (5)</text><path d="M623,98.1289 L623,123.1289 L729,123.1289 L729,108.1289 L719,98.1289 L623,98.1289 " fill="#FFC2D9" style="stroke: #FFFFFF; stroke-width: 1.0;"/><path d="M719,98.1289 L719,108.1289 L729,108.1289 L719,98.1289 " fill="#FFC2D9" style="stroke: #FFFFFF; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="85" x="629" y="115.1958">gNB to UPF</text><polygon fill="#000000" points="69,165.0938,59,169.0938,69,173.0938,65,169.0938" style="stroke: #000000; stroke-width: 1.0;"/><line style="stroke: #000000; stroke-width: 1.0;" x1="63" x2="617.5" y1="169.0938" y2="169.0938"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="100" x="75" y="148.895">4337, PFCP rsp.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="239" x="75" y="164.0278">PFCP Association Setup Response (6)</text><path d="M623,142.3945 L623,167.3945 L790,167.3945 L790,152.3945 L780,142.3945 L623,142.3945 " fill="#FFEAC2" style="stroke: #FFFFFF; stroke-width: 1.0;"/><path d="M780,142.3945 L780,152.3945 L790,152.3945 L780,142.3945 " fill="#FFEAC2" style="stroke: #FFFFFF; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="146" x="629" y="159.4614">UPF to Malicious UE</text><polygon fill="#000000" points="260.5,209.3594,250.5,213.3594,260.5,217.3594,256.5,213.3594" style="stroke: #000000; stroke-width: 1.0;"/><line style="stroke: #000000; stroke-width: 1.0;" x1="254.5" x2="617.5" y1="213.3594" y2="213.3594"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="100" x="266.5" y="193.1606">4338, PFCP rsp.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="239" x="266.5" y="208.2935">PFCP Association Setup Response (6)</text><path d="M623,186.6602 L623,211.6602 L729,211.6602 L729,196.6602 L719,186.6602 L623,186.6602 " fill="#FFEAC2" style="stroke: #FFFFFF; stroke-width: 1.0;"/><path d="M719,186.6602 L719,196.6602 L729,196.6602 L719,186.6602 " fill="#FFEAC2" style="stroke: #FFFFFF; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="85" x="629" y="203.7271">UPF to gNB</text><polygon fill="#000000" points="606.5,253.625,616.5,257.625,606.5,261.625,610.5,257.625" style="stroke: #000000; stroke-width: 1.0;"/><line style="stroke: #000000; stroke-width: 1.0;" x1="249.5" x2="612.5" y1="257.625" y2="257.625"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="345" x="256.5" y="237.4263">4339, &lt;PORT_UNREACHABLE&gt; PFCP,GTP&lt;ICMP&gt; rsp.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="239" x="256.5" y="252.5591">PFCP Association Setup Response (6)</text><path d="M623,230.9258 L623,255.9258 L729,255.9258 L729,240.9258 L719,230.9258 L623,230.9258 " fill="#D7FEFC" style="stroke: #FFFFFF; stroke-width: 1.0;"/><path d="M719,230.9258 L719,240.9258 L729,240.9258 L719,230.9258 " fill="#D7FEFC" style="stroke: #FFFFFF; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="85" x="629" y="247.9927">gNB to UPF</text><polygon fill="#000000" points="606.5,297.8906,616.5,301.8906,606.5,305.8906,610.5,301.8906" style="stroke: #000000; stroke-width: 1.0;"/><line style="stroke: #000000; stroke-width: 1.0;" x1="249.5" x2="612.5" y1="301.8906" y2="301.8906"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="101" x="256.5" y="281.6919">4341, PFCP req.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="229" x="256.5" y="296.8247">PFCP Session Deletion Request (54)</text><path d="M623,275.1914 L623,300.1914 L729,300.1914 L729,285.1914 L719,275.1914 L623,275.1914 " fill="#03B5AA" style="stroke: #FFFFFF; stroke-width: 1.0;"/><path d="M719,275.1914 L719,285.1914 L729,285.1914 L719,275.1914 " fill="#03B5AA" style="stroke: #FFFFFF; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="85" x="629" y="292.2583">gNB to UPF</text><polygon fill="#000000" points="606.5,342.1563,616.5,346.1563,606.5,350.1563,610.5,346.1563" style="stroke: #000000; stroke-width: 1.0;"/><line style="stroke: #000000; stroke-width: 1.0;" x1="58" x2="612.5" y1="346.1563" y2="346.1563"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="101" x="65" y="325.9575">4341, PFCP req.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="229" x="65" y="341.0903">PFCP Session Deletion Request (54)</text><path d="M623,319.457 L623,344.457 L729,344.457 L729,329.457 L719,319.457 L623,319.457 " fill="#FFC2D9" style="stroke: #FFFFFF; stroke-width: 1.0;"/><path d="M719,319.457 L719,329.457 L729,329.457 L719,319.457 " fill="#FFC2D9" style="stroke: #FFFFFF; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="85" x="629" y="336.5239">gNB to UPF</text><polygon fill="#000000" points="69,386.4219,59,390.4219,69,394.4219,65,390.4219" style="stroke: #000000; stroke-width: 1.0;"/><line style="stroke: #000000; stroke-width: 1.0;" x1="63" x2="617.5" y1="390.4219" y2="390.4219"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="100" x="75" y="370.2231">4343, PFCP rsp.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="239" x="75" y="385.356">PFCP Session Deletion Response (55)</text><path d="M623,363.7227 L623,388.7227 L790,388.7227 L790,373.7227 L780,363.7227 L623,363.7227 " fill="#FFEAC2" style="stroke: #FFFFFF; stroke-width: 1.0;"/><path d="M780,363.7227 L780,373.7227 L790,373.7227 L780,363.7227 " fill="#FFEAC2" style="stroke: #FFFFFF; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="146" x="629" y="380.7896">UPF to Malicious UE</text><polygon fill="#000000" points="260.5,430.6875,250.5,434.6875,260.5,438.6875,256.5,434.6875" style="stroke: #000000; stroke-width: 1.0;"/><line style="stroke: #000000; stroke-width: 1.0;" x1="254.5" x2="617.5" y1="434.6875" y2="434.6875"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="100" x="266.5" y="414.4888">4344, PFCP rsp.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="239" x="266.5" y="429.6216">PFCP Session Deletion Response (55)</text><path d="M623,407.9883 L623,432.9883 L729,432.9883 L729,417.9883 L719,407.9883 L623,407.9883 " fill="#FFEAC2" style="stroke: #FFFFFF; stroke-width: 1.0;"/><path d="M719,407.9883 L719,417.9883 L729,417.9883 L719,407.9883 " fill="#FFEAC2" style="stroke: #FFFFFF; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="85" x="629" y="425.0552">UPF to gNB</text><polygon fill="#000000" points="606.5,474.9531,616.5,478.9531,606.5,482.9531,610.5,478.9531" style="stroke: #000000; stroke-width: 1.0;"/><line style="stroke: #000000; stroke-width: 1.0;" x1="249.5" x2="612.5" y1="478.9531" y2="478.9531"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="345" x="256.5" y="458.7544">4345, &lt;PORT_UNREACHABLE&gt; PFCP,GTP&lt;ICMP&gt; rsp.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="239" x="256.5" y="473.8872">PFCP Session Deletion Response (55)</text><path d="M623,452.2539 L623,477.2539 L729,477.2539 L729,462.2539 L719,452.2539 L623,452.2539 " fill="#D7FEFC" style="stroke: #FFFFFF; stroke-width: 1.0;"/><path d="M719,452.2539 L719,462.2539 L729,462.2539 L719,452.2539 " fill="#D7FEFC" style="stroke: #FFFFFF; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="85" x="629" y="469.3208">gNB to UPF</text><!--MD5=[1096253ba339d8e049b7d1423f24012f]
@startuml
skinparam shadowing false
skinparam NoteBorderColor white
skinparam sequence {
    ArrowColor black
    LifeLineBorderColor black
    LifeLineBackgroundColor black
    ParticipantBorderColor white
    ParticipantBackgroundColor #e6e6e6
}

participant "Malicious UE"
participant "Targeted UE"
participant "gNB"
participant "AMF"
participant "SMF"
participant "UPF"
participant "SGWU"
participant "SGWC"

"gNB" -> "UPF": 4335, PFCP req.\nPFCP Association Setup Request (5)

note right #03B5AA
**gNB to UPF**
end note

"Malicious UE" -> "UPF": 4335, PFCP req.\nPFCP Association Setup Request (5)

note right #FFC2D9
**gNB to UPF**
end note

"UPF" -> "Malicious UE": 4337, PFCP rsp.\nPFCP Association Setup Response (6)

note right #FFEAC2
**UPF to Malicious UE**
end note

"UPF" -> "gNB": 4338, PFCP rsp.\nPFCP Association Setup Response (6)

note right #FFEAC2
**UPF to gNB**
end note

"gNB" -> "UPF": 4339, <PORT_UNREACHABLE> PFCP,GTP<ICMP> rsp.\nPFCP Association Setup Response (6)

note right #D7FEFC
**gNB to UPF**
end note

"gNB" -> "UPF": 4341, PFCP req.\nPFCP Session Deletion Request (54)

note right #03B5AA
**gNB to UPF**
end note

"Malicious UE" -> "UPF": 4341, PFCP req.\nPFCP Session Deletion Request (54)

note right #FFC2D9
**gNB to UPF**
end note


"UPF" -> "Malicious UE": 4343, PFCP rsp.\nPFCP Session Deletion Response (55)

note right #FFEAC2
**UPF to Malicious UE**
end note

"UPF" -> "gNB": 4344, PFCP rsp.\nPFCP Session Deletion Response (55)

note right #FFEAC2
**UPF to gNB**
end note

"gNB" -> "UPF": 4345, <PORT_UNREACHABLE> PFCP,GTP<ICMP> rsp.\nPFCP Session Deletion Response (55)

note right #D7FEFC
**gNB to UPF**
end note


@enduml

PlantUML version 1.2019.12(Sun Nov 03 11:24:54 CET 2019)
(APACHE source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Java Version: 11.0.18+10-post-Ubuntu-0ubuntu120.04.1
Operating System: Linux
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>