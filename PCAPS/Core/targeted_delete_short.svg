<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="537px" preserveAspectRatio="none" style="width:692px;height:537px;" version="1.1" viewBox="0 0 692 537" width="692px" zoomAndPan="magnify"><defs/><g><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="58" x2="58" y1="34.2969" y2="496.9531"/><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="139" x2="139" y1="34.2969" y2="496.9531"/><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="508" x2="508" y1="34.2969" y2="496.9531"/><rect fill="#E6E6E6" height="30.2969" style="stroke: #FFFFFF; stroke-width: 1.5;" width="100" x="8" y="3"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="86" x="15" y="22.9951">Malicious UE</text><rect fill="#E6E6E6" height="30.2969" style="stroke: #FFFFFF; stroke-width: 1.5;" width="100" x="8" y="495.9531"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="86" x="15" y="515.9482">Malicious UE</text><rect fill="#E6E6E6" height="30.2969" style="stroke: #FFFFFF; stroke-width: 1.5;" width="43" x="118" y="3"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="29" x="125" y="22.9951">gNB</text><rect fill="#E6E6E6" height="30.2969" style="stroke: #FFFFFF; stroke-width: 1.5;" width="43" x="118" y="495.9531"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="29" x="125" y="515.9482">gNB</text><rect fill="#E6E6E6" height="30.2969" style="stroke: #FFFFFF; stroke-width: 1.5;" width="193" x="412" y="3"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="179" x="419" y="22.9951">User Plane Function (UPF)</text><rect fill="#E6E6E6" height="30.2969" style="stroke: #FFFFFF; stroke-width: 1.5;" width="193" x="412" y="495.9531"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="179" x="419" y="515.9482">User Plane Function (UPF)</text><polygon fill="#000000" points="496.5,76.5625,506.5,80.5625,496.5,84.5625,500.5,80.5625" style="stroke: #000000; stroke-width: 1.0;"/><line style="stroke: #000000; stroke-width: 1.0;" x1="139.5" x2="502.5" y1="80.5625" y2="80.5625"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="61" x="146.5" y="60.3638">PFCP req.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="229" x="146.5" y="75.4966">PFCP Association Setup Request (5)</text><path d="M513,53.8633 L513,78.8633 L619,78.8633 L619,63.8633 L609,53.8633 L513,53.8633 " fill="#03B5AA" style="stroke: #FFFFFF; stroke-width: 1.0;"/><path d="M609,53.8633 L609,63.8633 L619,63.8633 L609,53.8633 " fill="#03B5AA" style="stroke: #FFFFFF; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="85" x="519" y="70.9302">gNB to UPF</text><polygon fill="#000000" points="496.5,120.8281,506.5,124.8281,496.5,128.8281,500.5,124.8281" style="stroke: #000000; stroke-width: 1.0;"/><line style="stroke: #000000; stroke-width: 1.0;" x1="58" x2="502.5" y1="124.8281" y2="124.8281"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="61" x="65" y="104.6294">PFCP req.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="229" x="65" y="119.7622">PFCP Association Setup Request (5)</text><path d="M513,98.1289 L513,123.1289 L619,123.1289 L619,108.1289 L609,98.1289 L513,98.1289 " fill="#FFC2D9" style="stroke: #FFFFFF; stroke-width: 1.0;"/><path d="M609,98.1289 L609,108.1289 L619,108.1289 L609,98.1289 " fill="#FFC2D9" style="stroke: #FFFFFF; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="85" x="519" y="115.1958">gNB to UPF</text><polygon fill="#000000" points="69,165.0938,59,169.0938,69,173.0938,65,169.0938" style="stroke: #000000; stroke-width: 1.0;"/><line style="stroke: #000000; stroke-width: 1.0;" x1="63" x2="507.5" y1="169.0938" y2="169.0938"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="60" x="75" y="148.895">PFCP rsp.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="239" x="75" y="164.0278">PFCP Association Setup Response (6)</text><path d="M513,142.3945 L513,167.3945 L680,167.3945 L680,152.3945 L670,142.3945 L513,142.3945 " fill="#FFEAC2" style="stroke: #FFFFFF; stroke-width: 1.0;"/><path d="M670,142.3945 L670,152.3945 L680,152.3945 L670,142.3945 " fill="#FFEAC2" style="stroke: #FFFFFF; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="146" x="519" y="159.4614">UPF to Malicious UE</text><polygon fill="#000000" points="150.5,209.3594,140.5,213.3594,150.5,217.3594,146.5,213.3594" style="stroke: #000000; stroke-width: 1.0;"/><line style="stroke: #000000; stroke-width: 1.0;" x1="144.5" x2="507.5" y1="213.3594" y2="213.3594"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="60" x="156.5" y="193.1606">PFCP rsp.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="239" x="156.5" y="208.2935">PFCP Association Setup Response (6)</text><path d="M513,186.6602 L513,211.6602 L619,211.6602 L619,196.6602 L609,186.6602 L513,186.6602 " fill="#FFEAC2" style="stroke: #FFFFFF; stroke-width: 1.0;"/><path d="M609,186.6602 L609,196.6602 L619,196.6602 L609,186.6602 " fill="#FFEAC2" style="stroke: #FFFFFF; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="85" x="519" y="203.7271">UPF to gNB</text><polygon fill="#000000" points="496.5,253.625,506.5,257.625,496.5,261.625,500.5,257.625" style="stroke: #000000; stroke-width: 1.0;"/><line style="stroke: #000000; stroke-width: 1.0;" x1="139.5" x2="502.5" y1="257.625" y2="257.625"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="305" x="146.5" y="237.4263">&lt;PORT_UNREACHABLE&gt; PFCP,GTP&lt;ICMP&gt; rsp.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="239" x="146.5" y="252.5591">PFCP Association Setup Response (6)</text><path d="M513,230.9258 L513,255.9258 L619,255.9258 L619,240.9258 L609,230.9258 L513,230.9258 " fill="#D7FEFC" style="stroke: #FFFFFF; stroke-width: 1.0;"/><path d="M609,230.9258 L609,240.9258 L619,240.9258 L609,230.9258 " fill="#D7FEFC" style="stroke: #FFFFFF; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="85" x="519" y="247.9927">gNB to UPF</text><polygon fill="#000000" points="496.5,297.8906,506.5,301.8906,496.5,305.8906,500.5,301.8906" style="stroke: #000000; stroke-width: 1.0;"/><line style="stroke: #000000; stroke-width: 1.0;" x1="139.5" x2="502.5" y1="301.8906" y2="301.8906"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="61" x="146.5" y="281.6919">PFCP req.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="229" x="146.5" y="296.8247">PFCP Session Deletion Request (54)</text><path d="M513,275.1914 L513,300.1914 L619,300.1914 L619,285.1914 L609,275.1914 L513,275.1914 " fill="#03B5AA" style="stroke: #FFFFFF; stroke-width: 1.0;"/><path d="M609,275.1914 L609,285.1914 L619,285.1914 L609,275.1914 " fill="#03B5AA" style="stroke: #FFFFFF; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="85" x="519" y="292.2583">gNB to UPF</text><polygon fill="#000000" points="496.5,342.1563,506.5,346.1563,496.5,350.1563,500.5,346.1563" style="stroke: #000000; stroke-width: 1.0;"/><line style="stroke: #000000; stroke-width: 1.0;" x1="58" x2="502.5" y1="346.1563" y2="346.1563"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="61" x="65" y="325.9575">PFCP req.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="229" x="65" y="341.0903">PFCP Session Deletion Request (54)</text><path d="M513,319.457 L513,344.457 L619,344.457 L619,329.457 L609,319.457 L513,319.457 " fill="#FFC2D9" style="stroke: #FFFFFF; stroke-width: 1.0;"/><path d="M609,319.457 L609,329.457 L619,329.457 L609,319.457 " fill="#FFC2D9" style="stroke: #FFFFFF; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="85" x="519" y="336.5239">gNB to UPF</text><polygon fill="#000000" points="69,386.4219,59,390.4219,69,394.4219,65,390.4219" style="stroke: #000000; stroke-width: 1.0;"/><line style="stroke: #000000; stroke-width: 1.0;" x1="63" x2="507.5" y1="390.4219" y2="390.4219"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="60" x="75" y="370.2231">PFCP rsp.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="239" x="75" y="385.356">PFCP Session Deletion Response (55)</text><path d="M513,363.7227 L513,388.7227 L680,388.7227 L680,373.7227 L670,363.7227 L513,363.7227 " fill="#FFEAC2" style="stroke: #FFFFFF; stroke-width: 1.0;"/><path d="M670,363.7227 L670,373.7227 L680,373.7227 L670,363.7227 " fill="#FFEAC2" style="stroke: #FFFFFF; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="146" x="519" y="380.7896">UPF to Malicious UE</text><polygon fill="#000000" points="150.5,430.6875,140.5,434.6875,150.5,438.6875,146.5,434.6875" style="stroke: #000000; stroke-width: 1.0;"/><line style="stroke: #000000; stroke-width: 1.0;" x1="144.5" x2="507.5" y1="434.6875" y2="434.6875"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="60" x="156.5" y="414.4888">PFCP rsp.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="239" x="156.5" y="429.6216">PFCP Session Deletion Response (55)</text><path d="M513,407.9883 L513,432.9883 L619,432.9883 L619,417.9883 L609,407.9883 L513,407.9883 " fill="#FFEAC2" style="stroke: #FFFFFF; stroke-width: 1.0;"/><path d="M609,407.9883 L609,417.9883 L619,417.9883 L609,407.9883 " fill="#FFEAC2" style="stroke: #FFFFFF; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="85" x="519" y="425.0552">UPF to gNB</text><polygon fill="#000000" points="496.5,474.9531,506.5,478.9531,496.5,482.9531,500.5,478.9531" style="stroke: #000000; stroke-width: 1.0;"/><line style="stroke: #000000; stroke-width: 1.0;" x1="139.5" x2="502.5" y1="478.9531" y2="478.9531"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="345" x="146.5" y="458.7544">4345, &lt;PORT_UNREACHABLE&gt; PFCP,GTP&lt;ICMP&gt; rsp.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="239" x="146.5" y="473.8872">PFCP Session Deletion Response (55)</text><path d="M513,452.2539 L513,477.2539 L619,477.2539 L619,462.2539 L609,452.2539 L513,452.2539 " fill="#D7FEFC" style="stroke: #FFFFFF; stroke-width: 1.0;"/><path d="M609,452.2539 L609,462.2539 L619,462.2539 L609,452.2539 " fill="#D7FEFC" style="stroke: #FFFFFF; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="85" x="519" y="469.3208">gNB to UPF</text><!--MD5=[aa5a800b3d1374afc111059d622e062a]
@startuml
skinparam shadowing false
skinparam NoteBorderColor white
skinparam sequence {
    ArrowColor black
    LifeLineBorderColor black
    LifeLineBackgroundColor black
    ParticipantBorderColor white
    ParticipantBackgroundColor #e6e6e6
}

participant "Malicious UE"
participant "gNB"
participant "User Plane Function (UPF)"


"gNB" -> "User Plane Function (UPF)": PFCP req.\nPFCP Association Setup Request (5)

note right #03B5AA
**gNB to UPF**
end note

"Malicious UE" -> "User Plane Function (UPF)":  PFCP req.\nPFCP Association Setup Request (5)

note right #FFC2D9
**gNB to UPF**
end note

"User Plane Function (UPF)" -> "Malicious UE": PFCP rsp.\nPFCP Association Setup Response (6)

note right #FFEAC2
**UPF to Malicious UE**
end note

"User Plane Function (UPF)" -> "gNB": PFCP rsp.\nPFCP Association Setup Response (6)

note right #FFEAC2
**UPF to gNB**
end note

"gNB" -> "User Plane Function (UPF)":  <PORT_UNREACHABLE> PFCP,GTP<ICMP> rsp.\nPFCP Association Setup Response (6)

note right #D7FEFC
**gNB to UPF**
end note

"gNB" -> "User Plane Function (UPF)": PFCP req.\nPFCP Session Deletion Request (54)

note right #03B5AA
**gNB to UPF**
end note

"Malicious UE" -> "User Plane Function (UPF)": PFCP req.\nPFCP Session Deletion Request (54)

note right #FFC2D9
**gNB to UPF**
end note


"User Plane Function (UPF)" -> "Malicious UE": PFCP rsp.\nPFCP Session Deletion Response (55)

note right #FFEAC2
**UPF to Malicious UE**
end note

"User Plane Function (UPF)" -> "gNB": PFCP rsp.\nPFCP Session Deletion Response (55)

note right #FFEAC2
**UPF to gNB**
end note

"gNB" -> "User Plane Function (UPF)": 4345, <PORT_UNREACHABLE> PFCP,GTP<ICMP> rsp.\nPFCP Session Deletion Response (55)

note right #D7FEFC
**gNB to UPF**
end note


@enduml

PlantUML version 1.2019.12(Sun Nov 03 11:24:54 CET 2019)
(APACHE source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Java Version: 11.0.18+10-post-Ubuntu-0ubuntu120.04.1
Operating System: Linux
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>