<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="582px" preserveAspectRatio="none" style="width:877px;height:582px;" version="1.1" viewBox="0 0 877 582" width="877px" zoomAndPan="magnify"><defs/><g><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="43" x2="43" y1="34.2969" y2="542.3516"/><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="105" x2="105" y1="34.2969" y2="542.3516"/><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="153" x2="153" y1="34.2969" y2="542.3516"/><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="206" x2="206" y1="34.2969" y2="542.3516"/><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="259" x2="259" y1="34.2969" y2="542.3516"/><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="522" x2="522" y1="34.2969" y2="542.3516"/><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="734.5" x2="734.5" y1="34.2969" y2="542.3516"/><rect fill="#E6E6E6" height="30.2969" style="stroke: #FFFFFF; stroke-width: 1.5;" width="71" x="8" y="3"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="57" x="15" y="22.9951">Attacker</text><rect fill="#E6E6E6" height="30.2969" style="stroke: #FFFFFF; stroke-width: 1.5;" width="71" x="8" y="541.3516"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="57" x="15" y="561.3467">Attacker</text><rect fill="#E6E6E6" height="30.2969" style="stroke: #FFFFFF; stroke-width: 1.5;" width="33" x="89" y="3"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="19" x="96" y="22.9951">UE</text><rect fill="#E6E6E6" height="30.2969" style="stroke: #FFFFFF; stroke-width: 1.5;" width="33" x="89" y="541.3516"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="19" x="96" y="561.3467">UE</text><rect fill="#E6E6E6" height="30.2969" style="stroke: #FFFFFF; stroke-width: 1.5;" width="43" x="132" y="3"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="29" x="139" y="22.9951">gNB</text><rect fill="#E6E6E6" height="30.2969" style="stroke: #FFFFFF; stroke-width: 1.5;" width="43" x="132" y="541.3516"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="29" x="139" y="561.3467">gNB</text><rect fill="#E6E6E6" height="30.2969" style="stroke: #FFFFFF; stroke-width: 1.5;" width="43" x="185" y="3"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="29" x="192" y="22.9951">AMF</text><rect fill="#E6E6E6" height="30.2969" style="stroke: #FFFFFF; stroke-width: 1.5;" width="43" x="185" y="541.3516"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="29" x="192" y="561.3467">AMF</text><rect fill="#E6E6E6" height="30.2969" style="stroke: #FFFFFF; stroke-width: 1.5;" width="43" x="238" y="3"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="29" x="245" y="22.9951">SMF</text><rect fill="#E6E6E6" height="30.2969" style="stroke: #FFFFFF; stroke-width: 1.5;" width="43" x="238" y="541.3516"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="29" x="245" y="561.3467">SMF</text><rect fill="#E6E6E6" height="30.2969" style="stroke: #FFFFFF; stroke-width: 1.5;" width="41" x="502" y="3"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="27" x="509" y="22.9951">UPF</text><rect fill="#E6E6E6" height="30.2969" style="stroke: #FFFFFF; stroke-width: 1.5;" width="41" x="502" y="541.3516"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="27" x="509" y="561.3467">UPF</text><rect fill="#E6E6E6" height="30.2969" style="stroke: #FFFFFF; stroke-width: 1.5;" width="62" x="703.5" y="3"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="48" x="710.5" y="22.9951">8.8.8.8</text><rect fill="#E6E6E6" height="30.2969" style="stroke: #FFFFFF; stroke-width: 1.5;" width="62" x="703.5" y="541.3516"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="48" x="710.5" y="561.3467">8.8.8.8</text><polygon fill="#000000" points="510.5,76.5625,520.5,80.5625,510.5,84.5625,514.5,80.5625" style="stroke: #000000; stroke-width: 1.0;"/><line style="stroke: #000000; stroke-width: 1.0;" x1="153.5" x2="516.5" y1="80.5625" y2="80.5625"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="178" x="160.5" y="60.3638">1103, GTP&lt;ICMP&gt; ping req.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="188" x="160.5" y="75.4966">+31.767s (19:38:18.839.636)</text><path d="M527,53.8633 L527,78.8633 L633,78.8633 L633,63.8633 L623,53.8633 L527,53.8633 " fill="#5C8001" style="stroke: #FFFFFF; stroke-width: 1.0;"/><path d="M623,53.8633 L623,63.8633 L633,63.8633 L623,53.8633 " fill="#5C8001" style="stroke: #FFFFFF; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="85" x="533" y="70.9302">gNB to UPF</text><polygon fill="#000000" points="722.5,120.8281,732.5,124.8281,722.5,128.8281,726.5,124.8281" style="stroke: #000000; stroke-width: 1.0;"/><line style="stroke: #000000; stroke-width: 1.0;" x1="105.5" x2="728.5" y1="124.8281" y2="124.8281"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="131" x="112.5" y="104.6294">1104, ICMP ping req.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="188" x="112.5" y="119.7622">+31.767s (19:38:18.839.723)</text><path d="M739,98.1289 L739,123.1289 L855,123.1289 L855,108.1289 L845,98.1289 L739,98.1289 " fill="#5C8001" style="stroke: #FFFFFF; stroke-width: 1.0;"/><path d="M845,98.1289 L845,108.1289 L855,108.1289 L845,98.1289 " fill="#5C8001" style="stroke: #FFFFFF; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="95" x="745" y="115.1958">UE to 8.8.8.8</text><polygon fill="#000000" points="722.5,165.0938,732.5,169.0938,722.5,173.0938,726.5,169.0938" style="stroke: #000000; stroke-width: 1.0;"/><line style="stroke: #000000; stroke-width: 1.0;" x1="522.5" x2="728.5" y1="169.0938" y2="169.0938"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="131" x="529.5" y="148.895">1105, ICMP ping req.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="188" x="529.5" y="164.0278">+31.767s (19:38:18.839.736)</text><path d="M739,142.3945 L739,167.3945 L865,167.3945 L865,152.3945 L855,142.3945 L739,142.3945 " fill="#5C8001" style="stroke: #FFFFFF; stroke-width: 1.0;"/><path d="M855,142.3945 L855,152.3945 L865,152.3945 L855,142.3945 " fill="#5C8001" style="stroke: #FFFFFF; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="105" x="745" y="159.4614">UPF to 8.8.8.8</text><polygon fill="#000000" points="533.5,209.3594,523.5,213.3594,533.5,217.3594,529.5,213.3594" style="stroke: #000000; stroke-width: 1.0;"/><line style="stroke: #000000; stroke-width: 1.0;" x1="527.5" x2="733.5" y1="213.3594" y2="213.3594"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="130" x="539.5" y="193.1606">1106, ICMP ping rsp.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="188" x="539.5" y="208.2935">+31.794s (19:38:18.866.435)</text><path d="M739,186.6602 L739,211.6602 L865,211.6602 L865,196.6602 L855,186.6602 L739,186.6602 " fill="#EDFEC2" style="stroke: #FFFFFF; stroke-width: 1.0;"/><path d="M855,186.6602 L855,196.6602 L865,196.6602 L855,186.6602 " fill="#EDFEC2" style="stroke: #FFFFFF; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="105" x="745" y="203.7271">8.8.8.8 to UPF</text><polygon fill="#000000" points="116.5,253.625,106.5,257.625,116.5,261.625,112.5,257.625" style="stroke: #000000; stroke-width: 1.0;"/><line style="stroke: #000000; stroke-width: 1.0;" x1="110.5" x2="733.5" y1="257.625" y2="257.625"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="130" x="122.5" y="237.4263">1107, ICMP ping rsp.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="188" x="122.5" y="252.5591">+31.794s (19:38:18.866.461)</text><path d="M739,230.9258 L739,255.9258 L855,255.9258 L855,240.9258 L845,230.9258 L739,230.9258 " fill="#EDFEC2" style="stroke: #FFFFFF; stroke-width: 1.0;"/><path d="M845,230.9258 L845,240.9258 L855,240.9258 L845,230.9258 " fill="#EDFEC2" style="stroke: #FFFFFF; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="95" x="745" y="247.9927">8.8.8.8 to UE</text><polygon fill="#000000" points="164.5,297.8906,154.5,301.8906,164.5,305.8906,160.5,301.8906" style="stroke: #000000; stroke-width: 1.0;"/><line style="stroke: #000000; stroke-width: 1.0;" x1="158.5" x2="521.5" y1="301.8906" y2="301.8906"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="177" x="170.5" y="281.6919">1108, GTP&lt;ICMP&gt; ping rsp.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="188" x="170.5" y="296.8247">+31.794s (19:38:18.866.543)</text><path d="M527,275.1914 L527,300.1914 L633,300.1914 L633,285.1914 L623,275.1914 L527,275.1914 " fill="#EDFEC2" style="stroke: #FFFFFF; stroke-width: 1.0;"/><path d="M623,275.1914 L623,285.1914 L633,285.1914 L623,275.1914 " fill="#EDFEC2" style="stroke: #FFFFFF; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="85" x="533" y="292.2583">UPF to gNB</text><polygon fill="#000000" points="510.5,357.2891,520.5,361.2891,510.5,365.2891,514.5,361.2891" style="stroke: #000000; stroke-width: 1.0;"/><line style="stroke: #000000; stroke-width: 1.0;" x1="43.5" x2="516.5" y1="361.2891" y2="361.2891"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="173" x="50.5" y="325.9575">1193, PFCP req. Malformed</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="252" x="50.5" y="341.0903">PFCP Session Modification Request (52)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="180" x="50.5" y="356.2231">+39.750s (19:38:26.823.36)</text><path d="M527,327.0234 L527,352.0234 L665,352.0234 L665,337.0234 L655,327.0234 L527,327.0234 " fill="#FFC2D9" style="stroke: #FFFFFF; stroke-width: 1.0;"/><path d="M655,327.0234 L655,337.0234 L665,337.0234 L655,327.0234 " fill="#FFC2D9" style="stroke: #FFFFFF; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="117" x="533" y="344.0903">Attacker to UPF</text><polygon fill="#000000" points="270.5,416.6875,260.5,420.6875,270.5,424.6875,266.5,420.6875" style="stroke: #000000; stroke-width: 1.0;"/><line style="stroke: #000000; stroke-width: 1.0;" x1="264.5" x2="521.5" y1="420.6875" y2="420.6875"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="101" x="276.5" y="385.356">1286, PFCP req.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="229" x="276.5" y="400.4888">PFCP Association Setup Request (5)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="180" x="276.5" y="415.6216">+42.940s (19:38:30.13.356)</text><path d="M527,386.4219 L527,411.4219 L633,411.4219 L633,396.4219 L623,386.4219 L527,386.4219 " fill="#03B5AA" style="stroke: #FFFFFF; stroke-width: 1.0;"/><path d="M623,386.4219 L623,396.4219 L633,396.4219 L623,386.4219 " fill="#03B5AA" style="stroke: #FFFFFF; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="85" x="533" y="403.4888">UPF to SMF</text><polygon fill="#000000" points="510.5,476.0859,520.5,480.0859,510.5,484.0859,514.5,480.0859" style="stroke: #000000; stroke-width: 1.0;"/><line style="stroke: #000000; stroke-width: 1.0;" x1="259.5" x2="516.5" y1="480.0859" y2="480.0859"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="100" x="266.5" y="444.7544">1287, PFCP rsp.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="239" x="266.5" y="459.8872">PFCP Association Setup Response (6)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="180" x="266.5" y="475.02">+42.941s (19:38:30.13.557)</text><path d="M527,445.8203 L527,470.8203 L633,470.8203 L633,455.8203 L623,445.8203 L527,445.8203 " fill="#D7FEFC" style="stroke: #FFFFFF; stroke-width: 1.0;"/><path d="M623,445.8203 L623,455.8203 L633,455.8203 L623,445.8203 " fill="#D7FEFC" style="stroke: #FFFFFF; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="85" x="533" y="462.8872">SMF to UPF</text><polygon fill="#000000" points="510.5,520.3516,520.5,524.3516,510.5,528.3516,514.5,524.3516" style="stroke: #000000; stroke-width: 1.0;"/><line style="stroke: #000000; stroke-width: 1.0;" x1="153.5" x2="516.5" y1="524.3516" y2="524.3516"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="178" x="160.5" y="504.1528">1429, GTP&lt;ICMP&gt; ping req.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="188" x="160.5" y="519.2856">+45.049s (19:38:32.121.547)</text><path d="M527,497.6523 L527,522.6523 L633,522.6523 L633,507.6523 L623,497.6523 L527,497.6523 " fill="#5C8001" style="stroke: #FFFFFF; stroke-width: 1.0;"/><path d="M623,497.6523 L623,507.6523 L633,507.6523 L623,497.6523 " fill="#5C8001" style="stroke: #FFFFFF; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="85" x="533" y="514.7192">gNB to UPF</text><!--MD5=[dde2b9b955050df3508ff57db2745c21]
@startuml
skinparam shadowing false
skinparam NoteBorderColor white
skinparam sequence {
    ArrowColor black
    LifeLineBorderColor black
    LifeLineBackgroundColor black
    ParticipantBorderColor white
    ParticipantBackgroundColor #e6e6e6
}
participant "Attacker"
participant "UE"
participant "gNB"
participant "AMF"
participant "SMF"
participant "UPF"
participant "8.8.8.8"

"gNB" -> "UPF": 1103, GTP<ICMP> ping req.\n+31.767s (19:38:18.839.636)

note right #5C8001
**gNB to UPF**
end note

"UE" -> "8.8.8.8": 1104, ICMP ping req.\n+31.767s (19:38:18.839.723)

note right #5C8001
**UE to 8.8.8.8**
end note

"UPF" -> "8.8.8.8": 1105, ICMP ping req.\n+31.767s (19:38:18.839.736)

note right #5C8001
**UPF to 8.8.8.8**
end note

"8.8.8.8" -> "UPF": 1106, ICMP ping rsp.\n+31.794s (19:38:18.866.435)

note right #EDFEC2
**8.8.8.8 to UPF**
end note

"8.8.8.8" -> "UE": 1107, ICMP ping rsp.\n+31.794s (19:38:18.866.461)

note right #EDFEC2
**8.8.8.8 to UE**
end note

"UPF" -> "gNB": 1108, GTP<ICMP> ping rsp.\n+31.794s (19:38:18.866.543)

note right #EDFEC2
**UPF to gNB**
end note

"Attacker" -> "UPF": 1193, PFCP req. Malformed \nPFCP Session Modification Request (52)\n+39.750s (19:38:26.823.36)

note right #FFC2D9
**Attacker to UPF**
end note

"UPF" -> "SMF": 1286, PFCP req.\nPFCP Association Setup Request (5)\n+42.940s (19:38:30.13.356)

note right #03B5AA
**UPF to SMF**
end note

"SMF" -> "UPF": 1287, PFCP rsp.\nPFCP Association Setup Response (6)\n+42.941s (19:38:30.13.557)

note right #D7FEFC
**SMF to UPF**
end note

"gNB" -> "UPF": 1429, GTP<ICMP> ping req.\n+45.049s (19:38:32.121.547)

note right #5C8001
**gNB to UPF**
end note

@enduml

PlantUML version 1.2019.12(Sun Nov 03 11:24:54 CET 2019)
(APACHE source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Java Version: 11.0.17+8-post-Ubuntu-1ubuntu220.04
Operating System: Linux
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>