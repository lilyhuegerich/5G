@startuml
skinparam shadowing false
skinparam NoteBorderColor white
skinparam sequence {
    ArrowColor black
    LifeLineBorderColor black
    LifeLineBackgroundColor black
    ParticipantBorderColor white
    ParticipantBackgroundColor #e6e6e6
}
participant "N1\n(10.0.2.15)" as 10.0.2.15
participant "10.0.14.1"
participant "10.0.17.1"
participant "127.0.0.2"
participant "8.8.8.8"
participant "10.45.0.11"
participant "127.0.0.8"
participant "10.45.0.12"
participant "10.0.12.1"
participant "N1\n(10.0.3.1)" as 10.0.3.1
participant "127.0.0.9"
participant "10.45.0.10"
participant "127.0.0.4"
participant "10.0.13.1"
participant "10.0.2.4"
participant "10.45.0.13"

"10.0.3.1" -> "10.0.2.15": 1302, NGAP UEContextRelease (41)

note right #c6ebc6
**10.0.3.1 to 10.0.2.15**
NGAP-PDU: 0029001000000200720004000a000a000f400140
ngap.procedureCode: 'procedureCode: id-UEContextRelease (41)'
per.enum_index: 'Enumerated Index: 0'
ngap.criticality: 'criticality: reject (0)'
per.open_type_length: 'Open Type Length: 16'
ngap.value_element:
-   ngap.UEContextReleaseCommand_element:
        per.extension_bit: '0... .... Extension Bit: False'
        per.sequence_of_length: 'Sequence-Of Length: 2'
        ngap.protocolIEs:
            'Item 0: id-UE-NGAP-IDs':
                ngap.id: 'id: id-UE-NGAP-IDs (114)'
                per.enum_index: 'Enumerated Index: 0'
                ngap.criticality: 'criticality: reject (0)'
                per.open_type_length: 'Open Type Length: 4'
                ngap.value_element:
                    per.choice_index: 'Choice Index: 0'
                    ngap.UE_NGAP_IDs:
                        ngap.uE_NGAP_ID_pair_element:
                            per.extension_bit: '..0. .... Extension Bit: False'
                            per.optional_field_bit: '...0 .... Optional Field Bit: False (iE-Extensions is NOT present)'
                            ngap.aMF_UE_NGAP_ID: 'aMF-UE-NGAP-ID: 10'
                            ngap.rAN_UE_NGAP_ID: 'rAN-UE-NGAP-ID: 10'
            'Item 1: id-Cause':
                ngap.id: 'id: id-Cause (15)'
                per.enum_index: 'Enumerated Index: 1'
                ngap.criticality: 'criticality: ignore (1)'
                per.open_type_length: 'Open Type Length: 1'
                ngap.value_element:
                    per.choice_index: 'Choice Index: 2'
                    ngap.Cause:
                        per.extension_present_bit: '...0 .... Extension Present Bit: False'
                        per.enum_index: 'Enumerated Index: 0'
                        ngap.nas: 'nas: normal-release (0)'

end note

"10.0.2.15" -> "10.0.3.1": 1306, NGAP UEContextRelease (41)

note right #c6ebc6
**10.0.2.15 to 10.0.3.1**
NGAP-PDU: 20290026000003000a4002000a00554002000a007940135009f107000000010009f107000001e74c1d9e
ngap.procedureCode: 'procedureCode: id-UEContextRelease (41)'
per.enum_index: 'Enumerated Index: 0'
ngap.criticality: 'criticality: reject (0)'
per.open_type_length: 'Open Type Length: 38'
ngap.value_element:
-   ngap.UEContextReleaseComplete_element:
        per.extension_bit: '0... .... Extension Bit: False'
        per.sequence_of_length: 'Sequence-Of Length: 3'
        ngap.protocolIEs:
            'Item 0: id-AMF-UE-NGAP-ID':
                ngap.id: 'id: id-AMF-UE-NGAP-ID (10)'
                per.enum_index: 'Enumerated Index: 1'
                ngap.criticality: 'criticality: ignore (1)'
                per.open_type_length: 'Open Type Length: 2'
                ngap.value_element:
                    ngap.AMF_UE_NGAP_ID: 'AMF-UE-NGAP-ID: 10'
            'Item 1: id-RAN-UE-NGAP-ID':
                ngap.id: 'id: id-RAN-UE-NGAP-ID (85)'
                per.enum_index: 'Enumerated Index: 1'
                ngap.criticality: 'criticality: ignore (1)'
                per.open_type_length: 'Open Type Length: 2'
                ngap.value_element:
                    ngap.RAN_UE_NGAP_ID: 'RAN-UE-NGAP-ID: 10'
            'Item 2: id-UserLocationInformation':
                ngap.id: 'id: id-UserLocationInformation (121)'
                per.enum_index: 'Enumerated Index: 1'
                ngap.criticality: 'criticality: ignore (1)'
                per.open_type_length: 'Open Type Length: 19'
                ngap.value_element:
                    per.choice_index: 'Choice Index: 1'
                    ngap.UserLocationInformation:
                        ngap.userLocationInformationNR_element:
                            per.extension_bit: '..0. .... Extension Bit: False'
                            per.optional_field_bit: '.... 0... Optional Field Bit: False (iE-Extensions is NOT present)'
                            ngap.nR_CGI_element:
                                per.extension_bit: '.... .0.. Extension Bit: False'
                                per.optional_field_bit: '.... ..0. Optional Field Bit: False (iE-Extensions is NOT present)'
                                ngap.pLMNIdentity:
                                    e212.mcc: 'Mobile Country Code (MCC): International Mobile, shared code (901)'
                                    e212.mnc: 'Mobile Network Code (MNC): Unknown (70)'
                                ngap.NRCellIdentity: 'nRCellIdentity: 0x0000000010'
                            ngap.tAI_element:
                                per.extension_bit: '.... 0... Extension Bit: False'
                                per.optional_field_bit: '.... .0.. Optional Field Bit: False (iE-Extensions is NOT present)'
                                ngap.pLMNIdentity:
                                    e212.mcc: 'Mobile Country Code (MCC): International Mobile, shared code (901)'
                                    e212.mnc: 'Mobile Network Code (MNC): Unknown (70)'
                                ngap.tAC: 'tAC: 1 (0x000001)'
                            ngap.timeStamp: 'timeStamp: e74c1d9e (Dec 20, 2022 11:40:14 UTC)'

end note

"10.0.3.1" -> "10.0.2.15": 1323, NGAP DownlinkNASTransport (4),\nNAS Authentication request (0x56)

note right #8cd98c
**10.0.3.1 to 10.0.2.15**
NGAP-PDU: 0004403e000003000a0002000c00550002000c0026002b2a7e0056030200002190693d0ae30969c2556380d7cffd0d3520107482af09a4408000b6f5700d8fe9ca20
ngap.procedureCode: 'procedureCode: id-DownlinkNASTransport (4)'
per.enum_index: 'Enumerated Index: 1'
ngap.criticality: 'criticality: ignore (1)'
per.open_type_length: 'Open Type Length: 62'
ngap.value_element:
-   ngap.DownlinkNASTransport_element:
        per.extension_bit: '0... .... Extension Bit: False'
        per.sequence_of_length: 'Sequence-Of Length: 3'
        ngap.protocolIEs:
            'Item 0: id-AMF-UE-NGAP-ID':
                ngap.id: 'id: id-AMF-UE-NGAP-ID (10)'
                per.enum_index: 'Enumerated Index: 0'
                ngap.criticality: 'criticality: reject (0)'
                per.open_type_length: 'Open Type Length: 2'
                ngap.value_element:
                    ngap.AMF_UE_NGAP_ID: 'AMF-UE-NGAP-ID: 12'
            'Item 1: id-RAN-UE-NGAP-ID':
                ngap.id: 'id: id-RAN-UE-NGAP-ID (85)'
                per.enum_index: 'Enumerated Index: 0'
                ngap.criticality: 'criticality: reject (0)'
                per.open_type_length: 'Open Type Length: 2'
                ngap.value_element:
                    ngap.RAN_UE_NGAP_ID: 'RAN-UE-NGAP-ID: 12'
            'Item 2: id-NAS-PDU':
                ngap.id: 'id: id-NAS-PDU (38)'
                per.enum_index: 'Enumerated Index: 0'
                ngap.criticality: 'criticality: reject (0)'
                per.open_type_length: 'Open Type Length: 43'
                ngap.value_element:
                    per.octet_string_length: 'Octet String Length: 42'
                    ngap.NAS_PDU:
                        nas-5gs:
                            Plain NAS 5GS Message:
                                nas_5gs.epd: 'Extended protocol discriminator: 5G mobility management messages (126)'
                                nas_5gs.spare_half_octet: '0000 .... = Spare Half Octet: 0'
                                nas_5gs.security_header_type: '.... 0000 = Security header type: Plain NAS message, not security protected (0)'
                                nas_5gs.mm.message_type: 'Message type: Authentication request (0x56)'
                                NAS key set identifier - ngKSI:
                                    nas_5gs.mm.tsc: '.... 0... = Type of security context flag (TSC): Native security context (for KSIAMF)'
                                    nas_5gs.mm.nas_key_set_id: '.... .011 = NAS key set identifier: 3'
                                ABBA:
                                    gsm_a.len: 'Length: 2'
                                    nas_5gs.mm.abba_contents: 'ABBA Contents: 0x0000'
                                Authentication Parameter RAND - 5G authentication challenge:
                                    gsm_a.dtap.elem_id: 'Element ID: 0x21'
                                    gsm_a.dtap.rand: 'RAND value: 90693d0ae30969c2556380d7cffd0d35'
                                Authentication Parameter AUTN (UMTS and EPS authentication challenge) - 5G authentication challenge:
                                    gsm_a.dtap.elem_id: 'Element ID: 0x20'
                                    gsm_a.len: 'Length: 16'
                                    gsm_a.dtap.autn:
                                        gsm_a.dtap.autn.sqn_xor_ak: 'SQN xor AK: 7482af09a440'
                                        gsm_a.dtap.autn.amf: 'AMF: 8000'
                                        gsm_a.dtap.autn.mac: 'MAC: b6f5700d8fe9ca20'

end note

"10.0.2.15" -> "10.0.3.1": 1324, NGAP UplinkNASTransport (46),\nNAS Authentication response (0x57)

note right #c6ebc6
**10.0.2.15 to 10.0.3.1**
NGAP-PDU: 002e4040000004000a0002000c00550002000c00260016157e00572d10a62b7aa29f16a666cce0e2bdedc3b81b007940135009f107000000010009f107000001e74c1d9e
ngap.procedureCode: 'procedureCode: id-UplinkNASTransport (46)'
per.enum_index: 'Enumerated Index: 1'
ngap.criticality: 'criticality: ignore (1)'
per.open_type_length: 'Open Type Length: 64'
ngap.value_element:
-   ngap.UplinkNASTransport_element:
        per.extension_bit: '0... .... Extension Bit: False'
        per.sequence_of_length: 'Sequence-Of Length: 4'
        ngap.protocolIEs:
            'Item 0: id-AMF-UE-NGAP-ID':
                ngap.id: 'id: id-AMF-UE-NGAP-ID (10)'
                per.enum_index: 'Enumerated Index: 0'
                ngap.criticality: 'criticality: reject (0)'
                per.open_type_length: 'Open Type Length: 2'
                ngap.value_element:
                    ngap.AMF_UE_NGAP_ID: 'AMF-UE-NGAP-ID: 12'
            'Item 1: id-RAN-UE-NGAP-ID':
                ngap.id: 'id: id-RAN-UE-NGAP-ID (85)'
                per.enum_index: 'Enumerated Index: 0'
                ngap.criticality: 'criticality: reject (0)'
                per.open_type_length: 'Open Type Length: 2'
                ngap.value_element:
                    ngap.RAN_UE_NGAP_ID: 'RAN-UE-NGAP-ID: 12'
            'Item 2: id-NAS-PDU':
                ngap.id: 'id: id-NAS-PDU (38)'
                per.enum_index: 'Enumerated Index: 0'
                ngap.criticality: 'criticality: reject (0)'
                per.open_type_length: 'Open Type Length: 22'
                ngap.value_element:
                    per.octet_string_length: 'Octet String Length: 21'
                    ngap.NAS_PDU:
                        nas-5gs:
                            Plain NAS 5GS Message:
                                nas_5gs.epd: 'Extended protocol discriminator: 5G mobility management messages (126)'
                                nas_5gs.spare_half_octet: '0000 .... = Spare Half Octet: 0'
                                nas_5gs.security_header_type: '.... 0000 = Security header type: Plain NAS message, not security protected (0)'
                                nas_5gs.mm.message_type: 'Message type: Authentication response (0x57)'
                                Authentication response parameter:
                                    nas_eps.emm.elem_id: 'Element ID: 0x2d'
                                    gsm_a.len: 'Length: 16'
                                    nas_eps.emm.res: 'RES: a62b7aa29f16a666cce0e2bdedc3b81b'
            'Item 3: id-UserLocationInformation':
                ngap.id: 'id: id-UserLocationInformation (121)'
                per.enum_index: 'Enumerated Index: 1'
                ngap.criticality: 'criticality: ignore (1)'
                per.open_type_length: 'Open Type Length: 19'
                ngap.value_element:
                    per.choice_index: 'Choice Index: 1'
                    ngap.UserLocationInformation:
                        ngap.userLocationInformationNR_element:
                            per.extension_bit: '..0. .... Extension Bit: False'
                            per.optional_field_bit: '.... 0... Optional Field Bit: False (iE-Extensions is NOT present)'
                            ngap.nR_CGI_element:
                                per.extension_bit: '.... .0.. Extension Bit: False'
                                per.optional_field_bit: '.... ..0. Optional Field Bit: False (iE-Extensions is NOT present)'
                                ngap.pLMNIdentity:
                                    e212.mcc: 'Mobile Country Code (MCC): International Mobile, shared code (901)'
                                    e212.mnc: 'Mobile Network Code (MNC): Unknown (70)'
                                ngap.NRCellIdentity: 'nRCellIdentity: 0x0000000010'
                            ngap.tAI_element:
                                per.extension_bit: '.... 0... Extension Bit: False'
                                per.optional_field_bit: '.... .0.. Optional Field Bit: False (iE-Extensions is NOT present)'
                                ngap.pLMNIdentity:
                                    e212.mcc: 'Mobile Country Code (MCC): International Mobile, shared code (901)'
                                    e212.mnc: 'Mobile Network Code (MNC): Unknown (70)'
                                ngap.tAC: 'tAC: 1 (0x000001)'
                            ngap.timeStamp: 'timeStamp: e74c1d9e (Dec 20, 2022 11:40:14 UTC)'

end note

"10.0.3.1" -> "10.0.2.15": 1347, NGAP DownlinkNASTransport (4),\nNAS Security mode command (0x5d)

note right #c6ebc6
**10.0.3.1 to 10.0.2.15**
NGAP-PDU: 00044029000003000a0002000c00550002000c00260016157e03e00a1383007e005d020304f0f0f0f0e1360102
ngap.procedureCode: 'procedureCode: id-DownlinkNASTransport (4)'
per.enum_index: 'Enumerated Index: 1'
ngap.criticality: 'criticality: ignore (1)'
per.open_type_length: 'Open Type Length: 41'
ngap.value_element:
-   ngap.DownlinkNASTransport_element:
        per.extension_bit: '0... .... Extension Bit: False'
        per.sequence_of_length: 'Sequence-Of Length: 3'
        ngap.protocolIEs:
            'Item 0: id-AMF-UE-NGAP-ID':
                ngap.id: 'id: id-AMF-UE-NGAP-ID (10)'
                per.enum_index: 'Enumerated Index: 0'
                ngap.criticality: 'criticality: reject (0)'
                per.open_type_length: 'Open Type Length: 2'
                ngap.value_element:
                    ngap.AMF_UE_NGAP_ID: 'AMF-UE-NGAP-ID: 12'
            'Item 1: id-RAN-UE-NGAP-ID':
                ngap.id: 'id: id-RAN-UE-NGAP-ID (85)'
                per.enum_index: 'Enumerated Index: 0'
                ngap.criticality: 'criticality: reject (0)'
                per.open_type_length: 'Open Type Length: 2'
                ngap.value_element:
                    ngap.RAN_UE_NGAP_ID: 'RAN-UE-NGAP-ID: 12'
            'Item 2: id-NAS-PDU':
                ngap.id: 'id: id-NAS-PDU (38)'
                per.enum_index: 'Enumerated Index: 0'
                ngap.criticality: 'criticality: reject (0)'
                per.open_type_length: 'Open Type Length: 22'
                ngap.value_element:
                    per.octet_string_length: 'Octet String Length: 21'
                    ngap.NAS_PDU:
                        nas-5gs:
                            Security protected NAS 5GS message:
                                nas_5gs.epd: 'Extended protocol discriminator: 5G mobility management messages (126)'
                                nas_5gs.spare_half_octet: '0000 .... = Spare Half Octet: 0'
                                nas_5gs.security_header_type: '.... 0011 = Security header type: Integrity protected with new 5GS security context (3)'
                                nas_5gs.msg_auth_code: 'Message authentication code: 0xe00a1383'
                                nas_5gs.seq_no: 'Sequence number: 0'
                            Plain NAS 5GS Message:
                                nas_5gs.epd: 'Extended protocol discriminator: 5G mobility management messages (126)'
                                nas_5gs.spare_half_octet: '0000 .... = Spare Half Octet: 0'
                                nas_5gs.security_header_type: '.... 0000 = Security header type: Plain NAS message, not security protected (0)'
                                nas_5gs.mm.message_type: 'Message type: Security mode command (0x5d)'
                                NAS security algorithms:
                                    nas_5gs.mm.nas_sec_algo_enc: '0000 .... = Type of ciphering algorithm: 5G-EA0 (null ciphering algorithm) (0)'
                                    nas_5gs.mm.nas_sec_algo_ip: '.... 0010 = Type of integrity protection algorithm: 128-5G-IA2 (2)'
                                NAS key set identifier - ngKSI:
                                    nas_5gs.mm.tsc: '.... 0... = Type of security context flag (TSC): Native security context (for KSIAMF)'
                                    nas_5gs.mm.nas_key_set_id: '.... .011 = NAS key set identifier: 3'
                                UE security capability - Replayed UE security capabilities:
                                    gsm_a.len: 'Length: 4'
                                    nas_5gs.mm.5g_ea0: '1... .... = 5G-EA0: Supported'
                                    nas_5gs.mm.128_5g_ea1: '.1.. .... = 128-5G-EA1: Supported'
                                    nas_5gs.mm.128_5g_ea2: '..1. .... = 128-5G-EA2: Supported'
                                    nas_5gs.mm.128_5g_ea3: '...1 .... = 128-5G-EA3: Supported'
                                    nas_5gs.mm.5g_ea4: '.... 0... = 5G-EA4: Not supported'
                                    nas_5gs.mm.5g_ea5: '.... .0.. = 5G-EA5: Not supported'
                                    nas_5gs.mm.5g_ea6: '.... ..0. = 5G-EA6: Not supported'
                                    nas_5gs.mm.5g_ea7: '.... ...0 = 5G-EA7: Not supported'
                                    nas_5gs.mm.ia0: '1... .... = 5G-IA0: Supported'
                                    nas_5gs.mm.5g_128_ia1: '.1.. .... = 128-5G-IA1: Supported'
                                    nas_5gs.mm.5g_128_ia2: '..1. .... = 128-5G-IA2: Supported'
                                    nas_5gs.mm.5g_128_ia4: '.... 0... = 5G-IA4: Not supported'
                                    nas_5gs.mm.5g_ia5: '.... .0.. = 5G-IA5: Not supported'
                                    nas_5gs.mm.5g_ia6: '.... ..0. = 5G-IA6: Not supported'
                                    nas_5gs.mm.5g_ia7: '.... ...0 = 5G-IA7: Not supported'
                                    nas_5gs.mm.eea0: '1... .... = EEA0: Supported'
                                    nas_5gs.mm.128eea1: '.1.. .... = 128-EEA1: Supported'
                                    nas_5gs.mm.128eea2: '..1. .... = 128-EEA2: Supported'
                                    nas_5gs.mm.eea3: '...1 .... = 128-EEA3: Supported'
                                    nas_5gs.mm.eea4: '.... 0... = EEA4: Not supported'
                                    nas_5gs.mm.eea5: '.... .0.. = EEA5: Not supported'
                                    nas_5gs.mm.eea6: '.... ..0. = EEA6: Not supported'
                                    nas_5gs.mm.eea7: '.... ...0 = EEA7: Not supported'
                                    nas_5gs.mm.eia0: '1... .... = EIA0: Supported'
                                    nas_5gs.mm.128eia1: '.1.. .... = 128-EIA1: Supported'
                                    nas_5gs.mm.128eia2: '..1. .... = 128-EIA2: Supported'
                                    nas_5gs.mm.eia3: '...1 .... = 128-EIA3: Supported'
                                    nas_5gs.mm.eia4: '.... 0... = EIA4: Not supported'
                                    nas_5gs.mm.eia5: '.... .0.. = EIA5: Not supported'
                                    nas_5gs.mm.eia6: '.... ..0. = EIA6: Not supported'
                                    nas_5gs.mm.eia7: '.... ...0 = EIA7: Not supported'
                                IMEISV request:
                                    gsm_a.common.elem_id: '1110 .... = Element ID: 0xe-'
                                    nas_eps.spare_bits: '.... 0... = Spare bit(s): 0x00'
                                    nas_eps.emm.imeisv_req: '.... .001 = IMEISV request: IMEISV requested (1)'
                                Additional 5G security information:
                                    nas_5gs.mm.elem_id: 'Element ID: 0x36'
                                    gsm_a.len: 'Length: 1'
                                    nas_5gs.spare_b3: '.... 0... = Spare: 0'
                                    nas_5gs.spare_b2: '.... .0.. = Spare: 0'
                                    nas_5gs.mm.rinmr: '.... ..1. = Retransmission of initial NAS message request(RINMR): Requested'
                                    nas_5gs.mm.hdp: '.... ...0 = Horizontal derivation parameter (HDP): Not required'

end note

"10.0.2.15" -> "10.0.3.1": 1348, NGAP UplinkNASTransport (46),\nNAS Security mode complete (0x5e),\nNAS Registration request (0x41)

note right #8cd98c
**10.0.2.15 to 10.0.3.1**
NGAP-PDU: 002e4069000004000a0002000c00550002000c0026003f3e7e04606dacaf007e005e7700094573806121856151f17100257e004179000d0109f1070000000000000000101001002e04f0f0f0f02f0401010101530100007940135009f107000000010009f107000001e74c1d9e
ngap.procedureCode: 'procedureCode: id-UplinkNASTransport (46)'
per.enum_index: 'Enumerated Index: 1'
ngap.criticality: 'criticality: ignore (1)'
per.open_type_length: 'Open Type Length: 105'
ngap.value_element:
-   ngap.UplinkNASTransport_element:
        per.extension_bit: '0... .... Extension Bit: False'
        per.sequence_of_length: 'Sequence-Of Length: 4'
        ngap.protocolIEs:
            'Item 0: id-AMF-UE-NGAP-ID':
                ngap.id: 'id: id-AMF-UE-NGAP-ID (10)'
                per.enum_index: 'Enumerated Index: 0'
                ngap.criticality: 'criticality: reject (0)'
                per.open_type_length: 'Open Type Length: 2'
                ngap.value_element:
                    ngap.AMF_UE_NGAP_ID: 'AMF-UE-NGAP-ID: 12'
            'Item 1: id-RAN-UE-NGAP-ID':
                ngap.id: 'id: id-RAN-UE-NGAP-ID (85)'
                per.enum_index: 'Enumerated Index: 0'
                ngap.criticality: 'criticality: reject (0)'
                per.open_type_length: 'Open Type Length: 2'
                ngap.value_element:
                    ngap.RAN_UE_NGAP_ID: 'RAN-UE-NGAP-ID: 12'
            'Item 2: id-NAS-PDU':
                ngap.id: 'id: id-NAS-PDU (38)'
                per.enum_index: 'Enumerated Index: 0'
                ngap.criticality: 'criticality: reject (0)'
                per.open_type_length: 'Open Type Length: 63'
                ngap.value_element:
                    per.octet_string_length: 'Octet String Length: 62'
                    ngap.NAS_PDU:
                        nas-5gs:
                            Security protected NAS 5GS message:
                                nas_5gs.epd: 'Extended protocol discriminator: 5G mobility management messages (126)'
                                nas_5gs.spare_half_octet: '0000 .... = Spare Half Octet: 0'
                                nas_5gs.security_header_type: '.... 0100 = Security header type: Integrity protected and ciphered with new 5GS security context (4)'
                                nas_5gs.msg_auth_code: 'Message authentication code: 0x606dacaf'
                                nas_5gs.seq_no: 'Sequence number: 0'
                            Plain NAS 5GS Message:
                                nas_5gs.epd: 'Extended protocol discriminator: 5G mobility management messages (126)'
                                nas_5gs.spare_half_octet: '0000 .... = Spare Half Octet: 0'
                                nas_5gs.security_header_type: '.... 0000 = Security header type: Plain NAS message, not security protected (0)'
                                nas_5gs.mm.message_type: 'Message type: Security mode complete (0x5e)'
                                5GS mobile identity:
                                    nas_5gs.mm.elem_id: 'Element ID: 0x77'
                                    gsm_a.len: 'Length: 9'
                                    nas_5gs.mm.odd_even: '.... 0... = Odd/even indication: Even number of identity digits'
                                    nas_5gs.mm.type_id: '.... .101 = Type of identity: IMEISV (5)'
                                    nas_5gs.mm.imeisv: 'IMEISV: 4370816125816151'
                                NAS message container:
                                    nas_5gs.mm.elem_id: 'Element ID: 0x71'
                                    gsm_a.len: 'Length: 37'
                                    nas-5gs:
                                        Plain NAS 5GS Message:
                                            nas_5gs.epd: 'Extended protocol discriminator: 5G mobility management messages (126)'
                                            nas_5gs.spare_half_octet: '0000 .... = Spare Half Octet: 0'
                                            nas_5gs.security_header_type: '.... 0000 = Security header type: Plain NAS message, not security protected (0)'
                                            nas_5gs.mm.message_type: 'Message type: Registration request (0x41)'
                                            5GS registration type:
                                                nas_5gs.mm.for: '.... 1... = Follow-On Request bit (FOR): Follow-on request pending'
                                                nas_5gs.mm.5gs_reg_type: '.... .001 = 5GS registration type: initial registration (1)'
                                            NAS key set identifier:
                                                nas_5gs.mm.tsc.h1: '0... .... = Type of security context flag (TSC): Native security context (for KSIAMF)'
                                                nas_5gs.mm.nas_key_set_id.h1: '.111 .... = NAS key set identifier: 7'
                                            5GS mobile identity:
                                                gsm_a.len: 'Length: 13'
                                                nas_5gs.spare_b7: '0... .... = Spare: 0'
                                                nas_5gs.mm.suci.supi_fmt: '.000 .... = SUPI format: IMSI (0)'
                                                nas_5gs.spare_b3: '.... 0... = Spare: 0'
                                                nas_5gs.mm.type_id: '.... .001 = Type of identity: SUCI (1)'
                                                e212.mcc: 'Mobile Country Code (MCC): International Mobile, shared code (901)'
                                                e212.mnc: 'Mobile Network Code (MNC): Unknown (70)'
                                                nas_5gs.mm.suci.routing_indicator: 'Routing indicator: 0000'
                                                nas_5gs.mm.suci.scheme_id: '.... 0000 = Protection scheme Id: NULL scheme (0)'
                                                nas_5gs.mm.suci.pki: 'Home network public key identifier: 0'
                                                nas_5gs.mm.suci.supi_null_scheme: 'Scheme output: 0000000001'
                                            5GMM capability:
                                                nas_5gs.mm.elem_id: 'Element ID: 0x10'
                                                gsm_a.len: 'Length: 1'
                                                nas_5gs.spare_b7: '0... .... = Spare: 0'
                                                nas_5gs.spare_b6: '.0.. .... = Spare: 0'
                                                nas_5gs.spare_b5: '..0. .... = Spare: 0'
                                                nas_5gs.spare_b4: '...0 .... = Spare: 0'
                                                nas_5gs.spare_b3: '.... 0... = Spare: 0'
                                                nas_5gs.mm.lpp_cap_b2: '.... .0.. = LTE Positioning Protocol (LPP) capability: Not Requested'
                                                nas_5gs.mm.ho_attach_b1: '.... ..0. = HO attach: Not supported'
                                                nas_5gs.mm.s1_mode_b0: '.... ...0 = S1 mode: Not Requested'
                                            UE security capability:
                                                nas_5gs.mm.elem_id: 'Element ID: 0x2e'
                                                gsm_a.len: 'Length: 4'
                                                nas_5gs.mm.5g_ea0: '1... .... = 5G-EA0: Supported'
                                                nas_5gs.mm.128_5g_ea1: '.1.. .... = 128-5G-EA1: Supported'
                                                nas_5gs.mm.128_5g_ea2: '..1. .... = 128-5G-EA2: Supported'
                                                nas_5gs.mm.128_5g_ea3: '...1 .... = 128-5G-EA3: Supported'
                                                nas_5gs.mm.5g_ea4: '.... 0... = 5G-EA4: Not supported'
                                                nas_5gs.mm.5g_ea5: '.... .0.. = 5G-EA5: Not supported'
                                                nas_5gs.mm.5g_ea6: '.... ..0. = 5G-EA6: Not supported'
                                                nas_5gs.mm.5g_ea7: '.... ...0 = 5G-EA7: Not supported'
                                                nas_5gs.mm.ia0: '1... .... = 5G-IA0: Supported'
                                                nas_5gs.mm.5g_128_ia1: '.1.. .... = 128-5G-IA1: Supported'
                                                nas_5gs.mm.5g_128_ia2: '..1. .... = 128-5G-IA2: Supported'
                                                nas_5gs.mm.5g_128_ia4: '.... 0... = 5G-IA4: Not supported'
                                                nas_5gs.mm.5g_ia5: '.... .0.. = 5G-IA5: Not supported'
                                                nas_5gs.mm.5g_ia6: '.... ..0. = 5G-IA6: Not supported'
                                                nas_5gs.mm.5g_ia7: '.... ...0 = 5G-IA7: Not supported'
                                                nas_5gs.mm.eea0: '1... .... = EEA0: Supported'
                                                nas_5gs.mm.128eea1: '.1.. .... = 128-EEA1: Supported'
                                                nas_5gs.mm.128eea2: '..1. .... = 128-EEA2: Supported'
                                                nas_5gs.mm.eea3: '...1 .... = 128-EEA3: Supported'
                                                nas_5gs.mm.eea4: '.... 0... = EEA4: Not supported'
                                                nas_5gs.mm.eea5: '.... .0.. = EEA5: Not supported'
                                                nas_5gs.mm.eea6: '.... ..0. = EEA6: Not supported'
                                                nas_5gs.mm.eea7: '.... ...0 = EEA7: Not supported'
                                                nas_5gs.mm.eia0: '1... .... = EIA0: Supported'
                                                nas_5gs.mm.128eia1: '.1.. .... = 128-EIA1: Supported'
                                                nas_5gs.mm.128eia2: '..1. .... = 128-EIA2: Supported'
                                                nas_5gs.mm.eia3: '...1 .... = 128-EIA3: Supported'
                                                nas_5gs.mm.eia4: '.... 0... = EIA4: Not supported'
                                                nas_5gs.mm.eia5: '.... .0.. = EIA5: Not supported'
                                                nas_5gs.mm.eia6: '.... ..0. = EIA6: Not supported'
                                                nas_5gs.mm.eia7: '.... ...0 = EIA7: Not supported'
                                            NSSAI - Requested NSSAI:
                                                nas_5gs.mm.elem_id: 'Element ID: 0x2f'
                                                gsm_a.len: 'Length: 4'
                                                S-NSSAI 1:
                                                    nas_5gs.mm.length: 'Length: 1'
                                                    nas_5gs.mm.sst: 'Slice/service type (SST): 1'
                                                S-NSSAI 2:
                                                    nas_5gs.mm.length: 'Length: 1'
                                                    nas_5gs.mm.sst: 'Slice/service type (SST): 1'
                                            5GS update type:
                                                nas_5gs.mm.elem_id: 'Element ID: 0x53'
                                                gsm_a.len: 'Length: 1'
                                                nas_5gs.spare_b3: '.... 0... = Spare: 0'
                                                nas_5gs.spare_b2: '.... .0.. = Spare: 0'
                                                nas_5gs.mm.ng_ran_rcu: '.... ..0. = NG-RAN Radio Capability Update (NG-RAN-RCU): Not Needed'
                                                nas_5gs.mm.sms_requested: '.... ...0 = SMS requested: SMS over NAS not supported'
            'Item 3: id-UserLocationInformation':
                ngap.id: 'id: id-UserLocationInformation (121)'
                per.enum_index: 'Enumerated Index: 1'
                ngap.criticality: 'criticality: ignore (1)'
                per.open_type_length: 'Open Type Length: 19'
                ngap.value_element:
                    per.choice_index: 'Choice Index: 1'
                    ngap.UserLocationInformation:
                        ngap.userLocationInformationNR_element:
                            per.extension_bit: '..0. .... Extension Bit: False'
                            per.optional_field_bit: '.... 0... Optional Field Bit: False (iE-Extensions is NOT present)'
                            ngap.nR_CGI_element:
                                per.extension_bit: '.... .0.. Extension Bit: False'
                                per.optional_field_bit: '.... ..0. Optional Field Bit: False (iE-Extensions is NOT present)'
                                ngap.pLMNIdentity:
                                    e212.mcc: 'Mobile Country Code (MCC): International Mobile, shared code (901)'
                                    e212.mnc: 'Mobile Network Code (MNC): Unknown (70)'
                                ngap.NRCellIdentity: 'nRCellIdentity: 0x0000000010'
                            ngap.tAI_element:
                                per.extension_bit: '.... 0... Extension Bit: False'
                                per.optional_field_bit: '.... .0.. Optional Field Bit: False (iE-Extensions is NOT present)'
                                ngap.pLMNIdentity:
                                    e212.mcc: 'Mobile Country Code (MCC): International Mobile, shared code (901)'
                                    e212.mnc: 'Mobile Network Code (MNC): Unknown (70)'
                                ngap.tAC: 'tAC: 1 (0x000001)'
                            ngap.timeStamp: 'timeStamp: e74c1d9e (Dec 20, 2022 11:40:14 UTC)'

end note

"10.0.3.1" -> "10.0.2.15": 1401, NGAP InitialContextSetup (14),\nNAS Registration accept (0x42)

note right #c6ebc6
**10.0.3.1 to 10.0.2.15**
NGAP-PDU: 000e008094000008000a0002000c00550002000c001c00070009f1070200400000000420010008007700091c000e000700038000005e002087bdf4783d03ed7e5bbeb5bb6f32b5cc8d011bb84da8ad4b683df9f1659c7a72002240084370816125ffff5100264031307e02a650a39e017e0042010177000bf209f107020040ce006b2954072009f107000001150401010101210201005e0129
ngap.procedureCode: 'procedureCode: id-InitialContextSetup (14)'
per.enum_index: 'Enumerated Index: 0'
ngap.criticality: 'criticality: reject (0)'
per.open_type_length: 'Open Type Length: 148'
ngap.value_element:
-   ngap.InitialContextSetupRequest_element:
        per.extension_bit: '0... .... Extension Bit: False'
        per.sequence_of_length: 'Sequence-Of Length: 8'
        ngap.protocolIEs:
            'Item 0: id-AMF-UE-NGAP-ID':
                ngap.id: 'id: id-AMF-UE-NGAP-ID (10)'
                per.enum_index: 'Enumerated Index: 0'
                ngap.criticality: 'criticality: reject (0)'
                per.open_type_length: 'Open Type Length: 2'
                ngap.value_element:
                    ngap.AMF_UE_NGAP_ID: 'AMF-UE-NGAP-ID: 12'
            'Item 1: id-RAN-UE-NGAP-ID':
                ngap.id: 'id: id-RAN-UE-NGAP-ID (85)'
                per.enum_index: 'Enumerated Index: 0'
                ngap.criticality: 'criticality: reject (0)'
                per.open_type_length: 'Open Type Length: 2'
                ngap.value_element:
                    ngap.RAN_UE_NGAP_ID: 'RAN-UE-NGAP-ID: 12'
            'Item 2: id-GUAMI':
                ngap.id: 'id: id-GUAMI (28)'
                per.enum_index: 'Enumerated Index: 0'
                ngap.criticality: 'criticality: reject (0)'
                per.open_type_length: 'Open Type Length: 7'
                ngap.value_element:
                    ngap.GUAMI_element:
                        per.extension_bit: '0... .... Extension Bit: False'
                        per.optional_field_bit: '.0.. .... Optional Field Bit: False (iE-Extensions is NOT present)'
                        ngap.pLMNIdentity:
                            e212.mcc: 'Mobile Country Code (MCC): International Mobile, shared code (901)'
                            e212.mnc: 'Mobile Network Code (MNC): Unknown (70)'
                        ngap.aMFRegionID: 'aMFRegionID: 02 [bit length 8, 0000 0010 decimal value 2]'
                        ngap.aMFSetID: 'aMFSetID: 0040 [bit length 10, 6 LSB pad bits, 0000 0000  01.. .... decimal value 1]'
                        ngap.aMFPointer: 'aMFPointer: 00 [bit length 6, 2 LSB pad bits, 0000 00.. decimal value 0]'
            'Item 3: id-AllowedNSSAI':
                ngap.id: 'id: id-AllowedNSSAI (0)'
                per.enum_index: 'Enumerated Index: 0'
                ngap.criticality: 'criticality: reject (0)'
                per.open_type_length: 'Open Type Length: 4'
                ngap.value_element:
                    per.sequence_of_length: 'Sequence-Of Length: 2'
                    ngap.AllowedNSSAI:
                        Item 0:
                            ngap.AllowedNSSAI_Item_element:
                                per.extension_bit: '...0 .... Extension Bit: False'
                                per.optional_field_bit: '.... 0... Optional Field Bit: False (iE-Extensions is NOT present)'
                                ngap.s_NSSAI_element:
                                    per.extension_bit: '.... .0.. Extension Bit: False'
                                    per.optional_field_bit: '.... ...0 Optional Field Bit: False (iE-Extensions is NOT present)'
                                    ngap.sST: 'sST: 01'
                        Item 1:
                            ngap.AllowedNSSAI_Item_element:
                                per.extension_bit: '0... .... Extension Bit: False'
                                per.optional_field_bit: '.0.. .... Optional Field Bit: False (iE-Extensions is NOT present)'
                                ngap.s_NSSAI_element:
                                    per.extension_bit: '..0. .... Extension Bit: False'
                                    per.optional_field_bit: '.... 0... Optional Field Bit: False (iE-Extensions is NOT present)'
                                    ngap.sST: 'sST: 01'
            'Item 4: id-UESecurityCapabilities':
                ngap.id: 'id: id-UESecurityCapabilities (119)'
                per.enum_index: 'Enumerated Index: 0'
                ngap.criticality: 'criticality: reject (0)'
                per.open_type_length: 'Open Type Length: 9'
                ngap.value_element:
                    ngap.UESecurityCapabilities_element:
                        per.extension_bit: '0... .... Extension Bit: False'
                        per.optional_field_bit: '.0.. .... Optional Field Bit: False (iE-Extensions is NOT present)'
                        per.extension_present_bit: '.... .0.. Extension Present Bit: False'
                        ngap.nRencryptionAlgorithms:
                            ngap.NrencyptionAlgorithms.nea1: '1... .... .... .... = 128-NEA1: Supported'
                            ngap.NrencyptionAlgorithms.nea2: '.1.. .... .... .... = 128-NEA2: Supported'
                            ngap.NrencyptionAlgorithms.nea3: '..1. .... .... .... = 128-NEA3: Supported'
                            ngap.NrencyptionAlgorithms.reserved: '...0 0000 0000 0000 = Reserved: 0x0000'
                        ngap.nRintegrityProtectionAlgorithms:
                            ngap.NrintegrityProtectionAlgorithms.nia1: '1... .... .... .... = 128-NIA1: Supported'
                            ngap.NrintegrityProtectionAlgorithms.nia2: '.1.. .... .... .... = 128-NIA2: Supported'
                            ngap.NrintegrityProtectionAlgorithms.nia3: '..1. .... .... .... = 128-NIA3: Supported'
                            ngap.NrintegrityProtectionAlgorithms.reserved: '...0 0000 0000 0000 = Reserved: 0x0000'
                        ngap.eUTRAencryptionAlgorithms:
                            ngap.EUTRAencryptionAlgorithms.eea1: '1... .... .... .... = 128-EEA1: Supported'
                            ngap.EUTRAencryptionAlgorithms.eea2: '.1.. .... .... .... = 128-EEA2: Supported'
                            ngap.EUTRAencryptionAlgorithms.eea3: '..1. .... .... .... = 128-EEA3: Supported'
                            ngap.EUTRAencryptionAlgorithms.reserved: '...0 0000 0000 0000 = Reserved: 0x0000'
                        ngap.eUTRAintegrityProtectionAlgorithms:
                            ngap.EUTRAintegrityProtectionAlgorithms.eia1: '1... .... .... .... = 128-EIA1: Supported'
                            ngap.EUTRAintegrityProtectionAlgorithms.eia2: '.1.. .... .... .... = 128-EIA2: Supported'
                            ngap.EUTRAintegrityProtectionAlgorithms.eia3: '..1. .... .... .... = 128-EIA3: Supported'
                            ngap.EUTRAintegrityProtectionAlgorithms.reserved: '...0 0000 0000 0000 = Reserved: 0x0000'
            'Item 5: id-SecurityKey':
                ngap.id: 'id: id-SecurityKey (94)'
                per.enum_index: 'Enumerated Index: 0'
                ngap.criticality: 'criticality: reject (0)'
                per.open_type_length: 'Open Type Length: 32'
                ngap.value_element:
                    ngap.SecurityKey: 'SecurityKey: 87bdf4783d03ed7e5bbeb5bb6f32b5cc8d011bb84da8ad4b\xe2\x80\xa6 [bit length 256]'
            'Item 6: id-MaskedIMEISV':
                ngap.id: 'id: id-MaskedIMEISV (34)'
                per.enum_index: 'Enumerated Index: 1'
                ngap.criticality: 'criticality: ignore (1)'
                per.open_type_length: 'Open Type Length: 8'
                ngap.value_element:
                    ngap.MaskedIMEISV: 'MaskedIMEISV: 4370816125ffff51 [bit length 64, 0100 0011  0111 0000  1000 0001  0110 0001  0010 0101  1111 1111  1111 1111  0101 0001 decimal value 4859526252182110033]'
            'Item 7: id-NAS-PDU':
                ngap.id: 'id: id-NAS-PDU (38)'
                per.enum_index: 'Enumerated Index: 1'
                ngap.criticality: 'criticality: ignore (1)'
                per.open_type_length: 'Open Type Length: 49'
                ngap.value_element:
                    per.octet_string_length: 'Octet String Length: 48'
                    ngap.NAS_PDU:
                        nas-5gs:
                            Security protected NAS 5GS message:
                                nas_5gs.epd: 'Extended protocol discriminator: 5G mobility management messages (126)'
                                nas_5gs.spare_half_octet: '0000 .... = Spare Half Octet: 0'
                                nas_5gs.security_header_type: '.... 0010 = Security header type: Integrity protected and ciphered (2)'
                                nas_5gs.msg_auth_code: 'Message authentication code: 0xa650a39e'
                                nas_5gs.seq_no: 'Sequence number: 1'
                            Plain NAS 5GS Message:
                                nas_5gs.epd: 'Extended protocol discriminator: 5G mobility management messages (126)'
                                nas_5gs.spare_half_octet: '0000 .... = Spare Half Octet: 0'
                                nas_5gs.security_header_type: '.... 0000 = Security header type: Plain NAS message, not security protected (0)'
                                nas_5gs.mm.message_type: 'Message type: Registration accept (0x42)'
                                5GS registration result:
                                    gsm_a.len: 'Length: 1'
                                    nas_5gs.mm.reg_res.nssaa_perf: '...0 .... = NSSAA Performed: False'
                                    nas_5gs.mm.reg_res.sms_all: '.... 0... = SMS over NAS: Not Allowed'
                                    nas_5gs.mm.reg_res.res: '.... .001 = 5GS registration result: 3GPP access (1)'
                                5GS mobile identity - 5G-GUTI:
                                    nas_5gs.mm.elem_id: 'Element ID: 0x77'
                                    gsm_a.len: 'Length: 11'
                                    nas_5gs.mm.odd_even: '.... 0... = Odd/even indication: Even number of identity digits'
                                    nas_5gs.mm.type_id: '.... .010 = Type of identity: 5G-GUTI (2)'
                                    e212.mcc: 'Mobile Country Code (MCC): International Mobile, shared code (901)'
                                    e212.mnc: 'Mobile Network Code (MNC): Unknown (70)'
                                    nas_5gs.amf_region_id: 'AMF Region ID: 2'
                                    nas_5gs.amf_set_id: '0000 0000 01.. .... = AMF Set ID: 1'
                                    nas_5gs.amf_pointer: '..00 0000 = AMF Pointer: 0'
                                    nas_5gs.5g_tmsi: '5G-TMSI: 0xce006b29'
                                5GS tracking area identity list:
                                    nas_5gs.mm.elem_id: 'Element ID: 0x54'
                                    gsm_a.len: 'Length: 7'
                                    Partial tracking area list  1:
                                        nas_5gs.mm.tal_t_li: '.01. .... = Type of list: list of TACs belonging to one PLMN, with consecutive TAC values (1)'
                                        nas_5gs.mm.tal_num_e: '...0 0000 = Number of elements: 1 element (0)'
                                        e212.mcc: 'Mobile Country Code (MCC): International Mobile, shared code (901)'
                                        e212.mnc: 'Mobile Network Code (MNC): Unknown (70)'
                                        nas_5gs.tac: 'TAC: 1'
                                NSSAI - Allowed NSSAI:
                                    nas_5gs.mm.elem_id: 'Element ID: 0x15'
                                    gsm_a.len: 'Length: 4'
                                    S-NSSAI 1:
                                        nas_5gs.mm.length: 'Length: 1'
                                        nas_5gs.mm.sst: 'Slice/service type (SST): 1'
                                    S-NSSAI 2:
                                        nas_5gs.mm.length: 'Length: 1'
                                        nas_5gs.mm.sst: 'Slice/service type (SST): 1'
                                5GS network feature support:
                                    nas_5gs.mm.elem_id: 'Element ID: 0x21'
                                    gsm_a.len: 'Length: 2'
                                    nas_5gs.nw_feat_sup.mpsi: '0... .... = MPS indicator (MPSI): Access identity 1 not valid in RPLMN or equivalent PLMN'
                                    nas_5gs.nw_feat_sup.iwk_n26: '.0.. .... = Interworking without N26: Not supported'
                                    nas_5gs.nw_feat_sup.emf: '..00 .... = Emergency service fallback indicator (EMF): Emergency services fallback not supported (0)'
                                    nas_5gs.nw_feat_sup.emc: '.... 00.. = Emergency service support indicator (EMC): Emergency services not supported (0)'
                                    nas_5gs.nw_feat_sup.vops_n3gpp: '.... ..0. = IMS voice over PS session over non-3GPP access indicator (IMS-VoPS-N3GPP): Not supported'
                                    nas_5gs.nw_feat_sup.vops_3gpp: '.... ...1 = IMS voice over PS session indicator (IMS VoPS): Supported'
                                    nas_5gs.spare_b7: '0... .... = Spare: 0'
                                    nas_5gs.spare_b6: '.0.. .... = Spare: 0'
                                    nas_5gs.spare_b5: '..0. .... = Spare: 0'
                                    nas_5gs.spare_b4: '...0 .... = Spare: 0'
                                    nas_5gs.spare_b3: '.... 0... = Spare: 0'
                                    nas_5gs.spare_b2: '.... .0.. = Spare: 0'
                                    nas_5gs.nw_feat_sup.mcsi: '.... ..0. = MCS indicator (MCSI): Not supported'
                                    nas_5gs.nw_feat_sup.emcn3: '.... ...0 = Emergency services over non-3GPP access (EMCN3): Not supported'
                                GPRS Timer 3 - T3512 value:
                                    gsm_a.gm.elem_id: 'Element ID: 0x5e'
                                    gsm_a.len: 'Length: 1'
                                    gsm_a.gm.gmm.gprs_timer3:
                                        gsm_a.gm.gmm.gprs_timer3_unit: '001. .... = Unit: value is incremented in multiples of 1 hour (1)'
                                        gsm_a.gm.gmm.gprs_timer3_value: '...0 1001 = Timer value: 9'

end note

"10.0.2.15" -> "10.0.3.1": 1402, NGAP InitialContextSetup (14)

note right #c6ebc6
**10.0.2.15 to 10.0.3.1**
NGAP-PDU: 200e000f000002000a4002000c00554002000c
ngap.procedureCode: 'procedureCode: id-InitialContextSetup (14)'
per.enum_index: 'Enumerated Index: 0'
ngap.criticality: 'criticality: reject (0)'
per.open_type_length: 'Open Type Length: 15'
ngap.value_element:
-   ngap.InitialContextSetupResponse_element:
        per.extension_bit: '0... .... Extension Bit: False'
        per.sequence_of_length: 'Sequence-Of Length: 2'
        ngap.protocolIEs:
            'Item 0: id-AMF-UE-NGAP-ID':
                ngap.id: 'id: id-AMF-UE-NGAP-ID (10)'
                per.enum_index: 'Enumerated Index: 1'
                ngap.criticality: 'criticality: ignore (1)'
                per.open_type_length: 'Open Type Length: 2'
                ngap.value_element:
                    ngap.AMF_UE_NGAP_ID: 'AMF-UE-NGAP-ID: 12'
            'Item 1: id-RAN-UE-NGAP-ID':
                ngap.id: 'id: id-RAN-UE-NGAP-ID (85)'
                per.enum_index: 'Enumerated Index: 1'
                ngap.criticality: 'criticality: ignore (1)'
                per.open_type_length: 'Open Type Length: 2'
                ngap.value_element:
                    ngap.RAN_UE_NGAP_ID: 'RAN-UE-NGAP-ID: 12'

end note

"10.0.2.15" -> "10.0.3.1": 1406, NGAP UplinkNASTransport (46),\nNAS Registration complete (0x43)

note right #c6ebc6
**10.0.2.15 to 10.0.3.1**
NGAP-PDU: 002e4035000004000a0002000c00550002000c0026000b0a7e02870c15f8017e0043007940135009f107000000010009f107000001e74c1d9e
ngap.procedureCode: 'procedureCode: id-UplinkNASTransport (46)'
per.enum_index: 'Enumerated Index: 1'
ngap.criticality: 'criticality: ignore (1)'
per.open_type_length: 'Open Type Length: 53'
ngap.value_element:
-   ngap.UplinkNASTransport_element:
        per.extension_bit: '0... .... Extension Bit: False'
        per.sequence_of_length: 'Sequence-Of Length: 4'
        ngap.protocolIEs:
            'Item 0: id-AMF-UE-NGAP-ID':
                ngap.id: 'id: id-AMF-UE-NGAP-ID (10)'
                per.enum_index: 'Enumerated Index: 0'
                ngap.criticality: 'criticality: reject (0)'
                per.open_type_length: 'Open Type Length: 2'
                ngap.value_element:
                    ngap.AMF_UE_NGAP_ID: 'AMF-UE-NGAP-ID: 12'
            'Item 1: id-RAN-UE-NGAP-ID':
                ngap.id: 'id: id-RAN-UE-NGAP-ID (85)'
                per.enum_index: 'Enumerated Index: 0'
                ngap.criticality: 'criticality: reject (0)'
                per.open_type_length: 'Open Type Length: 2'
                ngap.value_element:
                    ngap.RAN_UE_NGAP_ID: 'RAN-UE-NGAP-ID: 12'
            'Item 2: id-NAS-PDU':
                ngap.id: 'id: id-NAS-PDU (38)'
                per.enum_index: 'Enumerated Index: 0'
                ngap.criticality: 'criticality: reject (0)'
                per.open_type_length: 'Open Type Length: 11'
                ngap.value_element:
                    per.octet_string_length: 'Octet String Length: 10'
                    ngap.NAS_PDU:
                        nas-5gs:
                            Security protected NAS 5GS message:
                                nas_5gs.epd: 'Extended protocol discriminator: 5G mobility management messages (126)'
                                nas_5gs.spare_half_octet: '0000 .... = Spare Half Octet: 0'
                                nas_5gs.security_header_type: '.... 0010 = Security header type: Integrity protected and ciphered (2)'
                                nas_5gs.msg_auth_code: 'Message authentication code: 0x870c15f8'
                                nas_5gs.seq_no: 'Sequence number: 1'
                            Plain NAS 5GS Message:
                                nas_5gs.epd: 'Extended protocol discriminator: 5G mobility management messages (126)'
                                nas_5gs.spare_half_octet: '0000 .... = Spare Half Octet: 0'
                                nas_5gs.security_header_type: '.... 0000 = Security header type: Plain NAS message, not security protected (0)'
                                nas_5gs.mm.message_type: 'Message type: Registration complete (0x43)'
            'Item 3: id-UserLocationInformation':
                ngap.id: 'id: id-UserLocationInformation (121)'
                per.enum_index: 'Enumerated Index: 1'
                ngap.criticality: 'criticality: ignore (1)'
                per.open_type_length: 'Open Type Length: 19'
                ngap.value_element:
                    per.choice_index: 'Choice Index: 1'
                    ngap.UserLocationInformation:
                        ngap.userLocationInformationNR_element:
                            per.extension_bit: '..0. .... Extension Bit: False'
                            per.optional_field_bit: '.... 0... Optional Field Bit: False (iE-Extensions is NOT present)'
                            ngap.nR_CGI_element:
                                per.extension_bit: '.... .0.. Extension Bit: False'
                                per.optional_field_bit: '.... ..0. Optional Field Bit: False (iE-Extensions is NOT present)'
                                ngap.pLMNIdentity:
                                    e212.mcc: 'Mobile Country Code (MCC): International Mobile, shared code (901)'
                                    e212.mnc: 'Mobile Network Code (MNC): Unknown (70)'
                                ngap.NRCellIdentity: 'nRCellIdentity: 0x0000000010'
                            ngap.tAI_element:
                                per.extension_bit: '.... 0... Extension Bit: False'
                                per.optional_field_bit: '.... .0.. Optional Field Bit: False (iE-Extensions is NOT present)'
                                ngap.pLMNIdentity:
                                    e212.mcc: 'Mobile Country Code (MCC): International Mobile, shared code (901)'
                                    e212.mnc: 'Mobile Network Code (MNC): Unknown (70)'
                                ngap.tAC: 'tAC: 1 (0x000001)'
                            ngap.timeStamp: 'timeStamp: e74c1d9e (Dec 20, 2022 11:40:14 UTC)'

end note

"10.0.3.1" -> "10.0.2.15": 1407, NGAP DownlinkNASTransport (4),\nNAS Configuration update command (0x54)

note right #c6ebc6
**10.0.3.1 to 10.0.2.15**
NGAP-PDU: 0004403c000003000a0002000c00550002000c00260029287e02ce27fb61027e0054430f90004f00700065006e00350047005346404722219261600240490100
ngap.procedureCode: 'procedureCode: id-DownlinkNASTransport (4)'
per.enum_index: 'Enumerated Index: 1'
ngap.criticality: 'criticality: ignore (1)'
per.open_type_length: 'Open Type Length: 60'
ngap.value_element:
-   ngap.DownlinkNASTransport_element:
        per.extension_bit: '0... .... Extension Bit: False'
        per.sequence_of_length: 'Sequence-Of Length: 3'
        ngap.protocolIEs:
            'Item 0: id-AMF-UE-NGAP-ID':
                ngap.id: 'id: id-AMF-UE-NGAP-ID (10)'
                per.enum_index: 'Enumerated Index: 0'
                ngap.criticality: 'criticality: reject (0)'
                per.open_type_length: 'Open Type Length: 2'
                ngap.value_element:
                    ngap.AMF_UE_NGAP_ID: 'AMF-UE-NGAP-ID: 12'
            'Item 1: id-RAN-UE-NGAP-ID':
                ngap.id: 'id: id-RAN-UE-NGAP-ID (85)'
                per.enum_index: 'Enumerated Index: 0'
                ngap.criticality: 'criticality: reject (0)'
                per.open_type_length: 'Open Type Length: 2'
                ngap.value_element:
                    ngap.RAN_UE_NGAP_ID: 'RAN-UE-NGAP-ID: 12'
            'Item 2: id-NAS-PDU':
                ngap.id: 'id: id-NAS-PDU (38)'
                per.enum_index: 'Enumerated Index: 0'
                ngap.criticality: 'criticality: reject (0)'
                per.open_type_length: 'Open Type Length: 41'
                ngap.value_element:
                    per.octet_string_length: 'Octet String Length: 40'
                    ngap.NAS_PDU:
                        nas-5gs:
                            Security protected NAS 5GS message:
                                nas_5gs.epd: 'Extended protocol discriminator: 5G mobility management messages (126)'
                                nas_5gs.spare_half_octet: '0000 .... = Spare Half Octet: 0'
                                nas_5gs.security_header_type: '.... 0010 = Security header type: Integrity protected and ciphered (2)'
                                nas_5gs.msg_auth_code: 'Message authentication code: 0xce27fb61'
                                nas_5gs.seq_no: 'Sequence number: 2'
                            Plain NAS 5GS Message:
                                nas_5gs.epd: 'Extended protocol discriminator: 5G mobility management messages (126)'
                                nas_5gs.spare_half_octet: '0000 .... = Spare Half Octet: 0'
                                nas_5gs.security_header_type: '.... 0000 = Security header type: Plain NAS message, not security protected (0)'
                                nas_5gs.mm.message_type: 'Message type: Configuration update command (0x54)'
                                Network Name - Full name for network:
                                    gsm_a.dtap.elem_id: 'Element ID: 0x43'
                                    gsm_a.len: 'Length: 15'
                                    gsm_a.extension: '1... .... = Extension: No Extension'
                                    gsm_a.dtap.coding_scheme: '.001 .... = Coding Scheme: UCS2 (16 bit) (1)'
                                    gsm_a.dtap.add_ci: '.... 0... = Add CI: The MS should not add the letters for the Country''s Initials to the text string'
                                    gsm_a.dtap.number_of_spare_bits: '.... .000 = Number of spare bits in last octet: this field carries no information about the number of spare bits in octet n (0)'
                                    gsm_a.dtap.text_string: 'Text String: Open5GS'
                                Time Zone - Local:
                                    gsm_a.dtap.elem_id: 'Element ID: 0x46'
                                    gsm_a.dtap.timezone: 'Timezone: GMT + 1 hours 0 minutes'
                                Time Zone and Time - Universal Time and Local Time Zone:
                                    gsm_a.dtap.elem_id: 'Element ID: 0x47'
                                    gsm_a.dtap.time_zone_time: 'Time: Dec 29, 2022 16:06:20.000000000'
                                    gsm_a.dtap.timezone: 'Timezone: GMT + 1 hours 0 minutes'
                                Daylight Saving Time:
                                    gsm_a.dtap.elem_id: 'Element ID: 0x49'
                                    gsm_a.len: 'Length: 1'
                                    gsm_a.spare_bits: '0000 00.. = Spare bit(s): 0'
                                    gsm_a.dtap.dst_adjustment: '.... ..00 = DST Adjustment: No adjustment for Daylight Saving Time (0)'

end note

"10.0.2.15" -> "10.0.3.1": 1493, NGAP InitialUEMessage (15),\nNAS Service request (0x4c)

note right #8cd98c
**10.0.2.15 to 10.0.3.1**
NGAP-PDU: 000f406600000600550002000d0026002d2c7e01a4e4d321037e004c100007f40040ed005d857100157e004c100007f40040ed005d854002020050020200007900135009f107000000010009f107000001e74c1dab005a400120001a0007001000ed005d850070400100
ngap.procedureCode: 'procedureCode: id-InitialUEMessage (15)'
per.enum_index: 'Enumerated Index: 1'
ngap.criticality: 'criticality: ignore (1)'
per.open_type_length: 'Open Type Length: 102'
ngap.value_element:
-   ngap.InitialUEMessage_element:
        per.extension_bit: '0... .... Extension Bit: False'
        per.sequence_of_length: 'Sequence-Of Length: 6'
        ngap.protocolIEs:
            'Item 0: id-RAN-UE-NGAP-ID':
                ngap.id: 'id: id-RAN-UE-NGAP-ID (85)'
                per.enum_index: 'Enumerated Index: 0'
                ngap.criticality: 'criticality: reject (0)'
                per.open_type_length: 'Open Type Length: 2'
                ngap.value_element:
                    ngap.RAN_UE_NGAP_ID: 'RAN-UE-NGAP-ID: 13'
            'Item 1: id-NAS-PDU':
                ngap.id: 'id: id-NAS-PDU (38)'
                per.enum_index: 'Enumerated Index: 0'
                ngap.criticality: 'criticality: reject (0)'
                per.open_type_length: 'Open Type Length: 45'
                ngap.value_element:
                    per.octet_string_length: 'Octet String Length: 44'
                    ngap.NAS_PDU:
                        nas-5gs:
                            Security protected NAS 5GS message:
                                nas_5gs.epd: 'Extended protocol discriminator: 5G mobility management messages (126)'
                                nas_5gs.spare_half_octet: '0000 .... = Spare Half Octet: 0'
                                nas_5gs.security_header_type: '.... 0001 = Security header type: Integrity protected (1)'
                                nas_5gs.msg_auth_code: 'Message authentication code: 0xa4e4d321'
                                nas_5gs.seq_no: 'Sequence number: 3'
                            Plain NAS 5GS Message:
                                nas_5gs.epd: 'Extended protocol discriminator: 5G mobility management messages (126)'
                                nas_5gs.spare_half_octet: '0000 .... = Spare Half Octet: 0'
                                nas_5gs.security_header_type: '.... 0000 = Security header type: Plain NAS message, not security protected (0)'
                                nas_5gs.mm.message_type: 'Message type: Service request (0x4c)'
                                NAS key set identifier:
                                    nas_5gs.mm.tsc: '.... 0... = Type of security context flag (TSC): Native security context (for KSIAMF)'
                                    nas_5gs.mm.nas_key_set_id: '.... .000 = NAS key set identifier: 0'
                                Service type:
                                    nas_5gs.mm.serv_type: '.001 .... = Service type: Data (1)'
                                5GS mobile identity:
                                    gsm_a.len: 'Length: 7'
                                    nas_5gs.mm.odd_even: '.... 0... = Odd/even indication: Even number of identity digits'
                                    nas_5gs.mm.type_id: '.... .100 = Type of identity: 5G-S-TMSI (4)'
                                    nas_5gs.amf_set_id: '0000 0000 01.. .... = AMF Set ID: 1'
                                    nas_5gs.amf_pointer: '..00 0000 = AMF Pointer: 0'
                                    nas_5gs.5g_tmsi: '5G-TMSI: 0xed005d85'
                                NAS message container:
                                    nas_5gs.mm.elem_id: 'Element ID: 0x71'
                                    gsm_a.len: 'Length: 21'
                                    nas-5gs:
                                        Plain NAS 5GS Message:
                                            nas_5gs.epd: 'Extended protocol discriminator: 5G mobility management messages (126)'
                                            nas_5gs.spare_half_octet: '0000 .... = Spare Half Octet: 0'
                                            nas_5gs.security_header_type: '.... 0000 = Security header type: Plain NAS message, not security protected (0)'
                                            nas_5gs.mm.message_type: 'Message type: Service request (0x4c)'
                                            NAS key set identifier:
                                                nas_5gs.mm.tsc: '.... 0... = Type of security context flag (TSC): Native security context (for KSIAMF)'
                                                nas_5gs.mm.nas_key_set_id: '.... .000 = NAS key set identifier: 0'
                                            Service type:
                                                nas_5gs.mm.serv_type: '.001 .... = Service type: Data (1)'
                                            5GS mobile identity:
                                                gsm_a.len: 'Length: 7'
                                                nas_5gs.mm.odd_even: '.... 0... = Odd/even indication: Even number of identity digits'
                                                nas_5gs.mm.type_id: '.... .100 = Type of identity: 5G-S-TMSI (4)'
                                                nas_5gs.amf_set_id: '0000 0000 01.. .... = AMF Set ID: 1'
                                                nas_5gs.amf_pointer: '..00 0000 = AMF Pointer: 0'
                                                nas_5gs.5g_tmsi: '5G-TMSI: 0xed005d85'
                                            Uplink data status:
                                                nas_5gs.mm.elem_id: 'Element ID: 0x40'
                                                gsm_a.len: 'Length: 2'
                                                nas_5gs.ul_data_sts_psi_7_b7: '0... .... = PSI(7): no uplink data are pending'
                                                nas_5gs.ul_data_sts_psi_6_b6: '.0.. .... = PSI(6): no uplink data are pending'
                                                nas_5gs.ul_data_sts_psi_5_b5: '..0. .... = PSI(5): no uplink data are pending'
                                                nas_5gs.ul_data_sts_psi_4_b4: '...0 .... = PSI(4): no uplink data are pending'
                                                nas_5gs.ul_data_sts_psi_3_b3: '.... 0... = PSI(3): no uplink data are pending'
                                                nas_5gs.ul_data_sts_psi_2_b2: '.... .0.. = PSI(2): no uplink data are pending'
                                                nas_5gs.ul_data_sts_psi_1_b1: '.... ..1. = PSI(1): uplink data are pending'
                                                nas_5gs.ul_data_sts_psi_0_b0: '.... ...0 = Spare: False'
                                                nas_5gs.ul_data_sts_psi_15_b7: '0... .... = PSI(15): no uplink data are pending'
                                                nas_5gs.ul_data_sts_psi_14_b6: '.0.. .... = PSI(14): no uplink data are pending'
                                                nas_5gs.ul_data_sts_psi_13_b5: '..0. .... = PSI(13): no uplink data are pending'
                                                nas_5gs.ul_data_sts_psi_12_b4: '...0 .... = PSI(12): no uplink data are pending'
                                                nas_5gs.ul_data_sts_psi_11_b3: '.... 0... = PSI(11): no uplink data are pending'
                                                nas_5gs.ul_data_sts_psi_10_b2: '.... .0.. = PSI(10): no uplink data are pending'
                                                nas_5gs.ul_data_sts_psi_9_b1: '.... ..0. = PSI(9): no uplink data are pending'
                                                nas_5gs.ul_data_sts_psi_8_b0: '.... ...0 = PSI(8): no uplink data are pending'
                                            PDU session status:
                                                nas_5gs.mm.elem_id: 'Element ID: 0x50'
                                                gsm_a.len: 'Length: 2'
                                                nas_5gs.pdu_ses_sts_psi_7_b7: '0... .... = PSI(7): PDU SESSION INACTIVE'
                                                nas_5gs.pdu_ses_sts_psi_6_b6: '.0.. .... = PSI(6): PDU SESSION INACTIVE'
                                                nas_5gs.pdu_ses_sts_psi_5_b5: '..0. .... = PSI(5): PDU SESSION INACTIVE'
                                                nas_5gs.pdu_ses_sts_psi_4_b4: '...0 .... = PSI(4): PDU SESSION INACTIVE'
                                                nas_5gs.pdu_ses_sts_psi_3_b3: '.... 0... = PSI(3): PDU SESSION INACTIVE'
                                                nas_5gs.pdu_ses_sts_psi_2_b2: '.... .0.. = PSI(2): PDU SESSION INACTIVE'
                                                nas_5gs.pdu_ses_sts_psi_1_b1: '.... ..1. = PSI(1): Not PDU SESSION INACTIVE'
                                                nas_5gs.pdu_ses_sts_psi_0_b0: '.... ...0 = Spare: False'
                                                nas_5gs.pdu_ses_sts_psi_15_b7: '0... .... = PSI(15): PDU SESSION INACTIVE'
                                                nas_5gs.pdu_ses_sts_psi_14_b6: '.0.. .... = PSI(14): PDU SESSION INACTIVE'
                                                nas_5gs.pdu_ses_sts_psi_13_b5: '..0. .... = PSI(13): PDU SESSION INACTIVE'
                                                nas_5gs.pdu_ses_sts_psi_12_b4: '...0 .... = PSI(12): PDU SESSION INACTIVE'
                                                nas_5gs.pdu_ses_sts_psi_11_b3: '.... 0... = PSI(11): PDU SESSION INACTIVE'
                                                nas_5gs.pdu_ses_sts_psi_10_b2: '.... .0.. = PSI(10): PDU SESSION INACTIVE'
                                                nas_5gs.pdu_ses_sts_psi_9_b1: '.... ..0. = PSI(9): PDU SESSION INACTIVE'
                                                nas_5gs.pdu_ses_sts_psi_8_b0: '.... ...0 = PSI(8): PDU SESSION INACTIVE'
            'Item 2: id-UserLocationInformation':
                ngap.id: 'id: id-UserLocationInformation (121)'
                per.enum_index: 'Enumerated Index: 0'
                ngap.criticality: 'criticality: reject (0)'
                per.open_type_length: 'Open Type Length: 19'
                ngap.value_element:
                    per.choice_index: 'Choice Index: 1'
                    ngap.UserLocationInformation:
                        ngap.userLocationInformationNR_element:
                            per.extension_bit: '..0. .... Extension Bit: False'
                            per.optional_field_bit: '.... 0... Optional Field Bit: False (iE-Extensions is NOT present)'
                            ngap.nR_CGI_element:
                                per.extension_bit: '.... .0.. Extension Bit: False'
                                per.optional_field_bit: '.... ..0. Optional Field Bit: False (iE-Extensions is NOT present)'
                                ngap.pLMNIdentity:
                                    e212.mcc: 'Mobile Country Code (MCC): International Mobile, shared code (901)'
                                    e212.mnc: 'Mobile Network Code (MNC): Unknown (70)'
                                ngap.NRCellIdentity: 'nRCellIdentity: 0x0000000010'
                            ngap.tAI_element:
                                per.extension_bit: '.... 0... Extension Bit: False'
                                per.optional_field_bit: '.... .0.. Optional Field Bit: False (iE-Extensions is NOT present)'
                                ngap.pLMNIdentity:
                                    e212.mcc: 'Mobile Country Code (MCC): International Mobile, shared code (901)'
                                    e212.mnc: 'Mobile Network Code (MNC): Unknown (70)'
                                ngap.tAC: 'tAC: 1 (0x000001)'
                            ngap.timeStamp: 'timeStamp: e74c1dab (Dec 20, 2022 11:40:27 UTC)'
            'Item 3: id-RRCEstablishmentCause':
                ngap.id: 'id: id-RRCEstablishmentCause (90)'
                per.enum_index: 'Enumerated Index: 1'
                ngap.criticality: 'criticality: ignore (1)'
                per.open_type_length: 'Open Type Length: 1'
                ngap.value_element:
                    per.extension_present_bit: '0... .... Extension Present Bit: False'
                    per.enum_index: 'Enumerated Index: 4'
                    ngap.RRCEstablishmentCause: 'RRCEstablishmentCause: mo-Data (4)'
            'Item 4: id-FiveG-S-TMSI':
                ngap.id: 'id: id-FiveG-S-TMSI (26)'
                per.enum_index: 'Enumerated Index: 0'
                ngap.criticality: 'criticality: reject (0)'
                per.open_type_length: 'Open Type Length: 7'
                ngap.value_element:
                    ngap.FiveG_S_TMSI_element:
                        per.extension_bit: '0... .... Extension Bit: False'
                        per.optional_field_bit: '.0.. .... Optional Field Bit: False (iE-Extensions is NOT present)'
                        ngap.aMFSetID: 'aMFSetID: 0040 [bit length 10, 6 LSB pad bits, 0000 0000  01.. .... decimal value 1]'
                        ngap.aMFPointer: 'aMFPointer: 00 [bit length 6, 2 LSB pad bits, 0000 00.. decimal value 0]'
                        ngap.fiveG_TMSI: 'fiveG-TMSI: ed005d85'
            'Item 5: id-UEContextRequest':
                ngap.id: 'id: id-UEContextRequest (112)'
                per.enum_index: 'Enumerated Index: 1'
                ngap.criticality: 'criticality: ignore (1)'
                per.open_type_length: 'Open Type Length: 1'
                ngap.value_element:
                    per.extension_present_bit: '0... .... Extension Present Bit: False'
                    per.enum_index: 'Enumerated Index: 0'
                    ngap.UEContextRequest: 'UEContextRequest: requested (0)'

end note

"10.0.3.1" -> "10.0.2.15": 1494, NGAP DownlinkNASTransport (4),\nNAS Service reject (0x4d)

note right #c6ebc6
**10.0.3.1 to 10.0.2.15**
NGAP-PDU: 00044018000003000a0002000d00550002000d00260005047e004d09
ngap.procedureCode: 'procedureCode: id-DownlinkNASTransport (4)'
per.enum_index: 'Enumerated Index: 1'
ngap.criticality: 'criticality: ignore (1)'
per.open_type_length: 'Open Type Length: 24'
ngap.value_element:
-   ngap.DownlinkNASTransport_element:
        per.extension_bit: '0... .... Extension Bit: False'
        per.sequence_of_length: 'Sequence-Of Length: 3'
        ngap.protocolIEs:
            'Item 0: id-AMF-UE-NGAP-ID':
                ngap.id: 'id: id-AMF-UE-NGAP-ID (10)'
                per.enum_index: 'Enumerated Index: 0'
                ngap.criticality: 'criticality: reject (0)'
                per.open_type_length: 'Open Type Length: 2'
                ngap.value_element:
                    ngap.AMF_UE_NGAP_ID: 'AMF-UE-NGAP-ID: 13'
            'Item 1: id-RAN-UE-NGAP-ID':
                ngap.id: 'id: id-RAN-UE-NGAP-ID (85)'
                per.enum_index: 'Enumerated Index: 0'
                ngap.criticality: 'criticality: reject (0)'
                per.open_type_length: 'Open Type Length: 2'
                ngap.value_element:
                    ngap.RAN_UE_NGAP_ID: 'RAN-UE-NGAP-ID: 13'
            'Item 2: id-NAS-PDU':
                ngap.id: 'id: id-NAS-PDU (38)'
                per.enum_index: 'Enumerated Index: 0'
                ngap.criticality: 'criticality: reject (0)'
                per.open_type_length: 'Open Type Length: 5'
                ngap.value_element:
                    per.octet_string_length: 'Octet String Length: 4'
                    ngap.NAS_PDU:
                        nas-5gs:
                            Plain NAS 5GS Message:
                                nas_5gs.epd: 'Extended protocol discriminator: 5G mobility management messages (126)'
                                nas_5gs.spare_half_octet: '0000 .... = Spare Half Octet: 0'
                                nas_5gs.security_header_type: '.... 0000 = Security header type: Plain NAS message, not security protected (0)'
                                nas_5gs.mm.message_type: 'Message type: Service reject (0x4d)'
                                5GMM cause:
                                    nas_5gs.mm.5gmm_cause: '5GMM cause: UE identity cannot be derived by the network (9)'

end note

"10.0.3.1" -> "10.0.2.15": 1495, NGAP UEContextRelease (41)

note right #c6ebc6
**10.0.3.1 to 10.0.2.15**
NGAP-PDU: 0029001000000200720004000d000d000f400140
ngap.procedureCode: 'procedureCode: id-UEContextRelease (41)'
per.enum_index: 'Enumerated Index: 0'
ngap.criticality: 'criticality: reject (0)'
per.open_type_length: 'Open Type Length: 16'
ngap.value_element:
-   ngap.UEContextReleaseCommand_element:
        per.extension_bit: '0... .... Extension Bit: False'
        per.sequence_of_length: 'Sequence-Of Length: 2'
        ngap.protocolIEs:
            'Item 0: id-UE-NGAP-IDs':
                ngap.id: 'id: id-UE-NGAP-IDs (114)'
                per.enum_index: 'Enumerated Index: 0'
                ngap.criticality: 'criticality: reject (0)'
                per.open_type_length: 'Open Type Length: 4'
                ngap.value_element:
                    per.choice_index: 'Choice Index: 0'
                    ngap.UE_NGAP_IDs:
                        ngap.uE_NGAP_ID_pair_element:
                            per.extension_bit: '..0. .... Extension Bit: False'
                            per.optional_field_bit: '...0 .... Optional Field Bit: False (iE-Extensions is NOT present)'
                            ngap.aMF_UE_NGAP_ID: 'aMF-UE-NGAP-ID: 13'
                            ngap.rAN_UE_NGAP_ID: 'rAN-UE-NGAP-ID: 13'
            'Item 1: id-Cause':
                ngap.id: 'id: id-Cause (15)'
                per.enum_index: 'Enumerated Index: 1'
                ngap.criticality: 'criticality: ignore (1)'
                per.open_type_length: 'Open Type Length: 1'
                ngap.value_element:
                    per.choice_index: 'Choice Index: 2'
                    ngap.Cause:
                        per.extension_present_bit: '...0 .... Extension Present Bit: False'
                        per.enum_index: 'Enumerated Index: 0'
                        ngap.nas: 'nas: normal-release (0)'

end note

"10.0.2.15" -> "10.0.3.1": 1497, NGAP UEContextRelease (41)

note right #c6ebc6
**10.0.2.15 to 10.0.3.1**
NGAP-PDU: 20290026000003000a4002000d00554002000d007940135009f107000000010009f107000001e74c1dab
ngap.procedureCode: 'procedureCode: id-UEContextRelease (41)'
per.enum_index: 'Enumerated Index: 0'
ngap.criticality: 'criticality: reject (0)'
per.open_type_length: 'Open Type Length: 38'
ngap.value_element:
-   ngap.UEContextReleaseComplete_element:
        per.extension_bit: '0... .... Extension Bit: False'
        per.sequence_of_length: 'Sequence-Of Length: 3'
        ngap.protocolIEs:
            'Item 0: id-AMF-UE-NGAP-ID':
                ngap.id: 'id: id-AMF-UE-NGAP-ID (10)'
                per.enum_index: 'Enumerated Index: 1'
                ngap.criticality: 'criticality: ignore (1)'
                per.open_type_length: 'Open Type Length: 2'
                ngap.value_element:
                    ngap.AMF_UE_NGAP_ID: 'AMF-UE-NGAP-ID: 13'
            'Item 1: id-RAN-UE-NGAP-ID':
                ngap.id: 'id: id-RAN-UE-NGAP-ID (85)'
                per.enum_index: 'Enumerated Index: 1'
                ngap.criticality: 'criticality: ignore (1)'
                per.open_type_length: 'Open Type Length: 2'
                ngap.value_element:
                    ngap.RAN_UE_NGAP_ID: 'RAN-UE-NGAP-ID: 13'
            'Item 2: id-UserLocationInformation':
                ngap.id: 'id: id-UserLocationInformation (121)'
                per.enum_index: 'Enumerated Index: 1'
                ngap.criticality: 'criticality: ignore (1)'
                per.open_type_length: 'Open Type Length: 19'
                ngap.value_element:
                    per.choice_index: 'Choice Index: 1'
                    ngap.UserLocationInformation:
                        ngap.userLocationInformationNR_element:
                            per.extension_bit: '..0. .... Extension Bit: False'
                            per.optional_field_bit: '.... 0... Optional Field Bit: False (iE-Extensions is NOT present)'
                            ngap.nR_CGI_element:
                                per.extension_bit: '.... .0.. Extension Bit: False'
                                per.optional_field_bit: '.... ..0. Optional Field Bit: False (iE-Extensions is NOT present)'
                                ngap.pLMNIdentity:
                                    e212.mcc: 'Mobile Country Code (MCC): International Mobile, shared code (901)'
                                    e212.mnc: 'Mobile Network Code (MNC): Unknown (70)'
                                ngap.NRCellIdentity: 'nRCellIdentity: 0x0000000010'
                            ngap.tAI_element:
                                per.extension_bit: '.... 0... Extension Bit: False'
                                per.optional_field_bit: '.... .0.. Optional Field Bit: False (iE-Extensions is NOT present)'
                                ngap.pLMNIdentity:
                                    e212.mcc: 'Mobile Country Code (MCC): International Mobile, shared code (901)'
                                    e212.mnc: 'Mobile Network Code (MNC): Unknown (70)'
                                ngap.tAC: 'tAC: 1 (0x000001)'
                            ngap.timeStamp: 'timeStamp: e74c1dab (Dec 20, 2022 11:40:27 UTC)'

end note

"10.0.2.15" -> "10.0.3.1": 1499, NGAP InitialUEMessage (15),\nNAS Registration request (0x41)

note right #8cd98c
**10.0.2.15 to 10.0.3.1**
NGAP-PDU: 000f404800000500550002000e0026001a197e004179000d0109f1070000000000000000202e04f0f0f0f0007900135009f107000000010009f107000001e74c1dab005a4001200070400100
ngap.procedureCode: 'procedureCode: id-InitialUEMessage (15)'
per.enum_index: 'Enumerated Index: 1'
ngap.criticality: 'criticality: ignore (1)'
per.open_type_length: 'Open Type Length: 72'
ngap.value_element:
-   ngap.InitialUEMessage_element:
        per.extension_bit: '0... .... Extension Bit: False'
        per.sequence_of_length: 'Sequence-Of Length: 5'
        ngap.protocolIEs:
            'Item 0: id-RAN-UE-NGAP-ID':
                ngap.id: 'id: id-RAN-UE-NGAP-ID (85)'
                per.enum_index: 'Enumerated Index: 0'
                ngap.criticality: 'criticality: reject (0)'
                per.open_type_length: 'Open Type Length: 2'
                ngap.value_element:
                    ngap.RAN_UE_NGAP_ID: 'RAN-UE-NGAP-ID: 14'
            'Item 1: id-NAS-PDU':
                ngap.id: 'id: id-NAS-PDU (38)'
                per.enum_index: 'Enumerated Index: 0'
                ngap.criticality: 'criticality: reject (0)'
                per.open_type_length: 'Open Type Length: 26'
                ngap.value_element:
                    per.octet_string_length: 'Octet String Length: 25'
                    ngap.NAS_PDU:
                        nas-5gs:
                            Plain NAS 5GS Message:
                                nas_5gs.epd: 'Extended protocol discriminator: 5G mobility management messages (126)'
                                nas_5gs.spare_half_octet: '0000 .... = Spare Half Octet: 0'
                                nas_5gs.security_header_type: '.... 0000 = Security header type: Plain NAS message, not security protected (0)'
                                nas_5gs.mm.message_type: 'Message type: Registration request (0x41)'
                                5GS registration type:
                                    nas_5gs.mm.for: '.... 1... = Follow-On Request bit (FOR): Follow-on request pending'
                                    nas_5gs.mm.5gs_reg_type: '.... .001 = 5GS registration type: initial registration (1)'
                                NAS key set identifier:
                                    nas_5gs.mm.tsc.h1: '0... .... = Type of security context flag (TSC): Native security context (for KSIAMF)'
                                    nas_5gs.mm.nas_key_set_id.h1: '.111 .... = NAS key set identifier: 7'
                                5GS mobile identity:
                                    gsm_a.len: 'Length: 13'
                                    nas_5gs.spare_b7: '0... .... = Spare: 0'
                                    nas_5gs.mm.suci.supi_fmt: '.000 .... = SUPI format: IMSI (0)'
                                    nas_5gs.spare_b3: '.... 0... = Spare: 0'
                                    nas_5gs.mm.type_id: '.... .001 = Type of identity: SUCI (1)'
                                    e212.mcc: 'Mobile Country Code (MCC): International Mobile, shared code (901)'
                                    e212.mnc: 'Mobile Network Code (MNC): Unknown (70)'
                                    nas_5gs.mm.suci.routing_indicator: 'Routing indicator: 0000'
                                    nas_5gs.mm.suci.scheme_id: '.... 0000 = Protection scheme Id: NULL scheme (0)'
                                    nas_5gs.mm.suci.pki: 'Home network public key identifier: 0'
                                    nas_5gs.mm.suci.supi_null_scheme: 'Scheme output: 0000000002'
                                UE security capability:
                                    nas_5gs.mm.elem_id: 'Element ID: 0x2e'
                                    gsm_a.len: 'Length: 4'
                                    nas_5gs.mm.5g_ea0: '1... .... = 5G-EA0: Supported'
                                    nas_5gs.mm.128_5g_ea1: '.1.. .... = 128-5G-EA1: Supported'
                                    nas_5gs.mm.128_5g_ea2: '..1. .... = 128-5G-EA2: Supported'
                                    nas_5gs.mm.128_5g_ea3: '...1 .... = 128-5G-EA3: Supported'
                                    nas_5gs.mm.5g_ea4: '.... 0... = 5G-EA4: Not supported'
                                    nas_5gs.mm.5g_ea5: '.... .0.. = 5G-EA5: Not supported'
                                    nas_5gs.mm.5g_ea6: '.... ..0. = 5G-EA6: Not supported'
                                    nas_5gs.mm.5g_ea7: '.... ...0 = 5G-EA7: Not supported'
                                    nas_5gs.mm.ia0: '1... .... = 5G-IA0: Supported'
                                    nas_5gs.mm.5g_128_ia1: '.1.. .... = 128-5G-IA1: Supported'
                                    nas_5gs.mm.5g_128_ia2: '..1. .... = 128-5G-IA2: Supported'
                                    nas_5gs.mm.5g_128_ia4: '.... 0... = 5G-IA4: Not supported'
                                    nas_5gs.mm.5g_ia5: '.... .0.. = 5G-IA5: Not supported'
                                    nas_5gs.mm.5g_ia6: '.... ..0. = 5G-IA6: Not supported'
                                    nas_5gs.mm.5g_ia7: '.... ...0 = 5G-IA7: Not supported'
                                    nas_5gs.mm.eea0: '1... .... = EEA0: Supported'
                                    nas_5gs.mm.128eea1: '.1.. .... = 128-EEA1: Supported'
                                    nas_5gs.mm.128eea2: '..1. .... = 128-EEA2: Supported'
                                    nas_5gs.mm.eea3: '...1 .... = 128-EEA3: Supported'
                                    nas_5gs.mm.eea4: '.... 0... = EEA4: Not supported'
                                    nas_5gs.mm.eea5: '.... .0.. = EEA5: Not supported'
                                    nas_5gs.mm.eea6: '.... ..0. = EEA6: Not supported'
                                    nas_5gs.mm.eea7: '.... ...0 = EEA7: Not supported'
                                    nas_5gs.mm.eia0: '1... .... = EIA0: Supported'
                                    nas_5gs.mm.128eia1: '.1.. .... = 128-EIA1: Supported'
                                    nas_5gs.mm.128eia2: '..1. .... = 128-EIA2: Supported'
                                    nas_5gs.mm.eia3: '...1 .... = 128-EIA3: Supported'
                                    nas_5gs.mm.eia4: '.... 0... = EIA4: Not supported'
                                    nas_5gs.mm.eia5: '.... .0.. = EIA5: Not supported'
                                    nas_5gs.mm.eia6: '.... ..0. = EIA6: Not supported'
                                    nas_5gs.mm.eia7: '.... ...0 = EIA7: Not supported'
            'Item 2: id-UserLocationInformation':
                ngap.id: 'id: id-UserLocationInformation (121)'
                per.enum_index: 'Enumerated Index: 0'
                ngap.criticality: 'criticality: reject (0)'
                per.open_type_length: 'Open Type Length: 19'
                ngap.value_element:
                    per.choice_index: 'Choice Index: 1'
                    ngap.UserLocationInformation:
                        ngap.userLocationInformationNR_element:
                            per.extension_bit: '..0. .... Extension Bit: False'
                            per.optional_field_bit: '.... 0... Optional Field Bit: False (iE-Extensions is NOT present)'
                            ngap.nR_CGI_element:
                                per.extension_bit: '.... .0.. Extension Bit: False'
                                per.optional_field_bit: '.... ..0. Optional Field Bit: False (iE-Extensions is NOT present)'
                                ngap.pLMNIdentity:
                                    e212.mcc: 'Mobile Country Code (MCC): International Mobile, shared code (901)'
                                    e212.mnc: 'Mobile Network Code (MNC): Unknown (70)'
                                ngap.NRCellIdentity: 'nRCellIdentity: 0x0000000010'
                            ngap.tAI_element:
                                per.extension_bit: '.... 0... Extension Bit: False'
                                per.optional_field_bit: '.... .0.. Optional Field Bit: False (iE-Extensions is NOT present)'
                                ngap.pLMNIdentity:
                                    e212.mcc: 'Mobile Country Code (MCC): International Mobile, shared code (901)'
                                    e212.mnc: 'Mobile Network Code (MNC): Unknown (70)'
                                ngap.tAC: 'tAC: 1 (0x000001)'
                            ngap.timeStamp: 'timeStamp: e74c1dab (Dec 20, 2022 11:40:27 UTC)'
            'Item 3: id-RRCEstablishmentCause':
                ngap.id: 'id: id-RRCEstablishmentCause (90)'
                per.enum_index: 'Enumerated Index: 1'
                ngap.criticality: 'criticality: ignore (1)'
                per.open_type_length: 'Open Type Length: 1'
                ngap.value_element:
                    per.extension_present_bit: '0... .... Extension Present Bit: False'
                    per.enum_index: 'Enumerated Index: 4'
                    ngap.RRCEstablishmentCause: 'RRCEstablishmentCause: mo-Data (4)'
            'Item 4: id-UEContextRequest':
                ngap.id: 'id: id-UEContextRequest (112)'
                per.enum_index: 'Enumerated Index: 1'
                ngap.criticality: 'criticality: ignore (1)'
                per.open_type_length: 'Open Type Length: 1'
                ngap.value_element:
                    per.extension_present_bit: '0... .... Extension Present Bit: False'
                    per.enum_index: 'Enumerated Index: 0'
                    ngap.UEContextRequest: 'UEContextRequest: requested (0)'

end note

"10.0.3.1" -> "10.0.2.15": 1500, NGAP UEContextRelease (41)

note right #c6ebc6
**10.0.3.1 to 10.0.2.15**
NGAP-PDU: 002900100000020072000400050005000f400140
ngap.procedureCode: 'procedureCode: id-UEContextRelease (41)'
per.enum_index: 'Enumerated Index: 0'
ngap.criticality: 'criticality: reject (0)'
per.open_type_length: 'Open Type Length: 16'
ngap.value_element:
-   ngap.UEContextReleaseCommand_element:
        per.extension_bit: '0... .... Extension Bit: False'
        per.sequence_of_length: 'Sequence-Of Length: 2'
        ngap.protocolIEs:
            'Item 0: id-UE-NGAP-IDs':
                ngap.id: 'id: id-UE-NGAP-IDs (114)'
                per.enum_index: 'Enumerated Index: 0'
                ngap.criticality: 'criticality: reject (0)'
                per.open_type_length: 'Open Type Length: 4'
                ngap.value_element:
                    per.choice_index: 'Choice Index: 0'
                    ngap.UE_NGAP_IDs:
                        ngap.uE_NGAP_ID_pair_element:
                            per.extension_bit: '..0. .... Extension Bit: False'
                            per.optional_field_bit: '...0 .... Optional Field Bit: False (iE-Extensions is NOT present)'
                            ngap.aMF_UE_NGAP_ID: 'aMF-UE-NGAP-ID: 5'
                            ngap.rAN_UE_NGAP_ID: 'rAN-UE-NGAP-ID: 5'
            'Item 1: id-Cause':
                ngap.id: 'id: id-Cause (15)'
                per.enum_index: 'Enumerated Index: 1'
                ngap.criticality: 'criticality: ignore (1)'
                per.open_type_length: 'Open Type Length: 1'
                ngap.value_element:
                    per.choice_index: 'Choice Index: 2'
                    ngap.Cause:
                        per.extension_present_bit: '...0 .... Extension Present Bit: False'
                        per.enum_index: 'Enumerated Index: 0'
                        ngap.nas: 'nas: normal-release (0)'

end note

"10.0.14.1" -> "10.0.17.1": 1512, PFCP req.\nPFCP Session Deletion Request (54)

note right #80b3ff
**10.0.14.1 to 10.0.17.1**
pfcp.flags:
-   pfcp.version: '001. .... = Version: 1'
    pfcp.spare_b4: '...0 .... = Spare: 0'
    pfcp.spare_b3: '.... 0... = Spare: 0'
    pfcp.spare_b2: '.... .0.. = Spare: 0'
    pfcp.mp_flag: '.... ..0. = Message Priority (MP): False'
    pfcp.s: '.... ...1 = SEID (S): True'
pfcp.msg_type: 'Message Type: PFCP Session Deletion Request (54)'
pfcp.length: 'Length: 12'
pfcp.seid: 'SEID: 0x0000000000000005'
pfcp.seqno: 'Sequence Number: 219'
pfcp.spare_oct: 'Spare: 0'
pfcp.response_in: 'Response In: 1513'

end note

"10.0.17.1" -> "10.0.14.1": 1513, PFCP rsp.\nPFCP Session Deletion Response (55)

note right #cce0ff
**10.0.17.1 to 10.0.14.1**
pfcp.flags:
-   pfcp.version: '001. .... = Version: 1'
    pfcp.spare_b4: '...0 .... = Spare: 0'
    pfcp.spare_b3: '.... 0... = Spare: 0'
    pfcp.spare_b2: '.... .0.. = Spare: 0'
    pfcp.mp_flag: '.... ..0. = Message Priority (MP): False'
    pfcp.s: '.... ...1 = SEID (S): True'
pfcp.msg_type: 'Message Type: PFCP Session Deletion Response (55)'
pfcp.length: 'Length: 129'
pfcp.seid: 'SEID: 0x0000000000000005'
pfcp.seqno: 'Sequence Number: 219'
pfcp.spare_oct: 'Spare: 0'
'Cause : Request accepted(success)':
-   pfcp.ie_type: 'IE Type: Cause (19)'
    pfcp.ie_len: 'IE Length: 1'
    pfcp.cause: 'Cause: Request accepted(success) (1)'
'Usage Report (Session Deletion Response) : [Grouped IE]':
-   pfcp.ie_type: 'IE Type: Usage Report (Session Deletion Response) (79)'
    pfcp.ie_len: 'IE Length: 108'
    'URR ID : Dynamic by CP 1':
        pfcp.ie_type: 'IE Type: URR ID (81)'
        pfcp.ie_len: 'IE Length: 4'
        pfcp.urr_id_flg: '0... .... .... .... .... .... .... .... = Allocation type: Dynamic by CP'
        pfcp.urr_id: '.000 0000 0000 0000 0000 0000 0000 0001 = URR ID: 1'
    'UR-SEQN : 0':
        pfcp.ie_type: 'IE Type: UR-SEQN (104)'
        pfcp.ie_len: 'IE Length: 4'
        pfcp.ur_seqn: 'UR-SEQN: 0'
    'Usage Report Trigger : ':
        pfcp.ie_type: 'IE Type: Usage Report Trigger (63)'
        pfcp.ie_len: 'IE Length: 3'
        pfcp.usage_report_trigger.immer: '0... .... = IMMER (Immediate Report): False'
        pfcp.usage_report_trigger_flags.droth: '.0.. .... = DROTH (Dropped DL Traffic Threshold): False'
        pfcp.usage_report_trigger_flags.stopt: '..0. .... = STOPT (Stop of Traffic): False'
        pfcp.usage_report_trigger_flags.start: '...0 .... = START (Start of Traffic): False'
        pfcp.usage_report_trigger_flags.quhti: '.... 0... = QUHTI (Quota Holding Time): False'
        pfcp.usage_report_trigger_flags.timth: '.... .0.. = TIMTH (Time Threshold): False'
        pfcp.usage_report_trigger_flags.volth: '.... ..0. = VOLTH (Volume Threshold): False'
        pfcp.usage_report_trigger_flags.perio: '.... ...0 = PERIO (Periodic Reporting): False'
        pfcp.usage_report_trigger_flags.eveth: '0... .... = EVETH (Event Threshold): False'
        pfcp.usage_report_trigger_flags.macar: '.0.. .... = MACAR (MAC Addresses Reporting): False'
        pfcp.usage_report_trigger_flags.envcl: '..0. .... = ENVCL (Envelope Closure): False'
        pfcp.usage_report_trigger.monit: '...0 .... = MONIT (Monitoring Time): False'
        pfcp.usage_report_trigger.term: '.... 1... = TERMR (Termination Report): True'
        pfcp.usage_report_trigger_flags.liusa: '.... .0.. = LIUSA (Linked Usage Reporting): False'
        pfcp.usage_report_trigger_flags.timqu: '.... ..0. = TIMQU (Time Quota): False'
        pfcp.usage_report_trigger_flags.volqu: '.... ...0 = VOLQU (Volume Quota): False'
        pfcp.spare_b7_b2: '0000 00.. = Spare: 0'
        pfcp.usage_report_trigger_flags.tebur: '.... ..0. = TEMUR (Termination By UP function Report): False'
        pfcp.usage_report_trigger_flags.evequ: '.... ...0 = EVEQU (Event Quota): False'
    'End Time : Dec 29, 2022 16:06:33.000000000 UTC':
        pfcp.ie_type: 'IE Type: End Time (76)'
        pfcp.ie_len: 'IE Length: 4'
        pfcp.start_time: 'End Time: Dec 29, 2022 16:06:33.000000000 UTC'
    'Volume Measurement : ':
        pfcp.ie_type: 'IE Type: Volume Measurement (66)'
        pfcp.ie_len: 'IE Length: 49'
        pfcp.volume_measurement:
            pfcp.spare_b7_b3: '0011 1... = Spare: 7'
            pfcp.volume_measurement_flags.dlvol: '.... .1.. = DLVOL: True'
            pfcp.volume_measurement_flags.ulvol: '.... ..1. = ULVOL: True'
            pfcp.volume_measurement_flags.tovol: '.... ...1 = TOVOL: True'
        pfcp.volume_measurement.tovol: 'Total Volume: 0'
        pfcp.volume_measurement.ulvol: 'Uplink Volume: 0'
        pfcp.volume_measurement.dlvol: 'Downlink Volume: 0'
        IE data not decoded by WS yet:
            _ws.expert:
                pfcp.ie_data_not_decoded: IE data not decoded by WS yet
                _ws.expert.message: 'Message: IE data not decoded by WS yet'
                _ws.expert.severity: 'Severity level: Note'
                _ws.expert.group: 'Group: Undecoded'
    'Duration Measurement : 1672329993 s':
        pfcp.ie_type: 'IE Type: Duration Measurement (67)'
        pfcp.ie_len: 'IE Length: 4'
        pfcp.duration_measurement: 'Duration: 1672329993'
    'Time of First Packet : NULL':
        pfcp.ie_type: 'IE Type: Time of First Packet (69)'
        pfcp.ie_len: 'IE Length: 4'
        pfcp.time_of_first_packet: 'Time of First Packet: NULL'
    'Time of Last Packet : NULL':
        pfcp.ie_type: 'IE Type: Time of Last Packet (70)'
        pfcp.ie_len: 'IE Length: 4'
        pfcp.time_of_last_packet: 'Time of Last Packet: NULL'
pfcp.response_to: 'Response To: 1512'
pfcp.response_time: 'Response Time: 0.000096935 seconds'

end note

"10.0.2.15" -> "10.0.3.1": 1514, NGAP UEContextRelease (41)

note right #c6ebc6
**10.0.2.15 to 10.0.3.1**
NGAP-PDU: 20290026000003000a40020005005540020005007940135009f107000000010009f107000001e74c1dab
ngap.procedureCode: 'procedureCode: id-UEContextRelease (41)'
per.enum_index: 'Enumerated Index: 0'
ngap.criticality: 'criticality: reject (0)'
per.open_type_length: 'Open Type Length: 38'
ngap.value_element:
-   ngap.UEContextReleaseComplete_element:
        per.extension_bit: '0... .... Extension Bit: False'
        per.sequence_of_length: 'Sequence-Of Length: 3'
        ngap.protocolIEs:
            'Item 0: id-AMF-UE-NGAP-ID':
                ngap.id: 'id: id-AMF-UE-NGAP-ID (10)'
                per.enum_index: 'Enumerated Index: 1'
                ngap.criticality: 'criticality: ignore (1)'
                per.open_type_length: 'Open Type Length: 2'
                ngap.value_element:
                    ngap.AMF_UE_NGAP_ID: 'AMF-UE-NGAP-ID: 5'
            'Item 1: id-RAN-UE-NGAP-ID':
                ngap.id: 'id: id-RAN-UE-NGAP-ID (85)'
                per.enum_index: 'Enumerated Index: 1'
                ngap.criticality: 'criticality: ignore (1)'
                per.open_type_length: 'Open Type Length: 2'
                ngap.value_element:
                    ngap.RAN_UE_NGAP_ID: 'RAN-UE-NGAP-ID: 5'
            'Item 2: id-UserLocationInformation':
                ngap.id: 'id: id-UserLocationInformation (121)'
                per.enum_index: 'Enumerated Index: 1'
                ngap.criticality: 'criticality: ignore (1)'
                per.open_type_length: 'Open Type Length: 19'
                ngap.value_element:
                    per.choice_index: 'Choice Index: 1'
                    ngap.UserLocationInformation:
                        ngap.userLocationInformationNR_element:
                            per.extension_bit: '..0. .... Extension Bit: False'
                            per.optional_field_bit: '.... 0... Optional Field Bit: False (iE-Extensions is NOT present)'
                            ngap.nR_CGI_element:
                                per.extension_bit: '.... .0.. Extension Bit: False'
                                per.optional_field_bit: '.... ..0. Optional Field Bit: False (iE-Extensions is NOT present)'
                                ngap.pLMNIdentity:
                                    e212.mcc: 'Mobile Country Code (MCC): International Mobile, shared code (901)'
                                    e212.mnc: 'Mobile Network Code (MNC): Unknown (70)'
                                ngap.NRCellIdentity: 'nRCellIdentity: 0x0000000010'
                            ngap.tAI_element:
                                per.extension_bit: '.... 0... Extension Bit: False'
                                per.optional_field_bit: '.... .0.. Optional Field Bit: False (iE-Extensions is NOT present)'
                                ngap.pLMNIdentity:
                                    e212.mcc: 'Mobile Country Code (MCC): International Mobile, shared code (901)'
                                    e212.mnc: 'Mobile Network Code (MNC): Unknown (70)'
                                ngap.tAC: 'tAC: 1 (0x000001)'
                            ngap.timeStamp: 'timeStamp: e74c1dab (Dec 20, 2022 11:40:27 UTC)'

end note

"10.0.3.1" -> "10.0.2.15": 1538, NGAP DownlinkNASTransport (4),\nNAS Authentication request (0x56)

note right #8cd98c
**10.0.3.1 to 10.0.2.15**
NGAP-PDU: 0004403e000003000a0002000e00550002000e0026002b2a7e005602020000217936e3cad481fd27b142fd02dcd1ad2a2010feae4a001b9b800038714de9735252c9
ngap.procedureCode: 'procedureCode: id-DownlinkNASTransport (4)'
per.enum_index: 'Enumerated Index: 1'
ngap.criticality: 'criticality: ignore (1)'
per.open_type_length: 'Open Type Length: 62'
ngap.value_element:
-   ngap.DownlinkNASTransport_element:
        per.extension_bit: '0... .... Extension Bit: False'
        per.sequence_of_length: 'Sequence-Of Length: 3'
        ngap.protocolIEs:
            'Item 0: id-AMF-UE-NGAP-ID':
                ngap.id: 'id: id-AMF-UE-NGAP-ID (10)'
                per.enum_index: 'Enumerated Index: 0'
                ngap.criticality: 'criticality: reject (0)'
                per.open_type_length: 'Open Type Length: 2'
                ngap.value_element:
                    ngap.AMF_UE_NGAP_ID: 'AMF-UE-NGAP-ID: 14'
            'Item 1: id-RAN-UE-NGAP-ID':
                ngap.id: 'id: id-RAN-UE-NGAP-ID (85)'
                per.enum_index: 'Enumerated Index: 0'
                ngap.criticality: 'criticality: reject (0)'
                per.open_type_length: 'Open Type Length: 2'
                ngap.value_element:
                    ngap.RAN_UE_NGAP_ID: 'RAN-UE-NGAP-ID: 14'
            'Item 2: id-NAS-PDU':
                ngap.id: 'id: id-NAS-PDU (38)'
                per.enum_index: 'Enumerated Index: 0'
                ngap.criticality: 'criticality: reject (0)'
                per.open_type_length: 'Open Type Length: 43'
                ngap.value_element:
                    per.octet_string_length: 'Octet String Length: 42'
                    ngap.NAS_PDU:
                        nas-5gs:
                            Plain NAS 5GS Message:
                                nas_5gs.epd: 'Extended protocol discriminator: 5G mobility management messages (126)'
                                nas_5gs.spare_half_octet: '0000 .... = Spare Half Octet: 0'
                                nas_5gs.security_header_type: '.... 0000 = Security header type: Plain NAS message, not security protected (0)'
                                nas_5gs.mm.message_type: 'Message type: Authentication request (0x56)'
                                NAS key set identifier - ngKSI:
                                    nas_5gs.mm.tsc: '.... 0... = Type of security context flag (TSC): Native security context (for KSIAMF)'
                                    nas_5gs.mm.nas_key_set_id: '.... .010 = NAS key set identifier: 2'
                                ABBA:
                                    gsm_a.len: 'Length: 2'
                                    nas_5gs.mm.abba_contents: 'ABBA Contents: 0x0000'
                                Authentication Parameter RAND - 5G authentication challenge:
                                    gsm_a.dtap.elem_id: 'Element ID: 0x21'
                                    gsm_a.dtap.rand: 'RAND value: 7936e3cad481fd27b142fd02dcd1ad2a'
                                Authentication Parameter AUTN (UMTS and EPS authentication challenge) - 5G authentication challenge:
                                    gsm_a.dtap.elem_id: 'Element ID: 0x20'
                                    gsm_a.len: 'Length: 16'
                                    gsm_a.dtap.autn:
                                        gsm_a.dtap.autn.sqn_xor_ak: 'SQN xor AK: feae4a001b9b'
                                        gsm_a.dtap.autn.amf: 'AMF: 8000'
                                        gsm_a.dtap.autn.mac: 'MAC: 38714de9735252c9'

end note

"10.0.2.15" -> "10.0.3.1": 1539, NGAP UplinkNASTransport (46),\nNAS Authentication response (0x57)

note right #c6ebc6
**10.0.2.15 to 10.0.3.1**
NGAP-PDU: 002e4040000004000a0002000e00550002000e00260016157e00572d107d93e678162bf8794845bb649a7864b0007940135009f107000000010009f107000001e74c1dac
ngap.procedureCode: 'procedureCode: id-UplinkNASTransport (46)'
per.enum_index: 'Enumerated Index: 1'
ngap.criticality: 'criticality: ignore (1)'
per.open_type_length: 'Open Type Length: 64'
ngap.value_element:
-   ngap.UplinkNASTransport_element:
        per.extension_bit: '0... .... Extension Bit: False'
        per.sequence_of_length: 'Sequence-Of Length: 4'
        ngap.protocolIEs:
            'Item 0: id-AMF-UE-NGAP-ID':
                ngap.id: 'id: id-AMF-UE-NGAP-ID (10)'
                per.enum_index: 'Enumerated Index: 0'
                ngap.criticality: 'criticality: reject (0)'
                per.open_type_length: 'Open Type Length: 2'
                ngap.value_element:
                    ngap.AMF_UE_NGAP_ID: 'AMF-UE-NGAP-ID: 14'
            'Item 1: id-RAN-UE-NGAP-ID':
                ngap.id: 'id: id-RAN-UE-NGAP-ID (85)'
                per.enum_index: 'Enumerated Index: 0'
                ngap.criticality: 'criticality: reject (0)'
                per.open_type_length: 'Open Type Length: 2'
                ngap.value_element:
                    ngap.RAN_UE_NGAP_ID: 'RAN-UE-NGAP-ID: 14'
            'Item 2: id-NAS-PDU':
                ngap.id: 'id: id-NAS-PDU (38)'
                per.enum_index: 'Enumerated Index: 0'
                ngap.criticality: 'criticality: reject (0)'
                per.open_type_length: 'Open Type Length: 22'
                ngap.value_element:
                    per.octet_string_length: 'Octet String Length: 21'
                    ngap.NAS_PDU:
                        nas-5gs:
                            Plain NAS 5GS Message:
                                nas_5gs.epd: 'Extended protocol discriminator: 5G mobility management messages (126)'
                                nas_5gs.spare_half_octet: '0000 .... = Spare Half Octet: 0'
                                nas_5gs.security_header_type: '.... 0000 = Security header type: Plain NAS message, not security protected (0)'
                                nas_5gs.mm.message_type: 'Message type: Authentication response (0x57)'
                                Authentication response parameter:
                                    nas_eps.emm.elem_id: 'Element ID: 0x2d'
                                    gsm_a.len: 'Length: 16'
                                    nas_eps.emm.res: 'RES: 7d93e678162bf8794845bb649a7864b0'
            'Item 3: id-UserLocationInformation':
                ngap.id: 'id: id-UserLocationInformation (121)'
                per.enum_index: 'Enumerated Index: 1'
                ngap.criticality: 'criticality: ignore (1)'
                per.open_type_length: 'Open Type Length: 19'
                ngap.value_element:
                    per.choice_index: 'Choice Index: 1'
                    ngap.UserLocationInformation:
                        ngap.userLocationInformationNR_element:
                            per.extension_bit: '..0. .... Extension Bit: False'
                            per.optional_field_bit: '.... 0... Optional Field Bit: False (iE-Extensions is NOT present)'
                            ngap.nR_CGI_element:
                                per.extension_bit: '.... .0.. Extension Bit: False'
                                per.optional_field_bit: '.... ..0. Optional Field Bit: False (iE-Extensions is NOT present)'
                                ngap.pLMNIdentity:
                                    e212.mcc: 'Mobile Country Code (MCC): International Mobile, shared code (901)'
                                    e212.mnc: 'Mobile Network Code (MNC): Unknown (70)'
                                ngap.NRCellIdentity: 'nRCellIdentity: 0x0000000010'
                            ngap.tAI_element:
                                per.extension_bit: '.... 0... Extension Bit: False'
                                per.optional_field_bit: '.... .0.. Optional Field Bit: False (iE-Extensions is NOT present)'
                                ngap.pLMNIdentity:
                                    e212.mcc: 'Mobile Country Code (MCC): International Mobile, shared code (901)'
                                    e212.mnc: 'Mobile Network Code (MNC): Unknown (70)'
                                ngap.tAC: 'tAC: 1 (0x000001)'
                            ngap.timeStamp: 'timeStamp: e74c1dac (Dec 20, 2022 11:40:28 UTC)'

end note

"10.0.3.1" -> "10.0.2.15": 1562, NGAP DownlinkNASTransport (4),\nNAS Security mode command (0x5d)

note right #c6ebc6
**10.0.3.1 to 10.0.2.15**
NGAP-PDU: 00044029000003000a0002000e00550002000e00260016157e038923b79a007e005d020204f0f0f0f0e1360102
ngap.procedureCode: 'procedureCode: id-DownlinkNASTransport (4)'
per.enum_index: 'Enumerated Index: 1'
ngap.criticality: 'criticality: ignore (1)'
per.open_type_length: 'Open Type Length: 41'
ngap.value_element:
-   ngap.DownlinkNASTransport_element:
        per.extension_bit: '0... .... Extension Bit: False'
        per.sequence_of_length: 'Sequence-Of Length: 3'
        ngap.protocolIEs:
            'Item 0: id-AMF-UE-NGAP-ID':
                ngap.id: 'id: id-AMF-UE-NGAP-ID (10)'
                per.enum_index: 'Enumerated Index: 0'
                ngap.criticality: 'criticality: reject (0)'
                per.open_type_length: 'Open Type Length: 2'
                ngap.value_element:
                    ngap.AMF_UE_NGAP_ID: 'AMF-UE-NGAP-ID: 14'
            'Item 1: id-RAN-UE-NGAP-ID':
                ngap.id: 'id: id-RAN-UE-NGAP-ID (85)'
                per.enum_index: 'Enumerated Index: 0'
                ngap.criticality: 'criticality: reject (0)'
                per.open_type_length: 'Open Type Length: 2'
                ngap.value_element:
                    ngap.RAN_UE_NGAP_ID: 'RAN-UE-NGAP-ID: 14'
            'Item 2: id-NAS-PDU':
                ngap.id: 'id: id-NAS-PDU (38)'
                per.enum_index: 'Enumerated Index: 0'
                ngap.criticality: 'criticality: reject (0)'
                per.open_type_length: 'Open Type Length: 22'
                ngap.value_element:
                    per.octet_string_length: 'Octet String Length: 21'
                    ngap.NAS_PDU:
                        nas-5gs:
                            Security protected NAS 5GS message:
                                nas_5gs.epd: 'Extended protocol discriminator: 5G mobility management messages (126)'
                                nas_5gs.spare_half_octet: '0000 .... = Spare Half Octet: 0'
                                nas_5gs.security_header_type: '.... 0011 = Security header type: Integrity protected with new 5GS security context (3)'
                                nas_5gs.msg_auth_code: 'Message authentication code: 0x8923b79a'
                                nas_5gs.seq_no: 'Sequence number: 0'
                            Plain NAS 5GS Message:
                                nas_5gs.epd: 'Extended protocol discriminator: 5G mobility management messages (126)'
                                nas_5gs.spare_half_octet: '0000 .... = Spare Half Octet: 0'
                                nas_5gs.security_header_type: '.... 0000 = Security header type: Plain NAS message, not security protected (0)'
                                nas_5gs.mm.message_type: 'Message type: Security mode command (0x5d)'
                                NAS security algorithms:
                                    nas_5gs.mm.nas_sec_algo_enc: '0000 .... = Type of ciphering algorithm: 5G-EA0 (null ciphering algorithm) (0)'
                                    nas_5gs.mm.nas_sec_algo_ip: '.... 0010 = Type of integrity protection algorithm: 128-5G-IA2 (2)'
                                NAS key set identifier - ngKSI:
                                    nas_5gs.mm.tsc: '.... 0... = Type of security context flag (TSC): Native security context (for KSIAMF)'
                                    nas_5gs.mm.nas_key_set_id: '.... .010 = NAS key set identifier: 2'
                                UE security capability - Replayed UE security capabilities:
                                    gsm_a.len: 'Length: 4'
                                    nas_5gs.mm.5g_ea0: '1... .... = 5G-EA0: Supported'
                                    nas_5gs.mm.128_5g_ea1: '.1.. .... = 128-5G-EA1: Supported'
                                    nas_5gs.mm.128_5g_ea2: '..1. .... = 128-5G-EA2: Supported'
                                    nas_5gs.mm.128_5g_ea3: '...1 .... = 128-5G-EA3: Supported'
                                    nas_5gs.mm.5g_ea4: '.... 0... = 5G-EA4: Not supported'
                                    nas_5gs.mm.5g_ea5: '.... .0.. = 5G-EA5: Not supported'
                                    nas_5gs.mm.5g_ea6: '.... ..0. = 5G-EA6: Not supported'
                                    nas_5gs.mm.5g_ea7: '.... ...0 = 5G-EA7: Not supported'
                                    nas_5gs.mm.ia0: '1... .... = 5G-IA0: Supported'
                                    nas_5gs.mm.5g_128_ia1: '.1.. .... = 128-5G-IA1: Supported'
                                    nas_5gs.mm.5g_128_ia2: '..1. .... = 128-5G-IA2: Supported'
                                    nas_5gs.mm.5g_128_ia4: '.... 0... = 5G-IA4: Not supported'
                                    nas_5gs.mm.5g_ia5: '.... .0.. = 5G-IA5: Not supported'
                                    nas_5gs.mm.5g_ia6: '.... ..0. = 5G-IA6: Not supported'
                                    nas_5gs.mm.5g_ia7: '.... ...0 = 5G-IA7: Not supported'
                                    nas_5gs.mm.eea0: '1... .... = EEA0: Supported'
                                    nas_5gs.mm.128eea1: '.1.. .... = 128-EEA1: Supported'
                                    nas_5gs.mm.128eea2: '..1. .... = 128-EEA2: Supported'
                                    nas_5gs.mm.eea3: '...1 .... = 128-EEA3: Supported'
                                    nas_5gs.mm.eea4: '.... 0... = EEA4: Not supported'
                                    nas_5gs.mm.eea5: '.... .0.. = EEA5: Not supported'
                                    nas_5gs.mm.eea6: '.... ..0. = EEA6: Not supported'
                                    nas_5gs.mm.eea7: '.... ...0 = EEA7: Not supported'
                                    nas_5gs.mm.eia0: '1... .... = EIA0: Supported'
                                    nas_5gs.mm.128eia1: '.1.. .... = 128-EIA1: Supported'
                                    nas_5gs.mm.128eia2: '..1. .... = 128-EIA2: Supported'
                                    nas_5gs.mm.eia3: '...1 .... = 128-EIA3: Supported'
                                    nas_5gs.mm.eia4: '.... 0... = EIA4: Not supported'
                                    nas_5gs.mm.eia5: '.... .0.. = EIA5: Not supported'
                                    nas_5gs.mm.eia6: '.... ..0. = EIA6: Not supported'
                                    nas_5gs.mm.eia7: '.... ...0 = EIA7: Not supported'
                                IMEISV request:
                                    gsm_a.common.elem_id: '1110 .... = Element ID: 0xe-'
                                    nas_eps.spare_bits: '.... 0... = Spare bit(s): 0x00'
                                    nas_eps.emm.imeisv_req: '.... .001 = IMEISV request: IMEISV requested (1)'
                                Additional 5G security information:
                                    nas_5gs.mm.elem_id: 'Element ID: 0x36'
                                    gsm_a.len: 'Length: 1'
                                    nas_5gs.spare_b3: '.... 0... = Spare: 0'
                                    nas_5gs.spare_b2: '.... .0.. = Spare: 0'
                                    nas_5gs.mm.rinmr: '.... ..1. = Retransmission of initial NAS message request(RINMR): Requested'
                                    nas_5gs.mm.hdp: '.... ...0 = Horizontal derivation parameter (HDP): Not required'

end note

"10.0.2.15" -> "10.0.3.1": 1563, NGAP UplinkNASTransport (46),\nNAS Security mode complete (0x5e),\nNAS Registration request (0x41)

note right #8cd98c
**10.0.2.15 to 10.0.3.1**
NGAP-PDU: 002e4069000004000a0002000e00550002000e0026003f3e7e0432d5641d007e005e7700094573806121856151f17100257e004179000d0109f1070000000000000000201001002e04f0f0f0f02f0401010101530100007940135009f107000000010009f107000001e74c1dac
ngap.procedureCode: 'procedureCode: id-UplinkNASTransport (46)'
per.enum_index: 'Enumerated Index: 1'
ngap.criticality: 'criticality: ignore (1)'
per.open_type_length: 'Open Type Length: 105'
ngap.value_element:
-   ngap.UplinkNASTransport_element:
        per.extension_bit: '0... .... Extension Bit: False'
        per.sequence_of_length: 'Sequence-Of Length: 4'
        ngap.protocolIEs:
            'Item 0: id-AMF-UE-NGAP-ID':
                ngap.id: 'id: id-AMF-UE-NGAP-ID (10)'
                per.enum_index: 'Enumerated Index: 0'
                ngap.criticality: 'criticality: reject (0)'
                per.open_type_length: 'Open Type Length: 2'
                ngap.value_element:
                    ngap.AMF_UE_NGAP_ID: 'AMF-UE-NGAP-ID: 14'
            'Item 1: id-RAN-UE-NGAP-ID':
                ngap.id: 'id: id-RAN-UE-NGAP-ID (85)'
                per.enum_index: 'Enumerated Index: 0'
                ngap.criticality: 'criticality: reject (0)'
                per.open_type_length: 'Open Type Length: 2'
                ngap.value_element:
                    ngap.RAN_UE_NGAP_ID: 'RAN-UE-NGAP-ID: 14'
            'Item 2: id-NAS-PDU':
                ngap.id: 'id: id-NAS-PDU (38)'
                per.enum_index: 'Enumerated Index: 0'
                ngap.criticality: 'criticality: reject (0)'
                per.open_type_length: 'Open Type Length: 63'
                ngap.value_element:
                    per.octet_string_length: 'Octet String Length: 62'
                    ngap.NAS_PDU:
                        nas-5gs:
                            Security protected NAS 5GS message:
                                nas_5gs.epd: 'Extended protocol discriminator: 5G mobility management messages (126)'
                                nas_5gs.spare_half_octet: '0000 .... = Spare Half Octet: 0'
                                nas_5gs.security_header_type: '.... 0100 = Security header type: Integrity protected and ciphered with new 5GS security context (4)'
                                nas_5gs.msg_auth_code: 'Message authentication code: 0x32d5641d'
                                nas_5gs.seq_no: 'Sequence number: 0'
                            Plain NAS 5GS Message:
                                nas_5gs.epd: 'Extended protocol discriminator: 5G mobility management messages (126)'
                                nas_5gs.spare_half_octet: '0000 .... = Spare Half Octet: 0'
                                nas_5gs.security_header_type: '.... 0000 = Security header type: Plain NAS message, not security protected (0)'
                                nas_5gs.mm.message_type: 'Message type: Security mode complete (0x5e)'
                                5GS mobile identity:
                                    nas_5gs.mm.elem_id: 'Element ID: 0x77'
                                    gsm_a.len: 'Length: 9'
                                    nas_5gs.mm.odd_even: '.... 0... = Odd/even indication: Even number of identity digits'
                                    nas_5gs.mm.type_id: '.... .101 = Type of identity: IMEISV (5)'
                                    nas_5gs.mm.imeisv: 'IMEISV: 4370816125816151'
                                NAS message container:
                                    nas_5gs.mm.elem_id: 'Element ID: 0x71'
                                    gsm_a.len: 'Length: 37'
                                    nas-5gs:
                                        Plain NAS 5GS Message:
                                            nas_5gs.epd: 'Extended protocol discriminator: 5G mobility management messages (126)'
                                            nas_5gs.spare_half_octet: '0000 .... = Spare Half Octet: 0'
                                            nas_5gs.security_header_type: '.... 0000 = Security header type: Plain NAS message, not security protected (0)'
                                            nas_5gs.mm.message_type: 'Message type: Registration request (0x41)'
                                            5GS registration type:
                                                nas_5gs.mm.for: '.... 1... = Follow-On Request bit (FOR): Follow-on request pending'
                                                nas_5gs.mm.5gs_reg_type: '.... .001 = 5GS registration type: initial registration (1)'
                                            NAS key set identifier:
                                                nas_5gs.mm.tsc.h1: '0... .... = Type of security context flag (TSC): Native security context (for KSIAMF)'
                                                nas_5gs.mm.nas_key_set_id.h1: '.111 .... = NAS key set identifier: 7'
                                            5GS mobile identity:
                                                gsm_a.len: 'Length: 13'
                                                nas_5gs.spare_b7: '0... .... = Spare: 0'
                                                nas_5gs.mm.suci.supi_fmt: '.000 .... = SUPI format: IMSI (0)'
                                                nas_5gs.spare_b3: '.... 0... = Spare: 0'
                                                nas_5gs.mm.type_id: '.... .001 = Type of identity: SUCI (1)'
                                                e212.mcc: 'Mobile Country Code (MCC): International Mobile, shared code (901)'
                                                e212.mnc: 'Mobile Network Code (MNC): Unknown (70)'
                                                nas_5gs.mm.suci.routing_indicator: 'Routing indicator: 0000'
                                                nas_5gs.mm.suci.scheme_id: '.... 0000 = Protection scheme Id: NULL scheme (0)'
                                                nas_5gs.mm.suci.pki: 'Home network public key identifier: 0'
                                                nas_5gs.mm.suci.supi_null_scheme: 'Scheme output: 0000000002'
                                            5GMM capability:
                                                nas_5gs.mm.elem_id: 'Element ID: 0x10'
                                                gsm_a.len: 'Length: 1'
                                                nas_5gs.spare_b7: '0... .... = Spare: 0'
                                                nas_5gs.spare_b6: '.0.. .... = Spare: 0'
                                                nas_5gs.spare_b5: '..0. .... = Spare: 0'
                                                nas_5gs.spare_b4: '...0 .... = Spare: 0'
                                                nas_5gs.spare_b3: '.... 0... = Spare: 0'
                                                nas_5gs.mm.lpp_cap_b2: '.... .0.. = LTE Positioning Protocol (LPP) capability: Not Requested'
                                                nas_5gs.mm.ho_attach_b1: '.... ..0. = HO attach: Not supported'
                                                nas_5gs.mm.s1_mode_b0: '.... ...0 = S1 mode: Not Requested'
                                            UE security capability:
                                                nas_5gs.mm.elem_id: 'Element ID: 0x2e'
                                                gsm_a.len: 'Length: 4'
                                                nas_5gs.mm.5g_ea0: '1... .... = 5G-EA0: Supported'
                                                nas_5gs.mm.128_5g_ea1: '.1.. .... = 128-5G-EA1: Supported'
                                                nas_5gs.mm.128_5g_ea2: '..1. .... = 128-5G-EA2: Supported'
                                                nas_5gs.mm.128_5g_ea3: '...1 .... = 128-5G-EA3: Supported'
                                                nas_5gs.mm.5g_ea4: '.... 0... = 5G-EA4: Not supported'
                                                nas_5gs.mm.5g_ea5: '.... .0.. = 5G-EA5: Not supported'
                                                nas_5gs.mm.5g_ea6: '.... ..0. = 5G-EA6: Not supported'
                                                nas_5gs.mm.5g_ea7: '.... ...0 = 5G-EA7: Not supported'
                                                nas_5gs.mm.ia0: '1... .... = 5G-IA0: Supported'
                                                nas_5gs.mm.5g_128_ia1: '.1.. .... = 128-5G-IA1: Supported'
                                                nas_5gs.mm.5g_128_ia2: '..1. .... = 128-5G-IA2: Supported'
                                                nas_5gs.mm.5g_128_ia4: '.... 0... = 5G-IA4: Not supported'
                                                nas_5gs.mm.5g_ia5: '.... .0.. = 5G-IA5: Not supported'
                                                nas_5gs.mm.5g_ia6: '.... ..0. = 5G-IA6: Not supported'
                                                nas_5gs.mm.5g_ia7: '.... ...0 = 5G-IA7: Not supported'
                                                nas_5gs.mm.eea0: '1... .... = EEA0: Supported'
                                                nas_5gs.mm.128eea1: '.1.. .... = 128-EEA1: Supported'
                                                nas_5gs.mm.128eea2: '..1. .... = 128-EEA2: Supported'
                                                nas_5gs.mm.eea3: '...1 .... = 128-EEA3: Supported'
                                                nas_5gs.mm.eea4: '.... 0... = EEA4: Not supported'
                                                nas_5gs.mm.eea5: '.... .0.. = EEA5: Not supported'
                                                nas_5gs.mm.eea6: '.... ..0. = EEA6: Not supported'
                                                nas_5gs.mm.eea7: '.... ...0 = EEA7: Not supported'
                                                nas_5gs.mm.eia0: '1... .... = EIA0: Supported'
                                                nas_5gs.mm.128eia1: '.1.. .... = 128-EIA1: Supported'
                                                nas_5gs.mm.128eia2: '..1. .... = 128-EIA2: Supported'
                                                nas_5gs.mm.eia3: '...1 .... = 128-EIA3: Supported'
                                                nas_5gs.mm.eia4: '.... 0... = EIA4: Not supported'
                                                nas_5gs.mm.eia5: '.... .0.. = EIA5: Not supported'
                                                nas_5gs.mm.eia6: '.... ..0. = EIA6: Not supported'
                                                nas_5gs.mm.eia7: '.... ...0 = EIA7: Not supported'
                                            NSSAI - Requested NSSAI:
                                                nas_5gs.mm.elem_id: 'Element ID: 0x2f'
                                                gsm_a.len: 'Length: 4'
                                                S-NSSAI 1:
                                                    nas_5gs.mm.length: 'Length: 1'
                                                    nas_5gs.mm.sst: 'Slice/service type (SST): 1'
                                                S-NSSAI 2:
                                                    nas_5gs.mm.length: 'Length: 1'
                                                    nas_5gs.mm.sst: 'Slice/service type (SST): 1'
                                            5GS update type:
                                                nas_5gs.mm.elem_id: 'Element ID: 0x53'
                                                gsm_a.len: 'Length: 1'
                                                nas_5gs.spare_b3: '.... 0... = Spare: 0'
                                                nas_5gs.spare_b2: '.... .0.. = Spare: 0'
                                                nas_5gs.mm.ng_ran_rcu: '.... ..0. = NG-RAN Radio Capability Update (NG-RAN-RCU): Not Needed'
                                                nas_5gs.mm.sms_requested: '.... ...0 = SMS requested: SMS over NAS not supported'
            'Item 3: id-UserLocationInformation':
                ngap.id: 'id: id-UserLocationInformation (121)'
                per.enum_index: 'Enumerated Index: 1'
                ngap.criticality: 'criticality: ignore (1)'
                per.open_type_length: 'Open Type Length: 19'
                ngap.value_element:
                    per.choice_index: 'Choice Index: 1'
                    ngap.UserLocationInformation:
                        ngap.userLocationInformationNR_element:
                            per.extension_bit: '..0. .... Extension Bit: False'
                            per.optional_field_bit: '.... 0... Optional Field Bit: False (iE-Extensions is NOT present)'
                            ngap.nR_CGI_element:
                                per.extension_bit: '.... .0.. Extension Bit: False'
                                per.optional_field_bit: '.... ..0. Optional Field Bit: False (iE-Extensions is NOT present)'
                                ngap.pLMNIdentity:
                                    e212.mcc: 'Mobile Country Code (MCC): International Mobile, shared code (901)'
                                    e212.mnc: 'Mobile Network Code (MNC): Unknown (70)'
                                ngap.NRCellIdentity: 'nRCellIdentity: 0x0000000010'
                            ngap.tAI_element:
                                per.extension_bit: '.... 0... Extension Bit: False'
                                per.optional_field_bit: '.... .0.. Optional Field Bit: False (iE-Extensions is NOT present)'
                                ngap.pLMNIdentity:
                                    e212.mcc: 'Mobile Country Code (MCC): International Mobile, shared code (901)'
                                    e212.mnc: 'Mobile Network Code (MNC): Unknown (70)'
                                ngap.tAC: 'tAC: 1 (0x000001)'
                            ngap.timeStamp: 'timeStamp: e74c1dac (Dec 20, 2022 11:40:28 UTC)'

end note

"10.0.3.1" -> "10.0.2.15": 1618, NGAP InitialContextSetup (14),\nNAS Registration accept (0x42)

note right #c6ebc6
**10.0.3.1 to 10.0.2.15**
NGAP-PDU: 000e008094000008000a0002000e00550002000e001c00070009f1070200400000000420010008007700091c000e000700038000005e00201ec668f45e64d6b6352cf64b2af85680ee78a3208b8f8686c1919dd316d55793002240084370816125ffff5100264031307e02418d716c017e0042010177000bf209f107020040d300d45054072009f107000001150401010101210201005e0129
ngap.procedureCode: 'procedureCode: id-InitialContextSetup (14)'
per.enum_index: 'Enumerated Index: 0'
ngap.criticality: 'criticality: reject (0)'
per.open_type_length: 'Open Type Length: 148'
ngap.value_element:
-   ngap.InitialContextSetupRequest_element:
        per.extension_bit: '0... .... Extension Bit: False'
        per.sequence_of_length: 'Sequence-Of Length: 8'
        ngap.protocolIEs:
            'Item 0: id-AMF-UE-NGAP-ID':
                ngap.id: 'id: id-AMF-UE-NGAP-ID (10)'
                per.enum_index: 'Enumerated Index: 0'
                ngap.criticality: 'criticality: reject (0)'
                per.open_type_length: 'Open Type Length: 2'
                ngap.value_element:
                    ngap.AMF_UE_NGAP_ID: 'AMF-UE-NGAP-ID: 14'
            'Item 1: id-RAN-UE-NGAP-ID':
                ngap.id: 'id: id-RAN-UE-NGAP-ID (85)'
                per.enum_index: 'Enumerated Index: 0'
                ngap.criticality: 'criticality: reject (0)'
                per.open_type_length: 'Open Type Length: 2'
                ngap.value_element:
                    ngap.RAN_UE_NGAP_ID: 'RAN-UE-NGAP-ID: 14'
            'Item 2: id-GUAMI':
                ngap.id: 'id: id-GUAMI (28)'
                per.enum_index: 'Enumerated Index: 0'
                ngap.criticality: 'criticality: reject (0)'
                per.open_type_length: 'Open Type Length: 7'
                ngap.value_element:
                    ngap.GUAMI_element:
                        per.extension_bit: '0... .... Extension Bit: False'
                        per.optional_field_bit: '.0.. .... Optional Field Bit: False (iE-Extensions is NOT present)'
                        ngap.pLMNIdentity:
                            e212.mcc: 'Mobile Country Code (MCC): International Mobile, shared code (901)'
                            e212.mnc: 'Mobile Network Code (MNC): Unknown (70)'
                        ngap.aMFRegionID: 'aMFRegionID: 02 [bit length 8, 0000 0010 decimal value 2]'
                        ngap.aMFSetID: 'aMFSetID: 0040 [bit length 10, 6 LSB pad bits, 0000 0000  01.. .... decimal value 1]'
                        ngap.aMFPointer: 'aMFPointer: 00 [bit length 6, 2 LSB pad bits, 0000 00.. decimal value 0]'
            'Item 3: id-AllowedNSSAI':
                ngap.id: 'id: id-AllowedNSSAI (0)'
                per.enum_index: 'Enumerated Index: 0'
                ngap.criticality: 'criticality: reject (0)'
                per.open_type_length: 'Open Type Length: 4'
                ngap.value_element:
                    per.sequence_of_length: 'Sequence-Of Length: 2'
                    ngap.AllowedNSSAI:
                        Item 0:
                            ngap.AllowedNSSAI_Item_element:
                                per.extension_bit: '...0 .... Extension Bit: False'
                                per.optional_field_bit: '.... 0... Optional Field Bit: False (iE-Extensions is NOT present)'
                                ngap.s_NSSAI_element:
                                    per.extension_bit: '.... .0.. Extension Bit: False'
                                    per.optional_field_bit: '.... ...0 Optional Field Bit: False (iE-Extensions is NOT present)'
                                    ngap.sST: 'sST: 01'
                        Item 1:
                            ngap.AllowedNSSAI_Item_element:
                                per.extension_bit: '0... .... Extension Bit: False'
                                per.optional_field_bit: '.0.. .... Optional Field Bit: False (iE-Extensions is NOT present)'
                                ngap.s_NSSAI_element:
                                    per.extension_bit: '..0. .... Extension Bit: False'
                                    per.optional_field_bit: '.... 0... Optional Field Bit: False (iE-Extensions is NOT present)'
                                    ngap.sST: 'sST: 01'
            'Item 4: id-UESecurityCapabilities':
                ngap.id: 'id: id-UESecurityCapabilities (119)'
                per.enum_index: 'Enumerated Index: 0'
                ngap.criticality: 'criticality: reject (0)'
                per.open_type_length: 'Open Type Length: 9'
                ngap.value_element:
                    ngap.UESecurityCapabilities_element:
                        per.extension_bit: '0... .... Extension Bit: False'
                        per.optional_field_bit: '.0.. .... Optional Field Bit: False (iE-Extensions is NOT present)'
                        per.extension_present_bit: '.... .0.. Extension Present Bit: False'
                        ngap.nRencryptionAlgorithms:
                            ngap.NrencyptionAlgorithms.nea1: '1... .... .... .... = 128-NEA1: Supported'
                            ngap.NrencyptionAlgorithms.nea2: '.1.. .... .... .... = 128-NEA2: Supported'
                            ngap.NrencyptionAlgorithms.nea3: '..1. .... .... .... = 128-NEA3: Supported'
                            ngap.NrencyptionAlgorithms.reserved: '...0 0000 0000 0000 = Reserved: 0x0000'
                        ngap.nRintegrityProtectionAlgorithms:
                            ngap.NrintegrityProtectionAlgorithms.nia1: '1... .... .... .... = 128-NIA1: Supported'
                            ngap.NrintegrityProtectionAlgorithms.nia2: '.1.. .... .... .... = 128-NIA2: Supported'
                            ngap.NrintegrityProtectionAlgorithms.nia3: '..1. .... .... .... = 128-NIA3: Supported'
                            ngap.NrintegrityProtectionAlgorithms.reserved: '...0 0000 0000 0000 = Reserved: 0x0000'
                        ngap.eUTRAencryptionAlgorithms:
                            ngap.EUTRAencryptionAlgorithms.eea1: '1... .... .... .... = 128-EEA1: Supported'
                            ngap.EUTRAencryptionAlgorithms.eea2: '.1.. .... .... .... = 128-EEA2: Supported'
                            ngap.EUTRAencryptionAlgorithms.eea3: '..1. .... .... .... = 128-EEA3: Supported'
                            ngap.EUTRAencryptionAlgorithms.reserved: '...0 0000 0000 0000 = Reserved: 0x0000'
                        ngap.eUTRAintegrityProtectionAlgorithms:
                            ngap.EUTRAintegrityProtectionAlgorithms.eia1: '1... .... .... .... = 128-EIA1: Supported'
                            ngap.EUTRAintegrityProtectionAlgorithms.eia2: '.1.. .... .... .... = 128-EIA2: Supported'
                            ngap.EUTRAintegrityProtectionAlgorithms.eia3: '..1. .... .... .... = 128-EIA3: Supported'
                            ngap.EUTRAintegrityProtectionAlgorithms.reserved: '...0 0000 0000 0000 = Reserved: 0x0000'
            'Item 5: id-SecurityKey':
                ngap.id: 'id: id-SecurityKey (94)'
                per.enum_index: 'Enumerated Index: 0'
                ngap.criticality: 'criticality: reject (0)'
                per.open_type_length: 'Open Type Length: 32'
                ngap.value_element:
                    ngap.SecurityKey: 'SecurityKey: 1ec668f45e64d6b6352cf64b2af85680ee78a3208b8f8686\xe2\x80\xa6 [bit length 256]'
            'Item 6: id-MaskedIMEISV':
                ngap.id: 'id: id-MaskedIMEISV (34)'
                per.enum_index: 'Enumerated Index: 1'
                ngap.criticality: 'criticality: ignore (1)'
                per.open_type_length: 'Open Type Length: 8'
                ngap.value_element:
                    ngap.MaskedIMEISV: 'MaskedIMEISV: 4370816125ffff51 [bit length 64, 0100 0011  0111 0000  1000 0001  0110 0001  0010 0101  1111 1111  1111 1111  0101 0001 decimal value 4859526252182110033]'
            'Item 7: id-NAS-PDU':
                ngap.id: 'id: id-NAS-PDU (38)'
                per.enum_index: 'Enumerated Index: 1'
                ngap.criticality: 'criticality: ignore (1)'
                per.open_type_length: 'Open Type Length: 49'
                ngap.value_element:
                    per.octet_string_length: 'Octet String Length: 48'
                    ngap.NAS_PDU:
                        nas-5gs:
                            Security protected NAS 5GS message:
                                nas_5gs.epd: 'Extended protocol discriminator: 5G mobility management messages (126)'
                                nas_5gs.spare_half_octet: '0000 .... = Spare Half Octet: 0'
                                nas_5gs.security_header_type: '.... 0010 = Security header type: Integrity protected and ciphered (2)'
                                nas_5gs.msg_auth_code: 'Message authentication code: 0x418d716c'
                                nas_5gs.seq_no: 'Sequence number: 1'
                            Plain NAS 5GS Message:
                                nas_5gs.epd: 'Extended protocol discriminator: 5G mobility management messages (126)'
                                nas_5gs.spare_half_octet: '0000 .... = Spare Half Octet: 0'
                                nas_5gs.security_header_type: '.... 0000 = Security header type: Plain NAS message, not security protected (0)'
                                nas_5gs.mm.message_type: 'Message type: Registration accept (0x42)'
                                5GS registration result:
                                    gsm_a.len: 'Length: 1'
                                    nas_5gs.mm.reg_res.nssaa_perf: '...0 .... = NSSAA Performed: False'
                                    nas_5gs.mm.reg_res.sms_all: '.... 0... = SMS over NAS: Not Allowed'
                                    nas_5gs.mm.reg_res.res: '.... .001 = 5GS registration result: 3GPP access (1)'
                                5GS mobile identity - 5G-GUTI:
                                    nas_5gs.mm.elem_id: 'Element ID: 0x77'
                                    gsm_a.len: 'Length: 11'
                                    nas_5gs.mm.odd_even: '.... 0... = Odd/even indication: Even number of identity digits'
                                    nas_5gs.mm.type_id: '.... .010 = Type of identity: 5G-GUTI (2)'
                                    e212.mcc: 'Mobile Country Code (MCC): International Mobile, shared code (901)'
                                    e212.mnc: 'Mobile Network Code (MNC): Unknown (70)'
                                    nas_5gs.amf_region_id: 'AMF Region ID: 2'
                                    nas_5gs.amf_set_id: '0000 0000 01.. .... = AMF Set ID: 1'
                                    nas_5gs.amf_pointer: '..00 0000 = AMF Pointer: 0'
                                    nas_5gs.5g_tmsi: '5G-TMSI: 0xd300d450'
                                5GS tracking area identity list:
                                    nas_5gs.mm.elem_id: 'Element ID: 0x54'
                                    gsm_a.len: 'Length: 7'
                                    Partial tracking area list  1:
                                        nas_5gs.mm.tal_t_li: '.01. .... = Type of list: list of TACs belonging to one PLMN, with consecutive TAC values (1)'
                                        nas_5gs.mm.tal_num_e: '...0 0000 = Number of elements: 1 element (0)'
                                        e212.mcc: 'Mobile Country Code (MCC): International Mobile, shared code (901)'
                                        e212.mnc: 'Mobile Network Code (MNC): Unknown (70)'
                                        nas_5gs.tac: 'TAC: 1'
                                NSSAI - Allowed NSSAI:
                                    nas_5gs.mm.elem_id: 'Element ID: 0x15'
                                    gsm_a.len: 'Length: 4'
                                    S-NSSAI 1:
                                        nas_5gs.mm.length: 'Length: 1'
                                        nas_5gs.mm.sst: 'Slice/service type (SST): 1'
                                    S-NSSAI 2:
                                        nas_5gs.mm.length: 'Length: 1'
                                        nas_5gs.mm.sst: 'Slice/service type (SST): 1'
                                5GS network feature support:
                                    nas_5gs.mm.elem_id: 'Element ID: 0x21'
                                    gsm_a.len: 'Length: 2'
                                    nas_5gs.nw_feat_sup.mpsi: '0... .... = MPS indicator (MPSI): Access identity 1 not valid in RPLMN or equivalent PLMN'
                                    nas_5gs.nw_feat_sup.iwk_n26: '.0.. .... = Interworking without N26: Not supported'
                                    nas_5gs.nw_feat_sup.emf: '..00 .... = Emergency service fallback indicator (EMF): Emergency services fallback not supported (0)'
                                    nas_5gs.nw_feat_sup.emc: '.... 00.. = Emergency service support indicator (EMC): Emergency services not supported (0)'
                                    nas_5gs.nw_feat_sup.vops_n3gpp: '.... ..0. = IMS voice over PS session over non-3GPP access indicator (IMS-VoPS-N3GPP): Not supported'
                                    nas_5gs.nw_feat_sup.vops_3gpp: '.... ...1 = IMS voice over PS session indicator (IMS VoPS): Supported'
                                    nas_5gs.spare_b7: '0... .... = Spare: 0'
                                    nas_5gs.spare_b6: '.0.. .... = Spare: 0'
                                    nas_5gs.spare_b5: '..0. .... = Spare: 0'
                                    nas_5gs.spare_b4: '...0 .... = Spare: 0'
                                    nas_5gs.spare_b3: '.... 0... = Spare: 0'
                                    nas_5gs.spare_b2: '.... .0.. = Spare: 0'
                                    nas_5gs.nw_feat_sup.mcsi: '.... ..0. = MCS indicator (MCSI): Not supported'
                                    nas_5gs.nw_feat_sup.emcn3: '.... ...0 = Emergency services over non-3GPP access (EMCN3): Not supported'
                                GPRS Timer 3 - T3512 value:
                                    gsm_a.gm.elem_id: 'Element ID: 0x5e'
                                    gsm_a.len: 'Length: 1'
                                    gsm_a.gm.gmm.gprs_timer3:
                                        gsm_a.gm.gmm.gprs_timer3_unit: '001. .... = Unit: value is incremented in multiples of 1 hour (1)'
                                        gsm_a.gm.gmm.gprs_timer3_value: '...0 1001 = Timer value: 9'

end note

"10.0.2.15" -> "10.0.3.1": 1619, NGAP InitialContextSetup (14)

note right #c6ebc6
**10.0.2.15 to 10.0.3.1**
NGAP-PDU: 200e000f000002000a4002000e00554002000e
ngap.procedureCode: 'procedureCode: id-InitialContextSetup (14)'
per.enum_index: 'Enumerated Index: 0'
ngap.criticality: 'criticality: reject (0)'
per.open_type_length: 'Open Type Length: 15'
ngap.value_element:
-   ngap.InitialContextSetupResponse_element:
        per.extension_bit: '0... .... Extension Bit: False'
        per.sequence_of_length: 'Sequence-Of Length: 2'
        ngap.protocolIEs:
            'Item 0: id-AMF-UE-NGAP-ID':
                ngap.id: 'id: id-AMF-UE-NGAP-ID (10)'
                per.enum_index: 'Enumerated Index: 1'
                ngap.criticality: 'criticality: ignore (1)'
                per.open_type_length: 'Open Type Length: 2'
                ngap.value_element:
                    ngap.AMF_UE_NGAP_ID: 'AMF-UE-NGAP-ID: 14'
            'Item 1: id-RAN-UE-NGAP-ID':
                ngap.id: 'id: id-RAN-UE-NGAP-ID (85)'
                per.enum_index: 'Enumerated Index: 1'
                ngap.criticality: 'criticality: ignore (1)'
                per.open_type_length: 'Open Type Length: 2'
                ngap.value_element:
                    ngap.RAN_UE_NGAP_ID: 'RAN-UE-NGAP-ID: 14'

end note

"10.0.2.15" -> "10.0.3.1": 1623, NGAP UplinkNASTransport (46),\nNAS Registration complete (0x43)

note right #c6ebc6
**10.0.2.15 to 10.0.3.1**
NGAP-PDU: 002e4035000004000a0002000e00550002000e0026000b0a7e02a6b104f5017e0043007940135009f107000000010009f107000001e74c1dac
ngap.procedureCode: 'procedureCode: id-UplinkNASTransport (46)'
per.enum_index: 'Enumerated Index: 1'
ngap.criticality: 'criticality: ignore (1)'
per.open_type_length: 'Open Type Length: 53'
ngap.value_element:
-   ngap.UplinkNASTransport_element:
        per.extension_bit: '0... .... Extension Bit: False'
        per.sequence_of_length: 'Sequence-Of Length: 4'
        ngap.protocolIEs:
            'Item 0: id-AMF-UE-NGAP-ID':
                ngap.id: 'id: id-AMF-UE-NGAP-ID (10)'
                per.enum_index: 'Enumerated Index: 0'
                ngap.criticality: 'criticality: reject (0)'
                per.open_type_length: 'Open Type Length: 2'
                ngap.value_element:
                    ngap.AMF_UE_NGAP_ID: 'AMF-UE-NGAP-ID: 14'
            'Item 1: id-RAN-UE-NGAP-ID':
                ngap.id: 'id: id-RAN-UE-NGAP-ID (85)'
                per.enum_index: 'Enumerated Index: 0'
                ngap.criticality: 'criticality: reject (0)'
                per.open_type_length: 'Open Type Length: 2'
                ngap.value_element:
                    ngap.RAN_UE_NGAP_ID: 'RAN-UE-NGAP-ID: 14'
            'Item 2: id-NAS-PDU':
                ngap.id: 'id: id-NAS-PDU (38)'
                per.enum_index: 'Enumerated Index: 0'
                ngap.criticality: 'criticality: reject (0)'
                per.open_type_length: 'Open Type Length: 11'
                ngap.value_element:
                    per.octet_string_length: 'Octet String Length: 10'
                    ngap.NAS_PDU:
                        nas-5gs:
                            Security protected NAS 5GS message:
                                nas_5gs.epd: 'Extended protocol discriminator: 5G mobility management messages (126)'
                                nas_5gs.spare_half_octet: '0000 .... = Spare Half Octet: 0'
                                nas_5gs.security_header_type: '.... 0010 = Security header type: Integrity protected and ciphered (2)'
                                nas_5gs.msg_auth_code: 'Message authentication code: 0xa6b104f5'
                                nas_5gs.seq_no: 'Sequence number: 1'
                            Plain NAS 5GS Message:
                                nas_5gs.epd: 'Extended protocol discriminator: 5G mobility management messages (126)'
                                nas_5gs.spare_half_octet: '0000 .... = Spare Half Octet: 0'
                                nas_5gs.security_header_type: '.... 0000 = Security header type: Plain NAS message, not security protected (0)'
                                nas_5gs.mm.message_type: 'Message type: Registration complete (0x43)'
            'Item 3: id-UserLocationInformation':
                ngap.id: 'id: id-UserLocationInformation (121)'
                per.enum_index: 'Enumerated Index: 1'
                ngap.criticality: 'criticality: ignore (1)'
                per.open_type_length: 'Open Type Length: 19'
                ngap.value_element:
                    per.choice_index: 'Choice Index: 1'
                    ngap.UserLocationInformation:
                        ngap.userLocationInformationNR_element:
                            per.extension_bit: '..0. .... Extension Bit: False'
                            per.optional_field_bit: '.... 0... Optional Field Bit: False (iE-Extensions is NOT present)'
                            ngap.nR_CGI_element:
                                per.extension_bit: '.... .0.. Extension Bit: False'
                                per.optional_field_bit: '.... ..0. Optional Field Bit: False (iE-Extensions is NOT present)'
                                ngap.pLMNIdentity:
                                    e212.mcc: 'Mobile Country Code (MCC): International Mobile, shared code (901)'
                                    e212.mnc: 'Mobile Network Code (MNC): Unknown (70)'
                                ngap.NRCellIdentity: 'nRCellIdentity: 0x0000000010'
                            ngap.tAI_element:
                                per.extension_bit: '.... 0... Extension Bit: False'
                                per.optional_field_bit: '.... .0.. Optional Field Bit: False (iE-Extensions is NOT present)'
                                ngap.pLMNIdentity:
                                    e212.mcc: 'Mobile Country Code (MCC): International Mobile, shared code (901)'
                                    e212.mnc: 'Mobile Network Code (MNC): Unknown (70)'
                                ngap.tAC: 'tAC: 1 (0x000001)'
                            ngap.timeStamp: 'timeStamp: e74c1dac (Dec 20, 2022 11:40:28 UTC)'

end note

"10.0.3.1" -> "10.0.2.15": 1624, NGAP DownlinkNASTransport (4),\nNAS Configuration update command (0x54)

note right #c6ebc6
**10.0.3.1 to 10.0.2.15**
NGAP-PDU: 0004403c000003000a0002000e00550002000e00260029287e02b853b7cb027e0054430f90004f00700065006e00350047005346404722219261603340490100
ngap.procedureCode: 'procedureCode: id-DownlinkNASTransport (4)'
per.enum_index: 'Enumerated Index: 1'
ngap.criticality: 'criticality: ignore (1)'
per.open_type_length: 'Open Type Length: 60'
ngap.value_element:
-   ngap.DownlinkNASTransport_element:
        per.extension_bit: '0... .... Extension Bit: False'
        per.sequence_of_length: 'Sequence-Of Length: 3'
        ngap.protocolIEs:
            'Item 0: id-AMF-UE-NGAP-ID':
                ngap.id: 'id: id-AMF-UE-NGAP-ID (10)'
                per.enum_index: 'Enumerated Index: 0'
                ngap.criticality: 'criticality: reject (0)'
                per.open_type_length: 'Open Type Length: 2'
                ngap.value_element:
                    ngap.AMF_UE_NGAP_ID: 'AMF-UE-NGAP-ID: 14'
            'Item 1: id-RAN-UE-NGAP-ID':
                ngap.id: 'id: id-RAN-UE-NGAP-ID (85)'
                per.enum_index: 'Enumerated Index: 0'
                ngap.criticality: 'criticality: reject (0)'
                per.open_type_length: 'Open Type Length: 2'
                ngap.value_element:
                    ngap.RAN_UE_NGAP_ID: 'RAN-UE-NGAP-ID: 14'
            'Item 2: id-NAS-PDU':
                ngap.id: 'id: id-NAS-PDU (38)'
                per.enum_index: 'Enumerated Index: 0'
                ngap.criticality: 'criticality: reject (0)'
                per.open_type_length: 'Open Type Length: 41'
                ngap.value_element:
                    per.octet_string_length: 'Octet String Length: 40'
                    ngap.NAS_PDU:
                        nas-5gs:
                            Security protected NAS 5GS message:
                                nas_5gs.epd: 'Extended protocol discriminator: 5G mobility management messages (126)'
                                nas_5gs.spare_half_octet: '0000 .... = Spare Half Octet: 0'
                                nas_5gs.security_header_type: '.... 0010 = Security header type: Integrity protected and ciphered (2)'
                                nas_5gs.msg_auth_code: 'Message authentication code: 0xb853b7cb'
                                nas_5gs.seq_no: 'Sequence number: 2'
                            Plain NAS 5GS Message:
                                nas_5gs.epd: 'Extended protocol discriminator: 5G mobility management messages (126)'
                                nas_5gs.spare_half_octet: '0000 .... = Spare Half Octet: 0'
                                nas_5gs.security_header_type: '.... 0000 = Security header type: Plain NAS message, not security protected (0)'
                                nas_5gs.mm.message_type: 'Message type: Configuration update command (0x54)'
                                Network Name - Full name for network:
                                    gsm_a.dtap.elem_id: 'Element ID: 0x43'
                                    gsm_a.len: 'Length: 15'
                                    gsm_a.extension: '1... .... = Extension: No Extension'
                                    gsm_a.dtap.coding_scheme: '.001 .... = Coding Scheme: UCS2 (16 bit) (1)'
                                    gsm_a.dtap.add_ci: '.... 0... = Add CI: The MS should not add the letters for the Country''s Initials to the text string'
                                    gsm_a.dtap.number_of_spare_bits: '.... .000 = Number of spare bits in last octet: this field carries no information about the number of spare bits in octet n (0)'
                                    gsm_a.dtap.text_string: 'Text String: Open5GS'
                                Time Zone - Local:
                                    gsm_a.dtap.elem_id: 'Element ID: 0x46'
                                    gsm_a.dtap.timezone: 'Timezone: GMT + 1 hours 0 minutes'
                                Time Zone and Time - Universal Time and Local Time Zone:
                                    gsm_a.dtap.elem_id: 'Element ID: 0x47'
                                    gsm_a.dtap.time_zone_time: 'Time: Dec 29, 2022 16:06:33.000000000'
                                    gsm_a.dtap.timezone: 'Timezone: GMT + 1 hours 0 minutes'
                                Daylight Saving Time:
                                    gsm_a.dtap.elem_id: 'Element ID: 0x49'
                                    gsm_a.len: 'Length: 1'
                                    gsm_a.spare_bits: '0000 00.. = Spare bit(s): 0'
                                    gsm_a.dtap.dst_adjustment: '.... ..00 = DST Adjustment: No adjustment for Daylight Saving Time (0)'

end note

"10.0.2.15" -> "10.0.17.1": 1633, GTP<ICMP>

note right
**10.0.2.15 to 10.0.17.1**
Type: 8 (Echo (ping) request) seq=2/512
end note

"10.0.2.15" -> "10.0.17.1": 1634, GTP<ICMP>

note right
**10.0.2.15 to 10.0.17.1**
Type: 8 (Echo (ping) request) seq=3/768
end note

"10.0.2.15" -> "10.0.17.1": 1645, GTP<ICMP>

note right
**10.0.2.15 to 10.0.17.1**
Type: 8 (Echo (ping) request) seq=4/1024
end note

"10.0.2.15" -> "10.0.17.1": 1646, GTP<ICMP>

note right
**10.0.2.15 to 10.0.17.1**
Type: 8 (Echo (ping) request) seq=5/1280
end note

"10.0.2.15" -> "10.0.3.1": 1714, NGAP InitialUEMessage (15),\nNAS Service request (0x4c)

note right #8cd98c
**10.0.2.15 to 10.0.3.1**
NGAP-PDU: 000f406600000600550002000f0026002d2c7e01c4e009e3037e004c110007f40040da00a29a7100157e004c110007f40040da00a29a4002020050020200007900135009f107000000010009f107000001e74c1db5005a400120001a0007001000da00a29a0070400100
ngap.procedureCode: 'procedureCode: id-InitialUEMessage (15)'
per.enum_index: 'Enumerated Index: 1'
ngap.criticality: 'criticality: ignore (1)'
per.open_type_length: 'Open Type Length: 102'
ngap.value_element:
-   ngap.InitialUEMessage_element:
        per.extension_bit: '0... .... Extension Bit: False'
        per.sequence_of_length: 'Sequence-Of Length: 6'
        ngap.protocolIEs:
            'Item 0: id-RAN-UE-NGAP-ID':
                ngap.id: 'id: id-RAN-UE-NGAP-ID (85)'
                per.enum_index: 'Enumerated Index: 0'
                ngap.criticality: 'criticality: reject (0)'
                per.open_type_length: 'Open Type Length: 2'
                ngap.value_element:
                    ngap.RAN_UE_NGAP_ID: 'RAN-UE-NGAP-ID: 15'
            'Item 1: id-NAS-PDU':
                ngap.id: 'id: id-NAS-PDU (38)'
                per.enum_index: 'Enumerated Index: 0'
                ngap.criticality: 'criticality: reject (0)'
                per.open_type_length: 'Open Type Length: 45'
                ngap.value_element:
                    per.octet_string_length: 'Octet String Length: 44'
                    ngap.NAS_PDU:
                        nas-5gs:
                            Security protected NAS 5GS message:
                                nas_5gs.epd: 'Extended protocol discriminator: 5G mobility management messages (126)'
                                nas_5gs.spare_half_octet: '0000 .... = Spare Half Octet: 0'
                                nas_5gs.security_header_type: '.... 0001 = Security header type: Integrity protected (1)'
                                nas_5gs.msg_auth_code: 'Message authentication code: 0xc4e009e3'
                                nas_5gs.seq_no: 'Sequence number: 3'
                            Plain NAS 5GS Message:
                                nas_5gs.epd: 'Extended protocol discriminator: 5G mobility management messages (126)'
                                nas_5gs.spare_half_octet: '0000 .... = Spare Half Octet: 0'
                                nas_5gs.security_header_type: '.... 0000 = Security header type: Plain NAS message, not security protected (0)'
                                nas_5gs.mm.message_type: 'Message type: Service request (0x4c)'
                                NAS key set identifier:
                                    nas_5gs.mm.tsc: '.... 0... = Type of security context flag (TSC): Native security context (for KSIAMF)'
                                    nas_5gs.mm.nas_key_set_id: '.... .001 = NAS key set identifier: 1'
                                Service type:
                                    nas_5gs.mm.serv_type: '.001 .... = Service type: Data (1)'
                                5GS mobile identity:
                                    gsm_a.len: 'Length: 7'
                                    nas_5gs.mm.odd_even: '.... 0... = Odd/even indication: Even number of identity digits'
                                    nas_5gs.mm.type_id: '.... .100 = Type of identity: 5G-S-TMSI (4)'
                                    nas_5gs.amf_set_id: '0000 0000 01.. .... = AMF Set ID: 1'
                                    nas_5gs.amf_pointer: '..00 0000 = AMF Pointer: 0'
                                    nas_5gs.5g_tmsi: '5G-TMSI: 0xda00a29a'
                                NAS message container:
                                    nas_5gs.mm.elem_id: 'Element ID: 0x71'
                                    gsm_a.len: 'Length: 21'
                                    nas-5gs:
                                        Plain NAS 5GS Message:
                                            nas_5gs.epd: 'Extended protocol discriminator: 5G mobility management messages (126)'
                                            nas_5gs.spare_half_octet: '0000 .... = Spare Half Octet: 0'
                                            nas_5gs.security_header_type: '.... 0000 = Security header type: Plain NAS message, not security protected (0)'
                                            nas_5gs.mm.message_type: 'Message type: Service request (0x4c)'
                                            NAS key set identifier:
                                                nas_5gs.mm.tsc: '.... 0... = Type of security context flag (TSC): Native security context (for KSIAMF)'
                                                nas_5gs.mm.nas_key_set_id: '.... .001 = NAS key set identifier: 1'
                                            Service type:
                                                nas_5gs.mm.serv_type: '.001 .... = Service type: Data (1)'
                                            5GS mobile identity:
                                                gsm_a.len: 'Length: 7'
                                                nas_5gs.mm.odd_even: '.... 0... = Odd/even indication: Even number of identity digits'
                                                nas_5gs.mm.type_id: '.... .100 = Type of identity: 5G-S-TMSI (4)'
                                                nas_5gs.amf_set_id: '0000 0000 01.. .... = AMF Set ID: 1'
                                                nas_5gs.amf_pointer: '..00 0000 = AMF Pointer: 0'
                                                nas_5gs.5g_tmsi: '5G-TMSI: 0xda00a29a'
                                            Uplink data status:
                                                nas_5gs.mm.elem_id: 'Element ID: 0x40'
                                                gsm_a.len: 'Length: 2'
                                                nas_5gs.ul_data_sts_psi_7_b7: '0... .... = PSI(7): no uplink data are pending'
                                                nas_5gs.ul_data_sts_psi_6_b6: '.0.. .... = PSI(6): no uplink data are pending'
                                                nas_5gs.ul_data_sts_psi_5_b5: '..0. .... = PSI(5): no uplink data are pending'
                                                nas_5gs.ul_data_sts_psi_4_b4: '...0 .... = PSI(4): no uplink data are pending'
                                                nas_5gs.ul_data_sts_psi_3_b3: '.... 0... = PSI(3): no uplink data are pending'
                                                nas_5gs.ul_data_sts_psi_2_b2: '.... .0.. = PSI(2): no uplink data are pending'
                                                nas_5gs.ul_data_sts_psi_1_b1: '.... ..1. = PSI(1): uplink data are pending'
                                                nas_5gs.ul_data_sts_psi_0_b0: '.... ...0 = Spare: False'
                                                nas_5gs.ul_data_sts_psi_15_b7: '0... .... = PSI(15): no uplink data are pending'
                                                nas_5gs.ul_data_sts_psi_14_b6: '.0.. .... = PSI(14): no uplink data are pending'
                                                nas_5gs.ul_data_sts_psi_13_b5: '..0. .... = PSI(13): no uplink data are pending'
                                                nas_5gs.ul_data_sts_psi_12_b4: '...0 .... = PSI(12): no uplink data are pending'
                                                nas_5gs.ul_data_sts_psi_11_b3: '.... 0... = PSI(11): no uplink data are pending'
                                                nas_5gs.ul_data_sts_psi_10_b2: '.... .0.. = PSI(10): no uplink data are pending'
                                                nas_5gs.ul_data_sts_psi_9_b1: '.... ..0. = PSI(9): no uplink data are pending'
                                                nas_5gs.ul_data_sts_psi_8_b0: '.... ...0 = PSI(8): no uplink data are pending'
                                            PDU session status:
                                                nas_5gs.mm.elem_id: 'Element ID: 0x50'
                                                gsm_a.len: 'Length: 2'
                                                nas_5gs.pdu_ses_sts_psi_7_b7: '0... .... = PSI(7): PDU SESSION INACTIVE'
                                                nas_5gs.pdu_ses_sts_psi_6_b6: '.0.. .... = PSI(6): PDU SESSION INACTIVE'
                                                nas_5gs.pdu_ses_sts_psi_5_b5: '..0. .... = PSI(5): PDU SESSION INACTIVE'
                                                nas_5gs.pdu_ses_sts_psi_4_b4: '...0 .... = PSI(4): PDU SESSION INACTIVE'
                                                nas_5gs.pdu_ses_sts_psi_3_b3: '.... 0... = PSI(3): PDU SESSION INACTIVE'
                                                nas_5gs.pdu_ses_sts_psi_2_b2: '.... .0.. = PSI(2): PDU SESSION INACTIVE'
                                                nas_5gs.pdu_ses_sts_psi_1_b1: '.... ..1. = PSI(1): Not PDU SESSION INACTIVE'
                                                nas_5gs.pdu_ses_sts_psi_0_b0: '.... ...0 = Spare: False'
                                                nas_5gs.pdu_ses_sts_psi_15_b7: '0... .... = PSI(15): PDU SESSION INACTIVE'
                                                nas_5gs.pdu_ses_sts_psi_14_b6: '.0.. .... = PSI(14): PDU SESSION INACTIVE'
                                                nas_5gs.pdu_ses_sts_psi_13_b5: '..0. .... = PSI(13): PDU SESSION INACTIVE'
                                                nas_5gs.pdu_ses_sts_psi_12_b4: '...0 .... = PSI(12): PDU SESSION INACTIVE'
                                                nas_5gs.pdu_ses_sts_psi_11_b3: '.... 0... = PSI(11): PDU SESSION INACTIVE'
                                                nas_5gs.pdu_ses_sts_psi_10_b2: '.... .0.. = PSI(10): PDU SESSION INACTIVE'
                                                nas_5gs.pdu_ses_sts_psi_9_b1: '.... ..0. = PSI(9): PDU SESSION INACTIVE'
                                                nas_5gs.pdu_ses_sts_psi_8_b0: '.... ...0 = PSI(8): PDU SESSION INACTIVE'
            'Item 2: id-UserLocationInformation':
                ngap.id: 'id: id-UserLocationInformation (121)'
                per.enum_index: 'Enumerated Index: 0'
                ngap.criticality: 'criticality: reject (0)'
                per.open_type_length: 'Open Type Length: 19'
                ngap.value_element:
                    per.choice_index: 'Choice Index: 1'
                    ngap.UserLocationInformation:
                        ngap.userLocationInformationNR_element:
                            per.extension_bit: '..0. .... Extension Bit: False'
                            per.optional_field_bit: '.... 0... Optional Field Bit: False (iE-Extensions is NOT present)'
                            ngap.nR_CGI_element:
                                per.extension_bit: '.... .0.. Extension Bit: False'
                                per.optional_field_bit: '.... ..0. Optional Field Bit: False (iE-Extensions is NOT present)'
                                ngap.pLMNIdentity:
                                    e212.mcc: 'Mobile Country Code (MCC): International Mobile, shared code (901)'
                                    e212.mnc: 'Mobile Network Code (MNC): Unknown (70)'
                                ngap.NRCellIdentity: 'nRCellIdentity: 0x0000000010'
                            ngap.tAI_element:
                                per.extension_bit: '.... 0... Extension Bit: False'
                                per.optional_field_bit: '.... .0.. Optional Field Bit: False (iE-Extensions is NOT present)'
                                ngap.pLMNIdentity:
                                    e212.mcc: 'Mobile Country Code (MCC): International Mobile, shared code (901)'
                                    e212.mnc: 'Mobile Network Code (MNC): Unknown (70)'
                                ngap.tAC: 'tAC: 1 (0x000001)'
                            ngap.timeStamp: 'timeStamp: e74c1db5 (Dec 20, 2022 11:40:37 UTC)'
            'Item 3: id-RRCEstablishmentCause':
                ngap.id: 'id: id-RRCEstablishmentCause (90)'
                per.enum_index: 'Enumerated Index: 1'
                ngap.criticality: 'criticality: ignore (1)'
                per.open_type_length: 'Open Type Length: 1'
                ngap.value_element:
                    per.extension_present_bit: '0... .... Extension Present Bit: False'
                    per.enum_index: 'Enumerated Index: 4'
                    ngap.RRCEstablishmentCause: 'RRCEstablishmentCause: mo-Data (4)'
            'Item 4: id-FiveG-S-TMSI':
                ngap.id: 'id: id-FiveG-S-TMSI (26)'
                per.enum_index: 'Enumerated Index: 0'
                ngap.criticality: 'criticality: reject (0)'
                per.open_type_length: 'Open Type Length: 7'
                ngap.value_element:
                    ngap.FiveG_S_TMSI_element:
                        per.extension_bit: '0... .... Extension Bit: False'
                        per.optional_field_bit: '.0.. .... Optional Field Bit: False (iE-Extensions is NOT present)'
                        ngap.aMFSetID: 'aMFSetID: 0040 [bit length 10, 6 LSB pad bits, 0000 0000  01.. .... decimal value 1]'
                        ngap.aMFPointer: 'aMFPointer: 00 [bit length 6, 2 LSB pad bits, 0000 00.. decimal value 0]'
                        ngap.fiveG_TMSI: 'fiveG-TMSI: da00a29a'
            'Item 5: id-UEContextRequest':
                ngap.id: 'id: id-UEContextRequest (112)'
                per.enum_index: 'Enumerated Index: 1'
                ngap.criticality: 'criticality: ignore (1)'
                per.open_type_length: 'Open Type Length: 1'
                ngap.value_element:
                    per.extension_present_bit: '0... .... Extension Present Bit: False'
                    per.enum_index: 'Enumerated Index: 0'
                    ngap.UEContextRequest: 'UEContextRequest: requested (0)'

end note

"10.0.3.1" -> "10.0.2.15": 1715, NGAP DownlinkNASTransport (4),\nNAS Service reject (0x4d)

note right #c6ebc6
**10.0.3.1 to 10.0.2.15**
NGAP-PDU: 00044018000003000a0002000f00550002000f00260005047e004d09
ngap.procedureCode: 'procedureCode: id-DownlinkNASTransport (4)'
per.enum_index: 'Enumerated Index: 1'
ngap.criticality: 'criticality: ignore (1)'
per.open_type_length: 'Open Type Length: 24'
ngap.value_element:
-   ngap.DownlinkNASTransport_element:
        per.extension_bit: '0... .... Extension Bit: False'
        per.sequence_of_length: 'Sequence-Of Length: 3'
        ngap.protocolIEs:
            'Item 0: id-AMF-UE-NGAP-ID':
                ngap.id: 'id: id-AMF-UE-NGAP-ID (10)'
                per.enum_index: 'Enumerated Index: 0'
                ngap.criticality: 'criticality: reject (0)'
                per.open_type_length: 'Open Type Length: 2'
                ngap.value_element:
                    ngap.AMF_UE_NGAP_ID: 'AMF-UE-NGAP-ID: 15'
            'Item 1: id-RAN-UE-NGAP-ID':
                ngap.id: 'id: id-RAN-UE-NGAP-ID (85)'
                per.enum_index: 'Enumerated Index: 0'
                ngap.criticality: 'criticality: reject (0)'
                per.open_type_length: 'Open Type Length: 2'
                ngap.value_element:
                    ngap.RAN_UE_NGAP_ID: 'RAN-UE-NGAP-ID: 15'
            'Item 2: id-NAS-PDU':
                ngap.id: 'id: id-NAS-PDU (38)'
                per.enum_index: 'Enumerated Index: 0'
                ngap.criticality: 'criticality: reject (0)'
                per.open_type_length: 'Open Type Length: 5'
                ngap.value_element:
                    per.octet_string_length: 'Octet String Length: 4'
                    ngap.NAS_PDU:
                        nas-5gs:
                            Plain NAS 5GS Message:
                                nas_5gs.epd: 'Extended protocol discriminator: 5G mobility management messages (126)'
                                nas_5gs.spare_half_octet: '0000 .... = Spare Half Octet: 0'
                                nas_5gs.security_header_type: '.... 0000 = Security header type: Plain NAS message, not security protected (0)'
                                nas_5gs.mm.message_type: 'Message type: Service reject (0x4d)'
                                5GMM cause:
                                    nas_5gs.mm.5gmm_cause: '5GMM cause: UE identity cannot be derived by the network (9)'

end note

"10.0.3.1" -> "10.0.2.15": 1716, NGAP UEContextRelease (41)

note right #c6ebc6
**10.0.3.1 to 10.0.2.15**
NGAP-PDU: 0029001000000200720004000f000f000f400140
ngap.procedureCode: 'procedureCode: id-UEContextRelease (41)'
per.enum_index: 'Enumerated Index: 0'
ngap.criticality: 'criticality: reject (0)'
per.open_type_length: 'Open Type Length: 16'
ngap.value_element:
-   ngap.UEContextReleaseCommand_element:
        per.extension_bit: '0... .... Extension Bit: False'
        per.sequence_of_length: 'Sequence-Of Length: 2'
        ngap.protocolIEs:
            'Item 0: id-UE-NGAP-IDs':
                ngap.id: 'id: id-UE-NGAP-IDs (114)'
                per.enum_index: 'Enumerated Index: 0'
                ngap.criticality: 'criticality: reject (0)'
                per.open_type_length: 'Open Type Length: 4'
                ngap.value_element:
                    per.choice_index: 'Choice Index: 0'
                    ngap.UE_NGAP_IDs:
                        ngap.uE_NGAP_ID_pair_element:
                            per.extension_bit: '..0. .... Extension Bit: False'
                            per.optional_field_bit: '...0 .... Optional Field Bit: False (iE-Extensions is NOT present)'
                            ngap.aMF_UE_NGAP_ID: 'aMF-UE-NGAP-ID: 15'
                            ngap.rAN_UE_NGAP_ID: 'rAN-UE-NGAP-ID: 15'
            'Item 1: id-Cause':
                ngap.id: 'id: id-Cause (15)'
                per.enum_index: 'Enumerated Index: 1'
                ngap.criticality: 'criticality: ignore (1)'
                per.open_type_length: 'Open Type Length: 1'
                ngap.value_element:
                    per.choice_index: 'Choice Index: 2'
                    ngap.Cause:
                        per.extension_present_bit: '...0 .... Extension Present Bit: False'
                        per.enum_index: 'Enumerated Index: 0'
                        ngap.nas: 'nas: normal-release (0)'

end note

"10.0.2.15" -> "10.0.3.1": 1718, NGAP UEContextRelease (41)

note right #c6ebc6
**10.0.2.15 to 10.0.3.1**
NGAP-PDU: 20290026000003000a4002000f00554002000f007940135009f107000000010009f107000001e74c1db5
ngap.procedureCode: 'procedureCode: id-UEContextRelease (41)'
per.enum_index: 'Enumerated Index: 0'
ngap.criticality: 'criticality: reject (0)'
per.open_type_length: 'Open Type Length: 38'
ngap.value_element:
-   ngap.UEContextReleaseComplete_element:
        per.extension_bit: '0... .... Extension Bit: False'
        per.sequence_of_length: 'Sequence-Of Length: 3'
        ngap.protocolIEs:
            'Item 0: id-AMF-UE-NGAP-ID':
                ngap.id: 'id: id-AMF-UE-NGAP-ID (10)'
                per.enum_index: 'Enumerated Index: 1'
                ngap.criticality: 'criticality: ignore (1)'
                per.open_type_length: 'Open Type Length: 2'
                ngap.value_element:
                    ngap.AMF_UE_NGAP_ID: 'AMF-UE-NGAP-ID: 15'
            'Item 1: id-RAN-UE-NGAP-ID':
                ngap.id: 'id: id-RAN-UE-NGAP-ID (85)'
                per.enum_index: 'Enumerated Index: 1'
                ngap.criticality: 'criticality: ignore (1)'
                per.open_type_length: 'Open Type Length: 2'
                ngap.value_element:
                    ngap.RAN_UE_NGAP_ID: 'RAN-UE-NGAP-ID: 15'
            'Item 2: id-UserLocationInformation':
                ngap.id: 'id: id-UserLocationInformation (121)'
                per.enum_index: 'Enumerated Index: 1'
                ngap.criticality: 'criticality: ignore (1)'
                per.open_type_length: 'Open Type Length: 19'
                ngap.value_element:
                    per.choice_index: 'Choice Index: 1'
                    ngap.UserLocationInformation:
                        ngap.userLocationInformationNR_element:
                            per.extension_bit: '..0. .... Extension Bit: False'
                            per.optional_field_bit: '.... 0... Optional Field Bit: False (iE-Extensions is NOT present)'
                            ngap.nR_CGI_element:
                                per.extension_bit: '.... .0.. Extension Bit: False'
                                per.optional_field_bit: '.... ..0. Optional Field Bit: False (iE-Extensions is NOT present)'
                                ngap.pLMNIdentity:
                                    e212.mcc: 'Mobile Country Code (MCC): International Mobile, shared code (901)'
                                    e212.mnc: 'Mobile Network Code (MNC): Unknown (70)'
                                ngap.NRCellIdentity: 'nRCellIdentity: 0x0000000010'
                            ngap.tAI_element:
                                per.extension_bit: '.... 0... Extension Bit: False'
                                per.optional_field_bit: '.... .0.. Optional Field Bit: False (iE-Extensions is NOT present)'
                                ngap.pLMNIdentity:
                                    e212.mcc: 'Mobile Country Code (MCC): International Mobile, shared code (901)'
                                    e212.mnc: 'Mobile Network Code (MNC): Unknown (70)'
                                ngap.tAC: 'tAC: 1 (0x000001)'
                            ngap.timeStamp: 'timeStamp: e74c1db5 (Dec 20, 2022 11:40:37 UTC)'

end note

"10.0.2.15" -> "10.0.3.1": 1720, NGAP InitialUEMessage (15),\nNAS Registration request (0x41)

note right #8cd98c
**10.0.2.15 to 10.0.3.1**
NGAP-PDU: 000f40480000050055000200100026001a197e004179000d0109f1070000000000000000202e04f0f0f0f0007900135009f107000000010009f107000001e74c1db5005a4001200070400100
ngap.procedureCode: 'procedureCode: id-InitialUEMessage (15)'
per.enum_index: 'Enumerated Index: 1'
ngap.criticality: 'criticality: ignore (1)'
per.open_type_length: 'Open Type Length: 72'
ngap.value_element:
-   ngap.InitialUEMessage_element:
        per.extension_bit: '0... .... Extension Bit: False'
        per.sequence_of_length: 'Sequence-Of Length: 5'
        ngap.protocolIEs:
            'Item 0: id-RAN-UE-NGAP-ID':
                ngap.id: 'id: id-RAN-UE-NGAP-ID (85)'
                per.enum_index: 'Enumerated Index: 0'
                ngap.criticality: 'criticality: reject (0)'
                per.open_type_length: 'Open Type Length: 2'
                ngap.value_element:
                    ngap.RAN_UE_NGAP_ID: 'RAN-UE-NGAP-ID: 16'
            'Item 1: id-NAS-PDU':
                ngap.id: 'id: id-NAS-PDU (38)'
                per.enum_index: 'Enumerated Index: 0'
                ngap.criticality: 'criticality: reject (0)'
                per.open_type_length: 'Open Type Length: 26'
                ngap.value_element:
                    per.octet_string_length: 'Octet String Length: 25'
                    ngap.NAS_PDU:
                        nas-5gs:
                            Plain NAS 5GS Message:
                                nas_5gs.epd: 'Extended protocol discriminator: 5G mobility management messages (126)'
                                nas_5gs.spare_half_octet: '0000 .... = Spare Half Octet: 0'
                                nas_5gs.security_header_type: '.... 0000 = Security header type: Plain NAS message, not security protected (0)'
                                nas_5gs.mm.message_type: 'Message type: Registration request (0x41)'
                                5GS registration type:
                                    nas_5gs.mm.for: '.... 1... = Follow-On Request bit (FOR): Follow-on request pending'
                                    nas_5gs.mm.5gs_reg_type: '.... .001 = 5GS registration type: initial registration (1)'
                                NAS key set identifier:
                                    nas_5gs.mm.tsc.h1: '0... .... = Type of security context flag (TSC): Native security context (for KSIAMF)'
                                    nas_5gs.mm.nas_key_set_id.h1: '.111 .... = NAS key set identifier: 7'
                                5GS mobile identity:
                                    gsm_a.len: 'Length: 13'
                                    nas_5gs.spare_b7: '0... .... = Spare: 0'
                                    nas_5gs.mm.suci.supi_fmt: '.000 .... = SUPI format: IMSI (0)'
                                    nas_5gs.spare_b3: '.... 0... = Spare: 0'
                                    nas_5gs.mm.type_id: '.... .001 = Type of identity: SUCI (1)'
                                    e212.mcc: 'Mobile Country Code (MCC): International Mobile, shared code (901)'
                                    e212.mnc: 'Mobile Network Code (MNC): Unknown (70)'
                                    nas_5gs.mm.suci.routing_indicator: 'Routing indicator: 0000'
                                    nas_5gs.mm.suci.scheme_id: '.... 0000 = Protection scheme Id: NULL scheme (0)'
                                    nas_5gs.mm.suci.pki: 'Home network public key identifier: 0'
                                    nas_5gs.mm.suci.supi_null_scheme: 'Scheme output: 0000000002'
                                UE security capability:
                                    nas_5gs.mm.elem_id: 'Element ID: 0x2e'
                                    gsm_a.len: 'Length: 4'
                                    nas_5gs.mm.5g_ea0: '1... .... = 5G-EA0: Supported'
                                    nas_5gs.mm.128_5g_ea1: '.1.. .... = 128-5G-EA1: Supported'
                                    nas_5gs.mm.128_5g_ea2: '..1. .... = 128-5G-EA2: Supported'
                                    nas_5gs.mm.128_5g_ea3: '...1 .... = 128-5G-EA3: Supported'
                                    nas_5gs.mm.5g_ea4: '.... 0... = 5G-EA4: Not supported'
                                    nas_5gs.mm.5g_ea5: '.... .0.. = 5G-EA5: Not supported'
                                    nas_5gs.mm.5g_ea6: '.... ..0. = 5G-EA6: Not supported'
                                    nas_5gs.mm.5g_ea7: '.... ...0 = 5G-EA7: Not supported'
                                    nas_5gs.mm.ia0: '1... .... = 5G-IA0: Supported'
                                    nas_5gs.mm.5g_128_ia1: '.1.. .... = 128-5G-IA1: Supported'
                                    nas_5gs.mm.5g_128_ia2: '..1. .... = 128-5G-IA2: Supported'
                                    nas_5gs.mm.5g_128_ia4: '.... 0... = 5G-IA4: Not supported'
                                    nas_5gs.mm.5g_ia5: '.... .0.. = 5G-IA5: Not supported'
                                    nas_5gs.mm.5g_ia6: '.... ..0. = 5G-IA6: Not supported'
                                    nas_5gs.mm.5g_ia7: '.... ...0 = 5G-IA7: Not supported'
                                    nas_5gs.mm.eea0: '1... .... = EEA0: Supported'
                                    nas_5gs.mm.128eea1: '.1.. .... = 128-EEA1: Supported'
                                    nas_5gs.mm.128eea2: '..1. .... = 128-EEA2: Supported'
                                    nas_5gs.mm.eea3: '...1 .... = 128-EEA3: Supported'
                                    nas_5gs.mm.eea4: '.... 0... = EEA4: Not supported'
                                    nas_5gs.mm.eea5: '.... .0.. = EEA5: Not supported'
                                    nas_5gs.mm.eea6: '.... ..0. = EEA6: Not supported'
                                    nas_5gs.mm.eea7: '.... ...0 = EEA7: Not supported'
                                    nas_5gs.mm.eia0: '1... .... = EIA0: Supported'
                                    nas_5gs.mm.128eia1: '.1.. .... = 128-EIA1: Supported'
                                    nas_5gs.mm.128eia2: '..1. .... = 128-EIA2: Supported'
                                    nas_5gs.mm.eia3: '...1 .... = 128-EIA3: Supported'
                                    nas_5gs.mm.eia4: '.... 0... = EIA4: Not supported'
                                    nas_5gs.mm.eia5: '.... .0.. = EIA5: Not supported'
                                    nas_5gs.mm.eia6: '.... ..0. = EIA6: Not supported'
                                    nas_5gs.mm.eia7: '.... ...0 = EIA7: Not supported'
            'Item 2: id-UserLocationInformation':
                ngap.id: 'id: id-UserLocationInformation (121)'
                per.enum_index: 'Enumerated Index: 0'
                ngap.criticality: 'criticality: reject (0)'
                per.open_type_length: 'Open Type Length: 19'
                ngap.value_element:
                    per.choice_index: 'Choice Index: 1'
                    ngap.UserLocationInformation:
                        ngap.userLocationInformationNR_element:
                            per.extension_bit: '..0. .... Extension Bit: False'
                            per.optional_field_bit: '.... 0... Optional Field Bit: False (iE-Extensions is NOT present)'
                            ngap.nR_CGI_element:
                                per.extension_bit: '.... .0.. Extension Bit: False'
                                per.optional_field_bit: '.... ..0. Optional Field Bit: False (iE-Extensions is NOT present)'
                                ngap.pLMNIdentity:
                                    e212.mcc: 'Mobile Country Code (MCC): International Mobile, shared code (901)'
                                    e212.mnc: 'Mobile Network Code (MNC): Unknown (70)'
                                ngap.NRCellIdentity: 'nRCellIdentity: 0x0000000010'
                            ngap.tAI_element:
                                per.extension_bit: '.... 0... Extension Bit: False'
                                per.optional_field_bit: '.... .0.. Optional Field Bit: False (iE-Extensions is NOT present)'
                                ngap.pLMNIdentity:
                                    e212.mcc: 'Mobile Country Code (MCC): International Mobile, shared code (901)'
                                    e212.mnc: 'Mobile Network Code (MNC): Unknown (70)'
                                ngap.tAC: 'tAC: 1 (0x000001)'
                            ngap.timeStamp: 'timeStamp: e74c1db5 (Dec 20, 2022 11:40:37 UTC)'
            'Item 3: id-RRCEstablishmentCause':
                ngap.id: 'id: id-RRCEstablishmentCause (90)'
                per.enum_index: 'Enumerated Index: 1'
                ngap.criticality: 'criticality: ignore (1)'
                per.open_type_length: 'Open Type Length: 1'
                ngap.value_element:
                    per.extension_present_bit: '0... .... Extension Present Bit: False'
                    per.enum_index: 'Enumerated Index: 4'
                    ngap.RRCEstablishmentCause: 'RRCEstablishmentCause: mo-Data (4)'
            'Item 4: id-UEContextRequest':
                ngap.id: 'id: id-UEContextRequest (112)'
                per.enum_index: 'Enumerated Index: 1'
                ngap.criticality: 'criticality: ignore (1)'
                per.open_type_length: 'Open Type Length: 1'
                ngap.value_element:
                    per.extension_present_bit: '0... .... Extension Present Bit: False'
                    per.enum_index: 'Enumerated Index: 0'
                    ngap.UEContextRequest: 'UEContextRequest: requested (0)'

end note

"10.0.3.1" -> "10.0.2.15": 1721, NGAP UEContextRelease (41)

note right #c6ebc6
**10.0.3.1 to 10.0.2.15**
NGAP-PDU: 0029001000000200720004000e000e000f400140
ngap.procedureCode: 'procedureCode: id-UEContextRelease (41)'
per.enum_index: 'Enumerated Index: 0'
ngap.criticality: 'criticality: reject (0)'
per.open_type_length: 'Open Type Length: 16'
ngap.value_element:
-   ngap.UEContextReleaseCommand_element:
        per.extension_bit: '0... .... Extension Bit: False'
        per.sequence_of_length: 'Sequence-Of Length: 2'
        ngap.protocolIEs:
            'Item 0: id-UE-NGAP-IDs':
                ngap.id: 'id: id-UE-NGAP-IDs (114)'
                per.enum_index: 'Enumerated Index: 0'
                ngap.criticality: 'criticality: reject (0)'
                per.open_type_length: 'Open Type Length: 4'
                ngap.value_element:
                    per.choice_index: 'Choice Index: 0'
                    ngap.UE_NGAP_IDs:
                        ngap.uE_NGAP_ID_pair_element:
                            per.extension_bit: '..0. .... Extension Bit: False'
                            per.optional_field_bit: '...0 .... Optional Field Bit: False (iE-Extensions is NOT present)'
                            ngap.aMF_UE_NGAP_ID: 'aMF-UE-NGAP-ID: 14'
                            ngap.rAN_UE_NGAP_ID: 'rAN-UE-NGAP-ID: 14'
            'Item 1: id-Cause':
                ngap.id: 'id: id-Cause (15)'
                per.enum_index: 'Enumerated Index: 1'
                ngap.criticality: 'criticality: ignore (1)'
                per.open_type_length: 'Open Type Length: 1'
                ngap.value_element:
                    per.choice_index: 'Choice Index: 2'
                    ngap.Cause:
                        per.extension_present_bit: '...0 .... Extension Present Bit: False'
                        per.enum_index: 'Enumerated Index: 0'
                        ngap.nas: 'nas: normal-release (0)'

end note

"10.0.2.15" -> "10.0.3.1": 1729, NGAP UEContextRelease (41)

note right #c6ebc6
**10.0.2.15 to 10.0.3.1**
NGAP-PDU: 20290026000003000a4002000e00554002000e007940135009f107000000010009f107000001e74c1db5
ngap.procedureCode: 'procedureCode: id-UEContextRelease (41)'
per.enum_index: 'Enumerated Index: 0'
ngap.criticality: 'criticality: reject (0)'
per.open_type_length: 'Open Type Length: 38'
ngap.value_element:
-   ngap.UEContextReleaseComplete_element:
        per.extension_bit: '0... .... Extension Bit: False'
        per.sequence_of_length: 'Sequence-Of Length: 3'
        ngap.protocolIEs:
            'Item 0: id-AMF-UE-NGAP-ID':
                ngap.id: 'id: id-AMF-UE-NGAP-ID (10)'
                per.enum_index: 'Enumerated Index: 1'
                ngap.criticality: 'criticality: ignore (1)'
                per.open_type_length: 'Open Type Length: 2'
                ngap.value_element:
                    ngap.AMF_UE_NGAP_ID: 'AMF-UE-NGAP-ID: 14'
            'Item 1: id-RAN-UE-NGAP-ID':
                ngap.id: 'id: id-RAN-UE-NGAP-ID (85)'
                per.enum_index: 'Enumerated Index: 1'
                ngap.criticality: 'criticality: ignore (1)'
                per.open_type_length: 'Open Type Length: 2'
                ngap.value_element:
                    ngap.RAN_UE_NGAP_ID: 'RAN-UE-NGAP-ID: 14'
            'Item 2: id-UserLocationInformation':
                ngap.id: 'id: id-UserLocationInformation (121)'
                per.enum_index: 'Enumerated Index: 1'
                ngap.criticality: 'criticality: ignore (1)'
                per.open_type_length: 'Open Type Length: 19'
                ngap.value_element:
                    per.choice_index: 'Choice Index: 1'
                    ngap.UserLocationInformation:
                        ngap.userLocationInformationNR_element:
                            per.extension_bit: '..0. .... Extension Bit: False'
                            per.optional_field_bit: '.... 0... Optional Field Bit: False (iE-Extensions is NOT present)'
                            ngap.nR_CGI_element:
                                per.extension_bit: '.... .0.. Extension Bit: False'
                                per.optional_field_bit: '.... ..0. Optional Field Bit: False (iE-Extensions is NOT present)'
                                ngap.pLMNIdentity:
                                    e212.mcc: 'Mobile Country Code (MCC): International Mobile, shared code (901)'
                                    e212.mnc: 'Mobile Network Code (MNC): Unknown (70)'
                                ngap.NRCellIdentity: 'nRCellIdentity: 0x0000000010'
                            ngap.tAI_element:
                                per.extension_bit: '.... 0... Extension Bit: False'
                                per.optional_field_bit: '.... .0.. Optional Field Bit: False (iE-Extensions is NOT present)'
                                ngap.pLMNIdentity:
                                    e212.mcc: 'Mobile Country Code (MCC): International Mobile, shared code (901)'
                                    e212.mnc: 'Mobile Network Code (MNC): Unknown (70)'
                                ngap.tAC: 'tAC: 1 (0x000001)'
                            ngap.timeStamp: 'timeStamp: e74c1db5 (Dec 20, 2022 11:40:37 UTC)'

end note

"10.0.3.1" -> "10.0.2.15": 1744, NGAP DownlinkNASTransport (4),\nNAS Authentication request (0x56)

note right #8cd98c
**10.0.3.1 to 10.0.2.15**
NGAP-PDU: 0004403e000003000a000200100055000200100026002b2a7e00560302000021c4c45e6cda53d109983979ef9ca7e78120105ba389a374c58000c89258ef4e61fc5a
ngap.procedureCode: 'procedureCode: id-DownlinkNASTransport (4)'
per.enum_index: 'Enumerated Index: 1'
ngap.criticality: 'criticality: ignore (1)'
per.open_type_length: 'Open Type Length: 62'
ngap.value_element:
-   ngap.DownlinkNASTransport_element:
        per.extension_bit: '0... .... Extension Bit: False'
        per.sequence_of_length: 'Sequence-Of Length: 3'
        ngap.protocolIEs:
            'Item 0: id-AMF-UE-NGAP-ID':
                ngap.id: 'id: id-AMF-UE-NGAP-ID (10)'
                per.enum_index: 'Enumerated Index: 0'
                ngap.criticality: 'criticality: reject (0)'
                per.open_type_length: 'Open Type Length: 2'
                ngap.value_element:
                    ngap.AMF_UE_NGAP_ID: 'AMF-UE-NGAP-ID: 16'
            'Item 1: id-RAN-UE-NGAP-ID':
                ngap.id: 'id: id-RAN-UE-NGAP-ID (85)'
                per.enum_index: 'Enumerated Index: 0'
                ngap.criticality: 'criticality: reject (0)'
                per.open_type_length: 'Open Type Length: 2'
                ngap.value_element:
                    ngap.RAN_UE_NGAP_ID: 'RAN-UE-NGAP-ID: 16'
            'Item 2: id-NAS-PDU':
                ngap.id: 'id: id-NAS-PDU (38)'
                per.enum_index: 'Enumerated Index: 0'
                ngap.criticality: 'criticality: reject (0)'
                per.open_type_length: 'Open Type Length: 43'
                ngap.value_element:
                    per.octet_string_length: 'Octet String Length: 42'
                    ngap.NAS_PDU:
                        nas-5gs:
                            Plain NAS 5GS Message:
                                nas_5gs.epd: 'Extended protocol discriminator: 5G mobility management messages (126)'
                                nas_5gs.spare_half_octet: '0000 .... = Spare Half Octet: 0'
                                nas_5gs.security_header_type: '.... 0000 = Security header type: Plain NAS message, not security protected (0)'
                                nas_5gs.mm.message_type: 'Message type: Authentication request (0x56)'
                                NAS key set identifier - ngKSI:
                                    nas_5gs.mm.tsc: '.... 0... = Type of security context flag (TSC): Native security context (for KSIAMF)'
                                    nas_5gs.mm.nas_key_set_id: '.... .011 = NAS key set identifier: 3'
                                ABBA:
                                    gsm_a.len: 'Length: 2'
                                    nas_5gs.mm.abba_contents: 'ABBA Contents: 0x0000'
                                Authentication Parameter RAND - 5G authentication challenge:
                                    gsm_a.dtap.elem_id: 'Element ID: 0x21'
                                    gsm_a.dtap.rand: 'RAND value: c4c45e6cda53d109983979ef9ca7e781'
                                Authentication Parameter AUTN (UMTS and EPS authentication challenge) - 5G authentication challenge:
                                    gsm_a.dtap.elem_id: 'Element ID: 0x20'
                                    gsm_a.len: 'Length: 16'
                                    gsm_a.dtap.autn:
                                        gsm_a.dtap.autn.sqn_xor_ak: 'SQN xor AK: 5ba389a374c5'
                                        gsm_a.dtap.autn.amf: 'AMF: 8000'
                                        gsm_a.dtap.autn.mac: 'MAC: c89258ef4e61fc5a'

end note

"10.0.2.15" -> "10.0.3.1": 1745, NGAP UplinkNASTransport (46),\nNAS Authentication response (0x57)

note right #c6ebc6
**10.0.2.15 to 10.0.3.1**
NGAP-PDU: 002e4040000004000a0002001000550002001000260016157e00572d10397eb8bab273f20d9e173752cb999cc4007940135009f107000000010009f107000001e74c1db5
ngap.procedureCode: 'procedureCode: id-UplinkNASTransport (46)'
per.enum_index: 'Enumerated Index: 1'
ngap.criticality: 'criticality: ignore (1)'
per.open_type_length: 'Open Type Length: 64'
ngap.value_element:
-   ngap.UplinkNASTransport_element:
        per.extension_bit: '0... .... Extension Bit: False'
        per.sequence_of_length: 'Sequence-Of Length: 4'
        ngap.protocolIEs:
            'Item 0: id-AMF-UE-NGAP-ID':
                ngap.id: 'id: id-AMF-UE-NGAP-ID (10)'
                per.enum_index: 'Enumerated Index: 0'
                ngap.criticality: 'criticality: reject (0)'
                per.open_type_length: 'Open Type Length: 2'
                ngap.value_element:
                    ngap.AMF_UE_NGAP_ID: 'AMF-UE-NGAP-ID: 16'
            'Item 1: id-RAN-UE-NGAP-ID':
                ngap.id: 'id: id-RAN-UE-NGAP-ID (85)'
                per.enum_index: 'Enumerated Index: 0'
                ngap.criticality: 'criticality: reject (0)'
                per.open_type_length: 'Open Type Length: 2'
                ngap.value_element:
                    ngap.RAN_UE_NGAP_ID: 'RAN-UE-NGAP-ID: 16'
            'Item 2: id-NAS-PDU':
                ngap.id: 'id: id-NAS-PDU (38)'
                per.enum_index: 'Enumerated Index: 0'
                ngap.criticality: 'criticality: reject (0)'
                per.open_type_length: 'Open Type Length: 22'
                ngap.value_element:
                    per.octet_string_length: 'Octet String Length: 21'
                    ngap.NAS_PDU:
                        nas-5gs:
                            Plain NAS 5GS Message:
                                nas_5gs.epd: 'Extended protocol discriminator: 5G mobility management messages (126)'
                                nas_5gs.spare_half_octet: '0000 .... = Spare Half Octet: 0'
                                nas_5gs.security_header_type: '.... 0000 = Security header type: Plain NAS message, not security protected (0)'
                                nas_5gs.mm.message_type: 'Message type: Authentication response (0x57)'
                                Authentication response parameter:
                                    nas_eps.emm.elem_id: 'Element ID: 0x2d'
                                    gsm_a.len: 'Length: 16'
                                    nas_eps.emm.res: 'RES: 397eb8bab273f20d9e173752cb999cc4'
            'Item 3: id-UserLocationInformation':
                ngap.id: 'id: id-UserLocationInformation (121)'
                per.enum_index: 'Enumerated Index: 1'
                ngap.criticality: 'criticality: ignore (1)'
                per.open_type_length: 'Open Type Length: 19'
                ngap.value_element:
                    per.choice_index: 'Choice Index: 1'
                    ngap.UserLocationInformation:
                        ngap.userLocationInformationNR_element:
                            per.extension_bit: '..0. .... Extension Bit: False'
                            per.optional_field_bit: '.... 0... Optional Field Bit: False (iE-Extensions is NOT present)'
                            ngap.nR_CGI_element:
                                per.extension_bit: '.... .0.. Extension Bit: False'
                                per.optional_field_bit: '.... ..0. Optional Field Bit: False (iE-Extensions is NOT present)'
                                ngap.pLMNIdentity:
                                    e212.mcc: 'Mobile Country Code (MCC): International Mobile, shared code (901)'
                                    e212.mnc: 'Mobile Network Code (MNC): Unknown (70)'
                                ngap.NRCellIdentity: 'nRCellIdentity: 0x0000000010'
                            ngap.tAI_element:
                                per.extension_bit: '.... 0... Extension Bit: False'
                                per.optional_field_bit: '.... .0.. Optional Field Bit: False (iE-Extensions is NOT present)'
                                ngap.pLMNIdentity:
                                    e212.mcc: 'Mobile Country Code (MCC): International Mobile, shared code (901)'
                                    e212.mnc: 'Mobile Network Code (MNC): Unknown (70)'
                                ngap.tAC: 'tAC: 1 (0x000001)'
                            ngap.timeStamp: 'timeStamp: e74c1db5 (Dec 20, 2022 11:40:37 UTC)'

end note

"10.0.3.1" -> "10.0.2.15": 1768, NGAP DownlinkNASTransport (4),\nNAS Security mode command (0x5d)

note right #c6ebc6
**10.0.3.1 to 10.0.2.15**
NGAP-PDU: 00044029000003000a0002001000550002001000260016157e03dd1a3633007e005d020304f0f0f0f0e1360102
ngap.procedureCode: 'procedureCode: id-DownlinkNASTransport (4)'
per.enum_index: 'Enumerated Index: 1'
ngap.criticality: 'criticality: ignore (1)'
per.open_type_length: 'Open Type Length: 41'
ngap.value_element:
-   ngap.DownlinkNASTransport_element:
        per.extension_bit: '0... .... Extension Bit: False'
        per.sequence_of_length: 'Sequence-Of Length: 3'
        ngap.protocolIEs:
            'Item 0: id-AMF-UE-NGAP-ID':
                ngap.id: 'id: id-AMF-UE-NGAP-ID (10)'
                per.enum_index: 'Enumerated Index: 0'
                ngap.criticality: 'criticality: reject (0)'
                per.open_type_length: 'Open Type Length: 2'
                ngap.value_element:
                    ngap.AMF_UE_NGAP_ID: 'AMF-UE-NGAP-ID: 16'
            'Item 1: id-RAN-UE-NGAP-ID':
                ngap.id: 'id: id-RAN-UE-NGAP-ID (85)'
                per.enum_index: 'Enumerated Index: 0'
                ngap.criticality: 'criticality: reject (0)'
                per.open_type_length: 'Open Type Length: 2'
                ngap.value_element:
                    ngap.RAN_UE_NGAP_ID: 'RAN-UE-NGAP-ID: 16'
            'Item 2: id-NAS-PDU':
                ngap.id: 'id: id-NAS-PDU (38)'
                per.enum_index: 'Enumerated Index: 0'
                ngap.criticality: 'criticality: reject (0)'
                per.open_type_length: 'Open Type Length: 22'
                ngap.value_element:
                    per.octet_string_length: 'Octet String Length: 21'
                    ngap.NAS_PDU:
                        nas-5gs:
                            Security protected NAS 5GS message:
                                nas_5gs.epd: 'Extended protocol discriminator: 5G mobility management messages (126)'
                                nas_5gs.spare_half_octet: '0000 .... = Spare Half Octet: 0'
                                nas_5gs.security_header_type: '.... 0011 = Security header type: Integrity protected with new 5GS security context (3)'
                                nas_5gs.msg_auth_code: 'Message authentication code: 0xdd1a3633'
                                nas_5gs.seq_no: 'Sequence number: 0'
                            Plain NAS 5GS Message:
                                nas_5gs.epd: 'Extended protocol discriminator: 5G mobility management messages (126)'
                                nas_5gs.spare_half_octet: '0000 .... = Spare Half Octet: 0'
                                nas_5gs.security_header_type: '.... 0000 = Security header type: Plain NAS message, not security protected (0)'
                                nas_5gs.mm.message_type: 'Message type: Security mode command (0x5d)'
                                NAS security algorithms:
                                    nas_5gs.mm.nas_sec_algo_enc: '0000 .... = Type of ciphering algorithm: 5G-EA0 (null ciphering algorithm) (0)'
                                    nas_5gs.mm.nas_sec_algo_ip: '.... 0010 = Type of integrity protection algorithm: 128-5G-IA2 (2)'
                                NAS key set identifier - ngKSI:
                                    nas_5gs.mm.tsc: '.... 0... = Type of security context flag (TSC): Native security context (for KSIAMF)'
                                    nas_5gs.mm.nas_key_set_id: '.... .011 = NAS key set identifier: 3'
                                UE security capability - Replayed UE security capabilities:
                                    gsm_a.len: 'Length: 4'
                                    nas_5gs.mm.5g_ea0: '1... .... = 5G-EA0: Supported'
                                    nas_5gs.mm.128_5g_ea1: '.1.. .... = 128-5G-EA1: Supported'
                                    nas_5gs.mm.128_5g_ea2: '..1. .... = 128-5G-EA2: Supported'
                                    nas_5gs.mm.128_5g_ea3: '...1 .... = 128-5G-EA3: Supported'
                                    nas_5gs.mm.5g_ea4: '.... 0... = 5G-EA4: Not supported'
                                    nas_5gs.mm.5g_ea5: '.... .0.. = 5G-EA5: Not supported'
                                    nas_5gs.mm.5g_ea6: '.... ..0. = 5G-EA6: Not supported'
                                    nas_5gs.mm.5g_ea7: '.... ...0 = 5G-EA7: Not supported'
                                    nas_5gs.mm.ia0: '1... .... = 5G-IA0: Supported'
                                    nas_5gs.mm.5g_128_ia1: '.1.. .... = 128-5G-IA1: Supported'
                                    nas_5gs.mm.5g_128_ia2: '..1. .... = 128-5G-IA2: Supported'
                                    nas_5gs.mm.5g_128_ia4: '.... 0... = 5G-IA4: Not supported'
                                    nas_5gs.mm.5g_ia5: '.... .0.. = 5G-IA5: Not supported'
                                    nas_5gs.mm.5g_ia6: '.... ..0. = 5G-IA6: Not supported'
                                    nas_5gs.mm.5g_ia7: '.... ...0 = 5G-IA7: Not supported'
                                    nas_5gs.mm.eea0: '1... .... = EEA0: Supported'
                                    nas_5gs.mm.128eea1: '.1.. .... = 128-EEA1: Supported'
                                    nas_5gs.mm.128eea2: '..1. .... = 128-EEA2: Supported'
                                    nas_5gs.mm.eea3: '...1 .... = 128-EEA3: Supported'
                                    nas_5gs.mm.eea4: '.... 0... = EEA4: Not supported'
                                    nas_5gs.mm.eea5: '.... .0.. = EEA5: Not supported'
                                    nas_5gs.mm.eea6: '.... ..0. = EEA6: Not supported'
                                    nas_5gs.mm.eea7: '.... ...0 = EEA7: Not supported'
                                    nas_5gs.mm.eia0: '1... .... = EIA0: Supported'
                                    nas_5gs.mm.128eia1: '.1.. .... = 128-EIA1: Supported'
                                    nas_5gs.mm.128eia2: '..1. .... = 128-EIA2: Supported'
                                    nas_5gs.mm.eia3: '...1 .... = 128-EIA3: Supported'
                                    nas_5gs.mm.eia4: '.... 0... = EIA4: Not supported'
                                    nas_5gs.mm.eia5: '.... .0.. = EIA5: Not supported'
                                    nas_5gs.mm.eia6: '.... ..0. = EIA6: Not supported'
                                    nas_5gs.mm.eia7: '.... ...0 = EIA7: Not supported'
                                IMEISV request:
                                    gsm_a.common.elem_id: '1110 .... = Element ID: 0xe-'
                                    nas_eps.spare_bits: '.... 0... = Spare bit(s): 0x00'
                                    nas_eps.emm.imeisv_req: '.... .001 = IMEISV request: IMEISV requested (1)'
                                Additional 5G security information:
                                    nas_5gs.mm.elem_id: 'Element ID: 0x36'
                                    gsm_a.len: 'Length: 1'
                                    nas_5gs.spare_b3: '.... 0... = Spare: 0'
                                    nas_5gs.spare_b2: '.... .0.. = Spare: 0'
                                    nas_5gs.mm.rinmr: '.... ..1. = Retransmission of initial NAS message request(RINMR): Requested'
                                    nas_5gs.mm.hdp: '.... ...0 = Horizontal derivation parameter (HDP): Not required'

end note

"10.0.2.15" -> "10.0.3.1": 1769, NGAP UplinkNASTransport (46),\nNAS Security mode complete (0x5e),\nNAS Registration request (0x41)

note right #8cd98c
**10.0.2.15 to 10.0.3.1**
NGAP-PDU: 002e4069000004000a000200100055000200100026003f3e7e04b1bd262f007e005e7700094573806121856151f17100257e004179000d0109f1070000000000000000201001002e04f0f0f0f02f0401010101530100007940135009f107000000010009f107000001e74c1db5
ngap.procedureCode: 'procedureCode: id-UplinkNASTransport (46)'
per.enum_index: 'Enumerated Index: 1'
ngap.criticality: 'criticality: ignore (1)'
per.open_type_length: 'Open Type Length: 105'
ngap.value_element:
-   ngap.UplinkNASTransport_element:
        per.extension_bit: '0... .... Extension Bit: False'
        per.sequence_of_length: 'Sequence-Of Length: 4'
        ngap.protocolIEs:
            'Item 0: id-AMF-UE-NGAP-ID':
                ngap.id: 'id: id-AMF-UE-NGAP-ID (10)'
                per.enum_index: 'Enumerated Index: 0'
                ngap.criticality: 'criticality: reject (0)'
                per.open_type_length: 'Open Type Length: 2'
                ngap.value_element:
                    ngap.AMF_UE_NGAP_ID: 'AMF-UE-NGAP-ID: 16'
            'Item 1: id-RAN-UE-NGAP-ID':
                ngap.id: 'id: id-RAN-UE-NGAP-ID (85)'
                per.enum_index: 'Enumerated Index: 0'
                ngap.criticality: 'criticality: reject (0)'
                per.open_type_length: 'Open Type Length: 2'
                ngap.value_element:
                    ngap.RAN_UE_NGAP_ID: 'RAN-UE-NGAP-ID: 16'
            'Item 2: id-NAS-PDU':
                ngap.id: 'id: id-NAS-PDU (38)'
                per.enum_index: 'Enumerated Index: 0'
                ngap.criticality: 'criticality: reject (0)'
                per.open_type_length: 'Open Type Length: 63'
                ngap.value_element:
                    per.octet_string_length: 'Octet String Length: 62'
                    ngap.NAS_PDU:
                        nas-5gs:
                            Security protected NAS 5GS message:
                                nas_5gs.epd: 'Extended protocol discriminator: 5G mobility management messages (126)'
                                nas_5gs.spare_half_octet: '0000 .... = Spare Half Octet: 0'
                                nas_5gs.security_header_type: '.... 0100 = Security header type: Integrity protected and ciphered with new 5GS security context (4)'
                                nas_5gs.msg_auth_code: 'Message authentication code: 0xb1bd262f'
                                nas_5gs.seq_no: 'Sequence number: 0'
                            Plain NAS 5GS Message:
                                nas_5gs.epd: 'Extended protocol discriminator: 5G mobility management messages (126)'
                                nas_5gs.spare_half_octet: '0000 .... = Spare Half Octet: 0'
                                nas_5gs.security_header_type: '.... 0000 = Security header type: Plain NAS message, not security protected (0)'
                                nas_5gs.mm.message_type: 'Message type: Security mode complete (0x5e)'
                                5GS mobile identity:
                                    nas_5gs.mm.elem_id: 'Element ID: 0x77'
                                    gsm_a.len: 'Length: 9'
                                    nas_5gs.mm.odd_even: '.... 0... = Odd/even indication: Even number of identity digits'
                                    nas_5gs.mm.type_id: '.... .101 = Type of identity: IMEISV (5)'
                                    nas_5gs.mm.imeisv: 'IMEISV: 4370816125816151'
                                NAS message container:
                                    nas_5gs.mm.elem_id: 'Element ID: 0x71'
                                    gsm_a.len: 'Length: 37'
                                    nas-5gs:
                                        Plain NAS 5GS Message:
                                            nas_5gs.epd: 'Extended protocol discriminator: 5G mobility management messages (126)'
                                            nas_5gs.spare_half_octet: '0000 .... = Spare Half Octet: 0'
                                            nas_5gs.security_header_type: '.... 0000 = Security header type: Plain NAS message, not security protected (0)'
                                            nas_5gs.mm.message_type: 'Message type: Registration request (0x41)'
                                            5GS registration type:
                                                nas_5gs.mm.for: '.... 1... = Follow-On Request bit (FOR): Follow-on request pending'
                                                nas_5gs.mm.5gs_reg_type: '.... .001 = 5GS registration type: initial registration (1)'
                                            NAS key set identifier:
                                                nas_5gs.mm.tsc.h1: '0... .... = Type of security context flag (TSC): Native security context (for KSIAMF)'
                                                nas_5gs.mm.nas_key_set_id.h1: '.111 .... = NAS key set identifier: 7'
                                            5GS mobile identity:
                                                gsm_a.len: 'Length: 13'
                                                nas_5gs.spare_b7: '0... .... = Spare: 0'
                                                nas_5gs.mm.suci.supi_fmt: '.000 .... = SUPI format: IMSI (0)'
                                                nas_5gs.spare_b3: '.... 0... = Spare: 0'
                                                nas_5gs.mm.type_id: '.... .001 = Type of identity: SUCI (1)'
                                                e212.mcc: 'Mobile Country Code (MCC): International Mobile, shared code (901)'
                                                e212.mnc: 'Mobile Network Code (MNC): Unknown (70)'
                                                nas_5gs.mm.suci.routing_indicator: 'Routing indicator: 0000'
                                                nas_5gs.mm.suci.scheme_id: '.... 0000 = Protection scheme Id: NULL scheme (0)'
                                                nas_5gs.mm.suci.pki: 'Home network public key identifier: 0'
                                                nas_5gs.mm.suci.supi_null_scheme: 'Scheme output: 0000000002'
                                            5GMM capability:
                                                nas_5gs.mm.elem_id: 'Element ID: 0x10'
                                                gsm_a.len: 'Length: 1'
                                                nas_5gs.spare_b7: '0... .... = Spare: 0'
                                                nas_5gs.spare_b6: '.0.. .... = Spare: 0'
                                                nas_5gs.spare_b5: '..0. .... = Spare: 0'
                                                nas_5gs.spare_b4: '...0 .... = Spare: 0'
                                                nas_5gs.spare_b3: '.... 0... = Spare: 0'
                                                nas_5gs.mm.lpp_cap_b2: '.... .0.. = LTE Positioning Protocol (LPP) capability: Not Requested'
                                                nas_5gs.mm.ho_attach_b1: '.... ..0. = HO attach: Not supported'
                                                nas_5gs.mm.s1_mode_b0: '.... ...0 = S1 mode: Not Requested'
                                            UE security capability:
                                                nas_5gs.mm.elem_id: 'Element ID: 0x2e'
                                                gsm_a.len: 'Length: 4'
                                                nas_5gs.mm.5g_ea0: '1... .... = 5G-EA0: Supported'
                                                nas_5gs.mm.128_5g_ea1: '.1.. .... = 128-5G-EA1: Supported'
                                                nas_5gs.mm.128_5g_ea2: '..1. .... = 128-5G-EA2: Supported'
                                                nas_5gs.mm.128_5g_ea3: '...1 .... = 128-5G-EA3: Supported'
                                                nas_5gs.mm.5g_ea4: '.... 0... = 5G-EA4: Not supported'
                                                nas_5gs.mm.5g_ea5: '.... .0.. = 5G-EA5: Not supported'
                                                nas_5gs.mm.5g_ea6: '.... ..0. = 5G-EA6: Not supported'
                                                nas_5gs.mm.5g_ea7: '.... ...0 = 5G-EA7: Not supported'
                                                nas_5gs.mm.ia0: '1... .... = 5G-IA0: Supported'
                                                nas_5gs.mm.5g_128_ia1: '.1.. .... = 128-5G-IA1: Supported'
                                                nas_5gs.mm.5g_128_ia2: '..1. .... = 128-5G-IA2: Supported'
                                                nas_5gs.mm.5g_128_ia4: '.... 0... = 5G-IA4: Not supported'
                                                nas_5gs.mm.5g_ia5: '.... .0.. = 5G-IA5: Not supported'
                                                nas_5gs.mm.5g_ia6: '.... ..0. = 5G-IA6: Not supported'
                                                nas_5gs.mm.5g_ia7: '.... ...0 = 5G-IA7: Not supported'
                                                nas_5gs.mm.eea0: '1... .... = EEA0: Supported'
                                                nas_5gs.mm.128eea1: '.1.. .... = 128-EEA1: Supported'
                                                nas_5gs.mm.128eea2: '..1. .... = 128-EEA2: Supported'
                                                nas_5gs.mm.eea3: '...1 .... = 128-EEA3: Supported'
                                                nas_5gs.mm.eea4: '.... 0... = EEA4: Not supported'
                                                nas_5gs.mm.eea5: '.... .0.. = EEA5: Not supported'
                                                nas_5gs.mm.eea6: '.... ..0. = EEA6: Not supported'
                                                nas_5gs.mm.eea7: '.... ...0 = EEA7: Not supported'
                                                nas_5gs.mm.eia0: '1... .... = EIA0: Supported'
                                                nas_5gs.mm.128eia1: '.1.. .... = 128-EIA1: Supported'
                                                nas_5gs.mm.128eia2: '..1. .... = 128-EIA2: Supported'
                                                nas_5gs.mm.eia3: '...1 .... = 128-EIA3: Supported'
                                                nas_5gs.mm.eia4: '.... 0... = EIA4: Not supported'
                                                nas_5gs.mm.eia5: '.... .0.. = EIA5: Not supported'
                                                nas_5gs.mm.eia6: '.... ..0. = EIA6: Not supported'
                                                nas_5gs.mm.eia7: '.... ...0 = EIA7: Not supported'
                                            NSSAI - Requested NSSAI:
                                                nas_5gs.mm.elem_id: 'Element ID: 0x2f'
                                                gsm_a.len: 'Length: 4'
                                                S-NSSAI 1:
                                                    nas_5gs.mm.length: 'Length: 1'
                                                    nas_5gs.mm.sst: 'Slice/service type (SST): 1'
                                                S-NSSAI 2:
                                                    nas_5gs.mm.length: 'Length: 1'
                                                    nas_5gs.mm.sst: 'Slice/service type (SST): 1'
                                            5GS update type:
                                                nas_5gs.mm.elem_id: 'Element ID: 0x53'
                                                gsm_a.len: 'Length: 1'
                                                nas_5gs.spare_b3: '.... 0... = Spare: 0'
                                                nas_5gs.spare_b2: '.... .0.. = Spare: 0'
                                                nas_5gs.mm.ng_ran_rcu: '.... ..0. = NG-RAN Radio Capability Update (NG-RAN-RCU): Not Needed'
                                                nas_5gs.mm.sms_requested: '.... ...0 = SMS requested: SMS over NAS not supported'
            'Item 3: id-UserLocationInformation':
                ngap.id: 'id: id-UserLocationInformation (121)'
                per.enum_index: 'Enumerated Index: 1'
                ngap.criticality: 'criticality: ignore (1)'
                per.open_type_length: 'Open Type Length: 19'
                ngap.value_element:
                    per.choice_index: 'Choice Index: 1'
                    ngap.UserLocationInformation:
                        ngap.userLocationInformationNR_element:
                            per.extension_bit: '..0. .... Extension Bit: False'
                            per.optional_field_bit: '.... 0... Optional Field Bit: False (iE-Extensions is NOT present)'
                            ngap.nR_CGI_element:
                                per.extension_bit: '.... .0.. Extension Bit: False'
                                per.optional_field_bit: '.... ..0. Optional Field Bit: False (iE-Extensions is NOT present)'
                                ngap.pLMNIdentity:
                                    e212.mcc: 'Mobile Country Code (MCC): International Mobile, shared code (901)'
                                    e212.mnc: 'Mobile Network Code (MNC): Unknown (70)'
                                ngap.NRCellIdentity: 'nRCellIdentity: 0x0000000010'
                            ngap.tAI_element:
                                per.extension_bit: '.... 0... Extension Bit: False'
                                per.optional_field_bit: '.... .0.. Optional Field Bit: False (iE-Extensions is NOT present)'
                                ngap.pLMNIdentity:
                                    e212.mcc: 'Mobile Country Code (MCC): International Mobile, shared code (901)'
                                    e212.mnc: 'Mobile Network Code (MNC): Unknown (70)'
                                ngap.tAC: 'tAC: 1 (0x000001)'
                            ngap.timeStamp: 'timeStamp: e74c1db5 (Dec 20, 2022 11:40:37 UTC)'

end note

"10.0.3.1" -> "10.0.2.15": 1824, NGAP InitialContextSetup (14),\nNAS Registration accept (0x42)

note right #c6ebc6
**10.0.3.1 to 10.0.2.15**
NGAP-PDU: 000e008094000008000a00020010005500020010001c00070009f1070200400000000420010008007700091c000e000700038000005e00206b638595678ad960c5d07509c1acebf99ad272743c01ef08d23a4b7b306e29ab002240084370816125ffff5100264031307e02870be7b0017e0042010177000bf209f107020040db00d98654072009f107000001150401010101210201005e0129
ngap.procedureCode: 'procedureCode: id-InitialContextSetup (14)'
per.enum_index: 'Enumerated Index: 0'
ngap.criticality: 'criticality: reject (0)'
per.open_type_length: 'Open Type Length: 148'
ngap.value_element:
-   ngap.InitialContextSetupRequest_element:
        per.extension_bit: '0... .... Extension Bit: False'
        per.sequence_of_length: 'Sequence-Of Length: 8'
        ngap.protocolIEs:
            'Item 0: id-AMF-UE-NGAP-ID':
                ngap.id: 'id: id-AMF-UE-NGAP-ID (10)'
                per.enum_index: 'Enumerated Index: 0'
                ngap.criticality: 'criticality: reject (0)'
                per.open_type_length: 'Open Type Length: 2'
                ngap.value_element:
                    ngap.AMF_UE_NGAP_ID: 'AMF-UE-NGAP-ID: 16'
            'Item 1: id-RAN-UE-NGAP-ID':
                ngap.id: 'id: id-RAN-UE-NGAP-ID (85)'
                per.enum_index: 'Enumerated Index: 0'
                ngap.criticality: 'criticality: reject (0)'
                per.open_type_length: 'Open Type Length: 2'
                ngap.value_element:
                    ngap.RAN_UE_NGAP_ID: 'RAN-UE-NGAP-ID: 16'
            'Item 2: id-GUAMI':
                ngap.id: 'id: id-GUAMI (28)'
                per.enum_index: 'Enumerated Index: 0'
                ngap.criticality: 'criticality: reject (0)'
                per.open_type_length: 'Open Type Length: 7'
                ngap.value_element:
                    ngap.GUAMI_element:
                        per.extension_bit: '0... .... Extension Bit: False'
                        per.optional_field_bit: '.0.. .... Optional Field Bit: False (iE-Extensions is NOT present)'
                        ngap.pLMNIdentity:
                            e212.mcc: 'Mobile Country Code (MCC): International Mobile, shared code (901)'
                            e212.mnc: 'Mobile Network Code (MNC): Unknown (70)'
                        ngap.aMFRegionID: 'aMFRegionID: 02 [bit length 8, 0000 0010 decimal value 2]'
                        ngap.aMFSetID: 'aMFSetID: 0040 [bit length 10, 6 LSB pad bits, 0000 0000  01.. .... decimal value 1]'
                        ngap.aMFPointer: 'aMFPointer: 00 [bit length 6, 2 LSB pad bits, 0000 00.. decimal value 0]'
            'Item 3: id-AllowedNSSAI':
                ngap.id: 'id: id-AllowedNSSAI (0)'
                per.enum_index: 'Enumerated Index: 0'
                ngap.criticality: 'criticality: reject (0)'
                per.open_type_length: 'Open Type Length: 4'
                ngap.value_element:
                    per.sequence_of_length: 'Sequence-Of Length: 2'
                    ngap.AllowedNSSAI:
                        Item 0:
                            ngap.AllowedNSSAI_Item_element:
                                per.extension_bit: '...0 .... Extension Bit: False'
                                per.optional_field_bit: '.... 0... Optional Field Bit: False (iE-Extensions is NOT present)'
                                ngap.s_NSSAI_element:
                                    per.extension_bit: '.... .0.. Extension Bit: False'
                                    per.optional_field_bit: '.... ...0 Optional Field Bit: False (iE-Extensions is NOT present)'
                                    ngap.sST: 'sST: 01'
                        Item 1:
                            ngap.AllowedNSSAI_Item_element:
                                per.extension_bit: '0... .... Extension Bit: False'
                                per.optional_field_bit: '.0.. .... Optional Field Bit: False (iE-Extensions is NOT present)'
                                ngap.s_NSSAI_element:
                                    per.extension_bit: '..0. .... Extension Bit: False'
                                    per.optional_field_bit: '.... 0... Optional Field Bit: False (iE-Extensions is NOT present)'
                                    ngap.sST: 'sST: 01'
            'Item 4: id-UESecurityCapabilities':
                ngap.id: 'id: id-UESecurityCapabilities (119)'
                per.enum_index: 'Enumerated Index: 0'
                ngap.criticality: 'criticality: reject (0)'
                per.open_type_length: 'Open Type Length: 9'
                ngap.value_element:
                    ngap.UESecurityCapabilities_element:
                        per.extension_bit: '0... .... Extension Bit: False'
                        per.optional_field_bit: '.0.. .... Optional Field Bit: False (iE-Extensions is NOT present)'
                        per.extension_present_bit: '.... .0.. Extension Present Bit: False'
                        ngap.nRencryptionAlgorithms:
                            ngap.NrencyptionAlgorithms.nea1: '1... .... .... .... = 128-NEA1: Supported'
                            ngap.NrencyptionAlgorithms.nea2: '.1.. .... .... .... = 128-NEA2: Supported'
                            ngap.NrencyptionAlgorithms.nea3: '..1. .... .... .... = 128-NEA3: Supported'
                            ngap.NrencyptionAlgorithms.reserved: '...0 0000 0000 0000 = Reserved: 0x0000'
                        ngap.nRintegrityProtectionAlgorithms:
                            ngap.NrintegrityProtectionAlgorithms.nia1: '1... .... .... .... = 128-NIA1: Supported'
                            ngap.NrintegrityProtectionAlgorithms.nia2: '.1.. .... .... .... = 128-NIA2: Supported'
                            ngap.NrintegrityProtectionAlgorithms.nia3: '..1. .... .... .... = 128-NIA3: Supported'
                            ngap.NrintegrityProtectionAlgorithms.reserved: '...0 0000 0000 0000 = Reserved: 0x0000'
                        ngap.eUTRAencryptionAlgorithms:
                            ngap.EUTRAencryptionAlgorithms.eea1: '1... .... .... .... = 128-EEA1: Supported'
                            ngap.EUTRAencryptionAlgorithms.eea2: '.1.. .... .... .... = 128-EEA2: Supported'
                            ngap.EUTRAencryptionAlgorithms.eea3: '..1. .... .... .... = 128-EEA3: Supported'
                            ngap.EUTRAencryptionAlgorithms.reserved: '...0 0000 0000 0000 = Reserved: 0x0000'
                        ngap.eUTRAintegrityProtectionAlgorithms:
                            ngap.EUTRAintegrityProtectionAlgorithms.eia1: '1... .... .... .... = 128-EIA1: Supported'
                            ngap.EUTRAintegrityProtectionAlgorithms.eia2: '.1.. .... .... .... = 128-EIA2: Supported'
                            ngap.EUTRAintegrityProtectionAlgorithms.eia3: '..1. .... .... .... = 128-EIA3: Supported'
                            ngap.EUTRAintegrityProtectionAlgorithms.reserved: '...0 0000 0000 0000 = Reserved: 0x0000'
            'Item 5: id-SecurityKey':
                ngap.id: 'id: id-SecurityKey (94)'
                per.enum_index: 'Enumerated Index: 0'
                ngap.criticality: 'criticality: reject (0)'
                per.open_type_length: 'Open Type Length: 32'
                ngap.value_element:
                    ngap.SecurityKey: 'SecurityKey: 6b638595678ad960c5d07509c1acebf99ad272743c01ef08\xe2\x80\xa6 [bit length 256]'
            'Item 6: id-MaskedIMEISV':
                ngap.id: 'id: id-MaskedIMEISV (34)'
                per.enum_index: 'Enumerated Index: 1'
                ngap.criticality: 'criticality: ignore (1)'
                per.open_type_length: 'Open Type Length: 8'
                ngap.value_element:
                    ngap.MaskedIMEISV: 'MaskedIMEISV: 4370816125ffff51 [bit length 64, 0100 0011  0111 0000  1000 0001  0110 0001  0010 0101  1111 1111  1111 1111  0101 0001 decimal value 4859526252182110033]'
            'Item 7: id-NAS-PDU':
                ngap.id: 'id: id-NAS-PDU (38)'
                per.enum_index: 'Enumerated Index: 1'
                ngap.criticality: 'criticality: ignore (1)'
                per.open_type_length: 'Open Type Length: 49'
                ngap.value_element:
                    per.octet_string_length: 'Octet String Length: 48'
                    ngap.NAS_PDU:
                        nas-5gs:
                            Security protected NAS 5GS message:
                                nas_5gs.epd: 'Extended protocol discriminator: 5G mobility management messages (126)'
                                nas_5gs.spare_half_octet: '0000 .... = Spare Half Octet: 0'
                                nas_5gs.security_header_type: '.... 0010 = Security header type: Integrity protected and ciphered (2)'
                                nas_5gs.msg_auth_code: 'Message authentication code: 0x870be7b0'
                                nas_5gs.seq_no: 'Sequence number: 1'
                            Plain NAS 5GS Message:
                                nas_5gs.epd: 'Extended protocol discriminator: 5G mobility management messages (126)'
                                nas_5gs.spare_half_octet: '0000 .... = Spare Half Octet: 0'
                                nas_5gs.security_header_type: '.... 0000 = Security header type: Plain NAS message, not security protected (0)'
                                nas_5gs.mm.message_type: 'Message type: Registration accept (0x42)'
                                5GS registration result:
                                    gsm_a.len: 'Length: 1'
                                    nas_5gs.mm.reg_res.nssaa_perf: '...0 .... = NSSAA Performed: False'
                                    nas_5gs.mm.reg_res.sms_all: '.... 0... = SMS over NAS: Not Allowed'
                                    nas_5gs.mm.reg_res.res: '.... .001 = 5GS registration result: 3GPP access (1)'
                                5GS mobile identity - 5G-GUTI:
                                    nas_5gs.mm.elem_id: 'Element ID: 0x77'
                                    gsm_a.len: 'Length: 11'
                                    nas_5gs.mm.odd_even: '.... 0... = Odd/even indication: Even number of identity digits'
                                    nas_5gs.mm.type_id: '.... .010 = Type of identity: 5G-GUTI (2)'
                                    e212.mcc: 'Mobile Country Code (MCC): International Mobile, shared code (901)'
                                    e212.mnc: 'Mobile Network Code (MNC): Unknown (70)'
                                    nas_5gs.amf_region_id: 'AMF Region ID: 2'
                                    nas_5gs.amf_set_id: '0000 0000 01.. .... = AMF Set ID: 1'
                                    nas_5gs.amf_pointer: '..00 0000 = AMF Pointer: 0'
                                    nas_5gs.5g_tmsi: '5G-TMSI: 0xdb00d986'
                                5GS tracking area identity list:
                                    nas_5gs.mm.elem_id: 'Element ID: 0x54'
                                    gsm_a.len: 'Length: 7'
                                    Partial tracking area list  1:
                                        nas_5gs.mm.tal_t_li: '.01. .... = Type of list: list of TACs belonging to one PLMN, with consecutive TAC values (1)'
                                        nas_5gs.mm.tal_num_e: '...0 0000 = Number of elements: 1 element (0)'
                                        e212.mcc: 'Mobile Country Code (MCC): International Mobile, shared code (901)'
                                        e212.mnc: 'Mobile Network Code (MNC): Unknown (70)'
                                        nas_5gs.tac: 'TAC: 1'
                                NSSAI - Allowed NSSAI:
                                    nas_5gs.mm.elem_id: 'Element ID: 0x15'
                                    gsm_a.len: 'Length: 4'
                                    S-NSSAI 1:
                                        nas_5gs.mm.length: 'Length: 1'
                                        nas_5gs.mm.sst: 'Slice/service type (SST): 1'
                                    S-NSSAI 2:
                                        nas_5gs.mm.length: 'Length: 1'
                                        nas_5gs.mm.sst: 'Slice/service type (SST): 1'
                                5GS network feature support:
                                    nas_5gs.mm.elem_id: 'Element ID: 0x21'
                                    gsm_a.len: 'Length: 2'
                                    nas_5gs.nw_feat_sup.mpsi: '0... .... = MPS indicator (MPSI): Access identity 1 not valid in RPLMN or equivalent PLMN'
                                    nas_5gs.nw_feat_sup.iwk_n26: '.0.. .... = Interworking without N26: Not supported'
                                    nas_5gs.nw_feat_sup.emf: '..00 .... = Emergency service fallback indicator (EMF): Emergency services fallback not supported (0)'
                                    nas_5gs.nw_feat_sup.emc: '.... 00.. = Emergency service support indicator (EMC): Emergency services not supported (0)'
                                    nas_5gs.nw_feat_sup.vops_n3gpp: '.... ..0. = IMS voice over PS session over non-3GPP access indicator (IMS-VoPS-N3GPP): Not supported'
                                    nas_5gs.nw_feat_sup.vops_3gpp: '.... ...1 = IMS voice over PS session indicator (IMS VoPS): Supported'
                                    nas_5gs.spare_b7: '0... .... = Spare: 0'
                                    nas_5gs.spare_b6: '.0.. .... = Spare: 0'
                                    nas_5gs.spare_b5: '..0. .... = Spare: 0'
                                    nas_5gs.spare_b4: '...0 .... = Spare: 0'
                                    nas_5gs.spare_b3: '.... 0... = Spare: 0'
                                    nas_5gs.spare_b2: '.... .0.. = Spare: 0'
                                    nas_5gs.nw_feat_sup.mcsi: '.... ..0. = MCS indicator (MCSI): Not supported'
                                    nas_5gs.nw_feat_sup.emcn3: '.... ...0 = Emergency services over non-3GPP access (EMCN3): Not supported'
                                GPRS Timer 3 - T3512 value:
                                    gsm_a.gm.elem_id: 'Element ID: 0x5e'
                                    gsm_a.len: 'Length: 1'
                                    gsm_a.gm.gmm.gprs_timer3:
                                        gsm_a.gm.gmm.gprs_timer3_unit: '001. .... = Unit: value is incremented in multiples of 1 hour (1)'
                                        gsm_a.gm.gmm.gprs_timer3_value: '...0 1001 = Timer value: 9'

end note

"10.0.2.15" -> "10.0.3.1": 1825, NGAP InitialContextSetup (14)

note right #c6ebc6
**10.0.2.15 to 10.0.3.1**
NGAP-PDU: 200e000f000002000a40020010005540020010
ngap.procedureCode: 'procedureCode: id-InitialContextSetup (14)'
per.enum_index: 'Enumerated Index: 0'
ngap.criticality: 'criticality: reject (0)'
per.open_type_length: 'Open Type Length: 15'
ngap.value_element:
-   ngap.InitialContextSetupResponse_element:
        per.extension_bit: '0... .... Extension Bit: False'
        per.sequence_of_length: 'Sequence-Of Length: 2'
        ngap.protocolIEs:
            'Item 0: id-AMF-UE-NGAP-ID':
                ngap.id: 'id: id-AMF-UE-NGAP-ID (10)'
                per.enum_index: 'Enumerated Index: 1'
                ngap.criticality: 'criticality: ignore (1)'
                per.open_type_length: 'Open Type Length: 2'
                ngap.value_element:
                    ngap.AMF_UE_NGAP_ID: 'AMF-UE-NGAP-ID: 16'
            'Item 1: id-RAN-UE-NGAP-ID':
                ngap.id: 'id: id-RAN-UE-NGAP-ID (85)'
                per.enum_index: 'Enumerated Index: 1'
                ngap.criticality: 'criticality: ignore (1)'
                per.open_type_length: 'Open Type Length: 2'
                ngap.value_element:
                    ngap.RAN_UE_NGAP_ID: 'RAN-UE-NGAP-ID: 16'

end note

"10.0.2.15" -> "10.0.3.1": 1829, NGAP UplinkNASTransport (46),\nNAS Registration complete (0x43)

note right #c6ebc6
**10.0.2.15 to 10.0.3.1**
NGAP-PDU: 002e4035000004000a000200100055000200100026000b0a7e027675cbab017e0043007940135009f107000000010009f107000001e74c1db5
ngap.procedureCode: 'procedureCode: id-UplinkNASTransport (46)'
per.enum_index: 'Enumerated Index: 1'
ngap.criticality: 'criticality: ignore (1)'
per.open_type_length: 'Open Type Length: 53'
ngap.value_element:
-   ngap.UplinkNASTransport_element:
        per.extension_bit: '0... .... Extension Bit: False'
        per.sequence_of_length: 'Sequence-Of Length: 4'
        ngap.protocolIEs:
            'Item 0: id-AMF-UE-NGAP-ID':
                ngap.id: 'id: id-AMF-UE-NGAP-ID (10)'
                per.enum_index: 'Enumerated Index: 0'
                ngap.criticality: 'criticality: reject (0)'
                per.open_type_length: 'Open Type Length: 2'
                ngap.value_element:
                    ngap.AMF_UE_NGAP_ID: 'AMF-UE-NGAP-ID: 16'
            'Item 1: id-RAN-UE-NGAP-ID':
                ngap.id: 'id: id-RAN-UE-NGAP-ID (85)'
                per.enum_index: 'Enumerated Index: 0'
                ngap.criticality: 'criticality: reject (0)'
                per.open_type_length: 'Open Type Length: 2'
                ngap.value_element:
                    ngap.RAN_UE_NGAP_ID: 'RAN-UE-NGAP-ID: 16'
            'Item 2: id-NAS-PDU':
                ngap.id: 'id: id-NAS-PDU (38)'
                per.enum_index: 'Enumerated Index: 0'
                ngap.criticality: 'criticality: reject (0)'
                per.open_type_length: 'Open Type Length: 11'
                ngap.value_element:
                    per.octet_string_length: 'Octet String Length: 10'
                    ngap.NAS_PDU:
                        nas-5gs:
                            Security protected NAS 5GS message:
                                nas_5gs.epd: 'Extended protocol discriminator: 5G mobility management messages (126)'
                                nas_5gs.spare_half_octet: '0000 .... = Spare Half Octet: 0'
                                nas_5gs.security_header_type: '.... 0010 = Security header type: Integrity protected and ciphered (2)'
                                nas_5gs.msg_auth_code: 'Message authentication code: 0x7675cbab'
                                nas_5gs.seq_no: 'Sequence number: 1'
                            Plain NAS 5GS Message:
                                nas_5gs.epd: 'Extended protocol discriminator: 5G mobility management messages (126)'
                                nas_5gs.spare_half_octet: '0000 .... = Spare Half Octet: 0'
                                nas_5gs.security_header_type: '.... 0000 = Security header type: Plain NAS message, not security protected (0)'
                                nas_5gs.mm.message_type: 'Message type: Registration complete (0x43)'
            'Item 3: id-UserLocationInformation':
                ngap.id: 'id: id-UserLocationInformation (121)'
                per.enum_index: 'Enumerated Index: 1'
                ngap.criticality: 'criticality: ignore (1)'
                per.open_type_length: 'Open Type Length: 19'
                ngap.value_element:
                    per.choice_index: 'Choice Index: 1'
                    ngap.UserLocationInformation:
                        ngap.userLocationInformationNR_element:
                            per.extension_bit: '..0. .... Extension Bit: False'
                            per.optional_field_bit: '.... 0... Optional Field Bit: False (iE-Extensions is NOT present)'
                            ngap.nR_CGI_element:
                                per.extension_bit: '.... .0.. Extension Bit: False'
                                per.optional_field_bit: '.... ..0. Optional Field Bit: False (iE-Extensions is NOT present)'
                                ngap.pLMNIdentity:
                                    e212.mcc: 'Mobile Country Code (MCC): International Mobile, shared code (901)'
                                    e212.mnc: 'Mobile Network Code (MNC): Unknown (70)'
                                ngap.NRCellIdentity: 'nRCellIdentity: 0x0000000010'
                            ngap.tAI_element:
                                per.extension_bit: '.... 0... Extension Bit: False'
                                per.optional_field_bit: '.... .0.. Optional Field Bit: False (iE-Extensions is NOT present)'
                                ngap.pLMNIdentity:
                                    e212.mcc: 'Mobile Country Code (MCC): International Mobile, shared code (901)'
                                    e212.mnc: 'Mobile Network Code (MNC): Unknown (70)'
                                ngap.tAC: 'tAC: 1 (0x000001)'
                            ngap.timeStamp: 'timeStamp: e74c1db5 (Dec 20, 2022 11:40:37 UTC)'

end note

"10.0.3.1" -> "10.0.2.15": 1830, NGAP DownlinkNASTransport (4),\nNAS Configuration update command (0x54)

note right #c6ebc6
**10.0.3.1 to 10.0.2.15**
NGAP-PDU: 0004403c000003000a0002001000550002001000260029287e02687035dd027e0054430f90004f00700065006e00350047005346404722219261603440490100
ngap.procedureCode: 'procedureCode: id-DownlinkNASTransport (4)'
per.enum_index: 'Enumerated Index: 1'
ngap.criticality: 'criticality: ignore (1)'
per.open_type_length: 'Open Type Length: 60'
ngap.value_element:
-   ngap.DownlinkNASTransport_element:
        per.extension_bit: '0... .... Extension Bit: False'
        per.sequence_of_length: 'Sequence-Of Length: 3'
        ngap.protocolIEs:
            'Item 0: id-AMF-UE-NGAP-ID':
                ngap.id: 'id: id-AMF-UE-NGAP-ID (10)'
                per.enum_index: 'Enumerated Index: 0'
                ngap.criticality: 'criticality: reject (0)'
                per.open_type_length: 'Open Type Length: 2'
                ngap.value_element:
                    ngap.AMF_UE_NGAP_ID: 'AMF-UE-NGAP-ID: 16'
            'Item 1: id-RAN-UE-NGAP-ID':
                ngap.id: 'id: id-RAN-UE-NGAP-ID (85)'
                per.enum_index: 'Enumerated Index: 0'
                ngap.criticality: 'criticality: reject (0)'
                per.open_type_length: 'Open Type Length: 2'
                ngap.value_element:
                    ngap.RAN_UE_NGAP_ID: 'RAN-UE-NGAP-ID: 16'
            'Item 2: id-NAS-PDU':
                ngap.id: 'id: id-NAS-PDU (38)'
                per.enum_index: 'Enumerated Index: 0'
                ngap.criticality: 'criticality: reject (0)'
                per.open_type_length: 'Open Type Length: 41'
                ngap.value_element:
                    per.octet_string_length: 'Octet String Length: 40'
                    ngap.NAS_PDU:
                        nas-5gs:
                            Security protected NAS 5GS message:
                                nas_5gs.epd: 'Extended protocol discriminator: 5G mobility management messages (126)'
                                nas_5gs.spare_half_octet: '0000 .... = Spare Half Octet: 0'
                                nas_5gs.security_header_type: '.... 0010 = Security header type: Integrity protected and ciphered (2)'
                                nas_5gs.msg_auth_code: 'Message authentication code: 0x687035dd'
                                nas_5gs.seq_no: 'Sequence number: 2'
                            Plain NAS 5GS Message:
                                nas_5gs.epd: 'Extended protocol discriminator: 5G mobility management messages (126)'
                                nas_5gs.spare_half_octet: '0000 .... = Spare Half Octet: 0'
                                nas_5gs.security_header_type: '.... 0000 = Security header type: Plain NAS message, not security protected (0)'
                                nas_5gs.mm.message_type: 'Message type: Configuration update command (0x54)'
                                Network Name - Full name for network:
                                    gsm_a.dtap.elem_id: 'Element ID: 0x43'
                                    gsm_a.len: 'Length: 15'
                                    gsm_a.extension: '1... .... = Extension: No Extension'
                                    gsm_a.dtap.coding_scheme: '.001 .... = Coding Scheme: UCS2 (16 bit) (1)'
                                    gsm_a.dtap.add_ci: '.... 0... = Add CI: The MS should not add the letters for the Country''s Initials to the text string'
                                    gsm_a.dtap.number_of_spare_bits: '.... .000 = Number of spare bits in last octet: this field carries no information about the number of spare bits in octet n (0)'
                                    gsm_a.dtap.text_string: 'Text String: Open5GS'
                                Time Zone - Local:
                                    gsm_a.dtap.elem_id: 'Element ID: 0x46'
                                    gsm_a.dtap.timezone: 'Timezone: GMT + 1 hours 0 minutes'
                                Time Zone and Time - Universal Time and Local Time Zone:
                                    gsm_a.dtap.elem_id: 'Element ID: 0x47'
                                    gsm_a.dtap.time_zone_time: 'Time: Dec 29, 2022 16:06:43.000000000'
                                    gsm_a.dtap.timezone: 'Timezone: GMT + 1 hours 0 minutes'
                                Daylight Saving Time:
                                    gsm_a.dtap.elem_id: 'Element ID: 0x49'
                                    gsm_a.len: 'Length: 1'
                                    gsm_a.spare_bits: '0000 00.. = Spare bit(s): 0'
                                    gsm_a.dtap.dst_adjustment: '.... ..00 = DST Adjustment: No adjustment for Daylight Saving Time (0)'

end note

"10.0.14.1" -> "10.0.17.1": 1911, PFCP req.\nPFCP Session Modification Request (52)

note right #80b3ff
**10.0.14.1 to 10.0.17.1**
pfcp.flags:
-   pfcp.version: '001. .... = Version: 1'
    pfcp.spare_b4: '...0 .... = Spare: 0'
    pfcp.spare_b3: '.... 0... = Spare: 0'
    pfcp.spare_b2: '.... .0.. = Spare: 0'
    pfcp.mp_flag: '.... ..0. = Message Priority (MP): False'
    pfcp.s: '.... ...1 = SEID (S): True'
pfcp.msg_type: 'Message Type: PFCP Session Modification Request (52)'
pfcp.length: 'Length: 35'
pfcp.seid: 'SEID: 0x0000000000000007'
pfcp.seqno: 'Sequence Number: 222'
pfcp.spare_oct: 'Spare: 0'
'Update FAR : [Grouped IE]':
-   pfcp.ie_type: 'IE Type: Update FAR (10)'
    pfcp.ie_len: 'IE Length: 19'
    'FAR ID : Dynamic by CP 1':
        pfcp.ie_type: 'IE Type: FAR ID (108)'
        pfcp.ie_len: 'IE Length: 4'
        pfcp.far_id_flg: '0... .... .... .... .... .... .... .... = Allocation type: Dynamic by CP'
        pfcp.far_id: '.000 0000 0000 0000 0000 0000 0000 0001 = FAR ID: 1'
    'Apply Action : ':
        pfcp.ie_type: 'IE Type: Apply Action (44)'
        pfcp.ie_len: 'IE Length: 2'
        pfcp.apply_action_flags:
            pfcp.spare_b7_b5: '000. .... = Spare: 0'
            pfcp.apply_action.dupl: '...0 .... = DUPL (Duplicate): False'
            pfcp.apply_action.nocp: '.... 1... = NOCP (Notify the CP function): True'
            pfcp.apply_action.buff: '.... .1.. = BUFF (Buffer): True'
            pfcp.apply_action.forw: '.... ..0. = FORW (Forward): False'
            pfcp.apply_action.drop: '.... ...0 = DROP (Drop): False'
        IE data not decoded by WS yet:
            _ws.expert:
                pfcp.ie_data_not_decoded: IE data not decoded by WS yet
                _ws.expert.message: 'Message: IE data not decoded by WS yet'
                _ws.expert.severity: 'Severity level: Note'
                _ws.expert.group: 'Group: Undecoded'
    'BAR ID : 1':
        pfcp.ie_type: 'IE Type: BAR ID (88)'
        pfcp.ie_len: 'IE Length: 1'
        pfcp.bar_id: 'BAR ID: 1'
pfcp.response_in: 'Response In: 1913'

end note

"10.0.14.1" -> "10.0.17.1": 1912, PFCP req.\nPFCP Session Modification Request (52)

note right #80b3ff
**10.0.14.1 to 10.0.17.1**
pfcp.flags:
-   pfcp.version: '001. .... = Version: 1'
    pfcp.spare_b4: '...0 .... = Spare: 0'
    pfcp.spare_b3: '.... 0... = Spare: 0'
    pfcp.spare_b2: '.... .0.. = Spare: 0'
    pfcp.mp_flag: '.... ..0. = Message Priority (MP): False'
    pfcp.s: '.... ...1 = SEID (S): True'
pfcp.msg_type: 'Message Type: PFCP Session Modification Request (52)'
pfcp.length: 'Length: 35'
pfcp.seid: 'SEID: 0x0000000000000008'
pfcp.seqno: 'Sequence Number: 223'
pfcp.spare_oct: 'Spare: 0'
'Update FAR : [Grouped IE]':
-   pfcp.ie_type: 'IE Type: Update FAR (10)'
    pfcp.ie_len: 'IE Length: 19'
    'FAR ID : Dynamic by CP 1':
        pfcp.ie_type: 'IE Type: FAR ID (108)'
        pfcp.ie_len: 'IE Length: 4'
        pfcp.far_id_flg: '0... .... .... .... .... .... .... .... = Allocation type: Dynamic by CP'
        pfcp.far_id: '.000 0000 0000 0000 0000 0000 0000 0001 = FAR ID: 1'
    'Apply Action : ':
        pfcp.ie_type: 'IE Type: Apply Action (44)'
        pfcp.ie_len: 'IE Length: 2'
        pfcp.apply_action_flags:
            pfcp.spare_b7_b5: '000. .... = Spare: 0'
            pfcp.apply_action.dupl: '...0 .... = DUPL (Duplicate): False'
            pfcp.apply_action.nocp: '.... 1... = NOCP (Notify the CP function): True'
            pfcp.apply_action.buff: '.... .1.. = BUFF (Buffer): True'
            pfcp.apply_action.forw: '.... ..0. = FORW (Forward): False'
            pfcp.apply_action.drop: '.... ...0 = DROP (Drop): False'
        IE data not decoded by WS yet:
            _ws.expert:
                pfcp.ie_data_not_decoded: IE data not decoded by WS yet
                _ws.expert.message: 'Message: IE data not decoded by WS yet'
                _ws.expert.severity: 'Severity level: Note'
                _ws.expert.group: 'Group: Undecoded'
    'BAR ID : 1':
        pfcp.ie_type: 'IE Type: BAR ID (88)'
        pfcp.ie_len: 'IE Length: 1'
        pfcp.bar_id: 'BAR ID: 1'
pfcp.response_in: 'Response In: 1914'

end note

"10.0.17.1" -> "10.0.14.1": 1913, PFCP rsp.\nPFCP Session Modification Response (53)

note right #cce0ff
**10.0.17.1 to 10.0.14.1**
pfcp.flags:
-   pfcp.version: '001. .... = Version: 1'
    pfcp.spare_b4: '...0 .... = Spare: 0'
    pfcp.spare_b3: '.... 0... = Spare: 0'
    pfcp.spare_b2: '.... .0.. = Spare: 0'
    pfcp.mp_flag: '.... ..0. = Message Priority (MP): False'
    pfcp.s: '.... ...1 = SEID (S): True'
pfcp.msg_type: 'Message Type: PFCP Session Modification Response (53)'
pfcp.length: 'Length: 17'
pfcp.seid: 'SEID: 0x0000000000000007'
pfcp.seqno: 'Sequence Number: 222'
pfcp.spare_oct: 'Spare: 0'
'Cause : Request accepted(success)':
-   pfcp.ie_type: 'IE Type: Cause (19)'
    pfcp.ie_len: 'IE Length: 1'
    pfcp.cause: 'Cause: Request accepted(success) (1)'
pfcp.response_to: 'Response To: 1911'
pfcp.response_time: 'Response Time: 0.000172332 seconds'

end note

"10.0.17.1" -> "10.0.14.1": 1914, PFCP rsp.\nPFCP Session Modification Response (53)

note right #cce0ff
**10.0.17.1 to 10.0.14.1**
pfcp.flags:
-   pfcp.version: '001. .... = Version: 1'
    pfcp.spare_b4: '...0 .... = Spare: 0'
    pfcp.spare_b3: '.... 0... = Spare: 0'
    pfcp.spare_b2: '.... .0.. = Spare: 0'
    pfcp.mp_flag: '.... ..0. = Message Priority (MP): False'
    pfcp.s: '.... ...1 = SEID (S): True'
pfcp.msg_type: 'Message Type: PFCP Session Modification Response (53)'
pfcp.length: 'Length: 17'
pfcp.seid: 'SEID: 0x0000000000000008'
pfcp.seqno: 'Sequence Number: 223'
pfcp.spare_oct: 'Spare: 0'
'Cause : Request accepted(success)':
-   pfcp.ie_type: 'IE Type: Cause (19)'
    pfcp.ie_len: 'IE Length: 1'
    pfcp.cause: 'Cause: Request accepted(success) (1)'
pfcp.response_to: 'Response To: 1912'
pfcp.response_time: 'Response Time: 0.000131243 seconds'

end note

"10.0.2.15" -> "10.0.3.1": 1999, NGAP NGSetup (21)

note right #c6ebc6
**10.0.2.15 to 10.0.3.1**
NGAP-PDU: 00150041000004001b00090009f1075000000001005240170a00554552414e53494d2d676e622d3930312d37302d310066000d00000000010009f107000000080015400140
ngap.procedureCode: 'procedureCode: id-NGSetup (21)'
per.enum_index: 'Enumerated Index: 0'
ngap.criticality: 'criticality: reject (0)'
per.open_type_length: 'Open Type Length: 65'
ngap.value_element:
-   ngap.NGSetupRequest_element:
        per.extension_bit: '0... .... Extension Bit: False'
        per.sequence_of_length: 'Sequence-Of Length: 4'
        ngap.protocolIEs:
            'Item 0: id-GlobalRANNodeID':
                ngap.id: 'id: id-GlobalRANNodeID (27)'
                per.enum_index: 'Enumerated Index: 0'
                ngap.criticality: 'criticality: reject (0)'
                per.open_type_length: 'Open Type Length: 9'
                ngap.value_element:
                    per.choice_index: 'Choice Index: 0'
                    ngap.GlobalRANNodeID:
                        ngap.globalGNB_ID_element:
                            per.extension_bit: '..0. .... Extension Bit: False'
                            per.optional_field_bit: '...0 .... Optional Field Bit: False (iE-Extensions is NOT present)'
                            ngap.pLMNIdentity:
                                e212.mcc: 'Mobile Country Code (MCC): International Mobile, shared code (901)'
                                e212.mnc: 'Mobile Network Code (MNC): Unknown (70)'
                            per.choice_index: 'Choice Index: 0'
                            ngap.gNB_ID:
                                per.bit_string_length: 'Bit String Length: 32'
                                ngap.gNB_ID: 'gNB-ID: 00000001 [bit length 32, 0000 0000  0000 0000  0000 0000  0000 0001 decimal value 1]'
            'Item 1: id-RANNodeName':
                ngap.id: 'id: id-RANNodeName (82)'
                per.enum_index: 'Enumerated Index: 1'
                ngap.criticality: 'criticality: ignore (1)'
                per.open_type_length: 'Open Type Length: 23'
                ngap.value_element:
                    per.extension_present_bit: '0... .... Extension Present Bit: False'
                    per.octet_string_length: 'Octet String Length: 21'
                    ngap.RANNodeName: 'RANNodeName: UERANSIM-gnb-901-70-1'
            'Item 2: id-SupportedTAList':
                ngap.id: 'id: id-SupportedTAList (102)'
                per.enum_index: 'Enumerated Index: 0'
                ngap.criticality: 'criticality: reject (0)'
                per.open_type_length: 'Open Type Length: 13'
                ngap.value_element:
                    per.sequence_of_length: 'Sequence-Of Length: 1'
                    ngap.SupportedTAList:
                        Item 0:
                            ngap.SupportedTAItem_element:
                                per.extension_bit: '0... .... Extension Bit: False'
                                per.optional_field_bit: '.0.. .... Optional Field Bit: False (iE-Extensions is NOT present)'
                                ngap.tAC: 'tAC: 1 (0x000001)'
                                per.sequence_of_length: 'Sequence-Of Length: 1'
                                ngap.broadcastPLMNList:
                                    Item 0:
                                        ngap.BroadcastPLMNItem_element:
                                            per.extension_bit: '.... 0... Extension Bit: False'
                                            per.optional_field_bit: '.... .0.. Optional Field Bit: False (iE-Extensions is NOT present)'
                                            ngap.pLMNIdentity:
                                                e212.mcc: 'Mobile Country Code (MCC): International Mobile, shared code (901)'
                                                e212.mnc: 'Mobile Network Code (MNC): Unknown (70)'
                                            per.sequence_of_length: 'Sequence-Of Length: 1'
                                            ngap.tAISliceSupportList:
                                                Item 0:
                                                    ngap.SliceSupportItem_element:
                                                        per.extension_bit: '0... .... Extension Bit: False'
                                                        per.optional_field_bit: '.0.. .... Optional Field Bit: False (iE-Extensions is NOT present)'
                                                        ngap.s_NSSAI_element:
                                                            per.extension_bit: '..0. .... Extension Bit: False'
                                                            per.optional_field_bit: '.... 0... Optional Field Bit: False (iE-Extensions is NOT present)'
                                                            ngap.sST: 'sST: 01'
            'Item 3: id-DefaultPagingDRX':
                ngap.id: 'id: id-DefaultPagingDRX (21)'
                per.enum_index: 'Enumerated Index: 1'
                ngap.criticality: 'criticality: ignore (1)'
                per.open_type_length: 'Open Type Length: 1'
                ngap.value_element:
                    per.extension_present_bit: '0... .... Extension Present Bit: False'
                    per.enum_index: 'Enumerated Index: 2'
                    ngap.PagingDRX: 'PagingDRX: v128 (2)'

end note

"10.0.3.1" -> "10.0.2.15": 2001, NGAP NGSetup (21)

note right #c6ebc6
**10.0.3.1 to 10.0.2.15**
NGAP-PDU: 201500320000040001000e05806f70656e3567732d616d663000600008000009f10702004000564001ff005000080009f10700000008
ngap.procedureCode: 'procedureCode: id-NGSetup (21)'
per.enum_index: 'Enumerated Index: 0'
ngap.criticality: 'criticality: reject (0)'
per.open_type_length: 'Open Type Length: 50'
ngap.value_element:
-   ngap.NGSetupResponse_element:
        per.extension_bit: '0... .... Extension Bit: False'
        per.sequence_of_length: 'Sequence-Of Length: 4'
        ngap.protocolIEs:
            'Item 0: id-AMFName':
                ngap.id: 'id: id-AMFName (1)'
                per.enum_index: 'Enumerated Index: 0'
                ngap.criticality: 'criticality: reject (0)'
                per.open_type_length: 'Open Type Length: 14'
                ngap.value_element:
                    per.extension_present_bit: '0... .... Extension Present Bit: False'
                    per.octet_string_length: 'Octet String Length: 12'
                    ngap.AMFName: 'AMFName: open5gs-amf0'
            'Item 1: id-ServedGUAMIList':
                ngap.id: 'id: id-ServedGUAMIList (96)'
                per.enum_index: 'Enumerated Index: 0'
                ngap.criticality: 'criticality: reject (0)'
                per.open_type_length: 'Open Type Length: 8'
                ngap.value_element:
                    per.sequence_of_length: 'Sequence-Of Length: 1'
                    ngap.ServedGUAMIList:
                        Item 0:
                            ngap.ServedGUAMIItem_element:
                                per.extension_bit: '0... .... Extension Bit: False'
                                per.optional_field_bit: '..0. .... Optional Field Bit: False (iE-Extensions is NOT present)'
                                ngap.gUAMI_element:
                                    per.extension_bit: '...0 .... Extension Bit: False'
                                    per.optional_field_bit: '.... 0... Optional Field Bit: False (iE-Extensions is NOT present)'
                                    ngap.pLMNIdentity:
                                        e212.mcc: 'Mobile Country Code (MCC): International Mobile, shared code (901)'
                                        e212.mnc: 'Mobile Network Code (MNC): Unknown (70)'
                                    ngap.aMFRegionID: 'aMFRegionID: 02 [bit length 8, 0000 0010 decimal value 2]'
                                    ngap.aMFSetID: 'aMFSetID: 0040 [bit length 10, 6 LSB pad bits, 0000 0000  01.. .... decimal value 1]'
                                    ngap.aMFPointer: 'aMFPointer: 00 [bit length 6, 2 LSB pad bits, 0000 00.. decimal value 0]'
            'Item 2: id-RelativeAMFCapacity':
                ngap.id: 'id: id-RelativeAMFCapacity (86)'
                per.enum_index: 'Enumerated Index: 1'
                ngap.criticality: 'criticality: ignore (1)'
                per.open_type_length: 'Open Type Length: 1'
                ngap.value_element:
                    ngap.RelativeAMFCapacity: 'RelativeAMFCapacity: 255'
            'Item 3: id-PLMNSupportList':
                ngap.id: 'id: id-PLMNSupportList (80)'
                per.enum_index: 'Enumerated Index: 0'
                ngap.criticality: 'criticality: reject (0)'
                per.open_type_length: 'Open Type Length: 8'
                ngap.value_element:
                    per.sequence_of_length: 'Sequence-Of Length: 1'
                    ngap.PLMNSupportList:
                        Item 0:
                            ngap.PLMNSupportItem_element:
                                per.extension_bit: '.... 0... Extension Bit: False'
                                per.optional_field_bit: '.... .0.. Optional Field Bit: False (iE-Extensions is NOT present)'
                                ngap.pLMNIdentity:
                                    e212.mcc: 'Mobile Country Code (MCC): International Mobile, shared code (901)'
                                    e212.mnc: 'Mobile Network Code (MNC): Unknown (70)'
                                per.sequence_of_length: 'Sequence-Of Length: 1'
                                ngap.sliceSupportList:
                                    Item 0:
                                        ngap.SliceSupportItem_element:
                                            per.extension_bit: '0... .... Extension Bit: False'
                                            per.optional_field_bit: '.0.. .... Optional Field Bit: False (iE-Extensions is NOT present)'
                                            ngap.s_NSSAI_element:
                                                per.extension_bit: '..0. .... Extension Bit: False'
                                                per.optional_field_bit: '.... 0... Optional Field Bit: False (iE-Extensions is NOT present)'
                                                ngap.sST: 'sST: 01'

end note

"10.0.2.15" -> "10.0.3.1": 2060, NGAP InitialUEMessage (15),\nNAS Registration request (0x41)

note right #8cd98c
**10.0.2.15 to 10.0.3.1**
NGAP-PDU: 000f40480000050055000200010026001a197e004179000d0109f1070000000000000000102e04f0f0f0f0007900135009f107000000010009f107000001e74c1dcf005a4001180070400100
ngap.procedureCode: 'procedureCode: id-InitialUEMessage (15)'
per.enum_index: 'Enumerated Index: 1'
ngap.criticality: 'criticality: ignore (1)'
per.open_type_length: 'Open Type Length: 72'
ngap.value_element:
-   ngap.InitialUEMessage_element:
        per.extension_bit: '0... .... Extension Bit: False'
        per.sequence_of_length: 'Sequence-Of Length: 5'
        ngap.protocolIEs:
            'Item 0: id-RAN-UE-NGAP-ID':
                ngap.id: 'id: id-RAN-UE-NGAP-ID (85)'
                per.enum_index: 'Enumerated Index: 0'
                ngap.criticality: 'criticality: reject (0)'
                per.open_type_length: 'Open Type Length: 2'
                ngap.value_element:
                    ngap.RAN_UE_NGAP_ID: 'RAN-UE-NGAP-ID: 1'
            'Item 1: id-NAS-PDU':
                ngap.id: 'id: id-NAS-PDU (38)'
                per.enum_index: 'Enumerated Index: 0'
                ngap.criticality: 'criticality: reject (0)'
                per.open_type_length: 'Open Type Length: 26'
                ngap.value_element:
                    per.octet_string_length: 'Octet String Length: 25'
                    ngap.NAS_PDU:
                        nas-5gs:
                            Plain NAS 5GS Message:
                                nas_5gs.epd: 'Extended protocol discriminator: 5G mobility management messages (126)'
                                nas_5gs.spare_half_octet: '0000 .... = Spare Half Octet: 0'
                                nas_5gs.security_header_type: '.... 0000 = Security header type: Plain NAS message, not security protected (0)'
                                nas_5gs.mm.message_type: 'Message type: Registration request (0x41)'
                                5GS registration type:
                                    nas_5gs.mm.for: '.... 1... = Follow-On Request bit (FOR): Follow-on request pending'
                                    nas_5gs.mm.5gs_reg_type: '.... .001 = 5GS registration type: initial registration (1)'
                                NAS key set identifier:
                                    nas_5gs.mm.tsc.h1: '0... .... = Type of security context flag (TSC): Native security context (for KSIAMF)'
                                    nas_5gs.mm.nas_key_set_id.h1: '.111 .... = NAS key set identifier: 7'
                                5GS mobile identity:
                                    gsm_a.len: 'Length: 13'
                                    nas_5gs.spare_b7: '0... .... = Spare: 0'
                                    nas_5gs.mm.suci.supi_fmt: '.000 .... = SUPI format: IMSI (0)'
                                    nas_5gs.spare_b3: '.... 0... = Spare: 0'
                                    nas_5gs.mm.type_id: '.... .001 = Type of identity: SUCI (1)'
                                    e212.mcc: 'Mobile Country Code (MCC): International Mobile, shared code (901)'
                                    e212.mnc: 'Mobile Network Code (MNC): Unknown (70)'
                                    nas_5gs.mm.suci.routing_indicator: 'Routing indicator: 0000'
                                    nas_5gs.mm.suci.scheme_id: '.... 0000 = Protection scheme Id: NULL scheme (0)'
                                    nas_5gs.mm.suci.pki: 'Home network public key identifier: 0'
                                    nas_5gs.mm.suci.supi_null_scheme: 'Scheme output: 0000000001'
                                UE security capability:
                                    nas_5gs.mm.elem_id: 'Element ID: 0x2e'
                                    gsm_a.len: 'Length: 4'
                                    nas_5gs.mm.5g_ea0: '1... .... = 5G-EA0: Supported'
                                    nas_5gs.mm.128_5g_ea1: '.1.. .... = 128-5G-EA1: Supported'
                                    nas_5gs.mm.128_5g_ea2: '..1. .... = 128-5G-EA2: Supported'
                                    nas_5gs.mm.128_5g_ea3: '...1 .... = 128-5G-EA3: Supported'
                                    nas_5gs.mm.5g_ea4: '.... 0... = 5G-EA4: Not supported'
                                    nas_5gs.mm.5g_ea5: '.... .0.. = 5G-EA5: Not supported'
                                    nas_5gs.mm.5g_ea6: '.... ..0. = 5G-EA6: Not supported'
                                    nas_5gs.mm.5g_ea7: '.... ...0 = 5G-EA7: Not supported'
                                    nas_5gs.mm.ia0: '1... .... = 5G-IA0: Supported'
                                    nas_5gs.mm.5g_128_ia1: '.1.. .... = 128-5G-IA1: Supported'
                                    nas_5gs.mm.5g_128_ia2: '..1. .... = 128-5G-IA2: Supported'
                                    nas_5gs.mm.5g_128_ia4: '.... 0... = 5G-IA4: Not supported'
                                    nas_5gs.mm.5g_ia5: '.... .0.. = 5G-IA5: Not supported'
                                    nas_5gs.mm.5g_ia6: '.... ..0. = 5G-IA6: Not supported'
                                    nas_5gs.mm.5g_ia7: '.... ...0 = 5G-IA7: Not supported'
                                    nas_5gs.mm.eea0: '1... .... = EEA0: Supported'
                                    nas_5gs.mm.128eea1: '.1.. .... = 128-EEA1: Supported'
                                    nas_5gs.mm.128eea2: '..1. .... = 128-EEA2: Supported'
                                    nas_5gs.mm.eea3: '...1 .... = 128-EEA3: Supported'
                                    nas_5gs.mm.eea4: '.... 0... = EEA4: Not supported'
                                    nas_5gs.mm.eea5: '.... .0.. = EEA5: Not supported'
                                    nas_5gs.mm.eea6: '.... ..0. = EEA6: Not supported'
                                    nas_5gs.mm.eea7: '.... ...0 = EEA7: Not supported'
                                    nas_5gs.mm.eia0: '1... .... = EIA0: Supported'
                                    nas_5gs.mm.128eia1: '.1.. .... = 128-EIA1: Supported'
                                    nas_5gs.mm.128eia2: '..1. .... = 128-EIA2: Supported'
                                    nas_5gs.mm.eia3: '...1 .... = 128-EIA3: Supported'
                                    nas_5gs.mm.eia4: '.... 0... = EIA4: Not supported'
                                    nas_5gs.mm.eia5: '.... .0.. = EIA5: Not supported'
                                    nas_5gs.mm.eia6: '.... ..0. = EIA6: Not supported'
                                    nas_5gs.mm.eia7: '.... ...0 = EIA7: Not supported'
            'Item 2: id-UserLocationInformation':
                ngap.id: 'id: id-UserLocationInformation (121)'
                per.enum_index: 'Enumerated Index: 0'
                ngap.criticality: 'criticality: reject (0)'
                per.open_type_length: 'Open Type Length: 19'
                ngap.value_element:
                    per.choice_index: 'Choice Index: 1'
                    ngap.UserLocationInformation:
                        ngap.userLocationInformationNR_element:
                            per.extension_bit: '..0. .... Extension Bit: False'
                            per.optional_field_bit: '.... 0... Optional Field Bit: False (iE-Extensions is NOT present)'
                            ngap.nR_CGI_element:
                                per.extension_bit: '.... .0.. Extension Bit: False'
                                per.optional_field_bit: '.... ..0. Optional Field Bit: False (iE-Extensions is NOT present)'
                                ngap.pLMNIdentity:
                                    e212.mcc: 'Mobile Country Code (MCC): International Mobile, shared code (901)'
                                    e212.mnc: 'Mobile Network Code (MNC): Unknown (70)'
                                ngap.NRCellIdentity: 'nRCellIdentity: 0x0000000010'
                            ngap.tAI_element:
                                per.extension_bit: '.... 0... Extension Bit: False'
                                per.optional_field_bit: '.... .0.. Optional Field Bit: False (iE-Extensions is NOT present)'
                                ngap.pLMNIdentity:
                                    e212.mcc: 'Mobile Country Code (MCC): International Mobile, shared code (901)'
                                    e212.mnc: 'Mobile Network Code (MNC): Unknown (70)'
                                ngap.tAC: 'tAC: 1 (0x000001)'
                            ngap.timeStamp: 'timeStamp: e74c1dcf (Dec 20, 2022 11:41:03 UTC)'
            'Item 3: id-RRCEstablishmentCause':
                ngap.id: 'id: id-RRCEstablishmentCause (90)'
                per.enum_index: 'Enumerated Index: 1'
                ngap.criticality: 'criticality: ignore (1)'
                per.open_type_length: 'Open Type Length: 1'
                ngap.value_element:
                    per.extension_present_bit: '0... .... Extension Present Bit: False'
                    per.enum_index: 'Enumerated Index: 3'
                    ngap.RRCEstablishmentCause: 'RRCEstablishmentCause: mo-Signalling (3)'
            'Item 4: id-UEContextRequest':
                ngap.id: 'id: id-UEContextRequest (112)'
                per.enum_index: 'Enumerated Index: 1'
                ngap.criticality: 'criticality: ignore (1)'
                per.open_type_length: 'Open Type Length: 1'
                ngap.value_element:
                    per.extension_present_bit: '0... .... Extension Present Bit: False'
                    per.enum_index: 'Enumerated Index: 0'
                    ngap.UEContextRequest: 'UEContextRequest: requested (0)'

end note

"10.0.3.1" -> "10.0.2.15": 2082, NGAP DownlinkNASTransport (4),\nNAS Authentication request (0x56)

note right #8cd98c
**10.0.3.1 to 10.0.2.15**
NGAP-PDU: 0004403e000003000a000200110055000200010026002b2a7e005604020000217cb689ab0e20ea67119a765fe57eaf8e20101ce01a20defc80009fed2bf5b34e67ae
ngap.procedureCode: 'procedureCode: id-DownlinkNASTransport (4)'
per.enum_index: 'Enumerated Index: 1'
ngap.criticality: 'criticality: ignore (1)'
per.open_type_length: 'Open Type Length: 62'
ngap.value_element:
-   ngap.DownlinkNASTransport_element:
        per.extension_bit: '0... .... Extension Bit: False'
        per.sequence_of_length: 'Sequence-Of Length: 3'
        ngap.protocolIEs:
            'Item 0: id-AMF-UE-NGAP-ID':
                ngap.id: 'id: id-AMF-UE-NGAP-ID (10)'
                per.enum_index: 'Enumerated Index: 0'
                ngap.criticality: 'criticality: reject (0)'
                per.open_type_length: 'Open Type Length: 2'
                ngap.value_element:
                    ngap.AMF_UE_NGAP_ID: 'AMF-UE-NGAP-ID: 17'
            'Item 1: id-RAN-UE-NGAP-ID':
                ngap.id: 'id: id-RAN-UE-NGAP-ID (85)'
                per.enum_index: 'Enumerated Index: 0'
                ngap.criticality: 'criticality: reject (0)'
                per.open_type_length: 'Open Type Length: 2'
                ngap.value_element:
                    ngap.RAN_UE_NGAP_ID: 'RAN-UE-NGAP-ID: 1'
            'Item 2: id-NAS-PDU':
                ngap.id: 'id: id-NAS-PDU (38)'
                per.enum_index: 'Enumerated Index: 0'
                ngap.criticality: 'criticality: reject (0)'
                per.open_type_length: 'Open Type Length: 43'
                ngap.value_element:
                    per.octet_string_length: 'Octet String Length: 42'
                    ngap.NAS_PDU:
                        nas-5gs:
                            Plain NAS 5GS Message:
                                nas_5gs.epd: 'Extended protocol discriminator: 5G mobility management messages (126)'
                                nas_5gs.spare_half_octet: '0000 .... = Spare Half Octet: 0'
                                nas_5gs.security_header_type: '.... 0000 = Security header type: Plain NAS message, not security protected (0)'
                                nas_5gs.mm.message_type: 'Message type: Authentication request (0x56)'
                                NAS key set identifier - ngKSI:
                                    nas_5gs.mm.tsc: '.... 0... = Type of security context flag (TSC): Native security context (for KSIAMF)'
                                    nas_5gs.mm.nas_key_set_id: '.... .100 = NAS key set identifier: 4'
                                ABBA:
                                    gsm_a.len: 'Length: 2'
                                    nas_5gs.mm.abba_contents: 'ABBA Contents: 0x0000'
                                Authentication Parameter RAND - 5G authentication challenge:
                                    gsm_a.dtap.elem_id: 'Element ID: 0x21'
                                    gsm_a.dtap.rand: 'RAND value: 7cb689ab0e20ea67119a765fe57eaf8e'
                                Authentication Parameter AUTN (UMTS and EPS authentication challenge) - 5G authentication challenge:
                                    gsm_a.dtap.elem_id: 'Element ID: 0x20'
                                    gsm_a.len: 'Length: 16'
                                    gsm_a.dtap.autn:
                                        gsm_a.dtap.autn.sqn_xor_ak: 'SQN xor AK: 1ce01a20defc'
                                        gsm_a.dtap.autn.amf: 'AMF: 8000'
                                        gsm_a.dtap.autn.mac: 'MAC: 9fed2bf5b34e67ae'

end note

"10.0.2.15" -> "10.0.3.1": 2083, NGAP UplinkNASTransport (46),\nNAS Authentication response (0x57)

note right #c6ebc6
**10.0.2.15 to 10.0.3.1**
NGAP-PDU: 002e4040000004000a0002001100550002000100260016157e00572d10fec762ab85c3b314a5a80496ab2a21d4007940135009f107000000010009f107000001e74c1dcf
ngap.procedureCode: 'procedureCode: id-UplinkNASTransport (46)'
per.enum_index: 'Enumerated Index: 1'
ngap.criticality: 'criticality: ignore (1)'
per.open_type_length: 'Open Type Length: 64'
ngap.value_element:
-   ngap.UplinkNASTransport_element:
        per.extension_bit: '0... .... Extension Bit: False'
        per.sequence_of_length: 'Sequence-Of Length: 4'
        ngap.protocolIEs:
            'Item 0: id-AMF-UE-NGAP-ID':
                ngap.id: 'id: id-AMF-UE-NGAP-ID (10)'
                per.enum_index: 'Enumerated Index: 0'
                ngap.criticality: 'criticality: reject (0)'
                per.open_type_length: 'Open Type Length: 2'
                ngap.value_element:
                    ngap.AMF_UE_NGAP_ID: 'AMF-UE-NGAP-ID: 17'
            'Item 1: id-RAN-UE-NGAP-ID':
                ngap.id: 'id: id-RAN-UE-NGAP-ID (85)'
                per.enum_index: 'Enumerated Index: 0'
                ngap.criticality: 'criticality: reject (0)'
                per.open_type_length: 'Open Type Length: 2'
                ngap.value_element:
                    ngap.RAN_UE_NGAP_ID: 'RAN-UE-NGAP-ID: 1'
            'Item 2: id-NAS-PDU':
                ngap.id: 'id: id-NAS-PDU (38)'
                per.enum_index: 'Enumerated Index: 0'
                ngap.criticality: 'criticality: reject (0)'
                per.open_type_length: 'Open Type Length: 22'
                ngap.value_element:
                    per.octet_string_length: 'Octet String Length: 21'
                    ngap.NAS_PDU:
                        nas-5gs:
                            Plain NAS 5GS Message:
                                nas_5gs.epd: 'Extended protocol discriminator: 5G mobility management messages (126)'
                                nas_5gs.spare_half_octet: '0000 .... = Spare Half Octet: 0'
                                nas_5gs.security_header_type: '.... 0000 = Security header type: Plain NAS message, not security protected (0)'
                                nas_5gs.mm.message_type: 'Message type: Authentication response (0x57)'
                                Authentication response parameter:
                                    nas_eps.emm.elem_id: 'Element ID: 0x2d'
                                    gsm_a.len: 'Length: 16'
                                    nas_eps.emm.res: 'RES: fec762ab85c3b314a5a80496ab2a21d4'
            'Item 3: id-UserLocationInformation':
                ngap.id: 'id: id-UserLocationInformation (121)'
                per.enum_index: 'Enumerated Index: 1'
                ngap.criticality: 'criticality: ignore (1)'
                per.open_type_length: 'Open Type Length: 19'
                ngap.value_element:
                    per.choice_index: 'Choice Index: 1'
                    ngap.UserLocationInformation:
                        ngap.userLocationInformationNR_element:
                            per.extension_bit: '..0. .... Extension Bit: False'
                            per.optional_field_bit: '.... 0... Optional Field Bit: False (iE-Extensions is NOT present)'
                            ngap.nR_CGI_element:
                                per.extension_bit: '.... .0.. Extension Bit: False'
                                per.optional_field_bit: '.... ..0. Optional Field Bit: False (iE-Extensions is NOT present)'
                                ngap.pLMNIdentity:
                                    e212.mcc: 'Mobile Country Code (MCC): International Mobile, shared code (901)'
                                    e212.mnc: 'Mobile Network Code (MNC): Unknown (70)'
                                ngap.NRCellIdentity: 'nRCellIdentity: 0x0000000010'
                            ngap.tAI_element:
                                per.extension_bit: '.... 0... Extension Bit: False'
                                per.optional_field_bit: '.... .0.. Optional Field Bit: False (iE-Extensions is NOT present)'
                                ngap.pLMNIdentity:
                                    e212.mcc: 'Mobile Country Code (MCC): International Mobile, shared code (901)'
                                    e212.mnc: 'Mobile Network Code (MNC): Unknown (70)'
                                ngap.tAC: 'tAC: 1 (0x000001)'
                            ngap.timeStamp: 'timeStamp: e74c1dcf (Dec 20, 2022 11:41:03 UTC)'

end note

"10.0.3.1" -> "10.0.2.15": 2106, NGAP DownlinkNASTransport (4),\nNAS Security mode command (0x5d)

note right #c6ebc6
**10.0.3.1 to 10.0.2.15**
NGAP-PDU: 00044029000003000a0002001100550002000100260016157e03836a3a2e007e005d020404f0f0f0f0e1360102
ngap.procedureCode: 'procedureCode: id-DownlinkNASTransport (4)'
per.enum_index: 'Enumerated Index: 1'
ngap.criticality: 'criticality: ignore (1)'
per.open_type_length: 'Open Type Length: 41'
ngap.value_element:
-   ngap.DownlinkNASTransport_element:
        per.extension_bit: '0... .... Extension Bit: False'
        per.sequence_of_length: 'Sequence-Of Length: 3'
        ngap.protocolIEs:
            'Item 0: id-AMF-UE-NGAP-ID':
                ngap.id: 'id: id-AMF-UE-NGAP-ID (10)'
                per.enum_index: 'Enumerated Index: 0'
                ngap.criticality: 'criticality: reject (0)'
                per.open_type_length: 'Open Type Length: 2'
                ngap.value_element:
                    ngap.AMF_UE_NGAP_ID: 'AMF-UE-NGAP-ID: 17'
            'Item 1: id-RAN-UE-NGAP-ID':
                ngap.id: 'id: id-RAN-UE-NGAP-ID (85)'
                per.enum_index: 'Enumerated Index: 0'
                ngap.criticality: 'criticality: reject (0)'
                per.open_type_length: 'Open Type Length: 2'
                ngap.value_element:
                    ngap.RAN_UE_NGAP_ID: 'RAN-UE-NGAP-ID: 1'
            'Item 2: id-NAS-PDU':
                ngap.id: 'id: id-NAS-PDU (38)'
                per.enum_index: 'Enumerated Index: 0'
                ngap.criticality: 'criticality: reject (0)'
                per.open_type_length: 'Open Type Length: 22'
                ngap.value_element:
                    per.octet_string_length: 'Octet String Length: 21'
                    ngap.NAS_PDU:
                        nas-5gs:
                            Security protected NAS 5GS message:
                                nas_5gs.epd: 'Extended protocol discriminator: 5G mobility management messages (126)'
                                nas_5gs.spare_half_octet: '0000 .... = Spare Half Octet: 0'
                                nas_5gs.security_header_type: '.... 0011 = Security header type: Integrity protected with new 5GS security context (3)'
                                nas_5gs.msg_auth_code: 'Message authentication code: 0x836a3a2e'
                                nas_5gs.seq_no: 'Sequence number: 0'
                            Plain NAS 5GS Message:
                                nas_5gs.epd: 'Extended protocol discriminator: 5G mobility management messages (126)'
                                nas_5gs.spare_half_octet: '0000 .... = Spare Half Octet: 0'
                                nas_5gs.security_header_type: '.... 0000 = Security header type: Plain NAS message, not security protected (0)'
                                nas_5gs.mm.message_type: 'Message type: Security mode command (0x5d)'
                                NAS security algorithms:
                                    nas_5gs.mm.nas_sec_algo_enc: '0000 .... = Type of ciphering algorithm: 5G-EA0 (null ciphering algorithm) (0)'
                                    nas_5gs.mm.nas_sec_algo_ip: '.... 0010 = Type of integrity protection algorithm: 128-5G-IA2 (2)'
                                NAS key set identifier - ngKSI:
                                    nas_5gs.mm.tsc: '.... 0... = Type of security context flag (TSC): Native security context (for KSIAMF)'
                                    nas_5gs.mm.nas_key_set_id: '.... .100 = NAS key set identifier: 4'
                                UE security capability - Replayed UE security capabilities:
                                    gsm_a.len: 'Length: 4'
                                    nas_5gs.mm.5g_ea0: '1... .... = 5G-EA0: Supported'
                                    nas_5gs.mm.128_5g_ea1: '.1.. .... = 128-5G-EA1: Supported'
                                    nas_5gs.mm.128_5g_ea2: '..1. .... = 128-5G-EA2: Supported'
                                    nas_5gs.mm.128_5g_ea3: '...1 .... = 128-5G-EA3: Supported'
                                    nas_5gs.mm.5g_ea4: '.... 0... = 5G-EA4: Not supported'
                                    nas_5gs.mm.5g_ea5: '.... .0.. = 5G-EA5: Not supported'
                                    nas_5gs.mm.5g_ea6: '.... ..0. = 5G-EA6: Not supported'
                                    nas_5gs.mm.5g_ea7: '.... ...0 = 5G-EA7: Not supported'
                                    nas_5gs.mm.ia0: '1... .... = 5G-IA0: Supported'
                                    nas_5gs.mm.5g_128_ia1: '.1.. .... = 128-5G-IA1: Supported'
                                    nas_5gs.mm.5g_128_ia2: '..1. .... = 128-5G-IA2: Supported'
                                    nas_5gs.mm.5g_128_ia4: '.... 0... = 5G-IA4: Not supported'
                                    nas_5gs.mm.5g_ia5: '.... .0.. = 5G-IA5: Not supported'
                                    nas_5gs.mm.5g_ia6: '.... ..0. = 5G-IA6: Not supported'
                                    nas_5gs.mm.5g_ia7: '.... ...0 = 5G-IA7: Not supported'
                                    nas_5gs.mm.eea0: '1... .... = EEA0: Supported'
                                    nas_5gs.mm.128eea1: '.1.. .... = 128-EEA1: Supported'
                                    nas_5gs.mm.128eea2: '..1. .... = 128-EEA2: Supported'
                                    nas_5gs.mm.eea3: '...1 .... = 128-EEA3: Supported'
                                    nas_5gs.mm.eea4: '.... 0... = EEA4: Not supported'
                                    nas_5gs.mm.eea5: '.... .0.. = EEA5: Not supported'
                                    nas_5gs.mm.eea6: '.... ..0. = EEA6: Not supported'
                                    nas_5gs.mm.eea7: '.... ...0 = EEA7: Not supported'
                                    nas_5gs.mm.eia0: '1... .... = EIA0: Supported'
                                    nas_5gs.mm.128eia1: '.1.. .... = 128-EIA1: Supported'
                                    nas_5gs.mm.128eia2: '..1. .... = 128-EIA2: Supported'
                                    nas_5gs.mm.eia3: '...1 .... = 128-EIA3: Supported'
                                    nas_5gs.mm.eia4: '.... 0... = EIA4: Not supported'
                                    nas_5gs.mm.eia5: '.... .0.. = EIA5: Not supported'
                                    nas_5gs.mm.eia6: '.... ..0. = EIA6: Not supported'
                                    nas_5gs.mm.eia7: '.... ...0 = EIA7: Not supported'
                                IMEISV request:
                                    gsm_a.common.elem_id: '1110 .... = Element ID: 0xe-'
                                    nas_eps.spare_bits: '.... 0... = Spare bit(s): 0x00'
                                    nas_eps.emm.imeisv_req: '.... .001 = IMEISV request: IMEISV requested (1)'
                                Additional 5G security information:
                                    nas_5gs.mm.elem_id: 'Element ID: 0x36'
                                    gsm_a.len: 'Length: 1'
                                    nas_5gs.spare_b3: '.... 0... = Spare: 0'
                                    nas_5gs.spare_b2: '.... .0.. = Spare: 0'
                                    nas_5gs.mm.rinmr: '.... ..1. = Retransmission of initial NAS message request(RINMR): Requested'
                                    nas_5gs.mm.hdp: '.... ...0 = Horizontal derivation parameter (HDP): Not required'

end note

"10.0.2.15" -> "10.0.3.1": 2107, NGAP UplinkNASTransport (46),\nNAS Security mode complete (0x5e),\nNAS Registration request (0x41)

note right #8cd98c
**10.0.2.15 to 10.0.3.1**
NGAP-PDU: 002e4067000004000a000200110055000200010026003d3c7e04aa3e1f93007e005e7700094573806121856151f17100237e004179000d0109f1070000000000000000101001002e04f0f0f0f02f020101530100007940135009f107000000010009f107000001e74c1dcf
ngap.procedureCode: 'procedureCode: id-UplinkNASTransport (46)'
per.enum_index: 'Enumerated Index: 1'
ngap.criticality: 'criticality: ignore (1)'
per.open_type_length: 'Open Type Length: 103'
ngap.value_element:
-   ngap.UplinkNASTransport_element:
        per.extension_bit: '0... .... Extension Bit: False'
        per.sequence_of_length: 'Sequence-Of Length: 4'
        ngap.protocolIEs:
            'Item 0: id-AMF-UE-NGAP-ID':
                ngap.id: 'id: id-AMF-UE-NGAP-ID (10)'
                per.enum_index: 'Enumerated Index: 0'
                ngap.criticality: 'criticality: reject (0)'
                per.open_type_length: 'Open Type Length: 2'
                ngap.value_element:
                    ngap.AMF_UE_NGAP_ID: 'AMF-UE-NGAP-ID: 17'
            'Item 1: id-RAN-UE-NGAP-ID':
                ngap.id: 'id: id-RAN-UE-NGAP-ID (85)'
                per.enum_index: 'Enumerated Index: 0'
                ngap.criticality: 'criticality: reject (0)'
                per.open_type_length: 'Open Type Length: 2'
                ngap.value_element:
                    ngap.RAN_UE_NGAP_ID: 'RAN-UE-NGAP-ID: 1'
            'Item 2: id-NAS-PDU':
                ngap.id: 'id: id-NAS-PDU (38)'
                per.enum_index: 'Enumerated Index: 0'
                ngap.criticality: 'criticality: reject (0)'
                per.open_type_length: 'Open Type Length: 61'
                ngap.value_element:
                    per.octet_string_length: 'Octet String Length: 60'
                    ngap.NAS_PDU:
                        nas-5gs:
                            Security protected NAS 5GS message:
                                nas_5gs.epd: 'Extended protocol discriminator: 5G mobility management messages (126)'
                                nas_5gs.spare_half_octet: '0000 .... = Spare Half Octet: 0'
                                nas_5gs.security_header_type: '.... 0100 = Security header type: Integrity protected and ciphered with new 5GS security context (4)'
                                nas_5gs.msg_auth_code: 'Message authentication code: 0xaa3e1f93'
                                nas_5gs.seq_no: 'Sequence number: 0'
                            Plain NAS 5GS Message:
                                nas_5gs.epd: 'Extended protocol discriminator: 5G mobility management messages (126)'
                                nas_5gs.spare_half_octet: '0000 .... = Spare Half Octet: 0'
                                nas_5gs.security_header_type: '.... 0000 = Security header type: Plain NAS message, not security protected (0)'
                                nas_5gs.mm.message_type: 'Message type: Security mode complete (0x5e)'
                                5GS mobile identity:
                                    nas_5gs.mm.elem_id: 'Element ID: 0x77'
                                    gsm_a.len: 'Length: 9'
                                    nas_5gs.mm.odd_even: '.... 0... = Odd/even indication: Even number of identity digits'
                                    nas_5gs.mm.type_id: '.... .101 = Type of identity: IMEISV (5)'
                                    nas_5gs.mm.imeisv: 'IMEISV: 4370816125816151'
                                NAS message container:
                                    nas_5gs.mm.elem_id: 'Element ID: 0x71'
                                    gsm_a.len: 'Length: 35'
                                    nas-5gs:
                                        Plain NAS 5GS Message:
                                            nas_5gs.epd: 'Extended protocol discriminator: 5G mobility management messages (126)'
                                            nas_5gs.spare_half_octet: '0000 .... = Spare Half Octet: 0'
                                            nas_5gs.security_header_type: '.... 0000 = Security header type: Plain NAS message, not security protected (0)'
                                            nas_5gs.mm.message_type: 'Message type: Registration request (0x41)'
                                            5GS registration type:
                                                nas_5gs.mm.for: '.... 1... = Follow-On Request bit (FOR): Follow-on request pending'
                                                nas_5gs.mm.5gs_reg_type: '.... .001 = 5GS registration type: initial registration (1)'
                                            NAS key set identifier:
                                                nas_5gs.mm.tsc.h1: '0... .... = Type of security context flag (TSC): Native security context (for KSIAMF)'
                                                nas_5gs.mm.nas_key_set_id.h1: '.111 .... = NAS key set identifier: 7'
                                            5GS mobile identity:
                                                gsm_a.len: 'Length: 13'
                                                nas_5gs.spare_b7: '0... .... = Spare: 0'
                                                nas_5gs.mm.suci.supi_fmt: '.000 .... = SUPI format: IMSI (0)'
                                                nas_5gs.spare_b3: '.... 0... = Spare: 0'
                                                nas_5gs.mm.type_id: '.... .001 = Type of identity: SUCI (1)'
                                                e212.mcc: 'Mobile Country Code (MCC): International Mobile, shared code (901)'
                                                e212.mnc: 'Mobile Network Code (MNC): Unknown (70)'
                                                nas_5gs.mm.suci.routing_indicator: 'Routing indicator: 0000'
                                                nas_5gs.mm.suci.scheme_id: '.... 0000 = Protection scheme Id: NULL scheme (0)'
                                                nas_5gs.mm.suci.pki: 'Home network public key identifier: 0'
                                                nas_5gs.mm.suci.supi_null_scheme: 'Scheme output: 0000000001'
                                            5GMM capability:
                                                nas_5gs.mm.elem_id: 'Element ID: 0x10'
                                                gsm_a.len: 'Length: 1'
                                                nas_5gs.spare_b7: '0... .... = Spare: 0'
                                                nas_5gs.spare_b6: '.0.. .... = Spare: 0'
                                                nas_5gs.spare_b5: '..0. .... = Spare: 0'
                                                nas_5gs.spare_b4: '...0 .... = Spare: 0'
                                                nas_5gs.spare_b3: '.... 0... = Spare: 0'
                                                nas_5gs.mm.lpp_cap_b2: '.... .0.. = LTE Positioning Protocol (LPP) capability: Not Requested'
                                                nas_5gs.mm.ho_attach_b1: '.... ..0. = HO attach: Not supported'
                                                nas_5gs.mm.s1_mode_b0: '.... ...0 = S1 mode: Not Requested'
                                            UE security capability:
                                                nas_5gs.mm.elem_id: 'Element ID: 0x2e'
                                                gsm_a.len: 'Length: 4'
                                                nas_5gs.mm.5g_ea0: '1... .... = 5G-EA0: Supported'
                                                nas_5gs.mm.128_5g_ea1: '.1.. .... = 128-5G-EA1: Supported'
                                                nas_5gs.mm.128_5g_ea2: '..1. .... = 128-5G-EA2: Supported'
                                                nas_5gs.mm.128_5g_ea3: '...1 .... = 128-5G-EA3: Supported'
                                                nas_5gs.mm.5g_ea4: '.... 0... = 5G-EA4: Not supported'
                                                nas_5gs.mm.5g_ea5: '.... .0.. = 5G-EA5: Not supported'
                                                nas_5gs.mm.5g_ea6: '.... ..0. = 5G-EA6: Not supported'
                                                nas_5gs.mm.5g_ea7: '.... ...0 = 5G-EA7: Not supported'
                                                nas_5gs.mm.ia0: '1... .... = 5G-IA0: Supported'
                                                nas_5gs.mm.5g_128_ia1: '.1.. .... = 128-5G-IA1: Supported'
                                                nas_5gs.mm.5g_128_ia2: '..1. .... = 128-5G-IA2: Supported'
                                                nas_5gs.mm.5g_128_ia4: '.... 0... = 5G-IA4: Not supported'
                                                nas_5gs.mm.5g_ia5: '.... .0.. = 5G-IA5: Not supported'
                                                nas_5gs.mm.5g_ia6: '.... ..0. = 5G-IA6: Not supported'
                                                nas_5gs.mm.5g_ia7: '.... ...0 = 5G-IA7: Not supported'
                                                nas_5gs.mm.eea0: '1... .... = EEA0: Supported'
                                                nas_5gs.mm.128eea1: '.1.. .... = 128-EEA1: Supported'
                                                nas_5gs.mm.128eea2: '..1. .... = 128-EEA2: Supported'
                                                nas_5gs.mm.eea3: '...1 .... = 128-EEA3: Supported'
                                                nas_5gs.mm.eea4: '.... 0... = EEA4: Not supported'
                                                nas_5gs.mm.eea5: '.... .0.. = EEA5: Not supported'
                                                nas_5gs.mm.eea6: '.... ..0. = EEA6: Not supported'
                                                nas_5gs.mm.eea7: '.... ...0 = EEA7: Not supported'
                                                nas_5gs.mm.eia0: '1... .... = EIA0: Supported'
                                                nas_5gs.mm.128eia1: '.1.. .... = 128-EIA1: Supported'
                                                nas_5gs.mm.128eia2: '..1. .... = 128-EIA2: Supported'
                                                nas_5gs.mm.eia3: '...1 .... = 128-EIA3: Supported'
                                                nas_5gs.mm.eia4: '.... 0... = EIA4: Not supported'
                                                nas_5gs.mm.eia5: '.... .0.. = EIA5: Not supported'
                                                nas_5gs.mm.eia6: '.... ..0. = EIA6: Not supported'
                                                nas_5gs.mm.eia7: '.... ...0 = EIA7: Not supported'
                                            NSSAI - Requested NSSAI:
                                                nas_5gs.mm.elem_id: 'Element ID: 0x2f'
                                                gsm_a.len: 'Length: 2'
                                                S-NSSAI 1:
                                                    nas_5gs.mm.length: 'Length: 1'
                                                    nas_5gs.mm.sst: 'Slice/service type (SST): 1'
                                            5GS update type:
                                                nas_5gs.mm.elem_id: 'Element ID: 0x53'
                                                gsm_a.len: 'Length: 1'
                                                nas_5gs.spare_b3: '.... 0... = Spare: 0'
                                                nas_5gs.spare_b2: '.... .0.. = Spare: 0'
                                                nas_5gs.mm.ng_ran_rcu: '.... ..0. = NG-RAN Radio Capability Update (NG-RAN-RCU): Not Needed'
                                                nas_5gs.mm.sms_requested: '.... ...0 = SMS requested: SMS over NAS not supported'
            'Item 3: id-UserLocationInformation':
                ngap.id: 'id: id-UserLocationInformation (121)'
                per.enum_index: 'Enumerated Index: 1'
                ngap.criticality: 'criticality: ignore (1)'
                per.open_type_length: 'Open Type Length: 19'
                ngap.value_element:
                    per.choice_index: 'Choice Index: 1'
                    ngap.UserLocationInformation:
                        ngap.userLocationInformationNR_element:
                            per.extension_bit: '..0. .... Extension Bit: False'
                            per.optional_field_bit: '.... 0... Optional Field Bit: False (iE-Extensions is NOT present)'
                            ngap.nR_CGI_element:
                                per.extension_bit: '.... .0.. Extension Bit: False'
                                per.optional_field_bit: '.... ..0. Optional Field Bit: False (iE-Extensions is NOT present)'
                                ngap.pLMNIdentity:
                                    e212.mcc: 'Mobile Country Code (MCC): International Mobile, shared code (901)'
                                    e212.mnc: 'Mobile Network Code (MNC): Unknown (70)'
                                ngap.NRCellIdentity: 'nRCellIdentity: 0x0000000010'
                            ngap.tAI_element:
                                per.extension_bit: '.... 0... Extension Bit: False'
                                per.optional_field_bit: '.... .0.. Optional Field Bit: False (iE-Extensions is NOT present)'
                                ngap.pLMNIdentity:
                                    e212.mcc: 'Mobile Country Code (MCC): International Mobile, shared code (901)'
                                    e212.mnc: 'Mobile Network Code (MNC): Unknown (70)'
                                ngap.tAC: 'tAC: 1 (0x000001)'
                            ngap.timeStamp: 'timeStamp: e74c1dcf (Dec 20, 2022 11:41:03 UTC)'

end note

"10.0.3.1" -> "10.0.2.15": 2162, NGAP InitialContextSetup (14),\nNAS Registration accept (0x42)

note right #c6ebc6
**10.0.3.1 to 10.0.2.15**
NGAP-PDU: 000e008090000008000a00020011005500020001001c00070009f107020040000000020001007700091c000e000700038000005e0020b1bf30671d7e7c9dd530bccb5922d6b0044b4182f436062331fd499b72d4cfdb002240084370816125ffff510026402f2e7e02cecf3ac5017e0042010177000bf209f107020040e40017ec54072009f10700000115020101210201005e0129
ngap.procedureCode: 'procedureCode: id-InitialContextSetup (14)'
per.enum_index: 'Enumerated Index: 0'
ngap.criticality: 'criticality: reject (0)'
per.open_type_length: 'Open Type Length: 144'
ngap.value_element:
-   ngap.InitialContextSetupRequest_element:
        per.extension_bit: '0... .... Extension Bit: False'
        per.sequence_of_length: 'Sequence-Of Length: 8'
        ngap.protocolIEs:
            'Item 0: id-AMF-UE-NGAP-ID':
                ngap.id: 'id: id-AMF-UE-NGAP-ID (10)'
                per.enum_index: 'Enumerated Index: 0'
                ngap.criticality: 'criticality: reject (0)'
                per.open_type_length: 'Open Type Length: 2'
                ngap.value_element:
                    ngap.AMF_UE_NGAP_ID: 'AMF-UE-NGAP-ID: 17'
            'Item 1: id-RAN-UE-NGAP-ID':
                ngap.id: 'id: id-RAN-UE-NGAP-ID (85)'
                per.enum_index: 'Enumerated Index: 0'
                ngap.criticality: 'criticality: reject (0)'
                per.open_type_length: 'Open Type Length: 2'
                ngap.value_element:
                    ngap.RAN_UE_NGAP_ID: 'RAN-UE-NGAP-ID: 1'
            'Item 2: id-GUAMI':
                ngap.id: 'id: id-GUAMI (28)'
                per.enum_index: 'Enumerated Index: 0'
                ngap.criticality: 'criticality: reject (0)'
                per.open_type_length: 'Open Type Length: 7'
                ngap.value_element:
                    ngap.GUAMI_element:
                        per.extension_bit: '0... .... Extension Bit: False'
                        per.optional_field_bit: '.0.. .... Optional Field Bit: False (iE-Extensions is NOT present)'
                        ngap.pLMNIdentity:
                            e212.mcc: 'Mobile Country Code (MCC): International Mobile, shared code (901)'
                            e212.mnc: 'Mobile Network Code (MNC): Unknown (70)'
                        ngap.aMFRegionID: 'aMFRegionID: 02 [bit length 8, 0000 0010 decimal value 2]'
                        ngap.aMFSetID: 'aMFSetID: 0040 [bit length 10, 6 LSB pad bits, 0000 0000  01.. .... decimal value 1]'
                        ngap.aMFPointer: 'aMFPointer: 00 [bit length 6, 2 LSB pad bits, 0000 00.. decimal value 0]'
            'Item 3: id-AllowedNSSAI':
                ngap.id: 'id: id-AllowedNSSAI (0)'
                per.enum_index: 'Enumerated Index: 0'
                ngap.criticality: 'criticality: reject (0)'
                per.open_type_length: 'Open Type Length: 2'
                ngap.value_element:
                    per.sequence_of_length: 'Sequence-Of Length: 1'
                    ngap.AllowedNSSAI:
                        Item 0:
                            ngap.AllowedNSSAI_Item_element:
                                per.extension_bit: '...0 .... Extension Bit: False'
                                per.optional_field_bit: '.... 0... Optional Field Bit: False (iE-Extensions is NOT present)'
                                ngap.s_NSSAI_element:
                                    per.extension_bit: '.... .0.. Extension Bit: False'
                                    per.optional_field_bit: '.... ...0 Optional Field Bit: False (iE-Extensions is NOT present)'
                                    ngap.sST: 'sST: 01'
            'Item 4: id-UESecurityCapabilities':
                ngap.id: 'id: id-UESecurityCapabilities (119)'
                per.enum_index: 'Enumerated Index: 0'
                ngap.criticality: 'criticality: reject (0)'
                per.open_type_length: 'Open Type Length: 9'
                ngap.value_element:
                    ngap.UESecurityCapabilities_element:
                        per.extension_bit: '0... .... Extension Bit: False'
                        per.optional_field_bit: '.0.. .... Optional Field Bit: False (iE-Extensions is NOT present)'
                        per.extension_present_bit: '.... .0.. Extension Present Bit: False'
                        ngap.nRencryptionAlgorithms:
                            ngap.NrencyptionAlgorithms.nea1: '1... .... .... .... = 128-NEA1: Supported'
                            ngap.NrencyptionAlgorithms.nea2: '.1.. .... .... .... = 128-NEA2: Supported'
                            ngap.NrencyptionAlgorithms.nea3: '..1. .... .... .... = 128-NEA3: Supported'
                            ngap.NrencyptionAlgorithms.reserved: '...0 0000 0000 0000 = Reserved: 0x0000'
                        ngap.nRintegrityProtectionAlgorithms:
                            ngap.NrintegrityProtectionAlgorithms.nia1: '1... .... .... .... = 128-NIA1: Supported'
                            ngap.NrintegrityProtectionAlgorithms.nia2: '.1.. .... .... .... = 128-NIA2: Supported'
                            ngap.NrintegrityProtectionAlgorithms.nia3: '..1. .... .... .... = 128-NIA3: Supported'
                            ngap.NrintegrityProtectionAlgorithms.reserved: '...0 0000 0000 0000 = Reserved: 0x0000'
                        ngap.eUTRAencryptionAlgorithms:
                            ngap.EUTRAencryptionAlgorithms.eea1: '1... .... .... .... = 128-EEA1: Supported'
                            ngap.EUTRAencryptionAlgorithms.eea2: '.1.. .... .... .... = 128-EEA2: Supported'
                            ngap.EUTRAencryptionAlgorithms.eea3: '..1. .... .... .... = 128-EEA3: Supported'
                            ngap.EUTRAencryptionAlgorithms.reserved: '...0 0000 0000 0000 = Reserved: 0x0000'
                        ngap.eUTRAintegrityProtectionAlgorithms:
                            ngap.EUTRAintegrityProtectionAlgorithms.eia1: '1... .... .... .... = 128-EIA1: Supported'
                            ngap.EUTRAintegrityProtectionAlgorithms.eia2: '.1.. .... .... .... = 128-EIA2: Supported'
                            ngap.EUTRAintegrityProtectionAlgorithms.eia3: '..1. .... .... .... = 128-EIA3: Supported'
                            ngap.EUTRAintegrityProtectionAlgorithms.reserved: '...0 0000 0000 0000 = Reserved: 0x0000'
            'Item 5: id-SecurityKey':
                ngap.id: 'id: id-SecurityKey (94)'
                per.enum_index: 'Enumerated Index: 0'
                ngap.criticality: 'criticality: reject (0)'
                per.open_type_length: 'Open Type Length: 32'
                ngap.value_element:
                    ngap.SecurityKey: 'SecurityKey: b1bf30671d7e7c9dd530bccb5922d6b0044b4182f4360623\xe2\x80\xa6 [bit length 256]'
            'Item 6: id-MaskedIMEISV':
                ngap.id: 'id: id-MaskedIMEISV (34)'
                per.enum_index: 'Enumerated Index: 1'
                ngap.criticality: 'criticality: ignore (1)'
                per.open_type_length: 'Open Type Length: 8'
                ngap.value_element:
                    ngap.MaskedIMEISV: 'MaskedIMEISV: 4370816125ffff51 [bit length 64, 0100 0011  0111 0000  1000 0001  0110 0001  0010 0101  1111 1111  1111 1111  0101 0001 decimal value 4859526252182110033]'
            'Item 7: id-NAS-PDU':
                ngap.id: 'id: id-NAS-PDU (38)'
                per.enum_index: 'Enumerated Index: 1'
                ngap.criticality: 'criticality: ignore (1)'
                per.open_type_length: 'Open Type Length: 47'
                ngap.value_element:
                    per.octet_string_length: 'Octet String Length: 46'
                    ngap.NAS_PDU:
                        nas-5gs:
                            Security protected NAS 5GS message:
                                nas_5gs.epd: 'Extended protocol discriminator: 5G mobility management messages (126)'
                                nas_5gs.spare_half_octet: '0000 .... = Spare Half Octet: 0'
                                nas_5gs.security_header_type: '.... 0010 = Security header type: Integrity protected and ciphered (2)'
                                nas_5gs.msg_auth_code: 'Message authentication code: 0xcecf3ac5'
                                nas_5gs.seq_no: 'Sequence number: 1'
                            Plain NAS 5GS Message:
                                nas_5gs.epd: 'Extended protocol discriminator: 5G mobility management messages (126)'
                                nas_5gs.spare_half_octet: '0000 .... = Spare Half Octet: 0'
                                nas_5gs.security_header_type: '.... 0000 = Security header type: Plain NAS message, not security protected (0)'
                                nas_5gs.mm.message_type: 'Message type: Registration accept (0x42)'
                                5GS registration result:
                                    gsm_a.len: 'Length: 1'
                                    nas_5gs.mm.reg_res.nssaa_perf: '...0 .... = NSSAA Performed: False'
                                    nas_5gs.mm.reg_res.sms_all: '.... 0... = SMS over NAS: Not Allowed'
                                    nas_5gs.mm.reg_res.res: '.... .001 = 5GS registration result: 3GPP access (1)'
                                5GS mobile identity - 5G-GUTI:
                                    nas_5gs.mm.elem_id: 'Element ID: 0x77'
                                    gsm_a.len: 'Length: 11'
                                    nas_5gs.mm.odd_even: '.... 0... = Odd/even indication: Even number of identity digits'
                                    nas_5gs.mm.type_id: '.... .010 = Type of identity: 5G-GUTI (2)'
                                    e212.mcc: 'Mobile Country Code (MCC): International Mobile, shared code (901)'
                                    e212.mnc: 'Mobile Network Code (MNC): Unknown (70)'
                                    nas_5gs.amf_region_id: 'AMF Region ID: 2'
                                    nas_5gs.amf_set_id: '0000 0000 01.. .... = AMF Set ID: 1'
                                    nas_5gs.amf_pointer: '..00 0000 = AMF Pointer: 0'
                                    nas_5gs.5g_tmsi: '5G-TMSI: 0xe40017ec'
                                5GS tracking area identity list:
                                    nas_5gs.mm.elem_id: 'Element ID: 0x54'
                                    gsm_a.len: 'Length: 7'
                                    Partial tracking area list  1:
                                        nas_5gs.mm.tal_t_li: '.01. .... = Type of list: list of TACs belonging to one PLMN, with consecutive TAC values (1)'
                                        nas_5gs.mm.tal_num_e: '...0 0000 = Number of elements: 1 element (0)'
                                        e212.mcc: 'Mobile Country Code (MCC): International Mobile, shared code (901)'
                                        e212.mnc: 'Mobile Network Code (MNC): Unknown (70)'
                                        nas_5gs.tac: 'TAC: 1'
                                NSSAI - Allowed NSSAI:
                                    nas_5gs.mm.elem_id: 'Element ID: 0x15'
                                    gsm_a.len: 'Length: 2'
                                    S-NSSAI 1:
                                        nas_5gs.mm.length: 'Length: 1'
                                        nas_5gs.mm.sst: 'Slice/service type (SST): 1'
                                5GS network feature support:
                                    nas_5gs.mm.elem_id: 'Element ID: 0x21'
                                    gsm_a.len: 'Length: 2'
                                    nas_5gs.nw_feat_sup.mpsi: '0... .... = MPS indicator (MPSI): Access identity 1 not valid in RPLMN or equivalent PLMN'
                                    nas_5gs.nw_feat_sup.iwk_n26: '.0.. .... = Interworking without N26: Not supported'
                                    nas_5gs.nw_feat_sup.emf: '..00 .... = Emergency service fallback indicator (EMF): Emergency services fallback not supported (0)'
                                    nas_5gs.nw_feat_sup.emc: '.... 00.. = Emergency service support indicator (EMC): Emergency services not supported (0)'
                                    nas_5gs.nw_feat_sup.vops_n3gpp: '.... ..0. = IMS voice over PS session over non-3GPP access indicator (IMS-VoPS-N3GPP): Not supported'
                                    nas_5gs.nw_feat_sup.vops_3gpp: '.... ...1 = IMS voice over PS session indicator (IMS VoPS): Supported'
                                    nas_5gs.spare_b7: '0... .... = Spare: 0'
                                    nas_5gs.spare_b6: '.0.. .... = Spare: 0'
                                    nas_5gs.spare_b5: '..0. .... = Spare: 0'
                                    nas_5gs.spare_b4: '...0 .... = Spare: 0'
                                    nas_5gs.spare_b3: '.... 0... = Spare: 0'
                                    nas_5gs.spare_b2: '.... .0.. = Spare: 0'
                                    nas_5gs.nw_feat_sup.mcsi: '.... ..0. = MCS indicator (MCSI): Not supported'
                                    nas_5gs.nw_feat_sup.emcn3: '.... ...0 = Emergency services over non-3GPP access (EMCN3): Not supported'
                                GPRS Timer 3 - T3512 value:
                                    gsm_a.gm.elem_id: 'Element ID: 0x5e'
                                    gsm_a.len: 'Length: 1'
                                    gsm_a.gm.gmm.gprs_timer3:
                                        gsm_a.gm.gmm.gprs_timer3_unit: '001. .... = Unit: value is incremented in multiples of 1 hour (1)'
                                        gsm_a.gm.gmm.gprs_timer3_value: '...0 1001 = Timer value: 9'

end note

"10.0.2.15" -> "10.0.3.1": 2163, NGAP InitialContextSetup (14)

note right #c6ebc6
**10.0.2.15 to 10.0.3.1**
NGAP-PDU: 200e000f000002000a40020011005540020001
ngap.procedureCode: 'procedureCode: id-InitialContextSetup (14)'
per.enum_index: 'Enumerated Index: 0'
ngap.criticality: 'criticality: reject (0)'
per.open_type_length: 'Open Type Length: 15'
ngap.value_element:
-   ngap.InitialContextSetupResponse_element:
        per.extension_bit: '0... .... Extension Bit: False'
        per.sequence_of_length: 'Sequence-Of Length: 2'
        ngap.protocolIEs:
            'Item 0: id-AMF-UE-NGAP-ID':
                ngap.id: 'id: id-AMF-UE-NGAP-ID (10)'
                per.enum_index: 'Enumerated Index: 1'
                ngap.criticality: 'criticality: ignore (1)'
                per.open_type_length: 'Open Type Length: 2'
                ngap.value_element:
                    ngap.AMF_UE_NGAP_ID: 'AMF-UE-NGAP-ID: 17'
            'Item 1: id-RAN-UE-NGAP-ID':
                ngap.id: 'id: id-RAN-UE-NGAP-ID (85)'
                per.enum_index: 'Enumerated Index: 1'
                ngap.criticality: 'criticality: ignore (1)'
                per.open_type_length: 'Open Type Length: 2'
                ngap.value_element:
                    ngap.RAN_UE_NGAP_ID: 'RAN-UE-NGAP-ID: 1'

end note

"10.0.2.15" -> "10.0.3.1": 2167, NGAP UplinkNASTransport (46),\nNAS Registration complete (0x43),\nNAS UL NAS transport (0x67),\nNAS PDU session establishment request (0xc1)

note right #8cd98c
**10.0.2.15 to 10.0.3.1**
NGAP-PDU: 002e4035000004000a000200110055000200010026000b0a7e024795f12b017e0043007940135009f107000000010009f107000001e74c1dcf
ngap.procedureCode: 'procedureCode: id-UplinkNASTransport (46)'
per.enum_index: 'Enumerated Index: 1'
ngap.criticality: 'criticality: ignore (1)'
per.open_type_length: 'Open Type Length: 53'
ngap.value_element:
-   ngap.UplinkNASTransport_element:
        per.extension_bit: '0... .... Extension Bit: False'
        per.sequence_of_length: 'Sequence-Of Length: 4'
        ngap.protocolIEs:
            'Item 0: id-AMF-UE-NGAP-ID':
                ngap.id: 'id: id-AMF-UE-NGAP-ID (10)'
                per.enum_index: 'Enumerated Index: 0'
                ngap.criticality: 'criticality: reject (0)'
                per.open_type_length: 'Open Type Length: 2'
                ngap.value_element:
                    ngap.AMF_UE_NGAP_ID: 'AMF-UE-NGAP-ID: 17'
            'Item 1: id-RAN-UE-NGAP-ID':
                ngap.id: 'id: id-RAN-UE-NGAP-ID (85)'
                per.enum_index: 'Enumerated Index: 0'
                ngap.criticality: 'criticality: reject (0)'
                per.open_type_length: 'Open Type Length: 2'
                ngap.value_element:
                    ngap.RAN_UE_NGAP_ID: 'RAN-UE-NGAP-ID: 1'
            'Item 2: id-NAS-PDU':
                ngap.id: 'id: id-NAS-PDU (38)'
                per.enum_index: 'Enumerated Index: 0'
                ngap.criticality: 'criticality: reject (0)'
                per.open_type_length: 'Open Type Length: 11'
                ngap.value_element:
                    per.octet_string_length: 'Octet String Length: 10'
                    ngap.NAS_PDU:
                        nas-5gs:
                            Security protected NAS 5GS message:
                                nas_5gs.epd: 'Extended protocol discriminator: 5G mobility management messages (126)'
                                nas_5gs.spare_half_octet: '0000 .... = Spare Half Octet: 0'
                                nas_5gs.security_header_type: '.... 0010 = Security header type: Integrity protected and ciphered (2)'
                                nas_5gs.msg_auth_code: 'Message authentication code: 0x4795f12b'
                                nas_5gs.seq_no: 'Sequence number: 1'
                            Plain NAS 5GS Message:
                                nas_5gs.epd: 'Extended protocol discriminator: 5G mobility management messages (126)'
                                nas_5gs.spare_half_octet: '0000 .... = Spare Half Octet: 0'
                                nas_5gs.security_header_type: '.... 0000 = Security header type: Plain NAS message, not security protected (0)'
                                nas_5gs.mm.message_type: 'Message type: Registration complete (0x43)'
            'Item 3: id-UserLocationInformation':
                ngap.id: 'id: id-UserLocationInformation (121)'
                per.enum_index: 'Enumerated Index: 1'
                ngap.criticality: 'criticality: ignore (1)'
                per.open_type_length: 'Open Type Length: 19'
                ngap.value_element:
                    per.choice_index: 'Choice Index: 1'
                    ngap.UserLocationInformation:
                        ngap.userLocationInformationNR_element:
                            per.extension_bit: '..0. .... Extension Bit: False'
                            per.optional_field_bit: '.... 0... Optional Field Bit: False (iE-Extensions is NOT present)'
                            ngap.nR_CGI_element:
                                per.extension_bit: '.... .0.. Extension Bit: False'
                                per.optional_field_bit: '.... ..0. Optional Field Bit: False (iE-Extensions is NOT present)'
                                ngap.pLMNIdentity:
                                    e212.mcc: 'Mobile Country Code (MCC): International Mobile, shared code (901)'
                                    e212.mnc: 'Mobile Network Code (MNC): Unknown (70)'
                                ngap.NRCellIdentity: 'nRCellIdentity: 0x0000000010'
                            ngap.tAI_element:
                                per.extension_bit: '.... 0... Extension Bit: False'
                                per.optional_field_bit: '.... .0.. Optional Field Bit: False (iE-Extensions is NOT present)'
                                ngap.pLMNIdentity:
                                    e212.mcc: 'Mobile Country Code (MCC): International Mobile, shared code (901)'
                                    e212.mnc: 'Mobile Network Code (MNC): Unknown (70)'
                                ngap.tAC: 'tAC: 1 (0x000001)'
                            ngap.timeStamp: 'timeStamp: e74c1dcf (Dec 20, 2022 11:41:03 UTC)'

NGAP-PDU: 002e405e000004000a0002001100550002000100260034337e02f5cfda5e027e00670100152e0101c1ffff91a12801007b000780000a00000d00120181220101250908696e7465726e6574007940135009f107000000010009f107000001e74c1dcf
ngap.procedureCode: 'procedureCode: id-UplinkNASTransport (46)'
per.enum_index: 'Enumerated Index: 1'
ngap.criticality: 'criticality: ignore (1)'
per.open_type_length: 'Open Type Length: 94'
ngap.value_element:
-   ngap.UplinkNASTransport_element:
        per.extension_bit: '0... .... Extension Bit: False'
        per.sequence_of_length: 'Sequence-Of Length: 4'
        ngap.protocolIEs:
            'Item 0: id-AMF-UE-NGAP-ID':
                ngap.id: 'id: id-AMF-UE-NGAP-ID (10)'
                per.enum_index: 'Enumerated Index: 0'
                ngap.criticality: 'criticality: reject (0)'
                per.open_type_length: 'Open Type Length: 2'
                ngap.value_element:
                    ngap.AMF_UE_NGAP_ID: 'AMF-UE-NGAP-ID: 17'
            'Item 1: id-RAN-UE-NGAP-ID':
                ngap.id: 'id: id-RAN-UE-NGAP-ID (85)'
                per.enum_index: 'Enumerated Index: 0'
                ngap.criticality: 'criticality: reject (0)'
                per.open_type_length: 'Open Type Length: 2'
                ngap.value_element:
                    ngap.RAN_UE_NGAP_ID: 'RAN-UE-NGAP-ID: 1'
            'Item 2: id-NAS-PDU':
                ngap.id: 'id: id-NAS-PDU (38)'
                per.enum_index: 'Enumerated Index: 0'
                ngap.criticality: 'criticality: reject (0)'
                per.open_type_length: 'Open Type Length: 52'
                ngap.value_element:
                    per.octet_string_length: 'Octet String Length: 51'
                    ngap.NAS_PDU:
                        nas-5gs:
                            Security protected NAS 5GS message:
                                nas_5gs.epd: 'Extended protocol discriminator: 5G mobility management messages (126)'
                                nas_5gs.spare_half_octet: '0000 .... = Spare Half Octet: 0'
                                nas_5gs.security_header_type: '.... 0010 = Security header type: Integrity protected and ciphered (2)'
                                nas_5gs.msg_auth_code: 'Message authentication code: 0xf5cfda5e'
                                nas_5gs.seq_no: 'Sequence number: 2'
                            Plain NAS 5GS Message:
                                nas_5gs.epd: 'Extended protocol discriminator: 5G mobility management messages (126)'
                                nas_5gs.spare_half_octet: '0000 .... = Spare Half Octet: 0'
                                nas_5gs.security_header_type: '.... 0000 = Security header type: Plain NAS message, not security protected (0)'
                                nas_5gs.mm.message_type: 'Message type: UL NAS transport (0x67)'
                                Payload container type:
                                    nas_5gs.mm.pld_cont_type: '.... 0001 = Payload container type: N1 SM information (1)'
                                Payload container:
                                    gsm_a.len: 'Length: 21'
                                    Plain NAS 5GS Message:
                                        nas_5gs.epd: 'Extended protocol discriminator: 5G session management messages (46)'
                                        nas_5gs.pdu_session_id: 'PDU session identity: PDU session identity value 1 (1)'
                                        nas_5gs.proc_trans_id: 'Procedure transaction identity: 1'
                                        nas_5gs.sm.message_type: 'Message type: PDU session establishment request (0xc1)'
                                        Integrity protection maximum data rate:
                                            nas_5gs.sm.int_prot_max_data_rate_ul: 'Integrity protection maximum data rate for uplink: Full data rate (255)'
                                            nas_5gs.sm.int_prot_max_data_rate_dl: 'Integrity protection maximum data rate for downlink: Full data rate (255)'
                                        PDU session type:
                                            gsm_a.common.elem_id: '1001 .... = Element ID: 0x9-'
                                            nas_5gs.sm.pdu_session_type: '.... 0001 = PDU session type: IPv4 (1)'
                                        SSC mode:
                                            gsm_a.common.elem_id: '1010 .... = Element ID: 0xa-'
                                            nas_5gs.sm.sc_mode: '.... 0001 = SSC mode: SSC mode 1 (1)'
                                        5GSM capability:
                                            nas_5gs.sm.elem_id: 'Element ID: 0x28'
                                            gsm_a.len: 'Length: 1'
                                            nas_5gs.spare_b7: '0... .... = Spare: 0'
                                            nas_5gs.spare_b6: '.0.. .... = Spare: 0'
                                            nas_5gs.spare_b5: '..0. .... = Spare: 0'
                                            nas_5gs.spare_b4: '...0 .... = Spare: 0'
                                            nas_5gs.spare_b3: '.... 0... = Spare: 0'
                                            nas_5gs.spare_b2: '.... .0.. = Spare: 0'
                                            nas_5gs.sm.mh6_pdu: '.... ..0. = Multi-homed IPv6 PDU session (MH6-PDU): Not supported'
                                            nas_5gs.sm.rqos: '.... ...0 = Reflective QoS (RqoS): Not supported'
                                        Extended protocol configuration options:
                                            nas_eps.esm.elem_id: 'Element ID: 0x7b'
                                            gsm_a.len: 'Length: 7'
                                            gsm_a.gm.sm.link_dir: 'Link direction: MS to network (0)'
                                            gsm_a.gm.sm.ext: '1... .... = Extension: True'
                                            gsm_a.gm.configuration_protocol: '.... .000 = Configuration Protocol: PPP for use with IP PDP type or IP PDN type (0)'
                                            gsm_a.gm.sm.pco_pid:
                                            -   gsm_a.gm.sm.pco.length: 'Length: 0x00 (0)'
                                            -   gsm_a.gm.sm.pco.length: 'Length: 0x00 (0)'
                                PDU session identity 2 - PDU session ID:
                                    nas_5gs.mm.elem_id: 'Element ID: 0x12'
                                    nas_5gs.pdu_session_id: 'PDU session identity: PDU session identity value 1 (1)'
                                Request type:
                                    gsm_a.common.elem_id: '1000 .... = Element ID: 0x8-'
                                    nas_5gs.mm.req_typ: '.... 0001 = Request type: Initial request (1)'
                                S-NSSAI:
                                    nas_5gs.common.elem_id: 'Element ID: 0x22'
                                    gsm_a.len: 'Length: 1'
                                    nas_5gs.mm.sst: 'Slice/service type (SST): 1'
                                DNN:
                                    nas_5gs.common.elem_id: 'Element ID: 0x25'
                                    gsm_a.len: 'Length: 9'
                                    nas_5gs.cmn.dnn: 'DNN: internet'
            'Item 3: id-UserLocationInformation':
                ngap.id: 'id: id-UserLocationInformation (121)'
                per.enum_index: 'Enumerated Index: 1'
                ngap.criticality: 'criticality: ignore (1)'
                per.open_type_length: 'Open Type Length: 19'
                ngap.value_element:
                    per.choice_index: 'Choice Index: 1'
                    ngap.UserLocationInformation:
                        ngap.userLocationInformationNR_element:
                            per.extension_bit: '..0. .... Extension Bit: False'
                            per.optional_field_bit: '.... 0... Optional Field Bit: False (iE-Extensions is NOT present)'
                            ngap.nR_CGI_element:
                                per.extension_bit: '.... .0.. Extension Bit: False'
                                per.optional_field_bit: '.... ..0. Optional Field Bit: False (iE-Extensions is NOT present)'
                                ngap.pLMNIdentity:
                                    e212.mcc: 'Mobile Country Code (MCC): International Mobile, shared code (901)'
                                    e212.mnc: 'Mobile Network Code (MNC): Unknown (70)'
                                ngap.NRCellIdentity: 'nRCellIdentity: 0x0000000010'
                            ngap.tAI_element:
                                per.extension_bit: '.... 0... Extension Bit: False'
                                per.optional_field_bit: '.... .0.. Optional Field Bit: False (iE-Extensions is NOT present)'
                                ngap.pLMNIdentity:
                                    e212.mcc: 'Mobile Country Code (MCC): International Mobile, shared code (901)'
                                    e212.mnc: 'Mobile Network Code (MNC): Unknown (70)'
                                ngap.tAC: 'tAC: 1 (0x000001)'
                            ngap.timeStamp: 'timeStamp: e74c1dcf (Dec 20, 2022 11:41:03 UTC)'

end note

"10.0.3.1" -> "10.0.2.15": 2168, NGAP DownlinkNASTransport (4),\nNAS Configuration update command (0x54)

note right #c6ebc6
**10.0.3.1 to 10.0.2.15**
NGAP-PDU: 0004403c000003000a0002001100550002000100260029287e02cc64ce6b027e0054430f90004f00700065006e00350047005346404722219261708040490100
ngap.procedureCode: 'procedureCode: id-DownlinkNASTransport (4)'
per.enum_index: 'Enumerated Index: 1'
ngap.criticality: 'criticality: ignore (1)'
per.open_type_length: 'Open Type Length: 60'
ngap.value_element:
-   ngap.DownlinkNASTransport_element:
        per.extension_bit: '0... .... Extension Bit: False'
        per.sequence_of_length: 'Sequence-Of Length: 3'
        ngap.protocolIEs:
            'Item 0: id-AMF-UE-NGAP-ID':
                ngap.id: 'id: id-AMF-UE-NGAP-ID (10)'
                per.enum_index: 'Enumerated Index: 0'
                ngap.criticality: 'criticality: reject (0)'
                per.open_type_length: 'Open Type Length: 2'
                ngap.value_element:
                    ngap.AMF_UE_NGAP_ID: 'AMF-UE-NGAP-ID: 17'
            'Item 1: id-RAN-UE-NGAP-ID':
                ngap.id: 'id: id-RAN-UE-NGAP-ID (85)'
                per.enum_index: 'Enumerated Index: 0'
                ngap.criticality: 'criticality: reject (0)'
                per.open_type_length: 'Open Type Length: 2'
                ngap.value_element:
                    ngap.RAN_UE_NGAP_ID: 'RAN-UE-NGAP-ID: 1'
            'Item 2: id-NAS-PDU':
                ngap.id: 'id: id-NAS-PDU (38)'
                per.enum_index: 'Enumerated Index: 0'
                ngap.criticality: 'criticality: reject (0)'
                per.open_type_length: 'Open Type Length: 41'
                ngap.value_element:
                    per.octet_string_length: 'Octet String Length: 40'
                    ngap.NAS_PDU:
                        nas-5gs:
                            Security protected NAS 5GS message:
                                nas_5gs.epd: 'Extended protocol discriminator: 5G mobility management messages (126)'
                                nas_5gs.spare_half_octet: '0000 .... = Spare Half Octet: 0'
                                nas_5gs.security_header_type: '.... 0010 = Security header type: Integrity protected and ciphered (2)'
                                nas_5gs.msg_auth_code: 'Message authentication code: 0xcc64ce6b'
                                nas_5gs.seq_no: 'Sequence number: 2'
                            Plain NAS 5GS Message:
                                nas_5gs.epd: 'Extended protocol discriminator: 5G mobility management messages (126)'
                                nas_5gs.spare_half_octet: '0000 .... = Spare Half Octet: 0'
                                nas_5gs.security_header_type: '.... 0000 = Security header type: Plain NAS message, not security protected (0)'
                                nas_5gs.mm.message_type: 'Message type: Configuration update command (0x54)'
                                Network Name - Full name for network:
                                    gsm_a.dtap.elem_id: 'Element ID: 0x43'
                                    gsm_a.len: 'Length: 15'
                                    gsm_a.extension: '1... .... = Extension: No Extension'
                                    gsm_a.dtap.coding_scheme: '.001 .... = Coding Scheme: UCS2 (16 bit) (1)'
                                    gsm_a.dtap.add_ci: '.... 0... = Add CI: The MS should not add the letters for the Country''s Initials to the text string'
                                    gsm_a.dtap.number_of_spare_bits: '.... .000 = Number of spare bits in last octet: this field carries no information about the number of spare bits in octet n (0)'
                                    gsm_a.dtap.text_string: 'Text String: Open5GS'
                                Time Zone - Local:
                                    gsm_a.dtap.elem_id: 'Element ID: 0x46'
                                    gsm_a.dtap.timezone: 'Timezone: GMT + 1 hours 0 minutes'
                                Time Zone and Time - Universal Time and Local Time Zone:
                                    gsm_a.dtap.elem_id: 'Element ID: 0x47'
                                    gsm_a.dtap.time_zone_time: 'Time: Dec 29, 2022 16:07:08.000000000'
                                    gsm_a.dtap.timezone: 'Timezone: GMT + 1 hours 0 minutes'
                                Daylight Saving Time:
                                    gsm_a.dtap.elem_id: 'Element ID: 0x49'
                                    gsm_a.len: 'Length: 1'
                                    gsm_a.spare_bits: '0000 00.. = Spare bit(s): 0'
                                    gsm_a.dtap.dst_adjustment: '.... ..00 = DST Adjustment: No adjustment for Daylight Saving Time (0)'

end note

"10.0.14.1" -> "10.0.17.1": 2210, PFCP req.\nPFCP Session Establishment Request (50)

note right #80b3ff
**10.0.14.1 to 10.0.17.1**
pfcp.flags:
-   pfcp.version: '001. .... = Version: 1'
    pfcp.spare_b4: '...0 .... = Spare: 0'
    pfcp.spare_b3: '.... 0... = Spare: 0'
    pfcp.spare_b2: '.... .0.. = Spare: 0'
    pfcp.mp_flag: '.... ..0. = Message Priority (MP): False'
    pfcp.s: '.... ...1 = SEID (S): True'
pfcp.msg_type: 'Message Type: PFCP Session Establishment Request (50)'
pfcp.length: 'Length: 577'
pfcp.seid: 'SEID: 0x0000000000000000'
pfcp.seqno: 'Sequence Number: 225'
pfcp.spare_oct: 'Spare: 0'
'Node ID : IPv4 address: 10.0.14.1':
-   pfcp.ie_type: 'IE Type: Node ID (60)'
    pfcp.ie_len: 'IE Length: 5'
    pfcp.spare_h1: '0000 .... = Spare: 0'
    pfcp.node_id_type: '.... 0000 = Node ID Type: IPv4 address (0)'
    pfcp.node_id_ipv4: 'Node ID IPv4: 10.0.14.1'
'F-SEID : SEID: 0x0000000000000009, IPv4 10.0.14.1':
-   pfcp.ie_type: 'IE Type: F-SEID (57)'
    pfcp.ie_len: 'IE Length: 13'
    pfcp.f_seid_flags:
        pfcp.spare_b7: '0... .... = Spare: 0'
        pfcp.spare_b6: '.0.. .... = Spare: 0'
        pfcp.spare_b5: '..0. .... = Spare: 0'
        pfcp.spare_b4: '...0 .... = Spare: 0'
        pfcp.spare_b3: '.... 0... = Spare: 0'
        pfcp.spare_b2: '.... .0.. = Spare: 0'
        pfcp.f_seid_flags.v4: '.... ..1. = V4 (IPv4): Present'
        pfcp.f_seid_flags.v6: '.... ...0 = V6 (IPv6): Not Present'
    pfcp.seid: 'SEID: 0x0000000000000009'
    pfcp.f_seid.ipv4: 'IPv4 address: 10.0.14.1'
'Create PDR : [Grouped IE]':
-   pfcp.ie_type: 'IE Type: Create PDR (1)'
    pfcp.ie_len: 'IE Length: 69'
    'PDR ID : 1':
        pfcp.ie_type: 'IE Type: PDR ID (56)'
        pfcp.ie_len: 'IE Length: 2'
        pfcp.pdr_id: 'Rule ID: 1'
    'Precedence : 255':
        pfcp.ie_type: 'IE Type: Precedence (29)'
        pfcp.ie_len: 'IE Length: 4'
        pfcp.precedence: 'Precedence: 255'
    'PDI : [Grouped IE]':
        pfcp.ie_type: 'IE Type: PDI (2)'
        pfcp.ie_len: 'IE Length: 27'
        'Source Interface : Core':
            pfcp.ie_type: 'IE Type: Source Interface (20)'
            pfcp.ie_len: 'IE Length: 1'
            pfcp.spare_h1: '0000 .... = Spare: 0'
            pfcp.source_interface: '.... 0001 = Source Interface: Core (1)'
        'Network Instance : internet':
            pfcp.ie_type: 'IE Type: Network Instance (22)'
            pfcp.ie_len: 'IE Length: 9'
            pfcp.network_instance: 'Network Instance: internet'
        'UE IP Address : ':
            pfcp.ie_type: 'IE Type: UE IP Address (93)'
            pfcp.ie_len: 'IE Length: 5'
            pfcp.ue_ip_address_flags:
                pfcp.spare_b7_b4: '0000 .... = Spare: 0'
                pfcp.ue_ip_address_flag.v6d: '.... 0... = IPv6D: Source IP address'
                pfcp.ue_ip_address_flag.sd: '.... .1.. = S/D: Destination IP address'
                pfcp.ue_ip_address_flag.v4: '.... ..1. = V4 (IPv4): Present'
                pfcp.ue_ip_address_flag.v6: '.... ...0 = V6 (IPv6): Not Present'
            pfcp.ue_ip_addr_ipv4: 'IPv4 address: 10.45.0.10'
    'FAR ID : Dynamic by CP 1':
        pfcp.ie_type: 'IE Type: FAR ID (108)'
        pfcp.ie_len: 'IE Length: 4'
        pfcp.far_id_flg: '0... .... .... .... .... .... .... .... = Allocation type: Dynamic by CP'
        pfcp.far_id: '.000 0000 0000 0000 0000 0000 0000 0001 = FAR ID: 1'
    'URR ID : Dynamic by CP 1':
        pfcp.ie_type: 'IE Type: URR ID (81)'
        pfcp.ie_len: 'IE Length: 4'
        pfcp.urr_id_flg: '0... .... .... .... .... .... .... .... = Allocation type: Dynamic by CP'
        pfcp.urr_id: '.000 0000 0000 0000 0000 0000 0000 0001 = URR ID: 1'
    'QER ID : Dynamic by CP 1':
        pfcp.ie_type: 'IE Type: QER ID (109)'
        pfcp.ie_len: 'IE Length: 4'
        pfcp.qer_id_flg: '0... .... .... .... .... .... .... .... = Allocation type: Dynamic by CP'
        pfcp.qer_id: '.000 0000 0000 0000 0000 0000 0000 0001 = QER ID: 1'
-   pfcp.ie_type: 'IE Type: Create PDR (1)'
    pfcp.ie_len: 'IE Length: 78'
    'PDR ID : 2':
        pfcp.ie_type: 'IE Type: PDR ID (56)'
        pfcp.ie_len: 'IE Length: 2'
        pfcp.pdr_id: 'Rule ID: 2'
    'Precedence : 255':
        pfcp.ie_type: 'IE Type: Precedence (29)'
        pfcp.ie_len: 'IE Length: 4'
        pfcp.precedence: 'Precedence: 255'
    'PDI : [Grouped IE]':
        pfcp.ie_type: 'IE Type: PDI (2)'
        pfcp.ie_len: 'IE Length: 38'
        'Source Interface : Access':
            pfcp.ie_type: 'IE Type: Source Interface (20)'
            pfcp.ie_len: 'IE Length: 1'
            pfcp.spare_h1: '0000 .... = Spare: 0'
            pfcp.source_interface: '.... 0000 = Source Interface: Access (0)'
        'F-TEID : ':
            pfcp.ie_type: 'IE Type: F-TEID (21)'
            pfcp.ie_len: 'IE Length: 2'
            pfcp.f_teid_flags:
                pfcp.fteid_flg.spare: '0000 .... = Spare: 0'
                pfcp.f_teid_flags.ch_id: '.... 1... = CHID (CHOOSE_ID): True'
                pfcp.f_teid_flags.ch: '.... .1.. = CH (CHOOSE): True'
                pfcp.f_teid_flags.v6: '.... ..1. = V6 (IPv6): Present'
                pfcp.f_teid_flags.v4: '.... ...1 = V4 (IPv4): Present'
            pfcp.f_teid.choose_id: 'Choose Id: 05'
        'Network Instance : internet':
            pfcp.ie_type: 'IE Type: Network Instance (22)'
            pfcp.ie_len: 'IE Length: 9'
            pfcp.network_instance: 'Network Instance: internet'
        'UE IP Address : ':
            pfcp.ie_type: 'IE Type: UE IP Address (93)'
            pfcp.ie_len: 'IE Length: 5'
            pfcp.ue_ip_address_flags:
                pfcp.spare_b7_b4: '0000 .... = Spare: 0'
                pfcp.ue_ip_address_flag.v6d: '.... 0... = IPv6D: Source IP address'
                pfcp.ue_ip_address_flag.sd: '.... .0.. = S/D: Source IP address'
                pfcp.ue_ip_address_flag.v4: '.... ..1. = V4 (IPv4): Present'
                pfcp.ue_ip_address_flag.v6: '.... ...0 = V6 (IPv6): Not Present'
            pfcp.ue_ip_addr_ipv4: 'IPv4 address: 10.45.0.10'
        'QFI : ':
            pfcp.ie_type: 'IE Type: QFI (124)'
            pfcp.ie_len: 'IE Length: 1'
            pfcp.spare_b7_b6: '00.. .... = Spare: 0'
            pfcp.qfi_value: '.000 0001 = QFI: 0x01'
    'Outer Header Removal : GTP-U/UDP/IPv4':
        pfcp.ie_type: 'IE Type: Outer Header Removal (95)'
        pfcp.ie_len: 'IE Length: 2'
        pfcp.out_hdr_desc: 'Outer Header Removal Description: GTP-U/UDP/IPv4 (0)'
        pfcp.gtpu_ext_hdr_del.pdu_sess_cont: '.... ...1 = PDU Session Container to be deleted: True'
    'FAR ID : Dynamic by CP 2':
        pfcp.ie_type: 'IE Type: FAR ID (108)'
        pfcp.ie_len: 'IE Length: 4'
        pfcp.far_id_flg: '0... .... .... .... .... .... .... .... = Allocation type: Dynamic by CP'
        pfcp.far_id: '.000 0000 0000 0000 0000 0000 0000 0010 = FAR ID: 2'
    'QER ID : Dynamic by CP 1':
        pfcp.ie_type: 'IE Type: QER ID (109)'
        pfcp.ie_len: 'IE Length: 4'
        pfcp.qer_id_flg: '0... .... .... .... .... .... .... .... = Allocation type: Dynamic by CP'
        pfcp.qer_id: '.000 0000 0000 0000 0000 0000 0000 0001 = QER ID: 1'
-   pfcp.ie_type: 'IE Type: Create PDR (1)'
    pfcp.ie_len: 'IE Length: 62'
    'PDR ID : 3':
        pfcp.ie_type: 'IE Type: PDR ID (56)'
        pfcp.ie_len: 'IE Length: 2'
        pfcp.pdr_id: 'Rule ID: 3'
    'Precedence : 1000':
        pfcp.ie_type: 'IE Type: Precedence (29)'
        pfcp.ie_len: 'IE Length: 4'
        pfcp.precedence: 'Precedence: 1000'
    'PDI : [Grouped IE]':
        pfcp.ie_type: 'IE Type: PDI (2)'
        pfcp.ie_len: 'IE Length: 23'
        'Source Interface : CP-function':
            pfcp.ie_type: 'IE Type: Source Interface (20)'
            pfcp.ie_len: 'IE Length: 1'
            pfcp.spare_h1: '0000 .... = Spare: 0'
            pfcp.source_interface: '.... 0011 = Source Interface: CP-function (3)'
        'F-TEID : ':
            pfcp.ie_type: 'IE Type: F-TEID (21)'
            pfcp.ie_len: 'IE Length: 1'
            pfcp.f_teid_flags:
                pfcp.fteid_flg.spare: '0000 .... = Spare: 0'
                pfcp.f_teid_flags.ch_id: '.... 0... = CHID (CHOOSE_ID): False'
                pfcp.f_teid_flags.ch: '.... .1.. = CH (CHOOSE): True'
                pfcp.f_teid_flags.v6: '.... ..1. = V6 (IPv6): Present'
                pfcp.f_teid_flags.v4: '.... ...1 = V4 (IPv4): Present'
        'Network Instance : internet':
            pfcp.ie_type: 'IE Type: Network Instance (22)'
            pfcp.ie_len: 'IE Length: 9'
            pfcp.network_instance: 'Network Instance: internet'
    'Outer Header Removal : GTP-U/UDP/IPv4':
        pfcp.ie_type: 'IE Type: Outer Header Removal (95)'
        pfcp.ie_len: 'IE Length: 1'
        pfcp.out_hdr_desc: 'Outer Header Removal Description: GTP-U/UDP/IPv4 (0)'
    'FAR ID : Dynamic by CP 1':
        pfcp.ie_type: 'IE Type: FAR ID (108)'
        pfcp.ie_len: 'IE Length: 4'
        pfcp.far_id_flg: '0... .... .... .... .... .... .... .... = Allocation type: Dynamic by CP'
        pfcp.far_id: '.000 0000 0000 0000 0000 0000 0000 0001 = FAR ID: 1'
    'QER ID : Dynamic by CP 1':
        pfcp.ie_type: 'IE Type: QER ID (109)'
        pfcp.ie_len: 'IE Length: 4'
        pfcp.qer_id_flg: '0... .... .... .... .... .... .... .... = Allocation type: Dynamic by CP'
        pfcp.qer_id: '.000 0000 0000 0000 0000 0000 0000 0001 = QER ID: 1'
-   pfcp.ie_type: 'IE Type: Create PDR (1)'
    pfcp.ie_len: 'IE Length: 110'
    'PDR ID : 4':
        pfcp.ie_type: 'IE Type: PDR ID (56)'
        pfcp.ie_len: 'IE Length: 2'
        pfcp.pdr_id: 'Rule ID: 4'
    'Precedence : 1':
        pfcp.ie_type: 'IE Type: Precedence (29)'
        pfcp.ie_len: 'IE Length: 4'
        pfcp.precedence: 'Precedence: 1'
    'PDI : [Grouped IE]':
        pfcp.ie_type: 'IE Type: PDI (2)'
        pfcp.ie_len: 'IE Length: 79'
        'Source Interface : Access':
            pfcp.ie_type: 'IE Type: Source Interface (20)'
            pfcp.ie_len: 'IE Length: 1'
            pfcp.spare_h1: '0000 .... = Spare: 0'
            pfcp.source_interface: '.... 0000 = Source Interface: Access (0)'
        'F-TEID : ':
            pfcp.ie_type: 'IE Type: F-TEID (21)'
            pfcp.ie_len: 'IE Length: 2'
            pfcp.f_teid_flags:
                pfcp.fteid_flg.spare: '0000 .... = Spare: 0'
                pfcp.f_teid_flags.ch_id: '.... 1... = CHID (CHOOSE_ID): True'
                pfcp.f_teid_flags.ch: '.... .1.. = CH (CHOOSE): True'
                pfcp.f_teid_flags.v6: '.... ..1. = V6 (IPv6): Present'
                pfcp.f_teid_flags.v4: '.... ...1 = V4 (IPv4): Present'
            pfcp.f_teid.choose_id: 'Choose Id: 05'
        'Network Instance : internet':
            pfcp.ie_type: 'IE Type: Network Instance (22)'
            pfcp.ie_len: 'IE Length: 9'
            pfcp.network_instance: 'Network Instance: internet'
        'SDF Filter : ':
            pfcp.ie_type: 'IE Type: SDF Filter (23)'
            pfcp.ie_len: 'IE Length: 46'
            pfcp.sdf_filter_flags:
                pfcp.spare_h1: '0000 .... = Spare: 0'
                pfcp.sdf_filter.bid: '...0 .... = BID (Bidirectional SDF Filter): False'
                pfcp.sdf_filter.fl: '.... 0... = FL (Flow Label): False'
                pfcp.sdf_filter.spi: '.... .0.. = SPI (Security Parameter Index): False'
                pfcp.sdf_filter.ttc: '.... ..0. = TTC (ToS Traffic Class): False'
                pfcp.sdf_filter.fd: '.... ...1 = FD (Flow Description): True'
            pfcp.spare: 'Spare: 0'
            pfcp.flow_desc_len: 'Length of Flow Description: 42'
            pfcp.flow_desc: 'Flow Description: permit out 58 from ff02::2/128 to assigned'
        'QFI : ':
            pfcp.ie_type: 'IE Type: QFI (124)'
            pfcp.ie_len: 'IE Length: 1'
            pfcp.spare_b7_b6: '00.. .... = Spare: 0'
            pfcp.qfi_value: '.000 0001 = QFI: 0x01'
    'Outer Header Removal : GTP-U/UDP/IPv4':
        pfcp.ie_type: 'IE Type: Outer Header Removal (95)'
        pfcp.ie_len: 'IE Length: 1'
        pfcp.out_hdr_desc: 'Outer Header Removal Description: GTP-U/UDP/IPv4 (0)'
    'FAR ID : Dynamic by CP 3':
        pfcp.ie_type: 'IE Type: FAR ID (108)'
        pfcp.ie_len: 'IE Length: 4'
        pfcp.far_id_flg: '0... .... .... .... .... .... .... .... = Allocation type: Dynamic by CP'
        pfcp.far_id: '.000 0000 0000 0000 0000 0000 0000 0011 = FAR ID: 3'
'Create FAR : [Grouped IE]':
-   pfcp.ie_type: 'IE Type: Create FAR (3)'
    pfcp.ie_len: 'IE Length: 19'
    'FAR ID : Dynamic by CP 1':
        pfcp.ie_type: 'IE Type: FAR ID (108)'
        pfcp.ie_len: 'IE Length: 4'
        pfcp.far_id_flg: '0... .... .... .... .... .... .... .... = Allocation type: Dynamic by CP'
        pfcp.far_id: '.000 0000 0000 0000 0000 0000 0000 0001 = FAR ID: 1'
    'Apply Action : ':
        pfcp.ie_type: 'IE Type: Apply Action (44)'
        pfcp.ie_len: 'IE Length: 2'
        pfcp.apply_action_flags:
            pfcp.spare_b7_b5: '000. .... = Spare: 0'
            pfcp.apply_action.dupl: '...0 .... = DUPL (Duplicate): False'
            pfcp.apply_action.nocp: '.... 1... = NOCP (Notify the CP function): True'
            pfcp.apply_action.buff: '.... .1.. = BUFF (Buffer): True'
            pfcp.apply_action.forw: '.... ..0. = FORW (Forward): False'
            pfcp.apply_action.drop: '.... ...0 = DROP (Drop): False'
        IE data not decoded by WS yet:
            _ws.expert:
                pfcp.ie_data_not_decoded: IE data not decoded by WS yet
                _ws.expert.message: 'Message: IE data not decoded by WS yet'
                _ws.expert.severity: 'Severity level: Note'
                _ws.expert.group: 'Group: Undecoded'
    'BAR ID : 1':
        pfcp.ie_type: 'IE Type: BAR ID (88)'
        pfcp.ie_len: 'IE Length: 1'
        pfcp.bar_id: 'BAR ID: 1'
-   pfcp.ie_type: 'IE Type: Create FAR (3)'
    pfcp.ie_len: 'IE Length: 36'
    'FAR ID : Dynamic by CP 2':
        pfcp.ie_type: 'IE Type: FAR ID (108)'
        pfcp.ie_len: 'IE Length: 4'
        pfcp.far_id_flg: '0... .... .... .... .... .... .... .... = Allocation type: Dynamic by CP'
        pfcp.far_id: '.000 0000 0000 0000 0000 0000 0000 0010 = FAR ID: 2'
    'Apply Action : ':
        pfcp.ie_type: 'IE Type: Apply Action (44)'
        pfcp.ie_len: 'IE Length: 2'
        pfcp.apply_action_flags:
            pfcp.spare_b7_b5: '000. .... = Spare: 0'
            pfcp.apply_action.dupl: '...0 .... = DUPL (Duplicate): False'
            pfcp.apply_action.nocp: '.... 0... = NOCP (Notify the CP function): False'
            pfcp.apply_action.buff: '.... .0.. = BUFF (Buffer): False'
            pfcp.apply_action.forw: '.... ..1. = FORW (Forward): True'
            pfcp.apply_action.drop: '.... ...0 = DROP (Drop): False'
        IE data not decoded by WS yet:
            _ws.expert:
                pfcp.ie_data_not_decoded: IE data not decoded by WS yet
                _ws.expert.message: 'Message: IE data not decoded by WS yet'
                _ws.expert.severity: 'Severity level: Note'
                _ws.expert.group: 'Group: Undecoded'
    'Forwarding Parameters : [Grouped IE]':
        pfcp.ie_type: 'IE Type: Forwarding Parameters (4)'
        pfcp.ie_len: 'IE Length: 18'
        'Destination Interface : Core':
            pfcp.ie_type: 'IE Type: Destination Interface (42)'
            pfcp.ie_len: 'IE Length: 1'
            pfcp.spare_h1: '0000 .... = Spare: 0'
            pfcp.dst_interface: '.... 0001 = Interface: Core (1)'
        'Network Instance : internet':
            pfcp.ie_type: 'IE Type: Network Instance (22)'
            pfcp.ie_len: 'IE Length: 9'
            pfcp.network_instance: 'Network Instance: internet'
-   pfcp.ie_type: 'IE Type: Create FAR (3)'
    pfcp.ie_len: 'IE Length: 50'
    'FAR ID : Dynamic by CP 3':
        pfcp.ie_type: 'IE Type: FAR ID (108)'
        pfcp.ie_len: 'IE Length: 4'
        pfcp.far_id_flg: '0... .... .... .... .... .... .... .... = Allocation type: Dynamic by CP'
        pfcp.far_id: '.000 0000 0000 0000 0000 0000 0000 0011 = FAR ID: 3'
    'Apply Action : ':
        pfcp.ie_type: 'IE Type: Apply Action (44)'
        pfcp.ie_len: 'IE Length: 2'
        pfcp.apply_action_flags:
            pfcp.spare_b7_b5: '000. .... = Spare: 0'
            pfcp.apply_action.dupl: '...0 .... = DUPL (Duplicate): False'
            pfcp.apply_action.nocp: '.... 0... = NOCP (Notify the CP function): False'
            pfcp.apply_action.buff: '.... .0.. = BUFF (Buffer): False'
            pfcp.apply_action.forw: '.... ..1. = FORW (Forward): True'
            pfcp.apply_action.drop: '.... ...0 = DROP (Drop): False'
        IE data not decoded by WS yet:
            _ws.expert:
                pfcp.ie_data_not_decoded: IE data not decoded by WS yet
                _ws.expert.message: 'Message: IE data not decoded by WS yet'
                _ws.expert.severity: 'Severity level: Note'
                _ws.expert.group: 'Group: Undecoded'
    'Forwarding Parameters : [Grouped IE]':
        pfcp.ie_type: 'IE Type: Forwarding Parameters (4)'
        pfcp.ie_len: 'IE Length: 32'
        'Destination Interface : CP- Function':
            pfcp.ie_type: 'IE Type: Destination Interface (42)'
            pfcp.ie_len: 'IE Length: 1'
            pfcp.spare_h1: '0000 .... = Spare: 0'
            pfcp.dst_interface: '.... 0011 = Interface: CP- Function (3)'
        'Network Instance : internet':
            pfcp.ie_type: 'IE Type: Network Instance (22)'
            pfcp.ie_len: 'IE Length: 9'
            pfcp.network_instance: 'Network Instance: internet'
        'Outer Header Creation : ':
            pfcp.ie_type: 'IE Type: Outer Header Creation (84)'
            pfcp.ie_len: 'IE Length: 10'
            pfcp.outer_hdr_desc: 'Outer Header Creation Description: GTP-U/UDP/IPv4  (256)'
            pfcp.outer_hdr_creation.teid: 'TEID: 0x00000009'
            pfcp.outer_hdr_creation.ipv4: 'IPv4 Address: 10.0.14.1'
'Create URR : [Grouped IE]':
-   pfcp.ie_type: 'IE Type: Create URR (6)'
    pfcp.ie_len: 'IE Length: 33'
    'URR ID : Dynamic by CP 1':
        pfcp.ie_type: 'IE Type: URR ID (81)'
        pfcp.ie_len: 'IE Length: 4'
        pfcp.urr_id_flg: '0... .... .... .... .... .... .... .... = Allocation type: Dynamic by CP'
        pfcp.urr_id: '.000 0000 0000 0000 0000 0000 0000 0001 = URR ID: 1'
    'Measurement Method : ':
        pfcp.ie_type: 'IE Type: Measurement Method (62)'
        pfcp.ie_len: 'IE Length: 1'
        pfcp.measurement_method_flags:
            pfcp.spare_b7_b3: '0000 0... = Spare: 0'
            pfcp.measurement_method_flags.event: '.... .0.. = EVENT (Event): False'
            pfcp.measurement_method_flags.volume: '.... ..1. = VOLUM (Volume): True'
            pfcp.measurement_method_flags.durat: '.... ...0 = DURAT (Duration): False'
    'Reporting Triggers : ':
        pfcp.ie_type: 'IE Type: Reporting Triggers (37)'
        pfcp.ie_len: 'IE Length: 3'
        pfcp.reporting_triggers_flags.liusa: '0... .... = LIUSA (Linked Usage Reporting): False'
        pfcp.reporting_triggers_flags.droth: '.0.. .... = DROTH (Dropped DL Traffic Threshold): False'
        pfcp.reporting_triggers_flags.stopt: '..0. .... = STOPT (Stop of Traffic): False'
        pfcp.reporting_triggers_flags.start: '...0 .... = START (Start of Traffic): False'
        pfcp.reporting_triggers_flags.quhti: '.... 0... = QUHTI (Quota Holding Time): False'
        pfcp.reporting_triggers_flags.timth: '.... .0.. = TIMTH (Time Threshold): False'
        pfcp.reporting_triggers_flags.volth: '.... ..1. = VOLTH (Volume Threshold): True'
        pfcp.reporting_triggers_flags.perio: '.... ...0 = PERIO (Periodic Reporting): False'
        pfcp.spare_b7_b5: '000. .... = Spare: 0'
        pfcp.reporting_triggers_flags.evequ: '..0. .... = EVEQU (Event Quota): False'
        pfcp.reporting_triggers_flags.eveth: '...0 .... = EVETH (Event Threshold): False'
        pfcp.reporting_triggers_flags.macar: '.... 0... = MACAR (MAC Addresses Reporting): False'
        pfcp.reporting_triggers_flags.envcl: '.... .0.. = ENVCL (Envelope Closure): False'
        pfcp.reporting_triggers_flags.timqu: '.... ..0. = TIMQU (Time Quota): False'
        pfcp.reporting_triggers_flags.volqu: '.... ...0 = VOLQU (Volume Quota): False'
        IE data not decoded by WS yet:
            _ws.expert:
                pfcp.ie_data_not_decoded: IE data not decoded by WS yet
                _ws.expert.message: 'Message: IE data not decoded by WS yet'
                _ws.expert.severity: 'Severity level: Note'
                _ws.expert.group: 'Group: Undecoded'
    'Volume Threshold : ':
        pfcp.ie_type: 'IE Type: Volume Threshold (31)'
        pfcp.ie_len: 'IE Length: 9'
        pfcp.volume_threshold:
            pfcp.spare_b7_b3: '0000 0... = Spare: 0'
            pfcp.volume_threshold_flags.dlvol: '.... .0.. = DLVOL: False'
            pfcp.volume_threshold_flags.ulvol: '.... ..0. = ULVOL: False'
            pfcp.volume_threshold_flags.tovol: '.... ...1 = TOVOL: True'
        pfcp.volume_threshold.tovol: 'Total Volume: 104857600'
'Create QER : [Grouped IE]':
-   pfcp.ie_type: 'IE Type: Create QER (7)'
    pfcp.ie_len: 'IE Length: 32'
    'QER ID : Dynamic by CP 1':
        pfcp.ie_type: 'IE Type: QER ID (109)'
        pfcp.ie_len: 'IE Length: 4'
        pfcp.qer_id_flg: '0... .... .... .... .... .... .... .... = Allocation type: Dynamic by CP'
        pfcp.qer_id: '.000 0000 0000 0000 0000 0000 0000 0001 = QER ID: 1'
    'Gate Status : ':
        pfcp.ie_type: 'IE Type: Gate Status (25)'
        pfcp.ie_len: 'IE Length: 1'
        pfcp.gate_status:
            pfcp.gate_status.ulgate: '.... ..00 = DL Gate: OPEN (0)'
    'MBR : ':
        pfcp.ie_type: 'IE Type: MBR (26)'
        pfcp.ie_len: 'IE Length: 10'
        pfcp.ul_mbr: 'UL MBR: 1073741'
        pfcp.dl_mbr: 'DL MBR: 1073741'
    'QFI : ':
        pfcp.ie_type: 'IE Type: QFI (124)'
        pfcp.ie_len: 'IE Length: 1'
        pfcp.spare_b7_b6: '00.. .... = Spare: 0'
        pfcp.qfi_value: '.000 0001 = QFI: 0x01'
'Create BAR : [Grouped IE]':
-   pfcp.ie_type: 'IE Type: Create BAR (85)'
    pfcp.ie_len: 'IE Length: 5'
    'BAR ID : 1':
        pfcp.ie_type: 'IE Type: BAR ID (88)'
        pfcp.ie_len: 'IE Length: 1'
        pfcp.bar_id: 'BAR ID: 1'
'PDN Type : IPv4':
-   pfcp.ie_type: 'IE Type: PDN Type (113)'
    pfcp.ie_len: 'IE Length: 1'
    pfcp.pdn_type: '.... .001 = PDN Type: IPv4 (1)'
pfcp.response_in: 'Response In: 2211'

end note

"10.0.17.1" -> "10.0.14.1": 2211, PFCP rsp.\nPFCP Session Establishment Response (51)

note right #cce0ff
**10.0.17.1 to 10.0.14.1**
pfcp.flags:
-   pfcp.version: '001. .... = Version: 1'
    pfcp.spare_b4: '...0 .... = Spare: 0'
    pfcp.spare_b3: '.... 0... = Spare: 0'
    pfcp.spare_b2: '.... .0.. = Spare: 0'
    pfcp.mp_flag: '.... ..0. = Message Priority (MP): False'
    pfcp.s: '.... ...1 = SEID (S): True'
pfcp.msg_type: 'Message Type: PFCP Session Establishment Response (51)'
pfcp.length: 'Length: 112'
pfcp.seid: 'SEID: 0x0000000000000009'
pfcp.seqno: 'Sequence Number: 225'
pfcp.spare_oct: 'Spare: 0'
'Node ID : IPv4 address: 10.0.17.1':
-   pfcp.ie_type: 'IE Type: Node ID (60)'
    pfcp.ie_len: 'IE Length: 5'
    pfcp.spare_h1: '0000 .... = Spare: 0'
    pfcp.node_id_type: '.... 0000 = Node ID Type: IPv4 address (0)'
    pfcp.node_id_ipv4: 'Node ID IPv4: 10.0.17.1'
'Cause : Request accepted(success)':
-   pfcp.ie_type: 'IE Type: Cause (19)'
    pfcp.ie_len: 'IE Length: 1'
    pfcp.cause: 'Cause: Request accepted(success) (1)'
'F-SEID : SEID: 0x0000000000000009, IPv4 10.0.17.1':
-   pfcp.ie_type: 'IE Type: F-SEID (57)'
    pfcp.ie_len: 'IE Length: 13'
    pfcp.f_seid_flags:
        pfcp.spare_b7: '0... .... = Spare: 0'
        pfcp.spare_b6: '.0.. .... = Spare: 0'
        pfcp.spare_b5: '..0. .... = Spare: 0'
        pfcp.spare_b4: '...0 .... = Spare: 0'
        pfcp.spare_b3: '.... 0... = Spare: 0'
        pfcp.spare_b2: '.... .0.. = Spare: 0'
        pfcp.f_seid_flags.v4: '.... ..1. = V4 (IPv4): Present'
        pfcp.f_seid_flags.v6: '.... ...0 = V6 (IPv6): Not Present'
    pfcp.seid: 'SEID: 0x0000000000000009'
    pfcp.f_seid.ipv4: 'IPv4 address: 10.0.17.1'
'Created PDR : [Grouped IE]':
-   pfcp.ie_type: 'IE Type: Created PDR (8)'
    pfcp.ie_len: 'IE Length: 19'
    'PDR ID : 2':
        pfcp.ie_type: 'IE Type: PDR ID (56)'
        pfcp.ie_len: 'IE Length: 2'
        pfcp.pdr_id: 'Rule ID: 2'
    'F-TEID : TEID: 0x00000022, IPv4 10.0.17.1':
        pfcp.ie_type: 'IE Type: F-TEID (21)'
        pfcp.ie_len: 'IE Length: 9'
        pfcp.f_teid_flags:
            pfcp.fteid_flg.spare: '0000 .... = Spare: 0'
            pfcp.f_teid_flags.ch_id: '.... 0... = CHID (CHOOSE_ID): False'
            pfcp.f_teid_flags.ch: '.... .0.. = CH (CHOOSE): False'
            pfcp.f_teid_flags.v6: '.... ..0. = V6 (IPv6): Not Present'
            pfcp.f_teid_flags.v4: '.... ...1 = V4 (IPv4): Present'
        pfcp.f_teid.teid: 'TEID: 0x00000022'
        pfcp.f_teid.ipv4_addr: 'IPv4 address: 10.0.17.1'
-   pfcp.ie_type: 'IE Type: Created PDR (8)'
    pfcp.ie_len: 'IE Length: 19'
    'PDR ID : 3':
        pfcp.ie_type: 'IE Type: PDR ID (56)'
        pfcp.ie_len: 'IE Length: 2'
        pfcp.pdr_id: 'Rule ID: 3'
    'F-TEID : TEID: 0x00000023, IPv4 10.0.17.1':
        pfcp.ie_type: 'IE Type: F-TEID (21)'
        pfcp.ie_len: 'IE Length: 9'
        pfcp.f_teid_flags:
            pfcp.fteid_flg.spare: '0000 .... = Spare: 0'
            pfcp.f_teid_flags.ch_id: '.... 0... = CHID (CHOOSE_ID): False'
            pfcp.f_teid_flags.ch: '.... .0.. = CH (CHOOSE): False'
            pfcp.f_teid_flags.v6: '.... ..0. = V6 (IPv6): Not Present'
            pfcp.f_teid_flags.v4: '.... ...1 = V4 (IPv4): Present'
        pfcp.f_teid.teid: 'TEID: 0x00000023'
        pfcp.f_teid.ipv4_addr: 'IPv4 address: 10.0.17.1'
-   pfcp.ie_type: 'IE Type: Created PDR (8)'
    pfcp.ie_len: 'IE Length: 19'
    'PDR ID : 4':
        pfcp.ie_type: 'IE Type: PDR ID (56)'
        pfcp.ie_len: 'IE Length: 2'
        pfcp.pdr_id: 'Rule ID: 4'
    'F-TEID : TEID: 0x00000022, IPv4 10.0.17.1':
        pfcp.ie_type: 'IE Type: F-TEID (21)'
        pfcp.ie_len: 'IE Length: 9'
        pfcp.f_teid_flags:
            pfcp.fteid_flg.spare: '0000 .... = Spare: 0'
            pfcp.f_teid_flags.ch_id: '.... 0... = CHID (CHOOSE_ID): False'
            pfcp.f_teid_flags.ch: '.... .0.. = CH (CHOOSE): False'
            pfcp.f_teid_flags.v6: '.... ..0. = V6 (IPv6): Not Present'
            pfcp.f_teid_flags.v4: '.... ...1 = V4 (IPv4): Present'
        pfcp.f_teid.teid: 'TEID: 0x00000022'
        pfcp.f_teid.ipv4_addr: 'IPv4 address: 10.0.17.1'
pfcp.response_to: 'Response To: 2210'
pfcp.response_time: 'Response Time: 0.000942777 seconds'

end note

"10.0.3.1" -> "10.0.2.15": 2216, NGAP PDUSessionResourceSetup (29),\nNAS DL NAS transport (0x68),\nNAS PDU session establishment accept (0xc2)

note right #c6ebc6
**10.0.3.1 to 10.0.2.15**
NGAP-PDU: 001d0080ae000004000a00020011005500020001004a00808c004001567e02d65d3cad037e00680100472e0101c211000901000631310101ff01060b00010b00012905010a2d000a2201017900060120410101097b000f80000d0408080808000d0408080404250908696e7465726e6574120100202f0000040082000a0c400000003040000000008b000a01f00a0011010000002200860001000088000700010000091c00006e400a0c400000003040000000
ngap.procedureCode: 'procedureCode: id-PDUSessionResourceSetup (29)'
per.enum_index: 'Enumerated Index: 0'
ngap.criticality: 'criticality: reject (0)'
per.open_type_length: 'Open Type Length: 174'
ngap.value_element:
-   ngap.PDUSessionResourceSetupRequest_element:
        per.extension_bit: '0... .... Extension Bit: False'
        per.sequence_of_length: 'Sequence-Of Length: 4'
        ngap.protocolIEs:
            'Item 0: id-AMF-UE-NGAP-ID':
                ngap.id: 'id: id-AMF-UE-NGAP-ID (10)'
                per.enum_index: 'Enumerated Index: 0'
                ngap.criticality: 'criticality: reject (0)'
                per.open_type_length: 'Open Type Length: 2'
                ngap.value_element:
                    ngap.AMF_UE_NGAP_ID: 'AMF-UE-NGAP-ID: 17'
            'Item 1: id-RAN-UE-NGAP-ID':
                ngap.id: 'id: id-RAN-UE-NGAP-ID (85)'
                per.enum_index: 'Enumerated Index: 0'
                ngap.criticality: 'criticality: reject (0)'
                per.open_type_length: 'Open Type Length: 2'
                ngap.value_element:
                    ngap.RAN_UE_NGAP_ID: 'RAN-UE-NGAP-ID: 1'
            'Item 2: id-PDUSessionResourceSetupListSUReq':
                ngap.id: 'id: id-PDUSessionResourceSetupListSUReq (74)'
                per.enum_index: 'Enumerated Index: 0'
                ngap.criticality: 'criticality: reject (0)'
                per.open_type_length: 'Open Type Length: 140'
                ngap.value_element:
                    per.sequence_of_length: 'Sequence-Of Length: 1'
                    ngap.PDUSessionResourceSetupListSUReq:
                        Item 0:
                            ngap.PDUSessionResourceSetupItemSUReq_element:
                                per.extension_bit: '0... .... Extension Bit: False'
                                per.optional_field_bit: '..0. .... Optional Field Bit: False (iE-Extensions is NOT present)'
                                ngap.pDUSessionID: 'pDUSessionID: 1'
                                per.octet_string_length: 'Octet String Length: 47'
                                ngap.pDUSessionNAS_PDU:
                                    nas-5gs:
                                        Security protected NAS 5GS message:
                                            nas_5gs.epd: 'Extended protocol discriminator: 5G mobility management messages (126)'
                                            nas_5gs.spare_half_octet: '0000 .... = Spare Half Octet: 0'
                                            nas_5gs.security_header_type: '.... 0010 = Security header type: Integrity protected and ciphered (2)'
                                            nas_5gs.msg_auth_code: 'Message authentication code: 0xd65d3cad'
                                            nas_5gs.seq_no: 'Sequence number: 3'
                                        Plain NAS 5GS Message:
                                            nas_5gs.epd: 'Extended protocol discriminator: 5G mobility management messages (126)'
                                            nas_5gs.spare_half_octet: '0000 .... = Spare Half Octet: 0'
                                            nas_5gs.security_header_type: '.... 0000 = Security header type: Plain NAS message, not security protected (0)'
                                            nas_5gs.mm.message_type: 'Message type: DL NAS transport (0x68)'
                                            Payload container type:
                                                nas_5gs.mm.pld_cont_type: '.... 0001 = Payload container type: N1 SM information (1)'
                                            Payload container:
                                                gsm_a.len: 'Length: 71'
                                                Plain NAS 5GS Message:
                                                    nas_5gs.epd: 'Extended protocol discriminator: 5G session management messages (46)'
                                                    nas_5gs.pdu_session_id: 'PDU session identity: PDU session identity value 1 (1)'
                                                    nas_5gs.proc_trans_id: 'Procedure transaction identity: 1'
                                                    nas_5gs.sm.message_type: 'Message type: PDU session establishment accept (0xc2)'
                                                    nas_5gs.sm.sel_sc_mode: '0001 .... = Selected SSC mode: SSC mode 1 (1)'
                                                    PDU session type - Selected PDU session type:
                                                        nas_5gs.sm.pdu_session_type: '.... 0001 = PDU session type: IPv4 (1)'
                                                    QoS rules - Authorized QoS rules:
                                                        gsm_a.len: 'Length: 9'
                                                        QoS rule 1:
                                                            nas_5gs.sm.qos_rule_id: 'QoS rule identifier: 1'
                                                            nas_5gs.sm.length: 'Length: 6'
                                                            nas_5gs.sm.rop: '001. .... = Rule operation code: Create new QoS rule (1)'
                                                            nas_5gs.sm.dqr: '...1 .... = DQR: The QoS rule is the default QoS rule'
                                                            nas_5gs.sm.nof_pkt_filters: '.... 0001 = Number of packet filters: 1'
                                                            Packet filter 1:
                                                                nas_5gs.sm.pkt_flt_dir: '..11 .... = Packet filter direction: Bidirectional (3)'
                                                                nas_5gs.sm.pkt_flt_id: '.... 0001 = Packet filter identifier: 1'
                                                                nas_5gs.sm.pf_len: 'Length: 1'
                                                                Packet filter component 1:
                                                                    nas_5gs.sm.pf_type: 'Packet filter component type: Match-all type (1)'
                                                            nas_5gs.sm.qos_rule_precedence: 'QoS rule precedence: 255'
                                                            nas_5gs.spare_b7: '0... .... = Spare: 0'
                                                            nas_5gs.spare_b6: '.0.. .... = Spare: 0'
                                                            nas_5gs.sm.qfi: '..00 0001 = Qos flow identifier: 1'
                                                    Session-AMBR:
                                                        gsm_a.len: 'Length: 6'
                                                        nas_5gs.sm.unit_for_session_ambr_dl: 'Unit for Session-AMBR for downlink: value is incremented in multiples of 1 Gbps (11)'
                                                        nas_5gs.sm.session_ambr_dl: 'Session-AMBR for downlink: 1 Gbps (1)'
                                                        nas_5gs.sm.unit_for_session_ambr_ul: 'Unit for Session-AMBR for uplink: value is incremented in multiples of 1 Gbps (11)'
                                                        nas_5gs.sm.session_ambr_ul: 'Session-AMBR for uplink: 1 Gbps (1)'
                                                    PDU address:
                                                        nas_5gs.sm.elem_id: 'Element ID: 0x29'
                                                        gsm_a.len: 'Length: 5'
                                                        nas_5gs.sm.pdu_ses_type: '.... 0001 = PDU session type: IPv4 (1)'
                                                        nas_5gs.sm.pdu_addr_inf_ipv4: 'PDU address information: 10.45.0.10'
                                                    S-NSSAI:
                                                        nas_5gs.common.elem_id: 'Element ID: 0x22'
                                                        gsm_a.len: 'Length: 1'
                                                        nas_5gs.mm.sst: 'Slice/service type (SST): 1'
                                                    QoS flow descriptions - Authorized:
                                                        nas_5gs.sm.elem_id: 'Element ID: 0x79'
                                                        gsm_a.len: 'Length: 6'
                                                        QoS flow description 1:
                                                            nas_5gs.sm.qfi: '..00 0001 = Qos flow identifier: 1'
                                                            nas_5gs.sm.hf_nas_5gs_sm_qos_des_flow_opt_code: '001. .... = Operation code: Create new QoS flow description (1)'
                                                            nas_5gs.sm.e: '.1.. .... = E bit: 1'
                                                            nas_5gs.sm.nof_params: '..00 0001 = Number of parameters: 1'
                                                            Parameter 1 - 5QI:
                                                                nas_5gs.sm.param_id: 'Parameter identifier: 5QI (1)'
                                                                nas_5gs.sm.param_len: 'Length: 1'
                                                                nas_5gs.sm.5qi: '5QI: 9'
                                                    Extended protocol configuration options:
                                                        nas_eps.esm.elem_id: 'Element ID: 0x7b'
                                                        gsm_a.len: 'Length: 15'
                                                        gsm_a.gm.sm.link_dir: 'Link direction: Network to MS (1)'
                                                        gsm_a.gm.sm.ext: '1... .... = Extension: True'
                                                        gsm_a.gm.configuration_protocol: '.... .000 = Configuration Protocol: PPP for use with IP PDP type or IP PDN type (0)'
                                                        gsm_a.gm.sm.pco_pid:
                                                        -   gsm_a.gm.sm.pco.length: 'Length: 0x04 (4)'
                                                            gsm_a.gm.sm.pco.dns.ipv4: 'IPv4: 8.8.8.8'
                                                        -   gsm_a.gm.sm.pco.length: 'Length: 0x04 (4)'
                                                            gsm_a.gm.sm.pco.dns.ipv4: 'IPv4: 8.8.4.4'
                                                    DNN:
                                                        nas_5gs.common.elem_id: 'Element ID: 0x25'
                                                        gsm_a.len: 'Length: 9'
                                                        nas_5gs.cmn.dnn: 'DNN: internet'
                                            PDU session identity 2 - PDU session ID:
                                                nas_5gs.mm.elem_id: 'Element ID: 0x12'
                                                nas_5gs.pdu_session_id: 'PDU session identity: PDU session identity value 1 (1)'
                                ngap.s_NSSAI_element:
                                    per.extension_bit: '0... .... Extension Bit: False'
                                    per.optional_field_bit: '..0. .... Optional Field Bit: False (iE-Extensions is NOT present)'
                                    ngap.sST: 'sST: 01'
                                ngap.pDUSessionResourceSetupRequestTransfer:
                                    ngap.PDUSessionResourceSetupRequestTransfer_element:
                                        per.extension_bit: '0... .... Extension Bit: False'
                                        per.sequence_of_length: 'Sequence-Of Length: 4'
                                        ngap.protocolIEs:
                                            'Item 0: id-PDUSessionAggregateMaximumBitRate':
                                                ngap.id: 'id: id-PDUSessionAggregateMaximumBitRate (130)'
                                                per.enum_index: 'Enumerated Index: 0'
                                                ngap.criticality: 'criticality: reject (0)'
                                                per.open_type_length: 'Open Type Length: 10'
                                                ngap.value_element:
                                                    ngap.PDUSessionAggregateMaximumBitRate_element:
                                                        per.extension_bit: '0... .... Extension Bit: False'
                                                        per.optional_field_bit: '.0.. .... Optional Field Bit: False (iE-Extensions is NOT present)'
                                                        per.extension_present_bit: '0... .... Extension Present Bit: False'
                                                        ngap.pDUSessionAggregateMaximumBitRateDL: 'pDUSessionAggregateMaximumBitRateDL: 1073741824bits/s'
                                                        ngap.pDUSessionAggregateMaximumBitRateUL: 'pDUSessionAggregateMaximumBitRateUL: 1073741824bits/s'
                                            'Item 1: id-UL-NGU-UP-TNLInformation':
                                                ngap.id: 'id: id-UL-NGU-UP-TNLInformation (139)'
                                                per.enum_index: 'Enumerated Index: 0'
                                                ngap.criticality: 'criticality: reject (0)'
                                                per.open_type_length: 'Open Type Length: 10'
                                                ngap.value_element:
                                                    per.choice_index: 'Choice Index: 0'
                                                    ngap.UPTransportLayerInformation:
                                                        ngap.gTPTunnel_element:
                                                            per.extension_bit: '.0.. .... Extension Bit: False'
                                                            per.optional_field_bit: '..0. .... Optional Field Bit: False (iE-Extensions is NOT present)'
                                                            per.extension_present_bit: '...0 .... Extension Present Bit: False'
                                                            per.bit_string_length: 'Bit String Length: 32'
                                                            ngap.transportLayerAddress:
                                                                ngap.TransportLayerAddressIPv4: 'TransportLayerAddress (IPv4): 10.0.17.1'
                                                            ngap.gTP_TEID: 'gTP-TEID: 00000022'
                                            'Item 2: id-PDUSessionType':
                                                ngap.id: 'id: id-PDUSessionType (134)'
                                                per.enum_index: 'Enumerated Index: 0'
                                                ngap.criticality: 'criticality: reject (0)'
                                                per.open_type_length: 'Open Type Length: 1'
                                                ngap.value_element:
                                                    per.extension_present_bit: '0... .... Extension Present Bit: False'
                                                    per.enum_index: 'Enumerated Index: 0'
                                                    ngap.PDUSessionType: 'PDUSessionType: ipv4 (0)'
                                            'Item 3: id-QosFlowSetupRequestList':
                                                ngap.id: 'id: id-QosFlowSetupRequestList (136)'
                                                per.enum_index: 'Enumerated Index: 0'
                                                ngap.criticality: 'criticality: reject (0)'
                                                per.open_type_length: 'Open Type Length: 7'
                                                ngap.value_element:
                                                    per.sequence_of_length: 'Sequence-Of Length: 1'
                                                    ngap.QosFlowSetupRequestList:
                                                        Item 0:
                                                            ngap.QosFlowSetupRequestItem_element:
                                                                per.extension_bit: '.... ..0. Extension Bit: False'
                                                                per.optional_field_bit: '0... .... Optional Field Bit: False (iE-Extensions is NOT present)'
                                                                per.extension_present_bit: '.0.. .... Extension Present Bit: False'
                                                                ngap.qosFlowIdentifier: 'qosFlowIdentifier: 1'
                                                                ngap.qosFlowLevelQosParameters_element:
                                                                    per.extension_bit: '0... .... Extension Bit: False'
                                                                    per.optional_field_bit: '.... 0... Optional Field Bit: False (iE-Extensions is NOT present)'
                                                                    per.choice_index: 'Choice Index: 0'
                                                                    ngap.qosCharacteristics:
                                                                        ngap.nonDynamic5QI_element:
                                                                            per.extension_bit: '.... ...0 Extension Bit: False'
                                                                            per.optional_field_bit: '...0 .... Optional Field Bit: False (iE-Extensions is NOT present)'
                                                                            per.extension_present_bit: '.... 0... Extension Present Bit: False'
                                                                            ngap.fiveQI: 'fiveQI: 9'
                                                                    ngap.allocationAndRetentionPriority_element:
                                                                        per.extension_bit: '0... .... Extension Bit: False'
                                                                        per.optional_field_bit: '.0.. .... Optional Field Bit: False (iE-Extensions is NOT present)'
                                                                        ngap.priorityLevelARP: 'priorityLevelARP: 8'
                                                                        per.extension_present_bit: '0... .... Extension Present Bit: False'
                                                                        per.enum_index: 'Enumerated Index: 0'
                                                                        ngap.pre_emptionCapability: 'pre-emptionCapability: shall-not-trigger-pre-emption (0)'
                                                                        ngap.pre_emptionVulnerability: 'pre-emptionVulnerability: not-pre-emptable (0)'
            'Item 3: id-UEAggregateMaximumBitRate':
                ngap.id: 'id: id-UEAggregateMaximumBitRate (110)'
                per.enum_index: 'Enumerated Index: 1'
                ngap.criticality: 'criticality: ignore (1)'
                per.open_type_length: 'Open Type Length: 10'
                ngap.value_element:
                    ngap.UEAggregateMaximumBitRate_element:
                        per.extension_bit: '0... .... Extension Bit: False'
                        per.optional_field_bit: '.0.. .... Optional Field Bit: False (iE-Extensions is NOT present)'
                        per.extension_present_bit: '0... .... Extension Present Bit: False'
                        ngap.uEAggregateMaximumBitRateDL: 'uEAggregateMaximumBitRateDL: 1073741824bits/s'
                        ngap.uEAggregateMaximumBitRateUL: 'uEAggregateMaximumBitRateUL: 1073741824bits/s'

end note

"10.0.2.15" -> "10.0.3.1": 2221, NGAP PDUSessionResourceSetup (29)

note right #c6ebc6
**10.0.2.15 to 10.0.3.1**
NGAP-PDU: 201d0024000003000a40020011005540020001004b40110000010d0003e00a00020f000000010001
ngap.procedureCode: 'procedureCode: id-PDUSessionResourceSetup (29)'
per.enum_index: 'Enumerated Index: 0'
ngap.criticality: 'criticality: reject (0)'
per.open_type_length: 'Open Type Length: 36'
ngap.value_element:
-   ngap.PDUSessionResourceSetupResponse_element:
        per.extension_bit: '0... .... Extension Bit: False'
        per.sequence_of_length: 'Sequence-Of Length: 3'
        ngap.protocolIEs:
            'Item 0: id-AMF-UE-NGAP-ID':
                ngap.id: 'id: id-AMF-UE-NGAP-ID (10)'
                per.enum_index: 'Enumerated Index: 1'
                ngap.criticality: 'criticality: ignore (1)'
                per.open_type_length: 'Open Type Length: 2'
                ngap.value_element:
                    ngap.AMF_UE_NGAP_ID: 'AMF-UE-NGAP-ID: 17'
            'Item 1: id-RAN-UE-NGAP-ID':
                ngap.id: 'id: id-RAN-UE-NGAP-ID (85)'
                per.enum_index: 'Enumerated Index: 1'
                ngap.criticality: 'criticality: ignore (1)'
                per.open_type_length: 'Open Type Length: 2'
                ngap.value_element:
                    ngap.RAN_UE_NGAP_ID: 'RAN-UE-NGAP-ID: 1'
            'Item 2: id-PDUSessionResourceSetupListSURes':
                ngap.id: 'id: id-PDUSessionResourceSetupListSURes (75)'
                per.enum_index: 'Enumerated Index: 1'
                ngap.criticality: 'criticality: ignore (1)'
                per.open_type_length: 'Open Type Length: 17'
                ngap.value_element:
                    per.sequence_of_length: 'Sequence-Of Length: 1'
                    ngap.PDUSessionResourceSetupListSURes:
                        Item 0:
                            ngap.PDUSessionResourceSetupItemSURes_element:
                                per.extension_bit: '0... .... Extension Bit: False'
                                per.optional_field_bit: '.0.. .... Optional Field Bit: False (iE-Extensions is NOT present)'
                                ngap.pDUSessionID: 'pDUSessionID: 1'
                                per.octet_string_length: 'Octet String Length: 13'
                                ngap.pDUSessionResourceSetupResponseTransfer:
                                    ngap.PDUSessionResourceSetupResponseTransfer_element:
                                        per.extension_bit: '0... .... Extension Bit: False'
                                        per.optional_field_bit: '.... 0... Optional Field Bit: False (iE-Extensions is NOT present)'
                                        ngap.dLQosFlowPerTNLInformation_element:
                                            per.extension_bit: '.... .0.. Extension Bit: False'
                                            per.optional_field_bit: '.... ..0. Optional Field Bit: False (iE-Extensions is NOT present)'
                                            per.choice_index: 'Choice Index: 0'
                                            ngap.uPTransportLayerInformation:
                                                ngap.gTPTunnel_element:
                                                    per.extension_bit: '0... .... Extension Bit: False'
                                                    per.optional_field_bit: '.0.. .... Optional Field Bit: False (iE-Extensions is NOT present)'
                                                    per.extension_present_bit: '..0. .... Extension Present Bit: False'
                                                    per.bit_string_length: 'Bit String Length: 32'
                                                    ngap.transportLayerAddress:
                                                        ngap.TransportLayerAddressIPv4: 'TransportLayerAddress (IPv4): 10.0.2.15'
                                                    ngap.gTP_TEID: 'gTP-TEID: 00000001'
                                            per.sequence_of_length: 'Sequence-Of Length: 1'
                                            ngap.associatedQosFlowList:
                                                Item 0:
                                                    ngap.AssociatedQosFlowItem_element:
                                                        per.extension_bit: '.... ..0. Extension Bit: False'
                                                        per.optional_field_bit: '0... .... Optional Field Bit: False (iE-Extensions is NOT present)'
                                                        per.extension_present_bit: '.0.. .... Extension Present Bit: False'
                                                        ngap.qosFlowIdentifier: 'qosFlowIdentifier: 1'

end note

"10.0.14.1" -> "10.0.17.1": 2225, PFCP req.\nPFCP Session Modification Request (52)

note right #80b3ff
**10.0.14.1 to 10.0.17.1**
pfcp.flags:
-   pfcp.version: '001. .... = Version: 1'
    pfcp.spare_b4: '...0 .... = Spare: 0'
    pfcp.spare_b3: '.... 0... = Spare: 0'
    pfcp.spare_b2: '.... .0.. = Spare: 0'
    pfcp.mp_flag: '.... ..0. = Message Priority (MP): False'
    pfcp.s: '.... ...1 = SEID (S): True'
pfcp.msg_type: 'Message Type: PFCP Session Modification Request (52)'
pfcp.length: 'Length: 66'
pfcp.seid: 'SEID: 0x0000000000000009'
pfcp.seqno: 'Sequence Number: 226'
pfcp.spare_oct: 'Spare: 0'
'Update FAR : [Grouped IE]':
-   pfcp.ie_type: 'IE Type: Update FAR (10)'
    pfcp.ie_len: 'IE Length: 50'
    'FAR ID : Dynamic by CP 1':
        pfcp.ie_type: 'IE Type: FAR ID (108)'
        pfcp.ie_len: 'IE Length: 4'
        pfcp.far_id_flg: '0... .... .... .... .... .... .... .... = Allocation type: Dynamic by CP'
        pfcp.far_id: '.000 0000 0000 0000 0000 0000 0000 0001 = FAR ID: 1'
    'Apply Action : ':
        pfcp.ie_type: 'IE Type: Apply Action (44)'
        pfcp.ie_len: 'IE Length: 2'
        pfcp.apply_action_flags:
            pfcp.spare_b7_b5: '000. .... = Spare: 0'
            pfcp.apply_action.dupl: '...0 .... = DUPL (Duplicate): False'
            pfcp.apply_action.nocp: '.... 0... = NOCP (Notify the CP function): False'
            pfcp.apply_action.buff: '.... .0.. = BUFF (Buffer): False'
            pfcp.apply_action.forw: '.... ..1. = FORW (Forward): True'
            pfcp.apply_action.drop: '.... ...0 = DROP (Drop): False'
        IE data not decoded by WS yet:
            _ws.expert:
                pfcp.ie_data_not_decoded: IE data not decoded by WS yet
                _ws.expert.message: 'Message: IE data not decoded by WS yet'
                _ws.expert.severity: 'Severity level: Note'
                _ws.expert.group: 'Group: Undecoded'
    'Update Forwarding Parameters : [Grouped IE]':
        pfcp.ie_type: 'IE Type: Update Forwarding Parameters (11)'
        pfcp.ie_len: 'IE Length: 32'
        'Destination Interface : Access':
            pfcp.ie_type: 'IE Type: Destination Interface (42)'
            pfcp.ie_len: 'IE Length: 1'
            pfcp.spare_h1: '0000 .... = Spare: 0'
            pfcp.dst_interface: '.... 0000 = Interface: Access (0)'
        'Network Instance : internet':
            pfcp.ie_type: 'IE Type: Network Instance (22)'
            pfcp.ie_len: 'IE Length: 9'
            pfcp.network_instance: 'Network Instance: internet'
        'Outer Header Creation : ':
            pfcp.ie_type: 'IE Type: Outer Header Creation (84)'
            pfcp.ie_len: 'IE Length: 10'
            pfcp.outer_hdr_desc: 'Outer Header Creation Description: GTP-U/UDP/IPv4  (256)'
            pfcp.outer_hdr_creation.teid: 'TEID: 0x00000001'
            pfcp.outer_hdr_creation.ipv4: 'IPv4 Address: 10.0.2.15'
pfcp.response_in: 'Response In: 2226'

end note

"10.0.17.1" -> "10.0.14.1": 2226, PFCP rsp.\nPFCP Session Modification Response (53)

note right #cce0ff
**10.0.17.1 to 10.0.14.1**
pfcp.flags:
-   pfcp.version: '001. .... = Version: 1'
    pfcp.spare_b4: '...0 .... = Spare: 0'
    pfcp.spare_b3: '.... 0... = Spare: 0'
    pfcp.spare_b2: '.... .0.. = Spare: 0'
    pfcp.mp_flag: '.... ..0. = Message Priority (MP): False'
    pfcp.s: '.... ...1 = SEID (S): True'
pfcp.msg_type: 'Message Type: PFCP Session Modification Response (53)'
pfcp.length: 'Length: 17'
pfcp.seid: 'SEID: 0x0000000000000009'
pfcp.seqno: 'Sequence Number: 226'
pfcp.spare_oct: 'Spare: 0'
'Cause : Request accepted(success)':
-   pfcp.ie_type: 'IE Type: Cause (19)'
    pfcp.ie_len: 'IE Length: 1'
    pfcp.cause: 'Cause: Request accepted(success) (1)'
pfcp.response_to: 'Response To: 2225'
pfcp.response_time: 'Response Time: 0.000109051 seconds'

end note

"10.0.2.15" -> "10.0.3.1": 2247, NGAP InitialUEMessage (15),\nNAS Registration request (0x41)

note right #8cd98c
**10.0.2.15 to 10.0.3.1**
NGAP-PDU: 000f40480000050055000200020026001a197e004179000d0109f1070000000000000000202e04f0f0f0f0007900135009f107000000010009f107000001e74c1dd1005a4001180070400100
ngap.procedureCode: 'procedureCode: id-InitialUEMessage (15)'
per.enum_index: 'Enumerated Index: 1'
ngap.criticality: 'criticality: ignore (1)'
per.open_type_length: 'Open Type Length: 72'
ngap.value_element:
-   ngap.InitialUEMessage_element:
        per.extension_bit: '0... .... Extension Bit: False'
        per.sequence_of_length: 'Sequence-Of Length: 5'
        ngap.protocolIEs:
            'Item 0: id-RAN-UE-NGAP-ID':
                ngap.id: 'id: id-RAN-UE-NGAP-ID (85)'
                per.enum_index: 'Enumerated Index: 0'
                ngap.criticality: 'criticality: reject (0)'
                per.open_type_length: 'Open Type Length: 2'
                ngap.value_element:
                    ngap.RAN_UE_NGAP_ID: 'RAN-UE-NGAP-ID: 2'
            'Item 1: id-NAS-PDU':
                ngap.id: 'id: id-NAS-PDU (38)'
                per.enum_index: 'Enumerated Index: 0'
                ngap.criticality: 'criticality: reject (0)'
                per.open_type_length: 'Open Type Length: 26'
                ngap.value_element:
                    per.octet_string_length: 'Octet String Length: 25'
                    ngap.NAS_PDU:
                        nas-5gs:
                            Plain NAS 5GS Message:
                                nas_5gs.epd: 'Extended protocol discriminator: 5G mobility management messages (126)'
                                nas_5gs.spare_half_octet: '0000 .... = Spare Half Octet: 0'
                                nas_5gs.security_header_type: '.... 0000 = Security header type: Plain NAS message, not security protected (0)'
                                nas_5gs.mm.message_type: 'Message type: Registration request (0x41)'
                                5GS registration type:
                                    nas_5gs.mm.for: '.... 1... = Follow-On Request bit (FOR): Follow-on request pending'
                                    nas_5gs.mm.5gs_reg_type: '.... .001 = 5GS registration type: initial registration (1)'
                                NAS key set identifier:
                                    nas_5gs.mm.tsc.h1: '0... .... = Type of security context flag (TSC): Native security context (for KSIAMF)'
                                    nas_5gs.mm.nas_key_set_id.h1: '.111 .... = NAS key set identifier: 7'
                                5GS mobile identity:
                                    gsm_a.len: 'Length: 13'
                                    nas_5gs.spare_b7: '0... .... = Spare: 0'
                                    nas_5gs.mm.suci.supi_fmt: '.000 .... = SUPI format: IMSI (0)'
                                    nas_5gs.spare_b3: '.... 0... = Spare: 0'
                                    nas_5gs.mm.type_id: '.... .001 = Type of identity: SUCI (1)'
                                    e212.mcc: 'Mobile Country Code (MCC): International Mobile, shared code (901)'
                                    e212.mnc: 'Mobile Network Code (MNC): Unknown (70)'
                                    nas_5gs.mm.suci.routing_indicator: 'Routing indicator: 0000'
                                    nas_5gs.mm.suci.scheme_id: '.... 0000 = Protection scheme Id: NULL scheme (0)'
                                    nas_5gs.mm.suci.pki: 'Home network public key identifier: 0'
                                    nas_5gs.mm.suci.supi_null_scheme: 'Scheme output: 0000000002'
                                UE security capability:
                                    nas_5gs.mm.elem_id: 'Element ID: 0x2e'
                                    gsm_a.len: 'Length: 4'
                                    nas_5gs.mm.5g_ea0: '1... .... = 5G-EA0: Supported'
                                    nas_5gs.mm.128_5g_ea1: '.1.. .... = 128-5G-EA1: Supported'
                                    nas_5gs.mm.128_5g_ea2: '..1. .... = 128-5G-EA2: Supported'
                                    nas_5gs.mm.128_5g_ea3: '...1 .... = 128-5G-EA3: Supported'
                                    nas_5gs.mm.5g_ea4: '.... 0... = 5G-EA4: Not supported'
                                    nas_5gs.mm.5g_ea5: '.... .0.. = 5G-EA5: Not supported'
                                    nas_5gs.mm.5g_ea6: '.... ..0. = 5G-EA6: Not supported'
                                    nas_5gs.mm.5g_ea7: '.... ...0 = 5G-EA7: Not supported'
                                    nas_5gs.mm.ia0: '1... .... = 5G-IA0: Supported'
                                    nas_5gs.mm.5g_128_ia1: '.1.. .... = 128-5G-IA1: Supported'
                                    nas_5gs.mm.5g_128_ia2: '..1. .... = 128-5G-IA2: Supported'
                                    nas_5gs.mm.5g_128_ia4: '.... 0... = 5G-IA4: Not supported'
                                    nas_5gs.mm.5g_ia5: '.... .0.. = 5G-IA5: Not supported'
                                    nas_5gs.mm.5g_ia6: '.... ..0. = 5G-IA6: Not supported'
                                    nas_5gs.mm.5g_ia7: '.... ...0 = 5G-IA7: Not supported'
                                    nas_5gs.mm.eea0: '1... .... = EEA0: Supported'
                                    nas_5gs.mm.128eea1: '.1.. .... = 128-EEA1: Supported'
                                    nas_5gs.mm.128eea2: '..1. .... = 128-EEA2: Supported'
                                    nas_5gs.mm.eea3: '...1 .... = 128-EEA3: Supported'
                                    nas_5gs.mm.eea4: '.... 0... = EEA4: Not supported'
                                    nas_5gs.mm.eea5: '.... .0.. = EEA5: Not supported'
                                    nas_5gs.mm.eea6: '.... ..0. = EEA6: Not supported'
                                    nas_5gs.mm.eea7: '.... ...0 = EEA7: Not supported'
                                    nas_5gs.mm.eia0: '1... .... = EIA0: Supported'
                                    nas_5gs.mm.128eia1: '.1.. .... = 128-EIA1: Supported'
                                    nas_5gs.mm.128eia2: '..1. .... = 128-EIA2: Supported'
                                    nas_5gs.mm.eia3: '...1 .... = 128-EIA3: Supported'
                                    nas_5gs.mm.eia4: '.... 0... = EIA4: Not supported'
                                    nas_5gs.mm.eia5: '.... .0.. = EIA5: Not supported'
                                    nas_5gs.mm.eia6: '.... ..0. = EIA6: Not supported'
                                    nas_5gs.mm.eia7: '.... ...0 = EIA7: Not supported'
            'Item 2: id-UserLocationInformation':
                ngap.id: 'id: id-UserLocationInformation (121)'
                per.enum_index: 'Enumerated Index: 0'
                ngap.criticality: 'criticality: reject (0)'
                per.open_type_length: 'Open Type Length: 19'
                ngap.value_element:
                    per.choice_index: 'Choice Index: 1'
                    ngap.UserLocationInformation:
                        ngap.userLocationInformationNR_element:
                            per.extension_bit: '..0. .... Extension Bit: False'
                            per.optional_field_bit: '.... 0... Optional Field Bit: False (iE-Extensions is NOT present)'
                            ngap.nR_CGI_element:
                                per.extension_bit: '.... .0.. Extension Bit: False'
                                per.optional_field_bit: '.... ..0. Optional Field Bit: False (iE-Extensions is NOT present)'
                                ngap.pLMNIdentity:
                                    e212.mcc: 'Mobile Country Code (MCC): International Mobile, shared code (901)'
                                    e212.mnc: 'Mobile Network Code (MNC): Unknown (70)'
                                ngap.NRCellIdentity: 'nRCellIdentity: 0x0000000010'
                            ngap.tAI_element:
                                per.extension_bit: '.... 0... Extension Bit: False'
                                per.optional_field_bit: '.... .0.. Optional Field Bit: False (iE-Extensions is NOT present)'
                                ngap.pLMNIdentity:
                                    e212.mcc: 'Mobile Country Code (MCC): International Mobile, shared code (901)'
                                    e212.mnc: 'Mobile Network Code (MNC): Unknown (70)'
                                ngap.tAC: 'tAC: 1 (0x000001)'
                            ngap.timeStamp: 'timeStamp: e74c1dd1 (Dec 20, 2022 11:41:05 UTC)'
            'Item 3: id-RRCEstablishmentCause':
                ngap.id: 'id: id-RRCEstablishmentCause (90)'
                per.enum_index: 'Enumerated Index: 1'
                ngap.criticality: 'criticality: ignore (1)'
                per.open_type_length: 'Open Type Length: 1'
                ngap.value_element:
                    per.extension_present_bit: '0... .... Extension Present Bit: False'
                    per.enum_index: 'Enumerated Index: 3'
                    ngap.RRCEstablishmentCause: 'RRCEstablishmentCause: mo-Signalling (3)'
            'Item 4: id-UEContextRequest':
                ngap.id: 'id: id-UEContextRequest (112)'
                per.enum_index: 'Enumerated Index: 1'
                ngap.criticality: 'criticality: ignore (1)'
                per.open_type_length: 'Open Type Length: 1'
                ngap.value_element:
                    per.extension_present_bit: '0... .... Extension Present Bit: False'
                    per.enum_index: 'Enumerated Index: 0'
                    ngap.UEContextRequest: 'UEContextRequest: requested (0)'

end note

"10.0.3.1" -> "10.0.2.15": 2267, NGAP DownlinkNASTransport (4),\nNAS Authentication request (0x56)

note right #8cd98c
**10.0.3.1 to 10.0.2.15**
NGAP-PDU: 0004403e000003000a000200120055000200020026002b2a7e005604020000216b0f2b7911e3822c582f350648736fb7201067275f27a83e8000a6d2292381523520
ngap.procedureCode: 'procedureCode: id-DownlinkNASTransport (4)'
per.enum_index: 'Enumerated Index: 1'
ngap.criticality: 'criticality: ignore (1)'
per.open_type_length: 'Open Type Length: 62'
ngap.value_element:
-   ngap.DownlinkNASTransport_element:
        per.extension_bit: '0... .... Extension Bit: False'
        per.sequence_of_length: 'Sequence-Of Length: 3'
        ngap.protocolIEs:
            'Item 0: id-AMF-UE-NGAP-ID':
                ngap.id: 'id: id-AMF-UE-NGAP-ID (10)'
                per.enum_index: 'Enumerated Index: 0'
                ngap.criticality: 'criticality: reject (0)'
                per.open_type_length: 'Open Type Length: 2'
                ngap.value_element:
                    ngap.AMF_UE_NGAP_ID: 'AMF-UE-NGAP-ID: 18'
            'Item 1: id-RAN-UE-NGAP-ID':
                ngap.id: 'id: id-RAN-UE-NGAP-ID (85)'
                per.enum_index: 'Enumerated Index: 0'
                ngap.criticality: 'criticality: reject (0)'
                per.open_type_length: 'Open Type Length: 2'
                ngap.value_element:
                    ngap.RAN_UE_NGAP_ID: 'RAN-UE-NGAP-ID: 2'
            'Item 2: id-NAS-PDU':
                ngap.id: 'id: id-NAS-PDU (38)'
                per.enum_index: 'Enumerated Index: 0'
                ngap.criticality: 'criticality: reject (0)'
                per.open_type_length: 'Open Type Length: 43'
                ngap.value_element:
                    per.octet_string_length: 'Octet String Length: 42'
                    ngap.NAS_PDU:
                        nas-5gs:
                            Plain NAS 5GS Message:
                                nas_5gs.epd: 'Extended protocol discriminator: 5G mobility management messages (126)'
                                nas_5gs.spare_half_octet: '0000 .... = Spare Half Octet: 0'
                                nas_5gs.security_header_type: '.... 0000 = Security header type: Plain NAS message, not security protected (0)'
                                nas_5gs.mm.message_type: 'Message type: Authentication request (0x56)'
                                NAS key set identifier - ngKSI:
                                    nas_5gs.mm.tsc: '.... 0... = Type of security context flag (TSC): Native security context (for KSIAMF)'
                                    nas_5gs.mm.nas_key_set_id: '.... .100 = NAS key set identifier: 4'
                                ABBA:
                                    gsm_a.len: 'Length: 2'
                                    nas_5gs.mm.abba_contents: 'ABBA Contents: 0x0000'
                                Authentication Parameter RAND - 5G authentication challenge:
                                    gsm_a.dtap.elem_id: 'Element ID: 0x21'
                                    gsm_a.dtap.rand: 'RAND value: 6b0f2b7911e3822c582f350648736fb7'
                                Authentication Parameter AUTN (UMTS and EPS authentication challenge) - 5G authentication challenge:
                                    gsm_a.dtap.elem_id: 'Element ID: 0x20'
                                    gsm_a.len: 'Length: 16'
                                    gsm_a.dtap.autn:
                                        gsm_a.dtap.autn.sqn_xor_ak: 'SQN xor AK: 67275f27a83e'
                                        gsm_a.dtap.autn.amf: 'AMF: 8000'
                                        gsm_a.dtap.autn.mac: 'MAC: a6d2292381523520'

end note

"10.0.2.15" -> "10.0.3.1": 2268, NGAP UplinkNASTransport (46),\nNAS Authentication response (0x57)

note right #c6ebc6
**10.0.2.15 to 10.0.3.1**
NGAP-PDU: 002e4040000004000a0002001200550002000200260016157e00572d10ab2e932f903264a9a499075bb4e95344007940135009f107000000010009f107000001e74c1dd1
ngap.procedureCode: 'procedureCode: id-UplinkNASTransport (46)'
per.enum_index: 'Enumerated Index: 1'
ngap.criticality: 'criticality: ignore (1)'
per.open_type_length: 'Open Type Length: 64'
ngap.value_element:
-   ngap.UplinkNASTransport_element:
        per.extension_bit: '0... .... Extension Bit: False'
        per.sequence_of_length: 'Sequence-Of Length: 4'
        ngap.protocolIEs:
            'Item 0: id-AMF-UE-NGAP-ID':
                ngap.id: 'id: id-AMF-UE-NGAP-ID (10)'
                per.enum_index: 'Enumerated Index: 0'
                ngap.criticality: 'criticality: reject (0)'
                per.open_type_length: 'Open Type Length: 2'
                ngap.value_element:
                    ngap.AMF_UE_NGAP_ID: 'AMF-UE-NGAP-ID: 18'
            'Item 1: id-RAN-UE-NGAP-ID':
                ngap.id: 'id: id-RAN-UE-NGAP-ID (85)'
                per.enum_index: 'Enumerated Index: 0'
                ngap.criticality: 'criticality: reject (0)'
                per.open_type_length: 'Open Type Length: 2'
                ngap.value_element:
                    ngap.RAN_UE_NGAP_ID: 'RAN-UE-NGAP-ID: 2'
            'Item 2: id-NAS-PDU':
                ngap.id: 'id: id-NAS-PDU (38)'
                per.enum_index: 'Enumerated Index: 0'
                ngap.criticality: 'criticality: reject (0)'
                per.open_type_length: 'Open Type Length: 22'
                ngap.value_element:
                    per.octet_string_length: 'Octet String Length: 21'
                    ngap.NAS_PDU:
                        nas-5gs:
                            Plain NAS 5GS Message:
                                nas_5gs.epd: 'Extended protocol discriminator: 5G mobility management messages (126)'
                                nas_5gs.spare_half_octet: '0000 .... = Spare Half Octet: 0'
                                nas_5gs.security_header_type: '.... 0000 = Security header type: Plain NAS message, not security protected (0)'
                                nas_5gs.mm.message_type: 'Message type: Authentication response (0x57)'
                                Authentication response parameter:
                                    nas_eps.emm.elem_id: 'Element ID: 0x2d'
                                    gsm_a.len: 'Length: 16'
                                    nas_eps.emm.res: 'RES: ab2e932f903264a9a499075bb4e95344'
            'Item 3: id-UserLocationInformation':
                ngap.id: 'id: id-UserLocationInformation (121)'
                per.enum_index: 'Enumerated Index: 1'
                ngap.criticality: 'criticality: ignore (1)'
                per.open_type_length: 'Open Type Length: 19'
                ngap.value_element:
                    per.choice_index: 'Choice Index: 1'
                    ngap.UserLocationInformation:
                        ngap.userLocationInformationNR_element:
                            per.extension_bit: '..0. .... Extension Bit: False'
                            per.optional_field_bit: '.... 0... Optional Field Bit: False (iE-Extensions is NOT present)'
                            ngap.nR_CGI_element:
                                per.extension_bit: '.... .0.. Extension Bit: False'
                                per.optional_field_bit: '.... ..0. Optional Field Bit: False (iE-Extensions is NOT present)'
                                ngap.pLMNIdentity:
                                    e212.mcc: 'Mobile Country Code (MCC): International Mobile, shared code (901)'
                                    e212.mnc: 'Mobile Network Code (MNC): Unknown (70)'
                                ngap.NRCellIdentity: 'nRCellIdentity: 0x0000000010'
                            ngap.tAI_element:
                                per.extension_bit: '.... 0... Extension Bit: False'
                                per.optional_field_bit: '.... .0.. Optional Field Bit: False (iE-Extensions is NOT present)'
                                ngap.pLMNIdentity:
                                    e212.mcc: 'Mobile Country Code (MCC): International Mobile, shared code (901)'
                                    e212.mnc: 'Mobile Network Code (MNC): Unknown (70)'
                                ngap.tAC: 'tAC: 1 (0x000001)'
                            ngap.timeStamp: 'timeStamp: e74c1dd1 (Dec 20, 2022 11:41:05 UTC)'

end note

"10.0.3.1" -> "10.0.2.15": 2291, NGAP DownlinkNASTransport (4),\nNAS Security mode command (0x5d)

note right #c6ebc6
**10.0.3.1 to 10.0.2.15**
NGAP-PDU: 00044029000003000a0002001200550002000200260016157e03e405c7a4007e005d020404f0f0f0f0e1360102
ngap.procedureCode: 'procedureCode: id-DownlinkNASTransport (4)'
per.enum_index: 'Enumerated Index: 1'
ngap.criticality: 'criticality: ignore (1)'
per.open_type_length: 'Open Type Length: 41'
ngap.value_element:
-   ngap.DownlinkNASTransport_element:
        per.extension_bit: '0... .... Extension Bit: False'
        per.sequence_of_length: 'Sequence-Of Length: 3'
        ngap.protocolIEs:
            'Item 0: id-AMF-UE-NGAP-ID':
                ngap.id: 'id: id-AMF-UE-NGAP-ID (10)'
                per.enum_index: 'Enumerated Index: 0'
                ngap.criticality: 'criticality: reject (0)'
                per.open_type_length: 'Open Type Length: 2'
                ngap.value_element:
                    ngap.AMF_UE_NGAP_ID: 'AMF-UE-NGAP-ID: 18'
            'Item 1: id-RAN-UE-NGAP-ID':
                ngap.id: 'id: id-RAN-UE-NGAP-ID (85)'
                per.enum_index: 'Enumerated Index: 0'
                ngap.criticality: 'criticality: reject (0)'
                per.open_type_length: 'Open Type Length: 2'
                ngap.value_element:
                    ngap.RAN_UE_NGAP_ID: 'RAN-UE-NGAP-ID: 2'
            'Item 2: id-NAS-PDU':
                ngap.id: 'id: id-NAS-PDU (38)'
                per.enum_index: 'Enumerated Index: 0'
                ngap.criticality: 'criticality: reject (0)'
                per.open_type_length: 'Open Type Length: 22'
                ngap.value_element:
                    per.octet_string_length: 'Octet String Length: 21'
                    ngap.NAS_PDU:
                        nas-5gs:
                            Security protected NAS 5GS message:
                                nas_5gs.epd: 'Extended protocol discriminator: 5G mobility management messages (126)'
                                nas_5gs.spare_half_octet: '0000 .... = Spare Half Octet: 0'
                                nas_5gs.security_header_type: '.... 0011 = Security header type: Integrity protected with new 5GS security context (3)'
                                nas_5gs.msg_auth_code: 'Message authentication code: 0xe405c7a4'
                                nas_5gs.seq_no: 'Sequence number: 0'
                            Plain NAS 5GS Message:
                                nas_5gs.epd: 'Extended protocol discriminator: 5G mobility management messages (126)'
                                nas_5gs.spare_half_octet: '0000 .... = Spare Half Octet: 0'
                                nas_5gs.security_header_type: '.... 0000 = Security header type: Plain NAS message, not security protected (0)'
                                nas_5gs.mm.message_type: 'Message type: Security mode command (0x5d)'
                                NAS security algorithms:
                                    nas_5gs.mm.nas_sec_algo_enc: '0000 .... = Type of ciphering algorithm: 5G-EA0 (null ciphering algorithm) (0)'
                                    nas_5gs.mm.nas_sec_algo_ip: '.... 0010 = Type of integrity protection algorithm: 128-5G-IA2 (2)'
                                NAS key set identifier - ngKSI:
                                    nas_5gs.mm.tsc: '.... 0... = Type of security context flag (TSC): Native security context (for KSIAMF)'
                                    nas_5gs.mm.nas_key_set_id: '.... .100 = NAS key set identifier: 4'
                                UE security capability - Replayed UE security capabilities:
                                    gsm_a.len: 'Length: 4'
                                    nas_5gs.mm.5g_ea0: '1... .... = 5G-EA0: Supported'
                                    nas_5gs.mm.128_5g_ea1: '.1.. .... = 128-5G-EA1: Supported'
                                    nas_5gs.mm.128_5g_ea2: '..1. .... = 128-5G-EA2: Supported'
                                    nas_5gs.mm.128_5g_ea3: '...1 .... = 128-5G-EA3: Supported'
                                    nas_5gs.mm.5g_ea4: '.... 0... = 5G-EA4: Not supported'
                                    nas_5gs.mm.5g_ea5: '.... .0.. = 5G-EA5: Not supported'
                                    nas_5gs.mm.5g_ea6: '.... ..0. = 5G-EA6: Not supported'
                                    nas_5gs.mm.5g_ea7: '.... ...0 = 5G-EA7: Not supported'
                                    nas_5gs.mm.ia0: '1... .... = 5G-IA0: Supported'
                                    nas_5gs.mm.5g_128_ia1: '.1.. .... = 128-5G-IA1: Supported'
                                    nas_5gs.mm.5g_128_ia2: '..1. .... = 128-5G-IA2: Supported'
                                    nas_5gs.mm.5g_128_ia4: '.... 0... = 5G-IA4: Not supported'
                                    nas_5gs.mm.5g_ia5: '.... .0.. = 5G-IA5: Not supported'
                                    nas_5gs.mm.5g_ia6: '.... ..0. = 5G-IA6: Not supported'
                                    nas_5gs.mm.5g_ia7: '.... ...0 = 5G-IA7: Not supported'
                                    nas_5gs.mm.eea0: '1... .... = EEA0: Supported'
                                    nas_5gs.mm.128eea1: '.1.. .... = 128-EEA1: Supported'
                                    nas_5gs.mm.128eea2: '..1. .... = 128-EEA2: Supported'
                                    nas_5gs.mm.eea3: '...1 .... = 128-EEA3: Supported'
                                    nas_5gs.mm.eea4: '.... 0... = EEA4: Not supported'
                                    nas_5gs.mm.eea5: '.... .0.. = EEA5: Not supported'
                                    nas_5gs.mm.eea6: '.... ..0. = EEA6: Not supported'
                                    nas_5gs.mm.eea7: '.... ...0 = EEA7: Not supported'
                                    nas_5gs.mm.eia0: '1... .... = EIA0: Supported'
                                    nas_5gs.mm.128eia1: '.1.. .... = 128-EIA1: Supported'
                                    nas_5gs.mm.128eia2: '..1. .... = 128-EIA2: Supported'
                                    nas_5gs.mm.eia3: '...1 .... = 128-EIA3: Supported'
                                    nas_5gs.mm.eia4: '.... 0... = EIA4: Not supported'
                                    nas_5gs.mm.eia5: '.... .0.. = EIA5: Not supported'
                                    nas_5gs.mm.eia6: '.... ..0. = EIA6: Not supported'
                                    nas_5gs.mm.eia7: '.... ...0 = EIA7: Not supported'
                                IMEISV request:
                                    gsm_a.common.elem_id: '1110 .... = Element ID: 0xe-'
                                    nas_eps.spare_bits: '.... 0... = Spare bit(s): 0x00'
                                    nas_eps.emm.imeisv_req: '.... .001 = IMEISV request: IMEISV requested (1)'
                                Additional 5G security information:
                                    nas_5gs.mm.elem_id: 'Element ID: 0x36'
                                    gsm_a.len: 'Length: 1'
                                    nas_5gs.spare_b3: '.... 0... = Spare: 0'
                                    nas_5gs.spare_b2: '.... .0.. = Spare: 0'
                                    nas_5gs.mm.rinmr: '.... ..1. = Retransmission of initial NAS message request(RINMR): Requested'
                                    nas_5gs.mm.hdp: '.... ...0 = Horizontal derivation parameter (HDP): Not required'

end note

"10.0.2.15" -> "10.0.3.1": 2292, NGAP UplinkNASTransport (46),\nNAS Security mode complete (0x5e),\nNAS Registration request (0x41)

note right #8cd98c
**10.0.2.15 to 10.0.3.1**
NGAP-PDU: 002e4067000004000a000200120055000200020026003d3c7e04ec7dbc8c007e005e7700094573806121856151f17100237e004179000d0109f1070000000000000000201001002e04f0f0f0f02f020101530100007940135009f107000000010009f107000001e74c1dd1
ngap.procedureCode: 'procedureCode: id-UplinkNASTransport (46)'
per.enum_index: 'Enumerated Index: 1'
ngap.criticality: 'criticality: ignore (1)'
per.open_type_length: 'Open Type Length: 103'
ngap.value_element:
-   ngap.UplinkNASTransport_element:
        per.extension_bit: '0... .... Extension Bit: False'
        per.sequence_of_length: 'Sequence-Of Length: 4'
        ngap.protocolIEs:
            'Item 0: id-AMF-UE-NGAP-ID':
                ngap.id: 'id: id-AMF-UE-NGAP-ID (10)'
                per.enum_index: 'Enumerated Index: 0'
                ngap.criticality: 'criticality: reject (0)'
                per.open_type_length: 'Open Type Length: 2'
                ngap.value_element:
                    ngap.AMF_UE_NGAP_ID: 'AMF-UE-NGAP-ID: 18'
            'Item 1: id-RAN-UE-NGAP-ID':
                ngap.id: 'id: id-RAN-UE-NGAP-ID (85)'
                per.enum_index: 'Enumerated Index: 0'
                ngap.criticality: 'criticality: reject (0)'
                per.open_type_length: 'Open Type Length: 2'
                ngap.value_element:
                    ngap.RAN_UE_NGAP_ID: 'RAN-UE-NGAP-ID: 2'
            'Item 2: id-NAS-PDU':
                ngap.id: 'id: id-NAS-PDU (38)'
                per.enum_index: 'Enumerated Index: 0'
                ngap.criticality: 'criticality: reject (0)'
                per.open_type_length: 'Open Type Length: 61'
                ngap.value_element:
                    per.octet_string_length: 'Octet String Length: 60'
                    ngap.NAS_PDU:
                        nas-5gs:
                            Security protected NAS 5GS message:
                                nas_5gs.epd: 'Extended protocol discriminator: 5G mobility management messages (126)'
                                nas_5gs.spare_half_octet: '0000 .... = Spare Half Octet: 0'
                                nas_5gs.security_header_type: '.... 0100 = Security header type: Integrity protected and ciphered with new 5GS security context (4)'
                                nas_5gs.msg_auth_code: 'Message authentication code: 0xec7dbc8c'
                                nas_5gs.seq_no: 'Sequence number: 0'
                            Plain NAS 5GS Message:
                                nas_5gs.epd: 'Extended protocol discriminator: 5G mobility management messages (126)'
                                nas_5gs.spare_half_octet: '0000 .... = Spare Half Octet: 0'
                                nas_5gs.security_header_type: '.... 0000 = Security header type: Plain NAS message, not security protected (0)'
                                nas_5gs.mm.message_type: 'Message type: Security mode complete (0x5e)'
                                5GS mobile identity:
                                    nas_5gs.mm.elem_id: 'Element ID: 0x77'
                                    gsm_a.len: 'Length: 9'
                                    nas_5gs.mm.odd_even: '.... 0... = Odd/even indication: Even number of identity digits'
                                    nas_5gs.mm.type_id: '.... .101 = Type of identity: IMEISV (5)'
                                    nas_5gs.mm.imeisv: 'IMEISV: 4370816125816151'
                                NAS message container:
                                    nas_5gs.mm.elem_id: 'Element ID: 0x71'
                                    gsm_a.len: 'Length: 35'
                                    nas-5gs:
                                        Plain NAS 5GS Message:
                                            nas_5gs.epd: 'Extended protocol discriminator: 5G mobility management messages (126)'
                                            nas_5gs.spare_half_octet: '0000 .... = Spare Half Octet: 0'
                                            nas_5gs.security_header_type: '.... 0000 = Security header type: Plain NAS message, not security protected (0)'
                                            nas_5gs.mm.message_type: 'Message type: Registration request (0x41)'
                                            5GS registration type:
                                                nas_5gs.mm.for: '.... 1... = Follow-On Request bit (FOR): Follow-on request pending'
                                                nas_5gs.mm.5gs_reg_type: '.... .001 = 5GS registration type: initial registration (1)'
                                            NAS key set identifier:
                                                nas_5gs.mm.tsc.h1: '0... .... = Type of security context flag (TSC): Native security context (for KSIAMF)'
                                                nas_5gs.mm.nas_key_set_id.h1: '.111 .... = NAS key set identifier: 7'
                                            5GS mobile identity:
                                                gsm_a.len: 'Length: 13'
                                                nas_5gs.spare_b7: '0... .... = Spare: 0'
                                                nas_5gs.mm.suci.supi_fmt: '.000 .... = SUPI format: IMSI (0)'
                                                nas_5gs.spare_b3: '.... 0... = Spare: 0'
                                                nas_5gs.mm.type_id: '.... .001 = Type of identity: SUCI (1)'
                                                e212.mcc: 'Mobile Country Code (MCC): International Mobile, shared code (901)'
                                                e212.mnc: 'Mobile Network Code (MNC): Unknown (70)'
                                                nas_5gs.mm.suci.routing_indicator: 'Routing indicator: 0000'
                                                nas_5gs.mm.suci.scheme_id: '.... 0000 = Protection scheme Id: NULL scheme (0)'
                                                nas_5gs.mm.suci.pki: 'Home network public key identifier: 0'
                                                nas_5gs.mm.suci.supi_null_scheme: 'Scheme output: 0000000002'
                                            5GMM capability:
                                                nas_5gs.mm.elem_id: 'Element ID: 0x10'
                                                gsm_a.len: 'Length: 1'
                                                nas_5gs.spare_b7: '0... .... = Spare: 0'
                                                nas_5gs.spare_b6: '.0.. .... = Spare: 0'
                                                nas_5gs.spare_b5: '..0. .... = Spare: 0'
                                                nas_5gs.spare_b4: '...0 .... = Spare: 0'
                                                nas_5gs.spare_b3: '.... 0... = Spare: 0'
                                                nas_5gs.mm.lpp_cap_b2: '.... .0.. = LTE Positioning Protocol (LPP) capability: Not Requested'
                                                nas_5gs.mm.ho_attach_b1: '.... ..0. = HO attach: Not supported'
                                                nas_5gs.mm.s1_mode_b0: '.... ...0 = S1 mode: Not Requested'
                                            UE security capability:
                                                nas_5gs.mm.elem_id: 'Element ID: 0x2e'
                                                gsm_a.len: 'Length: 4'
                                                nas_5gs.mm.5g_ea0: '1... .... = 5G-EA0: Supported'
                                                nas_5gs.mm.128_5g_ea1: '.1.. .... = 128-5G-EA1: Supported'
                                                nas_5gs.mm.128_5g_ea2: '..1. .... = 128-5G-EA2: Supported'
                                                nas_5gs.mm.128_5g_ea3: '...1 .... = 128-5G-EA3: Supported'
                                                nas_5gs.mm.5g_ea4: '.... 0... = 5G-EA4: Not supported'
                                                nas_5gs.mm.5g_ea5: '.... .0.. = 5G-EA5: Not supported'
                                                nas_5gs.mm.5g_ea6: '.... ..0. = 5G-EA6: Not supported'
                                                nas_5gs.mm.5g_ea7: '.... ...0 = 5G-EA7: Not supported'
                                                nas_5gs.mm.ia0: '1... .... = 5G-IA0: Supported'
                                                nas_5gs.mm.5g_128_ia1: '.1.. .... = 128-5G-IA1: Supported'
                                                nas_5gs.mm.5g_128_ia2: '..1. .... = 128-5G-IA2: Supported'
                                                nas_5gs.mm.5g_128_ia4: '.... 0... = 5G-IA4: Not supported'
                                                nas_5gs.mm.5g_ia5: '.... .0.. = 5G-IA5: Not supported'
                                                nas_5gs.mm.5g_ia6: '.... ..0. = 5G-IA6: Not supported'
                                                nas_5gs.mm.5g_ia7: '.... ...0 = 5G-IA7: Not supported'
                                                nas_5gs.mm.eea0: '1... .... = EEA0: Supported'
                                                nas_5gs.mm.128eea1: '.1.. .... = 128-EEA1: Supported'
                                                nas_5gs.mm.128eea2: '..1. .... = 128-EEA2: Supported'
                                                nas_5gs.mm.eea3: '...1 .... = 128-EEA3: Supported'
                                                nas_5gs.mm.eea4: '.... 0... = EEA4: Not supported'
                                                nas_5gs.mm.eea5: '.... .0.. = EEA5: Not supported'
                                                nas_5gs.mm.eea6: '.... ..0. = EEA6: Not supported'
                                                nas_5gs.mm.eea7: '.... ...0 = EEA7: Not supported'
                                                nas_5gs.mm.eia0: '1... .... = EIA0: Supported'
                                                nas_5gs.mm.128eia1: '.1.. .... = 128-EIA1: Supported'
                                                nas_5gs.mm.128eia2: '..1. .... = 128-EIA2: Supported'
                                                nas_5gs.mm.eia3: '...1 .... = 128-EIA3: Supported'
                                                nas_5gs.mm.eia4: '.... 0... = EIA4: Not supported'
                                                nas_5gs.mm.eia5: '.... .0.. = EIA5: Not supported'
                                                nas_5gs.mm.eia6: '.... ..0. = EIA6: Not supported'
                                                nas_5gs.mm.eia7: '.... ...0 = EIA7: Not supported'
                                            NSSAI - Requested NSSAI:
                                                nas_5gs.mm.elem_id: 'Element ID: 0x2f'
                                                gsm_a.len: 'Length: 2'
                                                S-NSSAI 1:
                                                    nas_5gs.mm.length: 'Length: 1'
                                                    nas_5gs.mm.sst: 'Slice/service type (SST): 1'
                                            5GS update type:
                                                nas_5gs.mm.elem_id: 'Element ID: 0x53'
                                                gsm_a.len: 'Length: 1'
                                                nas_5gs.spare_b3: '.... 0... = Spare: 0'
                                                nas_5gs.spare_b2: '.... .0.. = Spare: 0'
                                                nas_5gs.mm.ng_ran_rcu: '.... ..0. = NG-RAN Radio Capability Update (NG-RAN-RCU): Not Needed'
                                                nas_5gs.mm.sms_requested: '.... ...0 = SMS requested: SMS over NAS not supported'
            'Item 3: id-UserLocationInformation':
                ngap.id: 'id: id-UserLocationInformation (121)'
                per.enum_index: 'Enumerated Index: 1'
                ngap.criticality: 'criticality: ignore (1)'
                per.open_type_length: 'Open Type Length: 19'
                ngap.value_element:
                    per.choice_index: 'Choice Index: 1'
                    ngap.UserLocationInformation:
                        ngap.userLocationInformationNR_element:
                            per.extension_bit: '..0. .... Extension Bit: False'
                            per.optional_field_bit: '.... 0... Optional Field Bit: False (iE-Extensions is NOT present)'
                            ngap.nR_CGI_element:
                                per.extension_bit: '.... .0.. Extension Bit: False'
                                per.optional_field_bit: '.... ..0. Optional Field Bit: False (iE-Extensions is NOT present)'
                                ngap.pLMNIdentity:
                                    e212.mcc: 'Mobile Country Code (MCC): International Mobile, shared code (901)'
                                    e212.mnc: 'Mobile Network Code (MNC): Unknown (70)'
                                ngap.NRCellIdentity: 'nRCellIdentity: 0x0000000010'
                            ngap.tAI_element:
                                per.extension_bit: '.... 0... Extension Bit: False'
                                per.optional_field_bit: '.... .0.. Optional Field Bit: False (iE-Extensions is NOT present)'
                                ngap.pLMNIdentity:
                                    e212.mcc: 'Mobile Country Code (MCC): International Mobile, shared code (901)'
                                    e212.mnc: 'Mobile Network Code (MNC): Unknown (70)'
                                ngap.tAC: 'tAC: 1 (0x000001)'
                            ngap.timeStamp: 'timeStamp: e74c1dd1 (Dec 20, 2022 11:41:05 UTC)'

end note

"10.0.3.1" -> "10.0.2.15": 2345, NGAP InitialContextSetup (14),\nNAS Registration accept (0x42)

note right #c6ebc6
**10.0.3.1 to 10.0.2.15**
NGAP-PDU: 000e008090000008000a00020012005500020002001c00070009f107020040000000020001007700091c000e000700038000005e0020ca963b02fc66e78c67e71884a5b51aea8e56fc38662ad02f4ab37c8d1aa1c7df002240084370816125ffff510026402f2e7e025f8cc4c9017e0042010177000bf209f107020040e40082cd54072009f10700000115020101210201005e0129
ngap.procedureCode: 'procedureCode: id-InitialContextSetup (14)'
per.enum_index: 'Enumerated Index: 0'
ngap.criticality: 'criticality: reject (0)'
per.open_type_length: 'Open Type Length: 144'
ngap.value_element:
-   ngap.InitialContextSetupRequest_element:
        per.extension_bit: '0... .... Extension Bit: False'
        per.sequence_of_length: 'Sequence-Of Length: 8'
        ngap.protocolIEs:
            'Item 0: id-AMF-UE-NGAP-ID':
                ngap.id: 'id: id-AMF-UE-NGAP-ID (10)'
                per.enum_index: 'Enumerated Index: 0'
                ngap.criticality: 'criticality: reject (0)'
                per.open_type_length: 'Open Type Length: 2'
                ngap.value_element:
                    ngap.AMF_UE_NGAP_ID: 'AMF-UE-NGAP-ID: 18'
            'Item 1: id-RAN-UE-NGAP-ID':
                ngap.id: 'id: id-RAN-UE-NGAP-ID (85)'
                per.enum_index: 'Enumerated Index: 0'
                ngap.criticality: 'criticality: reject (0)'
                per.open_type_length: 'Open Type Length: 2'
                ngap.value_element:
                    ngap.RAN_UE_NGAP_ID: 'RAN-UE-NGAP-ID: 2'
            'Item 2: id-GUAMI':
                ngap.id: 'id: id-GUAMI (28)'
                per.enum_index: 'Enumerated Index: 0'
                ngap.criticality: 'criticality: reject (0)'
                per.open_type_length: 'Open Type Length: 7'
                ngap.value_element:
                    ngap.GUAMI_element:
                        per.extension_bit: '0... .... Extension Bit: False'
                        per.optional_field_bit: '.0.. .... Optional Field Bit: False (iE-Extensions is NOT present)'
                        ngap.pLMNIdentity:
                            e212.mcc: 'Mobile Country Code (MCC): International Mobile, shared code (901)'
                            e212.mnc: 'Mobile Network Code (MNC): Unknown (70)'
                        ngap.aMFRegionID: 'aMFRegionID: 02 [bit length 8, 0000 0010 decimal value 2]'
                        ngap.aMFSetID: 'aMFSetID: 0040 [bit length 10, 6 LSB pad bits, 0000 0000  01.. .... decimal value 1]'
                        ngap.aMFPointer: 'aMFPointer: 00 [bit length 6, 2 LSB pad bits, 0000 00.. decimal value 0]'
            'Item 3: id-AllowedNSSAI':
                ngap.id: 'id: id-AllowedNSSAI (0)'
                per.enum_index: 'Enumerated Index: 0'
                ngap.criticality: 'criticality: reject (0)'
                per.open_type_length: 'Open Type Length: 2'
                ngap.value_element:
                    per.sequence_of_length: 'Sequence-Of Length: 1'
                    ngap.AllowedNSSAI:
                        Item 0:
                            ngap.AllowedNSSAI_Item_element:
                                per.extension_bit: '...0 .... Extension Bit: False'
                                per.optional_field_bit: '.... 0... Optional Field Bit: False (iE-Extensions is NOT present)'
                                ngap.s_NSSAI_element:
                                    per.extension_bit: '.... .0.. Extension Bit: False'
                                    per.optional_field_bit: '.... ...0 Optional Field Bit: False (iE-Extensions is NOT present)'
                                    ngap.sST: 'sST: 01'
            'Item 4: id-UESecurityCapabilities':
                ngap.id: 'id: id-UESecurityCapabilities (119)'
                per.enum_index: 'Enumerated Index: 0'
                ngap.criticality: 'criticality: reject (0)'
                per.open_type_length: 'Open Type Length: 9'
                ngap.value_element:
                    ngap.UESecurityCapabilities_element:
                        per.extension_bit: '0... .... Extension Bit: False'
                        per.optional_field_bit: '.0.. .... Optional Field Bit: False (iE-Extensions is NOT present)'
                        per.extension_present_bit: '.... .0.. Extension Present Bit: False'
                        ngap.nRencryptionAlgorithms:
                            ngap.NrencyptionAlgorithms.nea1: '1... .... .... .... = 128-NEA1: Supported'
                            ngap.NrencyptionAlgorithms.nea2: '.1.. .... .... .... = 128-NEA2: Supported'
                            ngap.NrencyptionAlgorithms.nea3: '..1. .... .... .... = 128-NEA3: Supported'
                            ngap.NrencyptionAlgorithms.reserved: '...0 0000 0000 0000 = Reserved: 0x0000'
                        ngap.nRintegrityProtectionAlgorithms:
                            ngap.NrintegrityProtectionAlgorithms.nia1: '1... .... .... .... = 128-NIA1: Supported'
                            ngap.NrintegrityProtectionAlgorithms.nia2: '.1.. .... .... .... = 128-NIA2: Supported'
                            ngap.NrintegrityProtectionAlgorithms.nia3: '..1. .... .... .... = 128-NIA3: Supported'
                            ngap.NrintegrityProtectionAlgorithms.reserved: '...0 0000 0000 0000 = Reserved: 0x0000'
                        ngap.eUTRAencryptionAlgorithms:
                            ngap.EUTRAencryptionAlgorithms.eea1: '1... .... .... .... = 128-EEA1: Supported'
                            ngap.EUTRAencryptionAlgorithms.eea2: '.1.. .... .... .... = 128-EEA2: Supported'
                            ngap.EUTRAencryptionAlgorithms.eea3: '..1. .... .... .... = 128-EEA3: Supported'
                            ngap.EUTRAencryptionAlgorithms.reserved: '...0 0000 0000 0000 = Reserved: 0x0000'
                        ngap.eUTRAintegrityProtectionAlgorithms:
                            ngap.EUTRAintegrityProtectionAlgorithms.eia1: '1... .... .... .... = 128-EIA1: Supported'
                            ngap.EUTRAintegrityProtectionAlgorithms.eia2: '.1.. .... .... .... = 128-EIA2: Supported'
                            ngap.EUTRAintegrityProtectionAlgorithms.eia3: '..1. .... .... .... = 128-EIA3: Supported'
                            ngap.EUTRAintegrityProtectionAlgorithms.reserved: '...0 0000 0000 0000 = Reserved: 0x0000'
            'Item 5: id-SecurityKey':
                ngap.id: 'id: id-SecurityKey (94)'
                per.enum_index: 'Enumerated Index: 0'
                ngap.criticality: 'criticality: reject (0)'
                per.open_type_length: 'Open Type Length: 32'
                ngap.value_element:
                    ngap.SecurityKey: 'SecurityKey: ca963b02fc66e78c67e71884a5b51aea8e56fc38662ad02f\xe2\x80\xa6 [bit length 256]'
            'Item 6: id-MaskedIMEISV':
                ngap.id: 'id: id-MaskedIMEISV (34)'
                per.enum_index: 'Enumerated Index: 1'
                ngap.criticality: 'criticality: ignore (1)'
                per.open_type_length: 'Open Type Length: 8'
                ngap.value_element:
                    ngap.MaskedIMEISV: 'MaskedIMEISV: 4370816125ffff51 [bit length 64, 0100 0011  0111 0000  1000 0001  0110 0001  0010 0101  1111 1111  1111 1111  0101 0001 decimal value 4859526252182110033]'
            'Item 7: id-NAS-PDU':
                ngap.id: 'id: id-NAS-PDU (38)'
                per.enum_index: 'Enumerated Index: 1'
                ngap.criticality: 'criticality: ignore (1)'
                per.open_type_length: 'Open Type Length: 47'
                ngap.value_element:
                    per.octet_string_length: 'Octet String Length: 46'
                    ngap.NAS_PDU:
                        nas-5gs:
                            Security protected NAS 5GS message:
                                nas_5gs.epd: 'Extended protocol discriminator: 5G mobility management messages (126)'
                                nas_5gs.spare_half_octet: '0000 .... = Spare Half Octet: 0'
                                nas_5gs.security_header_type: '.... 0010 = Security header type: Integrity protected and ciphered (2)'
                                nas_5gs.msg_auth_code: 'Message authentication code: 0x5f8cc4c9'
                                nas_5gs.seq_no: 'Sequence number: 1'
                            Plain NAS 5GS Message:
                                nas_5gs.epd: 'Extended protocol discriminator: 5G mobility management messages (126)'
                                nas_5gs.spare_half_octet: '0000 .... = Spare Half Octet: 0'
                                nas_5gs.security_header_type: '.... 0000 = Security header type: Plain NAS message, not security protected (0)'
                                nas_5gs.mm.message_type: 'Message type: Registration accept (0x42)'
                                5GS registration result:
                                    gsm_a.len: 'Length: 1'
                                    nas_5gs.mm.reg_res.nssaa_perf: '...0 .... = NSSAA Performed: False'
                                    nas_5gs.mm.reg_res.sms_all: '.... 0... = SMS over NAS: Not Allowed'
                                    nas_5gs.mm.reg_res.res: '.... .001 = 5GS registration result: 3GPP access (1)'
                                5GS mobile identity - 5G-GUTI:
                                    nas_5gs.mm.elem_id: 'Element ID: 0x77'
                                    gsm_a.len: 'Length: 11'
                                    nas_5gs.mm.odd_even: '.... 0... = Odd/even indication: Even number of identity digits'
                                    nas_5gs.mm.type_id: '.... .010 = Type of identity: 5G-GUTI (2)'
                                    e212.mcc: 'Mobile Country Code (MCC): International Mobile, shared code (901)'
                                    e212.mnc: 'Mobile Network Code (MNC): Unknown (70)'
                                    nas_5gs.amf_region_id: 'AMF Region ID: 2'
                                    nas_5gs.amf_set_id: '0000 0000 01.. .... = AMF Set ID: 1'
                                    nas_5gs.amf_pointer: '..00 0000 = AMF Pointer: 0'
                                    nas_5gs.5g_tmsi: '5G-TMSI: 0xe40082cd'
                                5GS tracking area identity list:
                                    nas_5gs.mm.elem_id: 'Element ID: 0x54'
                                    gsm_a.len: 'Length: 7'
                                    Partial tracking area list  1:
                                        nas_5gs.mm.tal_t_li: '.01. .... = Type of list: list of TACs belonging to one PLMN, with consecutive TAC values (1)'
                                        nas_5gs.mm.tal_num_e: '...0 0000 = Number of elements: 1 element (0)'
                                        e212.mcc: 'Mobile Country Code (MCC): International Mobile, shared code (901)'
                                        e212.mnc: 'Mobile Network Code (MNC): Unknown (70)'
                                        nas_5gs.tac: 'TAC: 1'
                                NSSAI - Allowed NSSAI:
                                    nas_5gs.mm.elem_id: 'Element ID: 0x15'
                                    gsm_a.len: 'Length: 2'
                                    S-NSSAI 1:
                                        nas_5gs.mm.length: 'Length: 1'
                                        nas_5gs.mm.sst: 'Slice/service type (SST): 1'
                                5GS network feature support:
                                    nas_5gs.mm.elem_id: 'Element ID: 0x21'
                                    gsm_a.len: 'Length: 2'
                                    nas_5gs.nw_feat_sup.mpsi: '0... .... = MPS indicator (MPSI): Access identity 1 not valid in RPLMN or equivalent PLMN'
                                    nas_5gs.nw_feat_sup.iwk_n26: '.0.. .... = Interworking without N26: Not supported'
                                    nas_5gs.nw_feat_sup.emf: '..00 .... = Emergency service fallback indicator (EMF): Emergency services fallback not supported (0)'
                                    nas_5gs.nw_feat_sup.emc: '.... 00.. = Emergency service support indicator (EMC): Emergency services not supported (0)'
                                    nas_5gs.nw_feat_sup.vops_n3gpp: '.... ..0. = IMS voice over PS session over non-3GPP access indicator (IMS-VoPS-N3GPP): Not supported'
                                    nas_5gs.nw_feat_sup.vops_3gpp: '.... ...1 = IMS voice over PS session indicator (IMS VoPS): Supported'
                                    nas_5gs.spare_b7: '0... .... = Spare: 0'
                                    nas_5gs.spare_b6: '.0.. .... = Spare: 0'
                                    nas_5gs.spare_b5: '..0. .... = Spare: 0'
                                    nas_5gs.spare_b4: '...0 .... = Spare: 0'
                                    nas_5gs.spare_b3: '.... 0... = Spare: 0'
                                    nas_5gs.spare_b2: '.... .0.. = Spare: 0'
                                    nas_5gs.nw_feat_sup.mcsi: '.... ..0. = MCS indicator (MCSI): Not supported'
                                    nas_5gs.nw_feat_sup.emcn3: '.... ...0 = Emergency services over non-3GPP access (EMCN3): Not supported'
                                GPRS Timer 3 - T3512 value:
                                    gsm_a.gm.elem_id: 'Element ID: 0x5e'
                                    gsm_a.len: 'Length: 1'
                                    gsm_a.gm.gmm.gprs_timer3:
                                        gsm_a.gm.gmm.gprs_timer3_unit: '001. .... = Unit: value is incremented in multiples of 1 hour (1)'
                                        gsm_a.gm.gmm.gprs_timer3_value: '...0 1001 = Timer value: 9'

end note

"10.0.2.15" -> "10.0.3.1": 2346, NGAP InitialContextSetup (14)

note right #c6ebc6
**10.0.2.15 to 10.0.3.1**
NGAP-PDU: 200e000f000002000a40020012005540020002
ngap.procedureCode: 'procedureCode: id-InitialContextSetup (14)'
per.enum_index: 'Enumerated Index: 0'
ngap.criticality: 'criticality: reject (0)'
per.open_type_length: 'Open Type Length: 15'
ngap.value_element:
-   ngap.InitialContextSetupResponse_element:
        per.extension_bit: '0... .... Extension Bit: False'
        per.sequence_of_length: 'Sequence-Of Length: 2'
        ngap.protocolIEs:
            'Item 0: id-AMF-UE-NGAP-ID':
                ngap.id: 'id: id-AMF-UE-NGAP-ID (10)'
                per.enum_index: 'Enumerated Index: 1'
                ngap.criticality: 'criticality: ignore (1)'
                per.open_type_length: 'Open Type Length: 2'
                ngap.value_element:
                    ngap.AMF_UE_NGAP_ID: 'AMF-UE-NGAP-ID: 18'
            'Item 1: id-RAN-UE-NGAP-ID':
                ngap.id: 'id: id-RAN-UE-NGAP-ID (85)'
                per.enum_index: 'Enumerated Index: 1'
                ngap.criticality: 'criticality: ignore (1)'
                per.open_type_length: 'Open Type Length: 2'
                ngap.value_element:
                    ngap.RAN_UE_NGAP_ID: 'RAN-UE-NGAP-ID: 2'

end note

"10.0.2.15" -> "10.0.3.1": 2350, NGAP UplinkNASTransport (46),\nNAS Registration complete (0x43),\nNAS UL NAS transport (0x67),\nNAS PDU session establishment request (0xc1)

note right #8cd98c
**10.0.2.15 to 10.0.3.1**
NGAP-PDU: 002e4035000004000a000200120055000200020026000b0a7e022d7f1790017e0043007940135009f107000000010009f107000001e74c1dd1
ngap.procedureCode: 'procedureCode: id-UplinkNASTransport (46)'
per.enum_index: 'Enumerated Index: 1'
ngap.criticality: 'criticality: ignore (1)'
per.open_type_length: 'Open Type Length: 53'
ngap.value_element:
-   ngap.UplinkNASTransport_element:
        per.extension_bit: '0... .... Extension Bit: False'
        per.sequence_of_length: 'Sequence-Of Length: 4'
        ngap.protocolIEs:
            'Item 0: id-AMF-UE-NGAP-ID':
                ngap.id: 'id: id-AMF-UE-NGAP-ID (10)'
                per.enum_index: 'Enumerated Index: 0'
                ngap.criticality: 'criticality: reject (0)'
                per.open_type_length: 'Open Type Length: 2'
                ngap.value_element:
                    ngap.AMF_UE_NGAP_ID: 'AMF-UE-NGAP-ID: 18'
            'Item 1: id-RAN-UE-NGAP-ID':
                ngap.id: 'id: id-RAN-UE-NGAP-ID (85)'
                per.enum_index: 'Enumerated Index: 0'
                ngap.criticality: 'criticality: reject (0)'
                per.open_type_length: 'Open Type Length: 2'
                ngap.value_element:
                    ngap.RAN_UE_NGAP_ID: 'RAN-UE-NGAP-ID: 2'
            'Item 2: id-NAS-PDU':
                ngap.id: 'id: id-NAS-PDU (38)'
                per.enum_index: 'Enumerated Index: 0'
                ngap.criticality: 'criticality: reject (0)'
                per.open_type_length: 'Open Type Length: 11'
                ngap.value_element:
                    per.octet_string_length: 'Octet String Length: 10'
                    ngap.NAS_PDU:
                        nas-5gs:
                            Security protected NAS 5GS message:
                                nas_5gs.epd: 'Extended protocol discriminator: 5G mobility management messages (126)'
                                nas_5gs.spare_half_octet: '0000 .... = Spare Half Octet: 0'
                                nas_5gs.security_header_type: '.... 0010 = Security header type: Integrity protected and ciphered (2)'
                                nas_5gs.msg_auth_code: 'Message authentication code: 0x2d7f1790'
                                nas_5gs.seq_no: 'Sequence number: 1'
                            Plain NAS 5GS Message:
                                nas_5gs.epd: 'Extended protocol discriminator: 5G mobility management messages (126)'
                                nas_5gs.spare_half_octet: '0000 .... = Spare Half Octet: 0'
                                nas_5gs.security_header_type: '.... 0000 = Security header type: Plain NAS message, not security protected (0)'
                                nas_5gs.mm.message_type: 'Message type: Registration complete (0x43)'
            'Item 3: id-UserLocationInformation':
                ngap.id: 'id: id-UserLocationInformation (121)'
                per.enum_index: 'Enumerated Index: 1'
                ngap.criticality: 'criticality: ignore (1)'
                per.open_type_length: 'Open Type Length: 19'
                ngap.value_element:
                    per.choice_index: 'Choice Index: 1'
                    ngap.UserLocationInformation:
                        ngap.userLocationInformationNR_element:
                            per.extension_bit: '..0. .... Extension Bit: False'
                            per.optional_field_bit: '.... 0... Optional Field Bit: False (iE-Extensions is NOT present)'
                            ngap.nR_CGI_element:
                                per.extension_bit: '.... .0.. Extension Bit: False'
                                per.optional_field_bit: '.... ..0. Optional Field Bit: False (iE-Extensions is NOT present)'
                                ngap.pLMNIdentity:
                                    e212.mcc: 'Mobile Country Code (MCC): International Mobile, shared code (901)'
                                    e212.mnc: 'Mobile Network Code (MNC): Unknown (70)'
                                ngap.NRCellIdentity: 'nRCellIdentity: 0x0000000010'
                            ngap.tAI_element:
                                per.extension_bit: '.... 0... Extension Bit: False'
                                per.optional_field_bit: '.... .0.. Optional Field Bit: False (iE-Extensions is NOT present)'
                                ngap.pLMNIdentity:
                                    e212.mcc: 'Mobile Country Code (MCC): International Mobile, shared code (901)'
                                    e212.mnc: 'Mobile Network Code (MNC): Unknown (70)'
                                ngap.tAC: 'tAC: 1 (0x000001)'
                            ngap.timeStamp: 'timeStamp: e74c1dd1 (Dec 20, 2022 11:41:05 UTC)'

NGAP-PDU: 002e4059000004000a000200120055000200020026002f2e7e02f4bef032027e00670100152e0101c1ffff91a12801007b000780000a00000d00120181220101250403696f74007940135009f107000000010009f107000001e74c1dd1
ngap.procedureCode: 'procedureCode: id-UplinkNASTransport (46)'
per.enum_index: 'Enumerated Index: 1'
ngap.criticality: 'criticality: ignore (1)'
per.open_type_length: 'Open Type Length: 89'
ngap.value_element:
-   ngap.UplinkNASTransport_element:
        per.extension_bit: '0... .... Extension Bit: False'
        per.sequence_of_length: 'Sequence-Of Length: 4'
        ngap.protocolIEs:
            'Item 0: id-AMF-UE-NGAP-ID':
                ngap.id: 'id: id-AMF-UE-NGAP-ID (10)'
                per.enum_index: 'Enumerated Index: 0'
                ngap.criticality: 'criticality: reject (0)'
                per.open_type_length: 'Open Type Length: 2'
                ngap.value_element:
                    ngap.AMF_UE_NGAP_ID: 'AMF-UE-NGAP-ID: 18'
            'Item 1: id-RAN-UE-NGAP-ID':
                ngap.id: 'id: id-RAN-UE-NGAP-ID (85)'
                per.enum_index: 'Enumerated Index: 0'
                ngap.criticality: 'criticality: reject (0)'
                per.open_type_length: 'Open Type Length: 2'
                ngap.value_element:
                    ngap.RAN_UE_NGAP_ID: 'RAN-UE-NGAP-ID: 2'
            'Item 2: id-NAS-PDU':
                ngap.id: 'id: id-NAS-PDU (38)'
                per.enum_index: 'Enumerated Index: 0'
                ngap.criticality: 'criticality: reject (0)'
                per.open_type_length: 'Open Type Length: 47'
                ngap.value_element:
                    per.octet_string_length: 'Octet String Length: 46'
                    ngap.NAS_PDU:
                        nas-5gs:
                            Security protected NAS 5GS message:
                                nas_5gs.epd: 'Extended protocol discriminator: 5G mobility management messages (126)'
                                nas_5gs.spare_half_octet: '0000 .... = Spare Half Octet: 0'
                                nas_5gs.security_header_type: '.... 0010 = Security header type: Integrity protected and ciphered (2)'
                                nas_5gs.msg_auth_code: 'Message authentication code: 0xf4bef032'
                                nas_5gs.seq_no: 'Sequence number: 2'
                            Plain NAS 5GS Message:
                                nas_5gs.epd: 'Extended protocol discriminator: 5G mobility management messages (126)'
                                nas_5gs.spare_half_octet: '0000 .... = Spare Half Octet: 0'
                                nas_5gs.security_header_type: '.... 0000 = Security header type: Plain NAS message, not security protected (0)'
                                nas_5gs.mm.message_type: 'Message type: UL NAS transport (0x67)'
                                Payload container type:
                                    nas_5gs.mm.pld_cont_type: '.... 0001 = Payload container type: N1 SM information (1)'
                                Payload container:
                                    gsm_a.len: 'Length: 21'
                                    Plain NAS 5GS Message:
                                        nas_5gs.epd: 'Extended protocol discriminator: 5G session management messages (46)'
                                        nas_5gs.pdu_session_id: 'PDU session identity: PDU session identity value 1 (1)'
                                        nas_5gs.proc_trans_id: 'Procedure transaction identity: 1'
                                        nas_5gs.sm.message_type: 'Message type: PDU session establishment request (0xc1)'
                                        Integrity protection maximum data rate:
                                            nas_5gs.sm.int_prot_max_data_rate_ul: 'Integrity protection maximum data rate for uplink: Full data rate (255)'
                                            nas_5gs.sm.int_prot_max_data_rate_dl: 'Integrity protection maximum data rate for downlink: Full data rate (255)'
                                        PDU session type:
                                            gsm_a.common.elem_id: '1001 .... = Element ID: 0x9-'
                                            nas_5gs.sm.pdu_session_type: '.... 0001 = PDU session type: IPv4 (1)'
                                        SSC mode:
                                            gsm_a.common.elem_id: '1010 .... = Element ID: 0xa-'
                                            nas_5gs.sm.sc_mode: '.... 0001 = SSC mode: SSC mode 1 (1)'
                                        5GSM capability:
                                            nas_5gs.sm.elem_id: 'Element ID: 0x28'
                                            gsm_a.len: 'Length: 1'
                                            nas_5gs.spare_b7: '0... .... = Spare: 0'
                                            nas_5gs.spare_b6: '.0.. .... = Spare: 0'
                                            nas_5gs.spare_b5: '..0. .... = Spare: 0'
                                            nas_5gs.spare_b4: '...0 .... = Spare: 0'
                                            nas_5gs.spare_b3: '.... 0... = Spare: 0'
                                            nas_5gs.spare_b2: '.... .0.. = Spare: 0'
                                            nas_5gs.sm.mh6_pdu: '.... ..0. = Multi-homed IPv6 PDU session (MH6-PDU): Not supported'
                                            nas_5gs.sm.rqos: '.... ...0 = Reflective QoS (RqoS): Not supported'
                                        Extended protocol configuration options:
                                            nas_eps.esm.elem_id: 'Element ID: 0x7b'
                                            gsm_a.len: 'Length: 7'
                                            gsm_a.gm.sm.link_dir: 'Link direction: MS to network (0)'
                                            gsm_a.gm.sm.ext: '1... .... = Extension: True'
                                            gsm_a.gm.configuration_protocol: '.... .000 = Configuration Protocol: PPP for use with IP PDP type or IP PDN type (0)'
                                            gsm_a.gm.sm.pco_pid:
                                            -   gsm_a.gm.sm.pco.length: 'Length: 0x00 (0)'
                                            -   gsm_a.gm.sm.pco.length: 'Length: 0x00 (0)'
                                PDU session identity 2 - PDU session ID:
                                    nas_5gs.mm.elem_id: 'Element ID: 0x12'
                                    nas_5gs.pdu_session_id: 'PDU session identity: PDU session identity value 1 (1)'
                                Request type:
                                    gsm_a.common.elem_id: '1000 .... = Element ID: 0x8-'
                                    nas_5gs.mm.req_typ: '.... 0001 = Request type: Initial request (1)'
                                S-NSSAI:
                                    nas_5gs.common.elem_id: 'Element ID: 0x22'
                                    gsm_a.len: 'Length: 1'
                                    nas_5gs.mm.sst: 'Slice/service type (SST): 1'
                                DNN:
                                    nas_5gs.common.elem_id: 'Element ID: 0x25'
                                    gsm_a.len: 'Length: 4'
                                    nas_5gs.cmn.dnn: 'DNN: iot'
            'Item 3: id-UserLocationInformation':
                ngap.id: 'id: id-UserLocationInformation (121)'
                per.enum_index: 'Enumerated Index: 1'
                ngap.criticality: 'criticality: ignore (1)'
                per.open_type_length: 'Open Type Length: 19'
                ngap.value_element:
                    per.choice_index: 'Choice Index: 1'
                    ngap.UserLocationInformation:
                        ngap.userLocationInformationNR_element:
                            per.extension_bit: '..0. .... Extension Bit: False'
                            per.optional_field_bit: '.... 0... Optional Field Bit: False (iE-Extensions is NOT present)'
                            ngap.nR_CGI_element:
                                per.extension_bit: '.... .0.. Extension Bit: False'
                                per.optional_field_bit: '.... ..0. Optional Field Bit: False (iE-Extensions is NOT present)'
                                ngap.pLMNIdentity:
                                    e212.mcc: 'Mobile Country Code (MCC): International Mobile, shared code (901)'
                                    e212.mnc: 'Mobile Network Code (MNC): Unknown (70)'
                                ngap.NRCellIdentity: 'nRCellIdentity: 0x0000000010'
                            ngap.tAI_element:
                                per.extension_bit: '.... 0... Extension Bit: False'
                                per.optional_field_bit: '.... .0.. Optional Field Bit: False (iE-Extensions is NOT present)'
                                ngap.pLMNIdentity:
                                    e212.mcc: 'Mobile Country Code (MCC): International Mobile, shared code (901)'
                                    e212.mnc: 'Mobile Network Code (MNC): Unknown (70)'
                                ngap.tAC: 'tAC: 1 (0x000001)'
                            ngap.timeStamp: 'timeStamp: e74c1dd1 (Dec 20, 2022 11:41:05 UTC)'

end note

"10.0.3.1" -> "10.0.2.15": 2351, NGAP DownlinkNASTransport (4),\nNAS Configuration update command (0x54)

note right #c6ebc6
**10.0.3.1 to 10.0.2.15**
NGAP-PDU: 0004403c000003000a0002001200550002000200260029287e02490d1779027e0054430f90004f00700065006e00350047005346404722219261701140490100
ngap.procedureCode: 'procedureCode: id-DownlinkNASTransport (4)'
per.enum_index: 'Enumerated Index: 1'
ngap.criticality: 'criticality: ignore (1)'
per.open_type_length: 'Open Type Length: 60'
ngap.value_element:
-   ngap.DownlinkNASTransport_element:
        per.extension_bit: '0... .... Extension Bit: False'
        per.sequence_of_length: 'Sequence-Of Length: 3'
        ngap.protocolIEs:
            'Item 0: id-AMF-UE-NGAP-ID':
                ngap.id: 'id: id-AMF-UE-NGAP-ID (10)'
                per.enum_index: 'Enumerated Index: 0'
                ngap.criticality: 'criticality: reject (0)'
                per.open_type_length: 'Open Type Length: 2'
                ngap.value_element:
                    ngap.AMF_UE_NGAP_ID: 'AMF-UE-NGAP-ID: 18'
            'Item 1: id-RAN-UE-NGAP-ID':
                ngap.id: 'id: id-RAN-UE-NGAP-ID (85)'
                per.enum_index: 'Enumerated Index: 0'
                ngap.criticality: 'criticality: reject (0)'
                per.open_type_length: 'Open Type Length: 2'
                ngap.value_element:
                    ngap.RAN_UE_NGAP_ID: 'RAN-UE-NGAP-ID: 2'
            'Item 2: id-NAS-PDU':
                ngap.id: 'id: id-NAS-PDU (38)'
                per.enum_index: 'Enumerated Index: 0'
                ngap.criticality: 'criticality: reject (0)'
                per.open_type_length: 'Open Type Length: 41'
                ngap.value_element:
                    per.octet_string_length: 'Octet String Length: 40'
                    ngap.NAS_PDU:
                        nas-5gs:
                            Security protected NAS 5GS message:
                                nas_5gs.epd: 'Extended protocol discriminator: 5G mobility management messages (126)'
                                nas_5gs.spare_half_octet: '0000 .... = Spare Half Octet: 0'
                                nas_5gs.security_header_type: '.... 0010 = Security header type: Integrity protected and ciphered (2)'
                                nas_5gs.msg_auth_code: 'Message authentication code: 0x490d1779'
                                nas_5gs.seq_no: 'Sequence number: 2'
                            Plain NAS 5GS Message:
                                nas_5gs.epd: 'Extended protocol discriminator: 5G mobility management messages (126)'
                                nas_5gs.spare_half_octet: '0000 .... = Spare Half Octet: 0'
                                nas_5gs.security_header_type: '.... 0000 = Security header type: Plain NAS message, not security protected (0)'
                                nas_5gs.mm.message_type: 'Message type: Configuration update command (0x54)'
                                Network Name - Full name for network:
                                    gsm_a.dtap.elem_id: 'Element ID: 0x43'
                                    gsm_a.len: 'Length: 15'
                                    gsm_a.extension: '1... .... = Extension: No Extension'
                                    gsm_a.dtap.coding_scheme: '.001 .... = Coding Scheme: UCS2 (16 bit) (1)'
                                    gsm_a.dtap.add_ci: '.... 0... = Add CI: The MS should not add the letters for the Country''s Initials to the text string'
                                    gsm_a.dtap.number_of_spare_bits: '.... .000 = Number of spare bits in last octet: this field carries no information about the number of spare bits in octet n (0)'
                                    gsm_a.dtap.text_string: 'Text String: Open5GS'
                                Time Zone - Local:
                                    gsm_a.dtap.elem_id: 'Element ID: 0x46'
                                    gsm_a.dtap.timezone: 'Timezone: GMT + 1 hours 0 minutes'
                                Time Zone and Time - Universal Time and Local Time Zone:
                                    gsm_a.dtap.elem_id: 'Element ID: 0x47'
                                    gsm_a.dtap.time_zone_time: 'Time: Dec 29, 2022 16:07:11.000000000'
                                    gsm_a.dtap.timezone: 'Timezone: GMT + 1 hours 0 minutes'
                                Daylight Saving Time:
                                    gsm_a.dtap.elem_id: 'Element ID: 0x49'
                                    gsm_a.len: 'Length: 1'
                                    gsm_a.spare_bits: '0000 00.. = Spare bit(s): 0'
                                    gsm_a.dtap.dst_adjustment: '.... ..00 = DST Adjustment: No adjustment for Daylight Saving Time (0)'

end note

"10.0.14.1" -> "10.0.17.1": 2393, PFCP req.\nPFCP Session Establishment Request (50)

note right #80b3ff
**10.0.14.1 to 10.0.17.1**
pfcp.flags:
-   pfcp.version: '001. .... = Version: 1'
    pfcp.spare_b4: '...0 .... = Spare: 0'
    pfcp.spare_b3: '.... 0... = Spare: 0'
    pfcp.spare_b2: '.... .0.. = Spare: 0'
    pfcp.mp_flag: '.... ..0. = Message Priority (MP): False'
    pfcp.s: '.... ...1 = SEID (S): True'
pfcp.msg_type: 'Message Type: PFCP Session Establishment Request (50)'
pfcp.length: 'Length: 547'
pfcp.seid: 'SEID: 0x0000000000000000'
pfcp.seqno: 'Sequence Number: 228'
pfcp.spare_oct: 'Spare: 0'
'Node ID : IPv4 address: 10.0.14.1':
-   pfcp.ie_type: 'IE Type: Node ID (60)'
    pfcp.ie_len: 'IE Length: 5'
    pfcp.spare_h1: '0000 .... = Spare: 0'
    pfcp.node_id_type: '.... 0000 = Node ID Type: IPv4 address (0)'
    pfcp.node_id_ipv4: 'Node ID IPv4: 10.0.14.1'
'F-SEID : SEID: 0x000000000000000a, IPv4 10.0.14.1':
-   pfcp.ie_type: 'IE Type: F-SEID (57)'
    pfcp.ie_len: 'IE Length: 13'
    pfcp.f_seid_flags:
        pfcp.spare_b7: '0... .... = Spare: 0'
        pfcp.spare_b6: '.0.. .... = Spare: 0'
        pfcp.spare_b5: '..0. .... = Spare: 0'
        pfcp.spare_b4: '...0 .... = Spare: 0'
        pfcp.spare_b3: '.... 0... = Spare: 0'
        pfcp.spare_b2: '.... .0.. = Spare: 0'
        pfcp.f_seid_flags.v4: '.... ..1. = V4 (IPv4): Present'
        pfcp.f_seid_flags.v6: '.... ...0 = V6 (IPv6): Not Present'
    pfcp.seid: 'SEID: 0x000000000000000a'
    pfcp.f_seid.ipv4: 'IPv4 address: 10.0.14.1'
'Create PDR : [Grouped IE]':
-   pfcp.ie_type: 'IE Type: Create PDR (1)'
    pfcp.ie_len: 'IE Length: 64'
    'PDR ID : 1':
        pfcp.ie_type: 'IE Type: PDR ID (56)'
        pfcp.ie_len: 'IE Length: 2'
        pfcp.pdr_id: 'Rule ID: 1'
    'Precedence : 255':
        pfcp.ie_type: 'IE Type: Precedence (29)'
        pfcp.ie_len: 'IE Length: 4'
        pfcp.precedence: 'Precedence: 255'
    'PDI : [Grouped IE]':
        pfcp.ie_type: 'IE Type: PDI (2)'
        pfcp.ie_len: 'IE Length: 22'
        'Source Interface : Core':
            pfcp.ie_type: 'IE Type: Source Interface (20)'
            pfcp.ie_len: 'IE Length: 1'
            pfcp.spare_h1: '0000 .... = Spare: 0'
            pfcp.source_interface: '.... 0001 = Source Interface: Core (1)'
        'Network Instance : iot':
            pfcp.ie_type: 'IE Type: Network Instance (22)'
            pfcp.ie_len: 'IE Length: 4'
            pfcp.network_instance: 'Network Instance: iot'
        'UE IP Address : ':
            pfcp.ie_type: 'IE Type: UE IP Address (93)'
            pfcp.ie_len: 'IE Length: 5'
            pfcp.ue_ip_address_flags:
                pfcp.spare_b7_b4: '0000 .... = Spare: 0'
                pfcp.ue_ip_address_flag.v6d: '.... 0... = IPv6D: Source IP address'
                pfcp.ue_ip_address_flag.sd: '.... .1.. = S/D: Destination IP address'
                pfcp.ue_ip_address_flag.v4: '.... ..1. = V4 (IPv4): Present'
                pfcp.ue_ip_address_flag.v6: '.... ...0 = V6 (IPv6): Not Present'
            pfcp.ue_ip_addr_ipv4: 'IPv4 address: 10.45.0.11'
    'FAR ID : Dynamic by CP 1':
        pfcp.ie_type: 'IE Type: FAR ID (108)'
        pfcp.ie_len: 'IE Length: 4'
        pfcp.far_id_flg: '0... .... .... .... .... .... .... .... = Allocation type: Dynamic by CP'
        pfcp.far_id: '.000 0000 0000 0000 0000 0000 0000 0001 = FAR ID: 1'
    'URR ID : Dynamic by CP 1':
        pfcp.ie_type: 'IE Type: URR ID (81)'
        pfcp.ie_len: 'IE Length: 4'
        pfcp.urr_id_flg: '0... .... .... .... .... .... .... .... = Allocation type: Dynamic by CP'
        pfcp.urr_id: '.000 0000 0000 0000 0000 0000 0000 0001 = URR ID: 1'
    'QER ID : Dynamic by CP 1':
        pfcp.ie_type: 'IE Type: QER ID (109)'
        pfcp.ie_len: 'IE Length: 4'
        pfcp.qer_id_flg: '0... .... .... .... .... .... .... .... = Allocation type: Dynamic by CP'
        pfcp.qer_id: '.000 0000 0000 0000 0000 0000 0000 0001 = QER ID: 1'
-   pfcp.ie_type: 'IE Type: Create PDR (1)'
    pfcp.ie_len: 'IE Length: 73'
    'PDR ID : 2':
        pfcp.ie_type: 'IE Type: PDR ID (56)'
        pfcp.ie_len: 'IE Length: 2'
        pfcp.pdr_id: 'Rule ID: 2'
    'Precedence : 255':
        pfcp.ie_type: 'IE Type: Precedence (29)'
        pfcp.ie_len: 'IE Length: 4'
        pfcp.precedence: 'Precedence: 255'
    'PDI : [Grouped IE]':
        pfcp.ie_type: 'IE Type: PDI (2)'
        pfcp.ie_len: 'IE Length: 33'
        'Source Interface : Access':
            pfcp.ie_type: 'IE Type: Source Interface (20)'
            pfcp.ie_len: 'IE Length: 1'
            pfcp.spare_h1: '0000 .... = Spare: 0'
            pfcp.source_interface: '.... 0000 = Source Interface: Access (0)'
        'F-TEID : ':
            pfcp.ie_type: 'IE Type: F-TEID (21)'
            pfcp.ie_len: 'IE Length: 2'
            pfcp.f_teid_flags:
                pfcp.fteid_flg.spare: '0000 .... = Spare: 0'
                pfcp.f_teid_flags.ch_id: '.... 1... = CHID (CHOOSE_ID): True'
                pfcp.f_teid_flags.ch: '.... .1.. = CH (CHOOSE): True'
                pfcp.f_teid_flags.v6: '.... ..1. = V6 (IPv6): Present'
                pfcp.f_teid_flags.v4: '.... ...1 = V4 (IPv4): Present'
            pfcp.f_teid.choose_id: 'Choose Id: 05'
        'Network Instance : iot':
            pfcp.ie_type: 'IE Type: Network Instance (22)'
            pfcp.ie_len: 'IE Length: 4'
            pfcp.network_instance: 'Network Instance: iot'
        'UE IP Address : ':
            pfcp.ie_type: 'IE Type: UE IP Address (93)'
            pfcp.ie_len: 'IE Length: 5'
            pfcp.ue_ip_address_flags:
                pfcp.spare_b7_b4: '0000 .... = Spare: 0'
                pfcp.ue_ip_address_flag.v6d: '.... 0... = IPv6D: Source IP address'
                pfcp.ue_ip_address_flag.sd: '.... .0.. = S/D: Source IP address'
                pfcp.ue_ip_address_flag.v4: '.... ..1. = V4 (IPv4): Present'
                pfcp.ue_ip_address_flag.v6: '.... ...0 = V6 (IPv6): Not Present'
            pfcp.ue_ip_addr_ipv4: 'IPv4 address: 10.45.0.11'
        'QFI : ':
            pfcp.ie_type: 'IE Type: QFI (124)'
            pfcp.ie_len: 'IE Length: 1'
            pfcp.spare_b7_b6: '00.. .... = Spare: 0'
            pfcp.qfi_value: '.000 0001 = QFI: 0x01'
    'Outer Header Removal : GTP-U/UDP/IPv4':
        pfcp.ie_type: 'IE Type: Outer Header Removal (95)'
        pfcp.ie_len: 'IE Length: 2'
        pfcp.out_hdr_desc: 'Outer Header Removal Description: GTP-U/UDP/IPv4 (0)'
        pfcp.gtpu_ext_hdr_del.pdu_sess_cont: '.... ...1 = PDU Session Container to be deleted: True'
    'FAR ID : Dynamic by CP 2':
        pfcp.ie_type: 'IE Type: FAR ID (108)'
        pfcp.ie_len: 'IE Length: 4'
        pfcp.far_id_flg: '0... .... .... .... .... .... .... .... = Allocation type: Dynamic by CP'
        pfcp.far_id: '.000 0000 0000 0000 0000 0000 0000 0010 = FAR ID: 2'
    'QER ID : Dynamic by CP 1':
        pfcp.ie_type: 'IE Type: QER ID (109)'
        pfcp.ie_len: 'IE Length: 4'
        pfcp.qer_id_flg: '0... .... .... .... .... .... .... .... = Allocation type: Dynamic by CP'
        pfcp.qer_id: '.000 0000 0000 0000 0000 0000 0000 0001 = QER ID: 1'
-   pfcp.ie_type: 'IE Type: Create PDR (1)'
    pfcp.ie_len: 'IE Length: 57'
    'PDR ID : 3':
        pfcp.ie_type: 'IE Type: PDR ID (56)'
        pfcp.ie_len: 'IE Length: 2'
        pfcp.pdr_id: 'Rule ID: 3'
    'Precedence : 1000':
        pfcp.ie_type: 'IE Type: Precedence (29)'
        pfcp.ie_len: 'IE Length: 4'
        pfcp.precedence: 'Precedence: 1000'
    'PDI : [Grouped IE]':
        pfcp.ie_type: 'IE Type: PDI (2)'
        pfcp.ie_len: 'IE Length: 18'
        'Source Interface : CP-function':
            pfcp.ie_type: 'IE Type: Source Interface (20)'
            pfcp.ie_len: 'IE Length: 1'
            pfcp.spare_h1: '0000 .... = Spare: 0'
            pfcp.source_interface: '.... 0011 = Source Interface: CP-function (3)'
        'F-TEID : ':
            pfcp.ie_type: 'IE Type: F-TEID (21)'
            pfcp.ie_len: 'IE Length: 1'
            pfcp.f_teid_flags:
                pfcp.fteid_flg.spare: '0000 .... = Spare: 0'
                pfcp.f_teid_flags.ch_id: '.... 0... = CHID (CHOOSE_ID): False'
                pfcp.f_teid_flags.ch: '.... .1.. = CH (CHOOSE): True'
                pfcp.f_teid_flags.v6: '.... ..1. = V6 (IPv6): Present'
                pfcp.f_teid_flags.v4: '.... ...1 = V4 (IPv4): Present'
        'Network Instance : iot':
            pfcp.ie_type: 'IE Type: Network Instance (22)'
            pfcp.ie_len: 'IE Length: 4'
            pfcp.network_instance: 'Network Instance: iot'
    'Outer Header Removal : GTP-U/UDP/IPv4':
        pfcp.ie_type: 'IE Type: Outer Header Removal (95)'
        pfcp.ie_len: 'IE Length: 1'
        pfcp.out_hdr_desc: 'Outer Header Removal Description: GTP-U/UDP/IPv4 (0)'
    'FAR ID : Dynamic by CP 1':
        pfcp.ie_type: 'IE Type: FAR ID (108)'
        pfcp.ie_len: 'IE Length: 4'
        pfcp.far_id_flg: '0... .... .... .... .... .... .... .... = Allocation type: Dynamic by CP'
        pfcp.far_id: '.000 0000 0000 0000 0000 0000 0000 0001 = FAR ID: 1'
    'QER ID : Dynamic by CP 1':
        pfcp.ie_type: 'IE Type: QER ID (109)'
        pfcp.ie_len: 'IE Length: 4'
        pfcp.qer_id_flg: '0... .... .... .... .... .... .... .... = Allocation type: Dynamic by CP'
        pfcp.qer_id: '.000 0000 0000 0000 0000 0000 0000 0001 = QER ID: 1'
-   pfcp.ie_type: 'IE Type: Create PDR (1)'
    pfcp.ie_len: 'IE Length: 105'
    'PDR ID : 4':
        pfcp.ie_type: 'IE Type: PDR ID (56)'
        pfcp.ie_len: 'IE Length: 2'
        pfcp.pdr_id: 'Rule ID: 4'
    'Precedence : 1':
        pfcp.ie_type: 'IE Type: Precedence (29)'
        pfcp.ie_len: 'IE Length: 4'
        pfcp.precedence: 'Precedence: 1'
    'PDI : [Grouped IE]':
        pfcp.ie_type: 'IE Type: PDI (2)'
        pfcp.ie_len: 'IE Length: 74'
        'Source Interface : Access':
            pfcp.ie_type: 'IE Type: Source Interface (20)'
            pfcp.ie_len: 'IE Length: 1'
            pfcp.spare_h1: '0000 .... = Spare: 0'
            pfcp.source_interface: '.... 0000 = Source Interface: Access (0)'
        'F-TEID : ':
            pfcp.ie_type: 'IE Type: F-TEID (21)'
            pfcp.ie_len: 'IE Length: 2'
            pfcp.f_teid_flags:
                pfcp.fteid_flg.spare: '0000 .... = Spare: 0'
                pfcp.f_teid_flags.ch_id: '.... 1... = CHID (CHOOSE_ID): True'
                pfcp.f_teid_flags.ch: '.... .1.. = CH (CHOOSE): True'
                pfcp.f_teid_flags.v6: '.... ..1. = V6 (IPv6): Present'
                pfcp.f_teid_flags.v4: '.... ...1 = V4 (IPv4): Present'
            pfcp.f_teid.choose_id: 'Choose Id: 05'
        'Network Instance : iot':
            pfcp.ie_type: 'IE Type: Network Instance (22)'
            pfcp.ie_len: 'IE Length: 4'
            pfcp.network_instance: 'Network Instance: iot'
        'SDF Filter : ':
            pfcp.ie_type: 'IE Type: SDF Filter (23)'
            pfcp.ie_len: 'IE Length: 46'
            pfcp.sdf_filter_flags:
                pfcp.spare_h1: '0000 .... = Spare: 0'
                pfcp.sdf_filter.bid: '...0 .... = BID (Bidirectional SDF Filter): False'
                pfcp.sdf_filter.fl: '.... 0... = FL (Flow Label): False'
                pfcp.sdf_filter.spi: '.... .0.. = SPI (Security Parameter Index): False'
                pfcp.sdf_filter.ttc: '.... ..0. = TTC (ToS Traffic Class): False'
                pfcp.sdf_filter.fd: '.... ...1 = FD (Flow Description): True'
            pfcp.spare: 'Spare: 0'
            pfcp.flow_desc_len: 'Length of Flow Description: 42'
            pfcp.flow_desc: 'Flow Description: permit out 58 from ff02::2/128 to assigned'
        'QFI : ':
            pfcp.ie_type: 'IE Type: QFI (124)'
            pfcp.ie_len: 'IE Length: 1'
            pfcp.spare_b7_b6: '00.. .... = Spare: 0'
            pfcp.qfi_value: '.000 0001 = QFI: 0x01'
    'Outer Header Removal : GTP-U/UDP/IPv4':
        pfcp.ie_type: 'IE Type: Outer Header Removal (95)'
        pfcp.ie_len: 'IE Length: 1'
        pfcp.out_hdr_desc: 'Outer Header Removal Description: GTP-U/UDP/IPv4 (0)'
    'FAR ID : Dynamic by CP 3':
        pfcp.ie_type: 'IE Type: FAR ID (108)'
        pfcp.ie_len: 'IE Length: 4'
        pfcp.far_id_flg: '0... .... .... .... .... .... .... .... = Allocation type: Dynamic by CP'
        pfcp.far_id: '.000 0000 0000 0000 0000 0000 0000 0011 = FAR ID: 3'
'Create FAR : [Grouped IE]':
-   pfcp.ie_type: 'IE Type: Create FAR (3)'
    pfcp.ie_len: 'IE Length: 19'
    'FAR ID : Dynamic by CP 1':
        pfcp.ie_type: 'IE Type: FAR ID (108)'
        pfcp.ie_len: 'IE Length: 4'
        pfcp.far_id_flg: '0... .... .... .... .... .... .... .... = Allocation type: Dynamic by CP'
        pfcp.far_id: '.000 0000 0000 0000 0000 0000 0000 0001 = FAR ID: 1'
    'Apply Action : ':
        pfcp.ie_type: 'IE Type: Apply Action (44)'
        pfcp.ie_len: 'IE Length: 2'
        pfcp.apply_action_flags:
            pfcp.spare_b7_b5: '000. .... = Spare: 0'
            pfcp.apply_action.dupl: '...0 .... = DUPL (Duplicate): False'
            pfcp.apply_action.nocp: '.... 1... = NOCP (Notify the CP function): True'
            pfcp.apply_action.buff: '.... .1.. = BUFF (Buffer): True'
            pfcp.apply_action.forw: '.... ..0. = FORW (Forward): False'
            pfcp.apply_action.drop: '.... ...0 = DROP (Drop): False'
        IE data not decoded by WS yet:
            _ws.expert:
                pfcp.ie_data_not_decoded: IE data not decoded by WS yet
                _ws.expert.message: 'Message: IE data not decoded by WS yet'
                _ws.expert.severity: 'Severity level: Note'
                _ws.expert.group: 'Group: Undecoded'
    'BAR ID : 1':
        pfcp.ie_type: 'IE Type: BAR ID (88)'
        pfcp.ie_len: 'IE Length: 1'
        pfcp.bar_id: 'BAR ID: 1'
-   pfcp.ie_type: 'IE Type: Create FAR (3)'
    pfcp.ie_len: 'IE Length: 31'
    'FAR ID : Dynamic by CP 2':
        pfcp.ie_type: 'IE Type: FAR ID (108)'
        pfcp.ie_len: 'IE Length: 4'
        pfcp.far_id_flg: '0... .... .... .... .... .... .... .... = Allocation type: Dynamic by CP'
        pfcp.far_id: '.000 0000 0000 0000 0000 0000 0000 0010 = FAR ID: 2'
    'Apply Action : ':
        pfcp.ie_type: 'IE Type: Apply Action (44)'
        pfcp.ie_len: 'IE Length: 2'
        pfcp.apply_action_flags:
            pfcp.spare_b7_b5: '000. .... = Spare: 0'
            pfcp.apply_action.dupl: '...0 .... = DUPL (Duplicate): False'
            pfcp.apply_action.nocp: '.... 0... = NOCP (Notify the CP function): False'
            pfcp.apply_action.buff: '.... .0.. = BUFF (Buffer): False'
            pfcp.apply_action.forw: '.... ..1. = FORW (Forward): True'
            pfcp.apply_action.drop: '.... ...0 = DROP (Drop): False'
        IE data not decoded by WS yet:
            _ws.expert:
                pfcp.ie_data_not_decoded: IE data not decoded by WS yet
                _ws.expert.message: 'Message: IE data not decoded by WS yet'
                _ws.expert.severity: 'Severity level: Note'
                _ws.expert.group: 'Group: Undecoded'
    'Forwarding Parameters : [Grouped IE]':
        pfcp.ie_type: 'IE Type: Forwarding Parameters (4)'
        pfcp.ie_len: 'IE Length: 13'
        'Destination Interface : Core':
            pfcp.ie_type: 'IE Type: Destination Interface (42)'
            pfcp.ie_len: 'IE Length: 1'
            pfcp.spare_h1: '0000 .... = Spare: 0'
            pfcp.dst_interface: '.... 0001 = Interface: Core (1)'
        'Network Instance : iot':
            pfcp.ie_type: 'IE Type: Network Instance (22)'
            pfcp.ie_len: 'IE Length: 4'
            pfcp.network_instance: 'Network Instance: iot'
-   pfcp.ie_type: 'IE Type: Create FAR (3)'
    pfcp.ie_len: 'IE Length: 45'
    'FAR ID : Dynamic by CP 3':
        pfcp.ie_type: 'IE Type: FAR ID (108)'
        pfcp.ie_len: 'IE Length: 4'
        pfcp.far_id_flg: '0... .... .... .... .... .... .... .... = Allocation type: Dynamic by CP'
        pfcp.far_id: '.000 0000 0000 0000 0000 0000 0000 0011 = FAR ID: 3'
    'Apply Action : ':
        pfcp.ie_type: 'IE Type: Apply Action (44)'
        pfcp.ie_len: 'IE Length: 2'
        pfcp.apply_action_flags:
            pfcp.spare_b7_b5: '000. .... = Spare: 0'
            pfcp.apply_action.dupl: '...0 .... = DUPL (Duplicate): False'
            pfcp.apply_action.nocp: '.... 0... = NOCP (Notify the CP function): False'
            pfcp.apply_action.buff: '.... .0.. = BUFF (Buffer): False'
            pfcp.apply_action.forw: '.... ..1. = FORW (Forward): True'
            pfcp.apply_action.drop: '.... ...0 = DROP (Drop): False'
        IE data not decoded by WS yet:
            _ws.expert:
                pfcp.ie_data_not_decoded: IE data not decoded by WS yet
                _ws.expert.message: 'Message: IE data not decoded by WS yet'
                _ws.expert.severity: 'Severity level: Note'
                _ws.expert.group: 'Group: Undecoded'
    'Forwarding Parameters : [Grouped IE]':
        pfcp.ie_type: 'IE Type: Forwarding Parameters (4)'
        pfcp.ie_len: 'IE Length: 27'
        'Destination Interface : CP- Function':
            pfcp.ie_type: 'IE Type: Destination Interface (42)'
            pfcp.ie_len: 'IE Length: 1'
            pfcp.spare_h1: '0000 .... = Spare: 0'
            pfcp.dst_interface: '.... 0011 = Interface: CP- Function (3)'
        'Network Instance : iot':
            pfcp.ie_type: 'IE Type: Network Instance (22)'
            pfcp.ie_len: 'IE Length: 4'
            pfcp.network_instance: 'Network Instance: iot'
        'Outer Header Creation : ':
            pfcp.ie_type: 'IE Type: Outer Header Creation (84)'
            pfcp.ie_len: 'IE Length: 10'
            pfcp.outer_hdr_desc: 'Outer Header Creation Description: GTP-U/UDP/IPv4  (256)'
            pfcp.outer_hdr_creation.teid: 'TEID: 0x0000000a'
            pfcp.outer_hdr_creation.ipv4: 'IPv4 Address: 10.0.14.1'
'Create URR : [Grouped IE]':
-   pfcp.ie_type: 'IE Type: Create URR (6)'
    pfcp.ie_len: 'IE Length: 33'
    'URR ID : Dynamic by CP 1':
        pfcp.ie_type: 'IE Type: URR ID (81)'
        pfcp.ie_len: 'IE Length: 4'
        pfcp.urr_id_flg: '0... .... .... .... .... .... .... .... = Allocation type: Dynamic by CP'
        pfcp.urr_id: '.000 0000 0000 0000 0000 0000 0000 0001 = URR ID: 1'
    'Measurement Method : ':
        pfcp.ie_type: 'IE Type: Measurement Method (62)'
        pfcp.ie_len: 'IE Length: 1'
        pfcp.measurement_method_flags:
            pfcp.spare_b7_b3: '0000 0... = Spare: 0'
            pfcp.measurement_method_flags.event: '.... .0.. = EVENT (Event): False'
            pfcp.measurement_method_flags.volume: '.... ..1. = VOLUM (Volume): True'
            pfcp.measurement_method_flags.durat: '.... ...0 = DURAT (Duration): False'
    'Reporting Triggers : ':
        pfcp.ie_type: 'IE Type: Reporting Triggers (37)'
        pfcp.ie_len: 'IE Length: 3'
        pfcp.reporting_triggers_flags.liusa: '0... .... = LIUSA (Linked Usage Reporting): False'
        pfcp.reporting_triggers_flags.droth: '.0.. .... = DROTH (Dropped DL Traffic Threshold): False'
        pfcp.reporting_triggers_flags.stopt: '..0. .... = STOPT (Stop of Traffic): False'
        pfcp.reporting_triggers_flags.start: '...0 .... = START (Start of Traffic): False'
        pfcp.reporting_triggers_flags.quhti: '.... 0... = QUHTI (Quota Holding Time): False'
        pfcp.reporting_triggers_flags.timth: '.... .0.. = TIMTH (Time Threshold): False'
        pfcp.reporting_triggers_flags.volth: '.... ..1. = VOLTH (Volume Threshold): True'
        pfcp.reporting_triggers_flags.perio: '.... ...0 = PERIO (Periodic Reporting): False'
        pfcp.spare_b7_b5: '000. .... = Spare: 0'
        pfcp.reporting_triggers_flags.evequ: '..0. .... = EVEQU (Event Quota): False'
        pfcp.reporting_triggers_flags.eveth: '...0 .... = EVETH (Event Threshold): False'
        pfcp.reporting_triggers_flags.macar: '.... 0... = MACAR (MAC Addresses Reporting): False'
        pfcp.reporting_triggers_flags.envcl: '.... .0.. = ENVCL (Envelope Closure): False'
        pfcp.reporting_triggers_flags.timqu: '.... ..0. = TIMQU (Time Quota): False'
        pfcp.reporting_triggers_flags.volqu: '.... ...0 = VOLQU (Volume Quota): False'
        IE data not decoded by WS yet:
            _ws.expert:
                pfcp.ie_data_not_decoded: IE data not decoded by WS yet
                _ws.expert.message: 'Message: IE data not decoded by WS yet'
                _ws.expert.severity: 'Severity level: Note'
                _ws.expert.group: 'Group: Undecoded'
    'Volume Threshold : ':
        pfcp.ie_type: 'IE Type: Volume Threshold (31)'
        pfcp.ie_len: 'IE Length: 9'
        pfcp.volume_threshold:
            pfcp.spare_b7_b3: '0000 0... = Spare: 0'
            pfcp.volume_threshold_flags.dlvol: '.... .0.. = DLVOL: False'
            pfcp.volume_threshold_flags.ulvol: '.... ..0. = ULVOL: False'
            pfcp.volume_threshold_flags.tovol: '.... ...1 = TOVOL: True'
        pfcp.volume_threshold.tovol: 'Total Volume: 104857600'
'Create QER : [Grouped IE]':
-   pfcp.ie_type: 'IE Type: Create QER (7)'
    pfcp.ie_len: 'IE Length: 32'
    'QER ID : Dynamic by CP 1':
        pfcp.ie_type: 'IE Type: QER ID (109)'
        pfcp.ie_len: 'IE Length: 4'
        pfcp.qer_id_flg: '0... .... .... .... .... .... .... .... = Allocation type: Dynamic by CP'
        pfcp.qer_id: '.000 0000 0000 0000 0000 0000 0000 0001 = QER ID: 1'
    'Gate Status : ':
        pfcp.ie_type: 'IE Type: Gate Status (25)'
        pfcp.ie_len: 'IE Length: 1'
        pfcp.gate_status:
            pfcp.gate_status.ulgate: '.... ..00 = DL Gate: OPEN (0)'
    'MBR : ':
        pfcp.ie_type: 'IE Type: MBR (26)'
        pfcp.ie_len: 'IE Length: 10'
        pfcp.ul_mbr: 'UL MBR: 1073741'
        pfcp.dl_mbr: 'DL MBR: 1073741'
    'QFI : ':
        pfcp.ie_type: 'IE Type: QFI (124)'
        pfcp.ie_len: 'IE Length: 1'
        pfcp.spare_b7_b6: '00.. .... = Spare: 0'
        pfcp.qfi_value: '.000 0001 = QFI: 0x01'
'Create BAR : [Grouped IE]':
-   pfcp.ie_type: 'IE Type: Create BAR (85)'
    pfcp.ie_len: 'IE Length: 5'
    'BAR ID : 1':
        pfcp.ie_type: 'IE Type: BAR ID (88)'
        pfcp.ie_len: 'IE Length: 1'
        pfcp.bar_id: 'BAR ID: 1'
'PDN Type : IPv4':
-   pfcp.ie_type: 'IE Type: PDN Type (113)'
    pfcp.ie_len: 'IE Length: 1'
    pfcp.pdn_type: '.... .001 = PDN Type: IPv4 (1)'
pfcp.response_in: 'Response In: 2394'

end note

"10.0.17.1" -> "10.0.14.1": 2394, PFCP rsp.\nPFCP Session Establishment Response (51)

note right #cce0ff
**10.0.17.1 to 10.0.14.1**
pfcp.flags:
-   pfcp.version: '001. .... = Version: 1'
    pfcp.spare_b4: '...0 .... = Spare: 0'
    pfcp.spare_b3: '.... 0... = Spare: 0'
    pfcp.spare_b2: '.... .0.. = Spare: 0'
    pfcp.mp_flag: '.... ..0. = Message Priority (MP): False'
    pfcp.s: '.... ...1 = SEID (S): True'
pfcp.msg_type: 'Message Type: PFCP Session Establishment Response (51)'
pfcp.length: 'Length: 112'
pfcp.seid: 'SEID: 0x000000000000000a'
pfcp.seqno: 'Sequence Number: 228'
pfcp.spare_oct: 'Spare: 0'
'Node ID : IPv4 address: 10.0.17.1':
-   pfcp.ie_type: 'IE Type: Node ID (60)'
    pfcp.ie_len: 'IE Length: 5'
    pfcp.spare_h1: '0000 .... = Spare: 0'
    pfcp.node_id_type: '.... 0000 = Node ID Type: IPv4 address (0)'
    pfcp.node_id_ipv4: 'Node ID IPv4: 10.0.17.1'
'Cause : Request accepted(success)':
-   pfcp.ie_type: 'IE Type: Cause (19)'
    pfcp.ie_len: 'IE Length: 1'
    pfcp.cause: 'Cause: Request accepted(success) (1)'
'F-SEID : SEID: 0x000000000000000a, IPv4 10.0.17.1':
-   pfcp.ie_type: 'IE Type: F-SEID (57)'
    pfcp.ie_len: 'IE Length: 13'
    pfcp.f_seid_flags:
        pfcp.spare_b7: '0... .... = Spare: 0'
        pfcp.spare_b6: '.0.. .... = Spare: 0'
        pfcp.spare_b5: '..0. .... = Spare: 0'
        pfcp.spare_b4: '...0 .... = Spare: 0'
        pfcp.spare_b3: '.... 0... = Spare: 0'
        pfcp.spare_b2: '.... .0.. = Spare: 0'
        pfcp.f_seid_flags.v4: '.... ..1. = V4 (IPv4): Present'
        pfcp.f_seid_flags.v6: '.... ...0 = V6 (IPv6): Not Present'
    pfcp.seid: 'SEID: 0x000000000000000a'
    pfcp.f_seid.ipv4: 'IPv4 address: 10.0.17.1'
'Created PDR : [Grouped IE]':
-   pfcp.ie_type: 'IE Type: Created PDR (8)'
    pfcp.ie_len: 'IE Length: 19'
    'PDR ID : 2':
        pfcp.ie_type: 'IE Type: PDR ID (56)'
        pfcp.ie_len: 'IE Length: 2'
        pfcp.pdr_id: 'Rule ID: 2'
    'F-TEID : TEID: 0x00000026, IPv4 10.0.17.1':
        pfcp.ie_type: 'IE Type: F-TEID (21)'
        pfcp.ie_len: 'IE Length: 9'
        pfcp.f_teid_flags:
            pfcp.fteid_flg.spare: '0000 .... = Spare: 0'
            pfcp.f_teid_flags.ch_id: '.... 0... = CHID (CHOOSE_ID): False'
            pfcp.f_teid_flags.ch: '.... .0.. = CH (CHOOSE): False'
            pfcp.f_teid_flags.v6: '.... ..0. = V6 (IPv6): Not Present'
            pfcp.f_teid_flags.v4: '.... ...1 = V4 (IPv4): Present'
        pfcp.f_teid.teid: 'TEID: 0x00000026'
        pfcp.f_teid.ipv4_addr: 'IPv4 address: 10.0.17.1'
-   pfcp.ie_type: 'IE Type: Created PDR (8)'
    pfcp.ie_len: 'IE Length: 19'
    'PDR ID : 3':
        pfcp.ie_type: 'IE Type: PDR ID (56)'
        pfcp.ie_len: 'IE Length: 2'
        pfcp.pdr_id: 'Rule ID: 3'
    'F-TEID : TEID: 0x00000027, IPv4 10.0.17.1':
        pfcp.ie_type: 'IE Type: F-TEID (21)'
        pfcp.ie_len: 'IE Length: 9'
        pfcp.f_teid_flags:
            pfcp.fteid_flg.spare: '0000 .... = Spare: 0'
            pfcp.f_teid_flags.ch_id: '.... 0... = CHID (CHOOSE_ID): False'
            pfcp.f_teid_flags.ch: '.... .0.. = CH (CHOOSE): False'
            pfcp.f_teid_flags.v6: '.... ..0. = V6 (IPv6): Not Present'
            pfcp.f_teid_flags.v4: '.... ...1 = V4 (IPv4): Present'
        pfcp.f_teid.teid: 'TEID: 0x00000027'
        pfcp.f_teid.ipv4_addr: 'IPv4 address: 10.0.17.1'
-   pfcp.ie_type: 'IE Type: Created PDR (8)'
    pfcp.ie_len: 'IE Length: 19'
    'PDR ID : 4':
        pfcp.ie_type: 'IE Type: PDR ID (56)'
        pfcp.ie_len: 'IE Length: 2'
        pfcp.pdr_id: 'Rule ID: 4'
    'F-TEID : TEID: 0x00000026, IPv4 10.0.17.1':
        pfcp.ie_type: 'IE Type: F-TEID (21)'
        pfcp.ie_len: 'IE Length: 9'
        pfcp.f_teid_flags:
            pfcp.fteid_flg.spare: '0000 .... = Spare: 0'
            pfcp.f_teid_flags.ch_id: '.... 0... = CHID (CHOOSE_ID): False'
            pfcp.f_teid_flags.ch: '.... .0.. = CH (CHOOSE): False'
            pfcp.f_teid_flags.v6: '.... ..0. = V6 (IPv6): Not Present'
            pfcp.f_teid_flags.v4: '.... ...1 = V4 (IPv4): Present'
        pfcp.f_teid.teid: 'TEID: 0x00000026'
        pfcp.f_teid.ipv4_addr: 'IPv4 address: 10.0.17.1'
pfcp.response_to: 'Response To: 2393'
pfcp.response_time: 'Response Time: 0.000307269 seconds'

end note

"10.0.3.1" -> "10.0.2.15": 2399, NGAP PDUSessionResourceSetup (29),\nNAS DL NAS transport (0x68),\nNAS PDU session establishment accept (0xc2)

note right #c6ebc6
**10.0.3.1 to 10.0.2.15**
NGAP-PDU: 001d0080a9000004000a00020012005500020002004a008087004001517e02e0b3d58e037e00680100422e0101c211000901000631310101ff01060b00010b00012905010a2d000b2201017900060120410101097b000f80000d0408080808000d0408080404250403696f74120100202f0000040082000a0c400000003040000000008b000a01f00a0011010000002600860001000088000700010000091c00006e400a0c400000003040000000
ngap.procedureCode: 'procedureCode: id-PDUSessionResourceSetup (29)'
per.enum_index: 'Enumerated Index: 0'
ngap.criticality: 'criticality: reject (0)'
per.open_type_length: 'Open Type Length: 169'
ngap.value_element:
-   ngap.PDUSessionResourceSetupRequest_element:
        per.extension_bit: '0... .... Extension Bit: False'
        per.sequence_of_length: 'Sequence-Of Length: 4'
        ngap.protocolIEs:
            'Item 0: id-AMF-UE-NGAP-ID':
                ngap.id: 'id: id-AMF-UE-NGAP-ID (10)'
                per.enum_index: 'Enumerated Index: 0'
                ngap.criticality: 'criticality: reject (0)'
                per.open_type_length: 'Open Type Length: 2'
                ngap.value_element:
                    ngap.AMF_UE_NGAP_ID: 'AMF-UE-NGAP-ID: 18'
            'Item 1: id-RAN-UE-NGAP-ID':
                ngap.id: 'id: id-RAN-UE-NGAP-ID (85)'
                per.enum_index: 'Enumerated Index: 0'
                ngap.criticality: 'criticality: reject (0)'
                per.open_type_length: 'Open Type Length: 2'
                ngap.value_element:
                    ngap.RAN_UE_NGAP_ID: 'RAN-UE-NGAP-ID: 2'
            'Item 2: id-PDUSessionResourceSetupListSUReq':
                ngap.id: 'id: id-PDUSessionResourceSetupListSUReq (74)'
                per.enum_index: 'Enumerated Index: 0'
                ngap.criticality: 'criticality: reject (0)'
                per.open_type_length: 'Open Type Length: 135'
                ngap.value_element:
                    per.sequence_of_length: 'Sequence-Of Length: 1'
                    ngap.PDUSessionResourceSetupListSUReq:
                        Item 0:
                            ngap.PDUSessionResourceSetupItemSUReq_element:
                                per.extension_bit: '0... .... Extension Bit: False'
                                per.optional_field_bit: '..0. .... Optional Field Bit: False (iE-Extensions is NOT present)'
                                ngap.pDUSessionID: 'pDUSessionID: 1'
                                per.octet_string_length: 'Octet String Length: 47'
                                ngap.pDUSessionNAS_PDU:
                                    nas-5gs:
                                        Security protected NAS 5GS message:
                                            nas_5gs.epd: 'Extended protocol discriminator: 5G mobility management messages (126)'
                                            nas_5gs.spare_half_octet: '0000 .... = Spare Half Octet: 0'
                                            nas_5gs.security_header_type: '.... 0010 = Security header type: Integrity protected and ciphered (2)'
                                            nas_5gs.msg_auth_code: 'Message authentication code: 0xe0b3d58e'
                                            nas_5gs.seq_no: 'Sequence number: 3'
                                        Plain NAS 5GS Message:
                                            nas_5gs.epd: 'Extended protocol discriminator: 5G mobility management messages (126)'
                                            nas_5gs.spare_half_octet: '0000 .... = Spare Half Octet: 0'
                                            nas_5gs.security_header_type: '.... 0000 = Security header type: Plain NAS message, not security protected (0)'
                                            nas_5gs.mm.message_type: 'Message type: DL NAS transport (0x68)'
                                            Payload container type:
                                                nas_5gs.mm.pld_cont_type: '.... 0001 = Payload container type: N1 SM information (1)'
                                            Payload container:
                                                gsm_a.len: 'Length: 66'
                                                Plain NAS 5GS Message:
                                                    nas_5gs.epd: 'Extended protocol discriminator: 5G session management messages (46)'
                                                    nas_5gs.pdu_session_id: 'PDU session identity: PDU session identity value 1 (1)'
                                                    nas_5gs.proc_trans_id: 'Procedure transaction identity: 1'
                                                    nas_5gs.sm.message_type: 'Message type: PDU session establishment accept (0xc2)'
                                                    nas_5gs.sm.sel_sc_mode: '0001 .... = Selected SSC mode: SSC mode 1 (1)'
                                                    PDU session type - Selected PDU session type:
                                                        nas_5gs.sm.pdu_session_type: '.... 0001 = PDU session type: IPv4 (1)'
                                                    QoS rules - Authorized QoS rules:
                                                        gsm_a.len: 'Length: 9'
                                                        QoS rule 1:
                                                            nas_5gs.sm.qos_rule_id: 'QoS rule identifier: 1'
                                                            nas_5gs.sm.length: 'Length: 6'
                                                            nas_5gs.sm.rop: '001. .... = Rule operation code: Create new QoS rule (1)'
                                                            nas_5gs.sm.dqr: '...1 .... = DQR: The QoS rule is the default QoS rule'
                                                            nas_5gs.sm.nof_pkt_filters: '.... 0001 = Number of packet filters: 1'
                                                            Packet filter 1:
                                                                nas_5gs.sm.pkt_flt_dir: '..11 .... = Packet filter direction: Bidirectional (3)'
                                                                nas_5gs.sm.pkt_flt_id: '.... 0001 = Packet filter identifier: 1'
                                                                nas_5gs.sm.pf_len: 'Length: 1'
                                                                Packet filter component 1:
                                                                    nas_5gs.sm.pf_type: 'Packet filter component type: Match-all type (1)'
                                                            nas_5gs.sm.qos_rule_precedence: 'QoS rule precedence: 255'
                                                            nas_5gs.spare_b7: '0... .... = Spare: 0'
                                                            nas_5gs.spare_b6: '.0.. .... = Spare: 0'
                                                            nas_5gs.sm.qfi: '..00 0001 = Qos flow identifier: 1'
                                                    Session-AMBR:
                                                        gsm_a.len: 'Length: 6'
                                                        nas_5gs.sm.unit_for_session_ambr_dl: 'Unit for Session-AMBR for downlink: value is incremented in multiples of 1 Gbps (11)'
                                                        nas_5gs.sm.session_ambr_dl: 'Session-AMBR for downlink: 1 Gbps (1)'
                                                        nas_5gs.sm.unit_for_session_ambr_ul: 'Unit for Session-AMBR for uplink: value is incremented in multiples of 1 Gbps (11)'
                                                        nas_5gs.sm.session_ambr_ul: 'Session-AMBR for uplink: 1 Gbps (1)'
                                                    PDU address:
                                                        nas_5gs.sm.elem_id: 'Element ID: 0x29'
                                                        gsm_a.len: 'Length: 5'
                                                        nas_5gs.sm.pdu_ses_type: '.... 0001 = PDU session type: IPv4 (1)'
                                                        nas_5gs.sm.pdu_addr_inf_ipv4: 'PDU address information: 10.45.0.11'
                                                    S-NSSAI:
                                                        nas_5gs.common.elem_id: 'Element ID: 0x22'
                                                        gsm_a.len: 'Length: 1'
                                                        nas_5gs.mm.sst: 'Slice/service type (SST): 1'
                                                    QoS flow descriptions - Authorized:
                                                        nas_5gs.sm.elem_id: 'Element ID: 0x79'
                                                        gsm_a.len: 'Length: 6'
                                                        QoS flow description 1:
                                                            nas_5gs.sm.qfi: '..00 0001 = Qos flow identifier: 1'
                                                            nas_5gs.sm.hf_nas_5gs_sm_qos_des_flow_opt_code: '001. .... = Operation code: Create new QoS flow description (1)'
                                                            nas_5gs.sm.e: '.1.. .... = E bit: 1'
                                                            nas_5gs.sm.nof_params: '..00 0001 = Number of parameters: 1'
                                                            Parameter 1 - 5QI:
                                                                nas_5gs.sm.param_id: 'Parameter identifier: 5QI (1)'
                                                                nas_5gs.sm.param_len: 'Length: 1'
                                                                nas_5gs.sm.5qi: '5QI: 9'
                                                    Extended protocol configuration options:
                                                        nas_eps.esm.elem_id: 'Element ID: 0x7b'
                                                        gsm_a.len: 'Length: 15'
                                                        gsm_a.gm.sm.link_dir: 'Link direction: Network to MS (1)'
                                                        gsm_a.gm.sm.ext: '1... .... = Extension: True'
                                                        gsm_a.gm.configuration_protocol: '.... .000 = Configuration Protocol: PPP for use with IP PDP type or IP PDN type (0)'
                                                        gsm_a.gm.sm.pco_pid:
                                                        -   gsm_a.gm.sm.pco.length: 'Length: 0x04 (4)'
                                                            gsm_a.gm.sm.pco.dns.ipv4: 'IPv4: 8.8.8.8'
                                                        -   gsm_a.gm.sm.pco.length: 'Length: 0x04 (4)'
                                                            gsm_a.gm.sm.pco.dns.ipv4: 'IPv4: 8.8.4.4'
                                                    DNN:
                                                        nas_5gs.common.elem_id: 'Element ID: 0x25'
                                                        gsm_a.len: 'Length: 4'
                                                        nas_5gs.cmn.dnn: 'DNN: iot'
                                            PDU session identity 2 - PDU session ID:
                                                nas_5gs.mm.elem_id: 'Element ID: 0x12'
                                                nas_5gs.pdu_session_id: 'PDU session identity: PDU session identity value 1 (1)'
                                ngap.s_NSSAI_element:
                                    per.extension_bit: '0... .... Extension Bit: False'
                                    per.optional_field_bit: '..0. .... Optional Field Bit: False (iE-Extensions is NOT present)'
                                    ngap.sST: 'sST: 01'
                                ngap.pDUSessionResourceSetupRequestTransfer:
                                    ngap.PDUSessionResourceSetupRequestTransfer_element:
                                        per.extension_bit: '0... .... Extension Bit: False'
                                        per.sequence_of_length: 'Sequence-Of Length: 4'
                                        ngap.protocolIEs:
                                            'Item 0: id-PDUSessionAggregateMaximumBitRate':
                                                ngap.id: 'id: id-PDUSessionAggregateMaximumBitRate (130)'
                                                per.enum_index: 'Enumerated Index: 0'
                                                ngap.criticality: 'criticality: reject (0)'
                                                per.open_type_length: 'Open Type Length: 10'
                                                ngap.value_element:
                                                    ngap.PDUSessionAggregateMaximumBitRate_element:
                                                        per.extension_bit: '0... .... Extension Bit: False'
                                                        per.optional_field_bit: '.0.. .... Optional Field Bit: False (iE-Extensions is NOT present)'
                                                        per.extension_present_bit: '0... .... Extension Present Bit: False'
                                                        ngap.pDUSessionAggregateMaximumBitRateDL: 'pDUSessionAggregateMaximumBitRateDL: 1073741824bits/s'
                                                        ngap.pDUSessionAggregateMaximumBitRateUL: 'pDUSessionAggregateMaximumBitRateUL: 1073741824bits/s'
                                            'Item 1: id-UL-NGU-UP-TNLInformation':
                                                ngap.id: 'id: id-UL-NGU-UP-TNLInformation (139)'
                                                per.enum_index: 'Enumerated Index: 0'
                                                ngap.criticality: 'criticality: reject (0)'
                                                per.open_type_length: 'Open Type Length: 10'
                                                ngap.value_element:
                                                    per.choice_index: 'Choice Index: 0'
                                                    ngap.UPTransportLayerInformation:
                                                        ngap.gTPTunnel_element:
                                                            per.extension_bit: '.0.. .... Extension Bit: False'
                                                            per.optional_field_bit: '..0. .... Optional Field Bit: False (iE-Extensions is NOT present)'
                                                            per.extension_present_bit: '...0 .... Extension Present Bit: False'
                                                            per.bit_string_length: 'Bit String Length: 32'
                                                            ngap.transportLayerAddress:
                                                                ngap.TransportLayerAddressIPv4: 'TransportLayerAddress (IPv4): 10.0.17.1'
                                                            ngap.gTP_TEID: 'gTP-TEID: 00000026'
                                            'Item 2: id-PDUSessionType':
                                                ngap.id: 'id: id-PDUSessionType (134)'
                                                per.enum_index: 'Enumerated Index: 0'
                                                ngap.criticality: 'criticality: reject (0)'
                                                per.open_type_length: 'Open Type Length: 1'
                                                ngap.value_element:
                                                    per.extension_present_bit: '0... .... Extension Present Bit: False'
                                                    per.enum_index: 'Enumerated Index: 0'
                                                    ngap.PDUSessionType: 'PDUSessionType: ipv4 (0)'
                                            'Item 3: id-QosFlowSetupRequestList':
                                                ngap.id: 'id: id-QosFlowSetupRequestList (136)'
                                                per.enum_index: 'Enumerated Index: 0'
                                                ngap.criticality: 'criticality: reject (0)'
                                                per.open_type_length: 'Open Type Length: 7'
                                                ngap.value_element:
                                                    per.sequence_of_length: 'Sequence-Of Length: 1'
                                                    ngap.QosFlowSetupRequestList:
                                                        Item 0:
                                                            ngap.QosFlowSetupRequestItem_element:
                                                                per.extension_bit: '.... ..0. Extension Bit: False'
                                                                per.optional_field_bit: '0... .... Optional Field Bit: False (iE-Extensions is NOT present)'
                                                                per.extension_present_bit: '.0.. .... Extension Present Bit: False'
                                                                ngap.qosFlowIdentifier: 'qosFlowIdentifier: 1'
                                                                ngap.qosFlowLevelQosParameters_element:
                                                                    per.extension_bit: '0... .... Extension Bit: False'
                                                                    per.optional_field_bit: '.... 0... Optional Field Bit: False (iE-Extensions is NOT present)'
                                                                    per.choice_index: 'Choice Index: 0'
                                                                    ngap.qosCharacteristics:
                                                                        ngap.nonDynamic5QI_element:
                                                                            per.extension_bit: '.... ...0 Extension Bit: False'
                                                                            per.optional_field_bit: '...0 .... Optional Field Bit: False (iE-Extensions is NOT present)'
                                                                            per.extension_present_bit: '.... 0... Extension Present Bit: False'
                                                                            ngap.fiveQI: 'fiveQI: 9'
                                                                    ngap.allocationAndRetentionPriority_element:
                                                                        per.extension_bit: '0... .... Extension Bit: False'
                                                                        per.optional_field_bit: '.0.. .... Optional Field Bit: False (iE-Extensions is NOT present)'
                                                                        ngap.priorityLevelARP: 'priorityLevelARP: 8'
                                                                        per.extension_present_bit: '0... .... Extension Present Bit: False'
                                                                        per.enum_index: 'Enumerated Index: 0'
                                                                        ngap.pre_emptionCapability: 'pre-emptionCapability: shall-not-trigger-pre-emption (0)'
                                                                        ngap.pre_emptionVulnerability: 'pre-emptionVulnerability: not-pre-emptable (0)'
            'Item 3: id-UEAggregateMaximumBitRate':
                ngap.id: 'id: id-UEAggregateMaximumBitRate (110)'
                per.enum_index: 'Enumerated Index: 1'
                ngap.criticality: 'criticality: ignore (1)'
                per.open_type_length: 'Open Type Length: 10'
                ngap.value_element:
                    ngap.UEAggregateMaximumBitRate_element:
                        per.extension_bit: '0... .... Extension Bit: False'
                        per.optional_field_bit: '.0.. .... Optional Field Bit: False (iE-Extensions is NOT present)'
                        per.extension_present_bit: '0... .... Extension Present Bit: False'
                        ngap.uEAggregateMaximumBitRateDL: 'uEAggregateMaximumBitRateDL: 1073741824bits/s'
                        ngap.uEAggregateMaximumBitRateUL: 'uEAggregateMaximumBitRateUL: 1073741824bits/s'

end note

"10.0.2.15" -> "10.0.3.1": 2404, NGAP PDUSessionResourceSetup (29)

note right #c6ebc6
**10.0.2.15 to 10.0.3.1**
NGAP-PDU: 201d0024000003000a40020012005540020002004b40110000010d0003e00a00020f000000020001
ngap.procedureCode: 'procedureCode: id-PDUSessionResourceSetup (29)'
per.enum_index: 'Enumerated Index: 0'
ngap.criticality: 'criticality: reject (0)'
per.open_type_length: 'Open Type Length: 36'
ngap.value_element:
-   ngap.PDUSessionResourceSetupResponse_element:
        per.extension_bit: '0... .... Extension Bit: False'
        per.sequence_of_length: 'Sequence-Of Length: 3'
        ngap.protocolIEs:
            'Item 0: id-AMF-UE-NGAP-ID':
                ngap.id: 'id: id-AMF-UE-NGAP-ID (10)'
                per.enum_index: 'Enumerated Index: 1'
                ngap.criticality: 'criticality: ignore (1)'
                per.open_type_length: 'Open Type Length: 2'
                ngap.value_element:
                    ngap.AMF_UE_NGAP_ID: 'AMF-UE-NGAP-ID: 18'
            'Item 1: id-RAN-UE-NGAP-ID':
                ngap.id: 'id: id-RAN-UE-NGAP-ID (85)'
                per.enum_index: 'Enumerated Index: 1'
                ngap.criticality: 'criticality: ignore (1)'
                per.open_type_length: 'Open Type Length: 2'
                ngap.value_element:
                    ngap.RAN_UE_NGAP_ID: 'RAN-UE-NGAP-ID: 2'
            'Item 2: id-PDUSessionResourceSetupListSURes':
                ngap.id: 'id: id-PDUSessionResourceSetupListSURes (75)'
                per.enum_index: 'Enumerated Index: 1'
                ngap.criticality: 'criticality: ignore (1)'
                per.open_type_length: 'Open Type Length: 17'
                ngap.value_element:
                    per.sequence_of_length: 'Sequence-Of Length: 1'
                    ngap.PDUSessionResourceSetupListSURes:
                        Item 0:
                            ngap.PDUSessionResourceSetupItemSURes_element:
                                per.extension_bit: '0... .... Extension Bit: False'
                                per.optional_field_bit: '.0.. .... Optional Field Bit: False (iE-Extensions is NOT present)'
                                ngap.pDUSessionID: 'pDUSessionID: 1'
                                per.octet_string_length: 'Octet String Length: 13'
                                ngap.pDUSessionResourceSetupResponseTransfer:
                                    ngap.PDUSessionResourceSetupResponseTransfer_element:
                                        per.extension_bit: '0... .... Extension Bit: False'
                                        per.optional_field_bit: '.... 0... Optional Field Bit: False (iE-Extensions is NOT present)'
                                        ngap.dLQosFlowPerTNLInformation_element:
                                            per.extension_bit: '.... .0.. Extension Bit: False'
                                            per.optional_field_bit: '.... ..0. Optional Field Bit: False (iE-Extensions is NOT present)'
                                            per.choice_index: 'Choice Index: 0'
                                            ngap.uPTransportLayerInformation:
                                                ngap.gTPTunnel_element:
                                                    per.extension_bit: '0... .... Extension Bit: False'
                                                    per.optional_field_bit: '.0.. .... Optional Field Bit: False (iE-Extensions is NOT present)'
                                                    per.extension_present_bit: '..0. .... Extension Present Bit: False'
                                                    per.bit_string_length: 'Bit String Length: 32'
                                                    ngap.transportLayerAddress:
                                                        ngap.TransportLayerAddressIPv4: 'TransportLayerAddress (IPv4): 10.0.2.15'
                                                    ngap.gTP_TEID: 'gTP-TEID: 00000002'
                                            per.sequence_of_length: 'Sequence-Of Length: 1'
                                            ngap.associatedQosFlowList:
                                                Item 0:
                                                    ngap.AssociatedQosFlowItem_element:
                                                        per.extension_bit: '.... ..0. Extension Bit: False'
                                                        per.optional_field_bit: '0... .... Optional Field Bit: False (iE-Extensions is NOT present)'
                                                        per.extension_present_bit: '.0.. .... Extension Present Bit: False'
                                                        ngap.qosFlowIdentifier: 'qosFlowIdentifier: 1'

end note

"10.0.14.1" -> "10.0.17.1": 2408, PFCP req.\nPFCP Session Modification Request (52)

note right #80b3ff
**10.0.14.1 to 10.0.17.1**
pfcp.flags:
-   pfcp.version: '001. .... = Version: 1'
    pfcp.spare_b4: '...0 .... = Spare: 0'
    pfcp.spare_b3: '.... 0... = Spare: 0'
    pfcp.spare_b2: '.... .0.. = Spare: 0'
    pfcp.mp_flag: '.... ..0. = Message Priority (MP): False'
    pfcp.s: '.... ...1 = SEID (S): True'
pfcp.msg_type: 'Message Type: PFCP Session Modification Request (52)'
pfcp.length: 'Length: 61'
pfcp.seid: 'SEID: 0x000000000000000a'
pfcp.seqno: 'Sequence Number: 229'
pfcp.spare_oct: 'Spare: 0'
'Update FAR : [Grouped IE]':
-   pfcp.ie_type: 'IE Type: Update FAR (10)'
    pfcp.ie_len: 'IE Length: 45'
    'FAR ID : Dynamic by CP 1':
        pfcp.ie_type: 'IE Type: FAR ID (108)'
        pfcp.ie_len: 'IE Length: 4'
        pfcp.far_id_flg: '0... .... .... .... .... .... .... .... = Allocation type: Dynamic by CP'
        pfcp.far_id: '.000 0000 0000 0000 0000 0000 0000 0001 = FAR ID: 1'
    'Apply Action : ':
        pfcp.ie_type: 'IE Type: Apply Action (44)'
        pfcp.ie_len: 'IE Length: 2'
        pfcp.apply_action_flags:
            pfcp.spare_b7_b5: '000. .... = Spare: 0'
            pfcp.apply_action.dupl: '...0 .... = DUPL (Duplicate): False'
            pfcp.apply_action.nocp: '.... 0... = NOCP (Notify the CP function): False'
            pfcp.apply_action.buff: '.... .0.. = BUFF (Buffer): False'
            pfcp.apply_action.forw: '.... ..1. = FORW (Forward): True'
            pfcp.apply_action.drop: '.... ...0 = DROP (Drop): False'
        IE data not decoded by WS yet:
            _ws.expert:
                pfcp.ie_data_not_decoded: IE data not decoded by WS yet
                _ws.expert.message: 'Message: IE data not decoded by WS yet'
                _ws.expert.severity: 'Severity level: Note'
                _ws.expert.group: 'Group: Undecoded'
    'Update Forwarding Parameters : [Grouped IE]':
        pfcp.ie_type: 'IE Type: Update Forwarding Parameters (11)'
        pfcp.ie_len: 'IE Length: 27'
        'Destination Interface : Access':
            pfcp.ie_type: 'IE Type: Destination Interface (42)'
            pfcp.ie_len: 'IE Length: 1'
            pfcp.spare_h1: '0000 .... = Spare: 0'
            pfcp.dst_interface: '.... 0000 = Interface: Access (0)'
        'Network Instance : iot':
            pfcp.ie_type: 'IE Type: Network Instance (22)'
            pfcp.ie_len: 'IE Length: 4'
            pfcp.network_instance: 'Network Instance: iot'
        'Outer Header Creation : ':
            pfcp.ie_type: 'IE Type: Outer Header Creation (84)'
            pfcp.ie_len: 'IE Length: 10'
            pfcp.outer_hdr_desc: 'Outer Header Creation Description: GTP-U/UDP/IPv4  (256)'
            pfcp.outer_hdr_creation.teid: 'TEID: 0x00000002'
            pfcp.outer_hdr_creation.ipv4: 'IPv4 Address: 10.0.2.15'
pfcp.response_in: 'Response In: 2409'

end note

"10.0.17.1" -> "10.0.14.1": 2409, PFCP rsp.\nPFCP Session Modification Response (53)

note right #cce0ff
**10.0.17.1 to 10.0.14.1**
pfcp.flags:
-   pfcp.version: '001. .... = Version: 1'
    pfcp.spare_b4: '...0 .... = Spare: 0'
    pfcp.spare_b3: '.... 0... = Spare: 0'
    pfcp.spare_b2: '.... .0.. = Spare: 0'
    pfcp.mp_flag: '.... ..0. = Message Priority (MP): False'
    pfcp.s: '.... ...1 = SEID (S): True'
pfcp.msg_type: 'Message Type: PFCP Session Modification Response (53)'
pfcp.length: 'Length: 17'
pfcp.seid: 'SEID: 0x000000000000000a'
pfcp.seqno: 'Sequence Number: 229'
pfcp.spare_oct: 'Spare: 0'
'Cause : Request accepted(success)':
-   pfcp.ie_type: 'IE Type: Cause (19)'
    pfcp.ie_len: 'IE Length: 1'
    pfcp.cause: 'Cause: Request accepted(success) (1)'
pfcp.response_to: 'Response To: 2408'
pfcp.response_time: 'Response Time: 0.000112945 seconds'

end note

"10.0.2.15" -> "10.0.3.1": 2413, NGAP InitialUEMessage (15),\nNAS Registration request (0x41)

note right #8cd98c
**10.0.2.15 to 10.0.3.1**
NGAP-PDU: 000f40480000050055000200030026001a197e004179000d0109f1070000000000000000302e04f0f0f0f0007900135009f107000000010009f107000001e74c1dd2005a4001180070400100
ngap.procedureCode: 'procedureCode: id-InitialUEMessage (15)'
per.enum_index: 'Enumerated Index: 1'
ngap.criticality: 'criticality: ignore (1)'
per.open_type_length: 'Open Type Length: 72'
ngap.value_element:
-   ngap.InitialUEMessage_element:
        per.extension_bit: '0... .... Extension Bit: False'
        per.sequence_of_length: 'Sequence-Of Length: 5'
        ngap.protocolIEs:
            'Item 0: id-RAN-UE-NGAP-ID':
                ngap.id: 'id: id-RAN-UE-NGAP-ID (85)'
                per.enum_index: 'Enumerated Index: 0'
                ngap.criticality: 'criticality: reject (0)'
                per.open_type_length: 'Open Type Length: 2'
                ngap.value_element:
                    ngap.RAN_UE_NGAP_ID: 'RAN-UE-NGAP-ID: 3'
            'Item 1: id-NAS-PDU':
                ngap.id: 'id: id-NAS-PDU (38)'
                per.enum_index: 'Enumerated Index: 0'
                ngap.criticality: 'criticality: reject (0)'
                per.open_type_length: 'Open Type Length: 26'
                ngap.value_element:
                    per.octet_string_length: 'Octet String Length: 25'
                    ngap.NAS_PDU:
                        nas-5gs:
                            Plain NAS 5GS Message:
                                nas_5gs.epd: 'Extended protocol discriminator: 5G mobility management messages (126)'
                                nas_5gs.spare_half_octet: '0000 .... = Spare Half Octet: 0'
                                nas_5gs.security_header_type: '.... 0000 = Security header type: Plain NAS message, not security protected (0)'
                                nas_5gs.mm.message_type: 'Message type: Registration request (0x41)'
                                5GS registration type:
                                    nas_5gs.mm.for: '.... 1... = Follow-On Request bit (FOR): Follow-on request pending'
                                    nas_5gs.mm.5gs_reg_type: '.... .001 = 5GS registration type: initial registration (1)'
                                NAS key set identifier:
                                    nas_5gs.mm.tsc.h1: '0... .... = Type of security context flag (TSC): Native security context (for KSIAMF)'
                                    nas_5gs.mm.nas_key_set_id.h1: '.111 .... = NAS key set identifier: 7'
                                5GS mobile identity:
                                    gsm_a.len: 'Length: 13'
                                    nas_5gs.spare_b7: '0... .... = Spare: 0'
                                    nas_5gs.mm.suci.supi_fmt: '.000 .... = SUPI format: IMSI (0)'
                                    nas_5gs.spare_b3: '.... 0... = Spare: 0'
                                    nas_5gs.mm.type_id: '.... .001 = Type of identity: SUCI (1)'
                                    e212.mcc: 'Mobile Country Code (MCC): International Mobile, shared code (901)'
                                    e212.mnc: 'Mobile Network Code (MNC): Unknown (70)'
                                    nas_5gs.mm.suci.routing_indicator: 'Routing indicator: 0000'
                                    nas_5gs.mm.suci.scheme_id: '.... 0000 = Protection scheme Id: NULL scheme (0)'
                                    nas_5gs.mm.suci.pki: 'Home network public key identifier: 0'
                                    nas_5gs.mm.suci.supi_null_scheme: 'Scheme output: 0000000003'
                                UE security capability:
                                    nas_5gs.mm.elem_id: 'Element ID: 0x2e'
                                    gsm_a.len: 'Length: 4'
                                    nas_5gs.mm.5g_ea0: '1... .... = 5G-EA0: Supported'
                                    nas_5gs.mm.128_5g_ea1: '.1.. .... = 128-5G-EA1: Supported'
                                    nas_5gs.mm.128_5g_ea2: '..1. .... = 128-5G-EA2: Supported'
                                    nas_5gs.mm.128_5g_ea3: '...1 .... = 128-5G-EA3: Supported'
                                    nas_5gs.mm.5g_ea4: '.... 0... = 5G-EA4: Not supported'
                                    nas_5gs.mm.5g_ea5: '.... .0.. = 5G-EA5: Not supported'
                                    nas_5gs.mm.5g_ea6: '.... ..0. = 5G-EA6: Not supported'
                                    nas_5gs.mm.5g_ea7: '.... ...0 = 5G-EA7: Not supported'
                                    nas_5gs.mm.ia0: '1... .... = 5G-IA0: Supported'
                                    nas_5gs.mm.5g_128_ia1: '.1.. .... = 128-5G-IA1: Supported'
                                    nas_5gs.mm.5g_128_ia2: '..1. .... = 128-5G-IA2: Supported'
                                    nas_5gs.mm.5g_128_ia4: '.... 0... = 5G-IA4: Not supported'
                                    nas_5gs.mm.5g_ia5: '.... .0.. = 5G-IA5: Not supported'
                                    nas_5gs.mm.5g_ia6: '.... ..0. = 5G-IA6: Not supported'
                                    nas_5gs.mm.5g_ia7: '.... ...0 = 5G-IA7: Not supported'
                                    nas_5gs.mm.eea0: '1... .... = EEA0: Supported'
                                    nas_5gs.mm.128eea1: '.1.. .... = 128-EEA1: Supported'
                                    nas_5gs.mm.128eea2: '..1. .... = 128-EEA2: Supported'
                                    nas_5gs.mm.eea3: '...1 .... = 128-EEA3: Supported'
                                    nas_5gs.mm.eea4: '.... 0... = EEA4: Not supported'
                                    nas_5gs.mm.eea5: '.... .0.. = EEA5: Not supported'
                                    nas_5gs.mm.eea6: '.... ..0. = EEA6: Not supported'
                                    nas_5gs.mm.eea7: '.... ...0 = EEA7: Not supported'
                                    nas_5gs.mm.eia0: '1... .... = EIA0: Supported'
                                    nas_5gs.mm.128eia1: '.1.. .... = 128-EIA1: Supported'
                                    nas_5gs.mm.128eia2: '..1. .... = 128-EIA2: Supported'
                                    nas_5gs.mm.eia3: '...1 .... = 128-EIA3: Supported'
                                    nas_5gs.mm.eia4: '.... 0... = EIA4: Not supported'
                                    nas_5gs.mm.eia5: '.... .0.. = EIA5: Not supported'
                                    nas_5gs.mm.eia6: '.... ..0. = EIA6: Not supported'
                                    nas_5gs.mm.eia7: '.... ...0 = EIA7: Not supported'
            'Item 2: id-UserLocationInformation':
                ngap.id: 'id: id-UserLocationInformation (121)'
                per.enum_index: 'Enumerated Index: 0'
                ngap.criticality: 'criticality: reject (0)'
                per.open_type_length: 'Open Type Length: 19'
                ngap.value_element:
                    per.choice_index: 'Choice Index: 1'
                    ngap.UserLocationInformation:
                        ngap.userLocationInformationNR_element:
                            per.extension_bit: '..0. .... Extension Bit: False'
                            per.optional_field_bit: '.... 0... Optional Field Bit: False (iE-Extensions is NOT present)'
                            ngap.nR_CGI_element:
                                per.extension_bit: '.... .0.. Extension Bit: False'
                                per.optional_field_bit: '.... ..0. Optional Field Bit: False (iE-Extensions is NOT present)'
                                ngap.pLMNIdentity:
                                    e212.mcc: 'Mobile Country Code (MCC): International Mobile, shared code (901)'
                                    e212.mnc: 'Mobile Network Code (MNC): Unknown (70)'
                                ngap.NRCellIdentity: 'nRCellIdentity: 0x0000000010'
                            ngap.tAI_element:
                                per.extension_bit: '.... 0... Extension Bit: False'
                                per.optional_field_bit: '.... .0.. Optional Field Bit: False (iE-Extensions is NOT present)'
                                ngap.pLMNIdentity:
                                    e212.mcc: 'Mobile Country Code (MCC): International Mobile, shared code (901)'
                                    e212.mnc: 'Mobile Network Code (MNC): Unknown (70)'
                                ngap.tAC: 'tAC: 1 (0x000001)'
                            ngap.timeStamp: 'timeStamp: e74c1dd2 (Dec 20, 2022 11:41:06 UTC)'
            'Item 3: id-RRCEstablishmentCause':
                ngap.id: 'id: id-RRCEstablishmentCause (90)'
                per.enum_index: 'Enumerated Index: 1'
                ngap.criticality: 'criticality: ignore (1)'
                per.open_type_length: 'Open Type Length: 1'
                ngap.value_element:
                    per.extension_present_bit: '0... .... Extension Present Bit: False'
                    per.enum_index: 'Enumerated Index: 3'
                    ngap.RRCEstablishmentCause: 'RRCEstablishmentCause: mo-Signalling (3)'
            'Item 4: id-UEContextRequest':
                ngap.id: 'id: id-UEContextRequest (112)'
                per.enum_index: 'Enumerated Index: 1'
                ngap.criticality: 'criticality: ignore (1)'
                per.open_type_length: 'Open Type Length: 1'
                ngap.value_element:
                    per.extension_present_bit: '0... .... Extension Present Bit: False'
                    per.enum_index: 'Enumerated Index: 0'
                    ngap.UEContextRequest: 'UEContextRequest: requested (0)'

end note

"10.0.14.1" -> "10.0.17.1": 2425, PFCP req.\nPFCP Session Deletion Request (54)

note right #80b3ff
**10.0.14.1 to 10.0.17.1**
pfcp.flags:
-   pfcp.version: '001. .... = Version: 1'
    pfcp.spare_b4: '...0 .... = Spare: 0'
    pfcp.spare_b3: '.... 0... = Spare: 0'
    pfcp.spare_b2: '.... .0.. = Spare: 0'
    pfcp.mp_flag: '.... ..0. = Message Priority (MP): False'
    pfcp.s: '.... ...1 = SEID (S): True'
pfcp.msg_type: 'Message Type: PFCP Session Deletion Request (54)'
pfcp.length: 'Length: 12'
pfcp.seid: 'SEID: 0x0000000000000007'
pfcp.seqno: 'Sequence Number: 230'
pfcp.spare_oct: 'Spare: 0'
pfcp.response_in: 'Response In: 2426'

end note

"10.0.17.1" -> "10.0.14.1": 2426, PFCP rsp.\nPFCP Session Deletion Response (55)

note right #cce0ff
**10.0.17.1 to 10.0.14.1**
pfcp.flags:
-   pfcp.version: '001. .... = Version: 1'
    pfcp.spare_b4: '...0 .... = Spare: 0'
    pfcp.spare_b3: '.... 0... = Spare: 0'
    pfcp.spare_b2: '.... .0.. = Spare: 0'
    pfcp.mp_flag: '.... ..0. = Message Priority (MP): False'
    pfcp.s: '.... ...1 = SEID (S): True'
pfcp.msg_type: 'Message Type: PFCP Session Deletion Response (55)'
pfcp.length: 'Length: 129'
pfcp.seid: 'SEID: 0x0000000000000007'
pfcp.seqno: 'Sequence Number: 230'
pfcp.spare_oct: 'Spare: 0'
'Cause : Request accepted(success)':
-   pfcp.ie_type: 'IE Type: Cause (19)'
    pfcp.ie_len: 'IE Length: 1'
    pfcp.cause: 'Cause: Request accepted(success) (1)'
'Usage Report (Session Deletion Response) : [Grouped IE]':
-   pfcp.ie_type: 'IE Type: Usage Report (Session Deletion Response) (79)'
    pfcp.ie_len: 'IE Length: 108'
    'URR ID : Dynamic by CP 1':
        pfcp.ie_type: 'IE Type: URR ID (81)'
        pfcp.ie_len: 'IE Length: 4'
        pfcp.urr_id_flg: '0... .... .... .... .... .... .... .... = Allocation type: Dynamic by CP'
        pfcp.urr_id: '.000 0000 0000 0000 0000 0000 0000 0001 = URR ID: 1'
    'UR-SEQN : 0':
        pfcp.ie_type: 'IE Type: UR-SEQN (104)'
        pfcp.ie_len: 'IE Length: 4'
        pfcp.ur_seqn: 'UR-SEQN: 0'
    'Usage Report Trigger : ':
        pfcp.ie_type: 'IE Type: Usage Report Trigger (63)'
        pfcp.ie_len: 'IE Length: 3'
        pfcp.usage_report_trigger.immer: '0... .... = IMMER (Immediate Report): False'
        pfcp.usage_report_trigger_flags.droth: '.0.. .... = DROTH (Dropped DL Traffic Threshold): False'
        pfcp.usage_report_trigger_flags.stopt: '..0. .... = STOPT (Stop of Traffic): False'
        pfcp.usage_report_trigger_flags.start: '...0 .... = START (Start of Traffic): False'
        pfcp.usage_report_trigger_flags.quhti: '.... 0... = QUHTI (Quota Holding Time): False'
        pfcp.usage_report_trigger_flags.timth: '.... .0.. = TIMTH (Time Threshold): False'
        pfcp.usage_report_trigger_flags.volth: '.... ..0. = VOLTH (Volume Threshold): False'
        pfcp.usage_report_trigger_flags.perio: '.... ...0 = PERIO (Periodic Reporting): False'
        pfcp.usage_report_trigger_flags.eveth: '0... .... = EVETH (Event Threshold): False'
        pfcp.usage_report_trigger_flags.macar: '.0.. .... = MACAR (MAC Addresses Reporting): False'
        pfcp.usage_report_trigger_flags.envcl: '..0. .... = ENVCL (Envelope Closure): False'
        pfcp.usage_report_trigger.monit: '...0 .... = MONIT (Monitoring Time): False'
        pfcp.usage_report_trigger.term: '.... 1... = TERMR (Termination Report): True'
        pfcp.usage_report_trigger_flags.liusa: '.... .0.. = LIUSA (Linked Usage Reporting): False'
        pfcp.usage_report_trigger_flags.timqu: '.... ..0. = TIMQU (Time Quota): False'
        pfcp.usage_report_trigger_flags.volqu: '.... ...0 = VOLQU (Volume Quota): False'
        pfcp.spare_b7_b2: '0000 00.. = Spare: 0'
        pfcp.usage_report_trigger_flags.tebur: '.... ..0. = TEMUR (Termination By UP function Report): False'
        pfcp.usage_report_trigger_flags.evequ: '.... ...0 = EVEQU (Event Quota): False'
    'End Time : Dec 29, 2022 16:07:11.000000000 UTC':
        pfcp.ie_type: 'IE Type: End Time (76)'
        pfcp.ie_len: 'IE Length: 4'
        pfcp.start_time: 'End Time: Dec 29, 2022 16:07:11.000000000 UTC'
    'Volume Measurement : ':
        pfcp.ie_type: 'IE Type: Volume Measurement (66)'
        pfcp.ie_len: 'IE Length: 49'
        pfcp.volume_measurement:
            pfcp.spare_b7_b3: '0011 1... = Spare: 7'
            pfcp.volume_measurement_flags.dlvol: '.... .1.. = DLVOL: True'
            pfcp.volume_measurement_flags.ulvol: '.... ..1. = ULVOL: True'
            pfcp.volume_measurement_flags.tovol: '.... ...1 = TOVOL: True'
        pfcp.volume_measurement.tovol: 'Total Volume: 0'
        pfcp.volume_measurement.ulvol: 'Uplink Volume: 0'
        pfcp.volume_measurement.dlvol: 'Downlink Volume: 0'
        IE data not decoded by WS yet:
            _ws.expert:
                pfcp.ie_data_not_decoded: IE data not decoded by WS yet
                _ws.expert.message: 'Message: IE data not decoded by WS yet'
                _ws.expert.severity: 'Severity level: Note'
                _ws.expert.group: 'Group: Undecoded'
    'Duration Measurement : 1672330032 s':
        pfcp.ie_type: 'IE Type: Duration Measurement (67)'
        pfcp.ie_len: 'IE Length: 4'
        pfcp.duration_measurement: 'Duration: 1672330032'
    'Time of First Packet : NULL':
        pfcp.ie_type: 'IE Type: Time of First Packet (69)'
        pfcp.ie_len: 'IE Length: 4'
        pfcp.time_of_first_packet: 'Time of First Packet: NULL'
    'Time of Last Packet : NULL':
        pfcp.ie_type: 'IE Type: Time of Last Packet (70)'
        pfcp.ie_len: 'IE Length: 4'
        pfcp.time_of_last_packet: 'Time of Last Packet: NULL'
pfcp.response_to: 'Response To: 2425'
pfcp.response_time: 'Response Time: 0.000129965 seconds'

end note

"10.0.3.1" -> "10.0.2.15": 2448, NGAP DownlinkNASTransport (4),\nNAS Authentication request (0x56)

note right #8cd98c
**10.0.3.1 to 10.0.2.15**
NGAP-PDU: 0004403e000003000a000200130055000200030026002b2a7e00560202000021076d1db9a8c604a7676b00c9ea159f5420107b852b042e2e8000a832e77ef119464e
ngap.procedureCode: 'procedureCode: id-DownlinkNASTransport (4)'
per.enum_index: 'Enumerated Index: 1'
ngap.criticality: 'criticality: ignore (1)'
per.open_type_length: 'Open Type Length: 62'
ngap.value_element:
-   ngap.DownlinkNASTransport_element:
        per.extension_bit: '0... .... Extension Bit: False'
        per.sequence_of_length: 'Sequence-Of Length: 3'
        ngap.protocolIEs:
            'Item 0: id-AMF-UE-NGAP-ID':
                ngap.id: 'id: id-AMF-UE-NGAP-ID (10)'
                per.enum_index: 'Enumerated Index: 0'
                ngap.criticality: 'criticality: reject (0)'
                per.open_type_length: 'Open Type Length: 2'
                ngap.value_element:
                    ngap.AMF_UE_NGAP_ID: 'AMF-UE-NGAP-ID: 19'
            'Item 1: id-RAN-UE-NGAP-ID':
                ngap.id: 'id: id-RAN-UE-NGAP-ID (85)'
                per.enum_index: 'Enumerated Index: 0'
                ngap.criticality: 'criticality: reject (0)'
                per.open_type_length: 'Open Type Length: 2'
                ngap.value_element:
                    ngap.RAN_UE_NGAP_ID: 'RAN-UE-NGAP-ID: 3'
            'Item 2: id-NAS-PDU':
                ngap.id: 'id: id-NAS-PDU (38)'
                per.enum_index: 'Enumerated Index: 0'
                ngap.criticality: 'criticality: reject (0)'
                per.open_type_length: 'Open Type Length: 43'
                ngap.value_element:
                    per.octet_string_length: 'Octet String Length: 42'
                    ngap.NAS_PDU:
                        nas-5gs:
                            Plain NAS 5GS Message:
                                nas_5gs.epd: 'Extended protocol discriminator: 5G mobility management messages (126)'
                                nas_5gs.spare_half_octet: '0000 .... = Spare Half Octet: 0'
                                nas_5gs.security_header_type: '.... 0000 = Security header type: Plain NAS message, not security protected (0)'
                                nas_5gs.mm.message_type: 'Message type: Authentication request (0x56)'
                                NAS key set identifier - ngKSI:
                                    nas_5gs.mm.tsc: '.... 0... = Type of security context flag (TSC): Native security context (for KSIAMF)'
                                    nas_5gs.mm.nas_key_set_id: '.... .010 = NAS key set identifier: 2'
                                ABBA:
                                    gsm_a.len: 'Length: 2'
                                    nas_5gs.mm.abba_contents: 'ABBA Contents: 0x0000'
                                Authentication Parameter RAND - 5G authentication challenge:
                                    gsm_a.dtap.elem_id: 'Element ID: 0x21'
                                    gsm_a.dtap.rand: 'RAND value: 076d1db9a8c604a7676b00c9ea159f54'
                                Authentication Parameter AUTN (UMTS and EPS authentication challenge) - 5G authentication challenge:
                                    gsm_a.dtap.elem_id: 'Element ID: 0x20'
                                    gsm_a.len: 'Length: 16'
                                    gsm_a.dtap.autn:
                                        gsm_a.dtap.autn.sqn_xor_ak: 'SQN xor AK: 7b852b042e2e'
                                        gsm_a.dtap.autn.amf: 'AMF: 8000'
                                        gsm_a.dtap.autn.mac: 'MAC: a832e77ef119464e'

end note

"10.0.2.15" -> "10.0.3.1": 2449, NGAP UplinkNASTransport (46),\nNAS Authentication response (0x57)

note right #c6ebc6
**10.0.2.15 to 10.0.3.1**
NGAP-PDU: 002e4040000004000a0002001300550002000300260016157e00572d102ab7bb8255dc0d6ed6f51f51fe03cfe7007940135009f107000000010009f107000001e74c1dd2
ngap.procedureCode: 'procedureCode: id-UplinkNASTransport (46)'
per.enum_index: 'Enumerated Index: 1'
ngap.criticality: 'criticality: ignore (1)'
per.open_type_length: 'Open Type Length: 64'
ngap.value_element:
-   ngap.UplinkNASTransport_element:
        per.extension_bit: '0... .... Extension Bit: False'
        per.sequence_of_length: 'Sequence-Of Length: 4'
        ngap.protocolIEs:
            'Item 0: id-AMF-UE-NGAP-ID':
                ngap.id: 'id: id-AMF-UE-NGAP-ID (10)'
                per.enum_index: 'Enumerated Index: 0'
                ngap.criticality: 'criticality: reject (0)'
                per.open_type_length: 'Open Type Length: 2'
                ngap.value_element:
                    ngap.AMF_UE_NGAP_ID: 'AMF-UE-NGAP-ID: 19'
            'Item 1: id-RAN-UE-NGAP-ID':
                ngap.id: 'id: id-RAN-UE-NGAP-ID (85)'
                per.enum_index: 'Enumerated Index: 0'
                ngap.criticality: 'criticality: reject (0)'
                per.open_type_length: 'Open Type Length: 2'
                ngap.value_element:
                    ngap.RAN_UE_NGAP_ID: 'RAN-UE-NGAP-ID: 3'
            'Item 2: id-NAS-PDU':
                ngap.id: 'id: id-NAS-PDU (38)'
                per.enum_index: 'Enumerated Index: 0'
                ngap.criticality: 'criticality: reject (0)'
                per.open_type_length: 'Open Type Length: 22'
                ngap.value_element:
                    per.octet_string_length: 'Octet String Length: 21'
                    ngap.NAS_PDU:
                        nas-5gs:
                            Plain NAS 5GS Message:
                                nas_5gs.epd: 'Extended protocol discriminator: 5G mobility management messages (126)'
                                nas_5gs.spare_half_octet: '0000 .... = Spare Half Octet: 0'
                                nas_5gs.security_header_type: '.... 0000 = Security header type: Plain NAS message, not security protected (0)'
                                nas_5gs.mm.message_type: 'Message type: Authentication response (0x57)'
                                Authentication response parameter:
                                    nas_eps.emm.elem_id: 'Element ID: 0x2d'
                                    gsm_a.len: 'Length: 16'
                                    nas_eps.emm.res: 'RES: 2ab7bb8255dc0d6ed6f51f51fe03cfe7'
            'Item 3: id-UserLocationInformation':
                ngap.id: 'id: id-UserLocationInformation (121)'
                per.enum_index: 'Enumerated Index: 1'
                ngap.criticality: 'criticality: ignore (1)'
                per.open_type_length: 'Open Type Length: 19'
                ngap.value_element:
                    per.choice_index: 'Choice Index: 1'
                    ngap.UserLocationInformation:
                        ngap.userLocationInformationNR_element:
                            per.extension_bit: '..0. .... Extension Bit: False'
                            per.optional_field_bit: '.... 0... Optional Field Bit: False (iE-Extensions is NOT present)'
                            ngap.nR_CGI_element:
                                per.extension_bit: '.... .0.. Extension Bit: False'
                                per.optional_field_bit: '.... ..0. Optional Field Bit: False (iE-Extensions is NOT present)'
                                ngap.pLMNIdentity:
                                    e212.mcc: 'Mobile Country Code (MCC): International Mobile, shared code (901)'
                                    e212.mnc: 'Mobile Network Code (MNC): Unknown (70)'
                                ngap.NRCellIdentity: 'nRCellIdentity: 0x0000000010'
                            ngap.tAI_element:
                                per.extension_bit: '.... 0... Extension Bit: False'
                                per.optional_field_bit: '.... .0.. Optional Field Bit: False (iE-Extensions is NOT present)'
                                ngap.pLMNIdentity:
                                    e212.mcc: 'Mobile Country Code (MCC): International Mobile, shared code (901)'
                                    e212.mnc: 'Mobile Network Code (MNC): Unknown (70)'
                                ngap.tAC: 'tAC: 1 (0x000001)'
                            ngap.timeStamp: 'timeStamp: e74c1dd2 (Dec 20, 2022 11:41:06 UTC)'

end note

"10.0.3.1" -> "10.0.2.15": 2472, NGAP DownlinkNASTransport (4),\nNAS Security mode command (0x5d)

note right #c6ebc6
**10.0.3.1 to 10.0.2.15**
NGAP-PDU: 00044029000003000a0002001300550002000300260016157e034e0d0550007e005d020204f0f0f0f0e1360102
ngap.procedureCode: 'procedureCode: id-DownlinkNASTransport (4)'
per.enum_index: 'Enumerated Index: 1'
ngap.criticality: 'criticality: ignore (1)'
per.open_type_length: 'Open Type Length: 41'
ngap.value_element:
-   ngap.DownlinkNASTransport_element:
        per.extension_bit: '0... .... Extension Bit: False'
        per.sequence_of_length: 'Sequence-Of Length: 3'
        ngap.protocolIEs:
            'Item 0: id-AMF-UE-NGAP-ID':
                ngap.id: 'id: id-AMF-UE-NGAP-ID (10)'
                per.enum_index: 'Enumerated Index: 0'
                ngap.criticality: 'criticality: reject (0)'
                per.open_type_length: 'Open Type Length: 2'
                ngap.value_element:
                    ngap.AMF_UE_NGAP_ID: 'AMF-UE-NGAP-ID: 19'
            'Item 1: id-RAN-UE-NGAP-ID':
                ngap.id: 'id: id-RAN-UE-NGAP-ID (85)'
                per.enum_index: 'Enumerated Index: 0'
                ngap.criticality: 'criticality: reject (0)'
                per.open_type_length: 'Open Type Length: 2'
                ngap.value_element:
                    ngap.RAN_UE_NGAP_ID: 'RAN-UE-NGAP-ID: 3'
            'Item 2: id-NAS-PDU':
                ngap.id: 'id: id-NAS-PDU (38)'
                per.enum_index: 'Enumerated Index: 0'
                ngap.criticality: 'criticality: reject (0)'
                per.open_type_length: 'Open Type Length: 22'
                ngap.value_element:
                    per.octet_string_length: 'Octet String Length: 21'
                    ngap.NAS_PDU:
                        nas-5gs:
                            Security protected NAS 5GS message:
                                nas_5gs.epd: 'Extended protocol discriminator: 5G mobility management messages (126)'
                                nas_5gs.spare_half_octet: '0000 .... = Spare Half Octet: 0'
                                nas_5gs.security_header_type: '.... 0011 = Security header type: Integrity protected with new 5GS security context (3)'
                                nas_5gs.msg_auth_code: 'Message authentication code: 0x4e0d0550'
                                nas_5gs.seq_no: 'Sequence number: 0'
                            Plain NAS 5GS Message:
                                nas_5gs.epd: 'Extended protocol discriminator: 5G mobility management messages (126)'
                                nas_5gs.spare_half_octet: '0000 .... = Spare Half Octet: 0'
                                nas_5gs.security_header_type: '.... 0000 = Security header type: Plain NAS message, not security protected (0)'
                                nas_5gs.mm.message_type: 'Message type: Security mode command (0x5d)'
                                NAS security algorithms:
                                    nas_5gs.mm.nas_sec_algo_enc: '0000 .... = Type of ciphering algorithm: 5G-EA0 (null ciphering algorithm) (0)'
                                    nas_5gs.mm.nas_sec_algo_ip: '.... 0010 = Type of integrity protection algorithm: 128-5G-IA2 (2)'
                                NAS key set identifier - ngKSI:
                                    nas_5gs.mm.tsc: '.... 0... = Type of security context flag (TSC): Native security context (for KSIAMF)'
                                    nas_5gs.mm.nas_key_set_id: '.... .010 = NAS key set identifier: 2'
                                UE security capability - Replayed UE security capabilities:
                                    gsm_a.len: 'Length: 4'
                                    nas_5gs.mm.5g_ea0: '1... .... = 5G-EA0: Supported'
                                    nas_5gs.mm.128_5g_ea1: '.1.. .... = 128-5G-EA1: Supported'
                                    nas_5gs.mm.128_5g_ea2: '..1. .... = 128-5G-EA2: Supported'
                                    nas_5gs.mm.128_5g_ea3: '...1 .... = 128-5G-EA3: Supported'
                                    nas_5gs.mm.5g_ea4: '.... 0... = 5G-EA4: Not supported'
                                    nas_5gs.mm.5g_ea5: '.... .0.. = 5G-EA5: Not supported'
                                    nas_5gs.mm.5g_ea6: '.... ..0. = 5G-EA6: Not supported'
                                    nas_5gs.mm.5g_ea7: '.... ...0 = 5G-EA7: Not supported'
                                    nas_5gs.mm.ia0: '1... .... = 5G-IA0: Supported'
                                    nas_5gs.mm.5g_128_ia1: '.1.. .... = 128-5G-IA1: Supported'
                                    nas_5gs.mm.5g_128_ia2: '..1. .... = 128-5G-IA2: Supported'
                                    nas_5gs.mm.5g_128_ia4: '.... 0... = 5G-IA4: Not supported'
                                    nas_5gs.mm.5g_ia5: '.... .0.. = 5G-IA5: Not supported'
                                    nas_5gs.mm.5g_ia6: '.... ..0. = 5G-IA6: Not supported'
                                    nas_5gs.mm.5g_ia7: '.... ...0 = 5G-IA7: Not supported'
                                    nas_5gs.mm.eea0: '1... .... = EEA0: Supported'
                                    nas_5gs.mm.128eea1: '.1.. .... = 128-EEA1: Supported'
                                    nas_5gs.mm.128eea2: '..1. .... = 128-EEA2: Supported'
                                    nas_5gs.mm.eea3: '...1 .... = 128-EEA3: Supported'
                                    nas_5gs.mm.eea4: '.... 0... = EEA4: Not supported'
                                    nas_5gs.mm.eea5: '.... .0.. = EEA5: Not supported'
                                    nas_5gs.mm.eea6: '.... ..0. = EEA6: Not supported'
                                    nas_5gs.mm.eea7: '.... ...0 = EEA7: Not supported'
                                    nas_5gs.mm.eia0: '1... .... = EIA0: Supported'
                                    nas_5gs.mm.128eia1: '.1.. .... = 128-EIA1: Supported'
                                    nas_5gs.mm.128eia2: '..1. .... = 128-EIA2: Supported'
                                    nas_5gs.mm.eia3: '...1 .... = 128-EIA3: Supported'
                                    nas_5gs.mm.eia4: '.... 0... = EIA4: Not supported'
                                    nas_5gs.mm.eia5: '.... .0.. = EIA5: Not supported'
                                    nas_5gs.mm.eia6: '.... ..0. = EIA6: Not supported'
                                    nas_5gs.mm.eia7: '.... ...0 = EIA7: Not supported'
                                IMEISV request:
                                    gsm_a.common.elem_id: '1110 .... = Element ID: 0xe-'
                                    nas_eps.spare_bits: '.... 0... = Spare bit(s): 0x00'
                                    nas_eps.emm.imeisv_req: '.... .001 = IMEISV request: IMEISV requested (1)'
                                Additional 5G security information:
                                    nas_5gs.mm.elem_id: 'Element ID: 0x36'
                                    gsm_a.len: 'Length: 1'
                                    nas_5gs.spare_b3: '.... 0... = Spare: 0'
                                    nas_5gs.spare_b2: '.... .0.. = Spare: 0'
                                    nas_5gs.mm.rinmr: '.... ..1. = Retransmission of initial NAS message request(RINMR): Requested'
                                    nas_5gs.mm.hdp: '.... ...0 = Horizontal derivation parameter (HDP): Not required'

end note

"10.0.2.15" -> "10.0.3.1": 2473, NGAP UplinkNASTransport (46),\nNAS Security mode complete (0x5e),\nNAS Registration request (0x41)

note right #8cd98c
**10.0.2.15 to 10.0.3.1**
NGAP-PDU: 002e4067000004000a000200130055000200030026003d3c7e04249ca1cb007e005e7700094573806121856151f17100237e004179000d0109f1070000000000000000301001002e04f0f0f0f02f020101530100007940135009f107000000010009f107000001e74c1dd2
ngap.procedureCode: 'procedureCode: id-UplinkNASTransport (46)'
per.enum_index: 'Enumerated Index: 1'
ngap.criticality: 'criticality: ignore (1)'
per.open_type_length: 'Open Type Length: 103'
ngap.value_element:
-   ngap.UplinkNASTransport_element:
        per.extension_bit: '0... .... Extension Bit: False'
        per.sequence_of_length: 'Sequence-Of Length: 4'
        ngap.protocolIEs:
            'Item 0: id-AMF-UE-NGAP-ID':
                ngap.id: 'id: id-AMF-UE-NGAP-ID (10)'
                per.enum_index: 'Enumerated Index: 0'
                ngap.criticality: 'criticality: reject (0)'
                per.open_type_length: 'Open Type Length: 2'
                ngap.value_element:
                    ngap.AMF_UE_NGAP_ID: 'AMF-UE-NGAP-ID: 19'
            'Item 1: id-RAN-UE-NGAP-ID':
                ngap.id: 'id: id-RAN-UE-NGAP-ID (85)'
                per.enum_index: 'Enumerated Index: 0'
                ngap.criticality: 'criticality: reject (0)'
                per.open_type_length: 'Open Type Length: 2'
                ngap.value_element:
                    ngap.RAN_UE_NGAP_ID: 'RAN-UE-NGAP-ID: 3'
            'Item 2: id-NAS-PDU':
                ngap.id: 'id: id-NAS-PDU (38)'
                per.enum_index: 'Enumerated Index: 0'
                ngap.criticality: 'criticality: reject (0)'
                per.open_type_length: 'Open Type Length: 61'
                ngap.value_element:
                    per.octet_string_length: 'Octet String Length: 60'
                    ngap.NAS_PDU:
                        nas-5gs:
                            Security protected NAS 5GS message:
                                nas_5gs.epd: 'Extended protocol discriminator: 5G mobility management messages (126)'
                                nas_5gs.spare_half_octet: '0000 .... = Spare Half Octet: 0'
                                nas_5gs.security_header_type: '.... 0100 = Security header type: Integrity protected and ciphered with new 5GS security context (4)'
                                nas_5gs.msg_auth_code: 'Message authentication code: 0x249ca1cb'
                                nas_5gs.seq_no: 'Sequence number: 0'
                            Plain NAS 5GS Message:
                                nas_5gs.epd: 'Extended protocol discriminator: 5G mobility management messages (126)'
                                nas_5gs.spare_half_octet: '0000 .... = Spare Half Octet: 0'
                                nas_5gs.security_header_type: '.... 0000 = Security header type: Plain NAS message, not security protected (0)'
                                nas_5gs.mm.message_type: 'Message type: Security mode complete (0x5e)'
                                5GS mobile identity:
                                    nas_5gs.mm.elem_id: 'Element ID: 0x77'
                                    gsm_a.len: 'Length: 9'
                                    nas_5gs.mm.odd_even: '.... 0... = Odd/even indication: Even number of identity digits'
                                    nas_5gs.mm.type_id: '.... .101 = Type of identity: IMEISV (5)'
                                    nas_5gs.mm.imeisv: 'IMEISV: 4370816125816151'
                                NAS message container:
                                    nas_5gs.mm.elem_id: 'Element ID: 0x71'
                                    gsm_a.len: 'Length: 35'
                                    nas-5gs:
                                        Plain NAS 5GS Message:
                                            nas_5gs.epd: 'Extended protocol discriminator: 5G mobility management messages (126)'
                                            nas_5gs.spare_half_octet: '0000 .... = Spare Half Octet: 0'
                                            nas_5gs.security_header_type: '.... 0000 = Security header type: Plain NAS message, not security protected (0)'
                                            nas_5gs.mm.message_type: 'Message type: Registration request (0x41)'
                                            5GS registration type:
                                                nas_5gs.mm.for: '.... 1... = Follow-On Request bit (FOR): Follow-on request pending'
                                                nas_5gs.mm.5gs_reg_type: '.... .001 = 5GS registration type: initial registration (1)'
                                            NAS key set identifier:
                                                nas_5gs.mm.tsc.h1: '0... .... = Type of security context flag (TSC): Native security context (for KSIAMF)'
                                                nas_5gs.mm.nas_key_set_id.h1: '.111 .... = NAS key set identifier: 7'
                                            5GS mobile identity:
                                                gsm_a.len: 'Length: 13'
                                                nas_5gs.spare_b7: '0... .... = Spare: 0'
                                                nas_5gs.mm.suci.supi_fmt: '.000 .... = SUPI format: IMSI (0)'
                                                nas_5gs.spare_b3: '.... 0... = Spare: 0'
                                                nas_5gs.mm.type_id: '.... .001 = Type of identity: SUCI (1)'
                                                e212.mcc: 'Mobile Country Code (MCC): International Mobile, shared code (901)'
                                                e212.mnc: 'Mobile Network Code (MNC): Unknown (70)'
                                                nas_5gs.mm.suci.routing_indicator: 'Routing indicator: 0000'
                                                nas_5gs.mm.suci.scheme_id: '.... 0000 = Protection scheme Id: NULL scheme (0)'
                                                nas_5gs.mm.suci.pki: 'Home network public key identifier: 0'
                                                nas_5gs.mm.suci.supi_null_scheme: 'Scheme output: 0000000003'
                                            5GMM capability:
                                                nas_5gs.mm.elem_id: 'Element ID: 0x10'
                                                gsm_a.len: 'Length: 1'
                                                nas_5gs.spare_b7: '0... .... = Spare: 0'
                                                nas_5gs.spare_b6: '.0.. .... = Spare: 0'
                                                nas_5gs.spare_b5: '..0. .... = Spare: 0'
                                                nas_5gs.spare_b4: '...0 .... = Spare: 0'
                                                nas_5gs.spare_b3: '.... 0... = Spare: 0'
                                                nas_5gs.mm.lpp_cap_b2: '.... .0.. = LTE Positioning Protocol (LPP) capability: Not Requested'
                                                nas_5gs.mm.ho_attach_b1: '.... ..0. = HO attach: Not supported'
                                                nas_5gs.mm.s1_mode_b0: '.... ...0 = S1 mode: Not Requested'
                                            UE security capability:
                                                nas_5gs.mm.elem_id: 'Element ID: 0x2e'
                                                gsm_a.len: 'Length: 4'
                                                nas_5gs.mm.5g_ea0: '1... .... = 5G-EA0: Supported'
                                                nas_5gs.mm.128_5g_ea1: '.1.. .... = 128-5G-EA1: Supported'
                                                nas_5gs.mm.128_5g_ea2: '..1. .... = 128-5G-EA2: Supported'
                                                nas_5gs.mm.128_5g_ea3: '...1 .... = 128-5G-EA3: Supported'
                                                nas_5gs.mm.5g_ea4: '.... 0... = 5G-EA4: Not supported'
                                                nas_5gs.mm.5g_ea5: '.... .0.. = 5G-EA5: Not supported'
                                                nas_5gs.mm.5g_ea6: '.... ..0. = 5G-EA6: Not supported'
                                                nas_5gs.mm.5g_ea7: '.... ...0 = 5G-EA7: Not supported'
                                                nas_5gs.mm.ia0: '1... .... = 5G-IA0: Supported'
                                                nas_5gs.mm.5g_128_ia1: '.1.. .... = 128-5G-IA1: Supported'
                                                nas_5gs.mm.5g_128_ia2: '..1. .... = 128-5G-IA2: Supported'
                                                nas_5gs.mm.5g_128_ia4: '.... 0... = 5G-IA4: Not supported'
                                                nas_5gs.mm.5g_ia5: '.... .0.. = 5G-IA5: Not supported'
                                                nas_5gs.mm.5g_ia6: '.... ..0. = 5G-IA6: Not supported'
                                                nas_5gs.mm.5g_ia7: '.... ...0 = 5G-IA7: Not supported'
                                                nas_5gs.mm.eea0: '1... .... = EEA0: Supported'
                                                nas_5gs.mm.128eea1: '.1.. .... = 128-EEA1: Supported'
                                                nas_5gs.mm.128eea2: '..1. .... = 128-EEA2: Supported'
                                                nas_5gs.mm.eea3: '...1 .... = 128-EEA3: Supported'
                                                nas_5gs.mm.eea4: '.... 0... = EEA4: Not supported'
                                                nas_5gs.mm.eea5: '.... .0.. = EEA5: Not supported'
                                                nas_5gs.mm.eea6: '.... ..0. = EEA6: Not supported'
                                                nas_5gs.mm.eea7: '.... ...0 = EEA7: Not supported'
                                                nas_5gs.mm.eia0: '1... .... = EIA0: Supported'
                                                nas_5gs.mm.128eia1: '.1.. .... = 128-EIA1: Supported'
                                                nas_5gs.mm.128eia2: '..1. .... = 128-EIA2: Supported'
                                                nas_5gs.mm.eia3: '...1 .... = 128-EIA3: Supported'
                                                nas_5gs.mm.eia4: '.... 0... = EIA4: Not supported'
                                                nas_5gs.mm.eia5: '.... .0.. = EIA5: Not supported'
                                                nas_5gs.mm.eia6: '.... ..0. = EIA6: Not supported'
                                                nas_5gs.mm.eia7: '.... ...0 = EIA7: Not supported'
                                            NSSAI - Requested NSSAI:
                                                nas_5gs.mm.elem_id: 'Element ID: 0x2f'
                                                gsm_a.len: 'Length: 2'
                                                S-NSSAI 1:
                                                    nas_5gs.mm.length: 'Length: 1'
                                                    nas_5gs.mm.sst: 'Slice/service type (SST): 1'
                                            5GS update type:
                                                nas_5gs.mm.elem_id: 'Element ID: 0x53'
                                                gsm_a.len: 'Length: 1'
                                                nas_5gs.spare_b3: '.... 0... = Spare: 0'
                                                nas_5gs.spare_b2: '.... .0.. = Spare: 0'
                                                nas_5gs.mm.ng_ran_rcu: '.... ..0. = NG-RAN Radio Capability Update (NG-RAN-RCU): Not Needed'
                                                nas_5gs.mm.sms_requested: '.... ...0 = SMS requested: SMS over NAS not supported'
            'Item 3: id-UserLocationInformation':
                ngap.id: 'id: id-UserLocationInformation (121)'
                per.enum_index: 'Enumerated Index: 1'
                ngap.criticality: 'criticality: ignore (1)'
                per.open_type_length: 'Open Type Length: 19'
                ngap.value_element:
                    per.choice_index: 'Choice Index: 1'
                    ngap.UserLocationInformation:
                        ngap.userLocationInformationNR_element:
                            per.extension_bit: '..0. .... Extension Bit: False'
                            per.optional_field_bit: '.... 0... Optional Field Bit: False (iE-Extensions is NOT present)'
                            ngap.nR_CGI_element:
                                per.extension_bit: '.... .0.. Extension Bit: False'
                                per.optional_field_bit: '.... ..0. Optional Field Bit: False (iE-Extensions is NOT present)'
                                ngap.pLMNIdentity:
                                    e212.mcc: 'Mobile Country Code (MCC): International Mobile, shared code (901)'
                                    e212.mnc: 'Mobile Network Code (MNC): Unknown (70)'
                                ngap.NRCellIdentity: 'nRCellIdentity: 0x0000000010'
                            ngap.tAI_element:
                                per.extension_bit: '.... 0... Extension Bit: False'
                                per.optional_field_bit: '.... .0.. Optional Field Bit: False (iE-Extensions is NOT present)'
                                ngap.pLMNIdentity:
                                    e212.mcc: 'Mobile Country Code (MCC): International Mobile, shared code (901)'
                                    e212.mnc: 'Mobile Network Code (MNC): Unknown (70)'
                                ngap.tAC: 'tAC: 1 (0x000001)'
                            ngap.timeStamp: 'timeStamp: e74c1dd2 (Dec 20, 2022 11:41:06 UTC)'

end note

"10.0.3.1" -> "10.0.2.15": 2526, NGAP InitialContextSetup (14),\nNAS Registration accept (0x42)

note right #c6ebc6
**10.0.3.1 to 10.0.2.15**
NGAP-PDU: 000e008090000008000a00020013005500020003001c00070009f107020040000000020001007700091c000e000700038000005e00208e68cf5580d52b0401d886da4a4e86872e4f19023c8cd5ff1d4146115adb7cae002240084370816125ffff510026402f2e7e02c7554e75017e0042010177000bf209f107020040e500baea54072009f10700000115020101210201005e0129
ngap.procedureCode: 'procedureCode: id-InitialContextSetup (14)'
per.enum_index: 'Enumerated Index: 0'
ngap.criticality: 'criticality: reject (0)'
per.open_type_length: 'Open Type Length: 144'
ngap.value_element:
-   ngap.InitialContextSetupRequest_element:
        per.extension_bit: '0... .... Extension Bit: False'
        per.sequence_of_length: 'Sequence-Of Length: 8'
        ngap.protocolIEs:
            'Item 0: id-AMF-UE-NGAP-ID':
                ngap.id: 'id: id-AMF-UE-NGAP-ID (10)'
                per.enum_index: 'Enumerated Index: 0'
                ngap.criticality: 'criticality: reject (0)'
                per.open_type_length: 'Open Type Length: 2'
                ngap.value_element:
                    ngap.AMF_UE_NGAP_ID: 'AMF-UE-NGAP-ID: 19'
            'Item 1: id-RAN-UE-NGAP-ID':
                ngap.id: 'id: id-RAN-UE-NGAP-ID (85)'
                per.enum_index: 'Enumerated Index: 0'
                ngap.criticality: 'criticality: reject (0)'
                per.open_type_length: 'Open Type Length: 2'
                ngap.value_element:
                    ngap.RAN_UE_NGAP_ID: 'RAN-UE-NGAP-ID: 3'
            'Item 2: id-GUAMI':
                ngap.id: 'id: id-GUAMI (28)'
                per.enum_index: 'Enumerated Index: 0'
                ngap.criticality: 'criticality: reject (0)'
                per.open_type_length: 'Open Type Length: 7'
                ngap.value_element:
                    ngap.GUAMI_element:
                        per.extension_bit: '0... .... Extension Bit: False'
                        per.optional_field_bit: '.0.. .... Optional Field Bit: False (iE-Extensions is NOT present)'
                        ngap.pLMNIdentity:
                            e212.mcc: 'Mobile Country Code (MCC): International Mobile, shared code (901)'
                            e212.mnc: 'Mobile Network Code (MNC): Unknown (70)'
                        ngap.aMFRegionID: 'aMFRegionID: 02 [bit length 8, 0000 0010 decimal value 2]'
                        ngap.aMFSetID: 'aMFSetID: 0040 [bit length 10, 6 LSB pad bits, 0000 0000  01.. .... decimal value 1]'
                        ngap.aMFPointer: 'aMFPointer: 00 [bit length 6, 2 LSB pad bits, 0000 00.. decimal value 0]'
            'Item 3: id-AllowedNSSAI':
                ngap.id: 'id: id-AllowedNSSAI (0)'
                per.enum_index: 'Enumerated Index: 0'
                ngap.criticality: 'criticality: reject (0)'
                per.open_type_length: 'Open Type Length: 2'
                ngap.value_element:
                    per.sequence_of_length: 'Sequence-Of Length: 1'
                    ngap.AllowedNSSAI:
                        Item 0:
                            ngap.AllowedNSSAI_Item_element:
                                per.extension_bit: '...0 .... Extension Bit: False'
                                per.optional_field_bit: '.... 0... Optional Field Bit: False (iE-Extensions is NOT present)'
                                ngap.s_NSSAI_element:
                                    per.extension_bit: '.... .0.. Extension Bit: False'
                                    per.optional_field_bit: '.... ...0 Optional Field Bit: False (iE-Extensions is NOT present)'
                                    ngap.sST: 'sST: 01'
            'Item 4: id-UESecurityCapabilities':
                ngap.id: 'id: id-UESecurityCapabilities (119)'
                per.enum_index: 'Enumerated Index: 0'
                ngap.criticality: 'criticality: reject (0)'
                per.open_type_length: 'Open Type Length: 9'
                ngap.value_element:
                    ngap.UESecurityCapabilities_element:
                        per.extension_bit: '0... .... Extension Bit: False'
                        per.optional_field_bit: '.0.. .... Optional Field Bit: False (iE-Extensions is NOT present)'
                        per.extension_present_bit: '.... .0.. Extension Present Bit: False'
                        ngap.nRencryptionAlgorithms:
                            ngap.NrencyptionAlgorithms.nea1: '1... .... .... .... = 128-NEA1: Supported'
                            ngap.NrencyptionAlgorithms.nea2: '.1.. .... .... .... = 128-NEA2: Supported'
                            ngap.NrencyptionAlgorithms.nea3: '..1. .... .... .... = 128-NEA3: Supported'
                            ngap.NrencyptionAlgorithms.reserved: '...0 0000 0000 0000 = Reserved: 0x0000'
                        ngap.nRintegrityProtectionAlgorithms:
                            ngap.NrintegrityProtectionAlgorithms.nia1: '1... .... .... .... = 128-NIA1: Supported'
                            ngap.NrintegrityProtectionAlgorithms.nia2: '.1.. .... .... .... = 128-NIA2: Supported'
                            ngap.NrintegrityProtectionAlgorithms.nia3: '..1. .... .... .... = 128-NIA3: Supported'
                            ngap.NrintegrityProtectionAlgorithms.reserved: '...0 0000 0000 0000 = Reserved: 0x0000'
                        ngap.eUTRAencryptionAlgorithms:
                            ngap.EUTRAencryptionAlgorithms.eea1: '1... .... .... .... = 128-EEA1: Supported'
                            ngap.EUTRAencryptionAlgorithms.eea2: '.1.. .... .... .... = 128-EEA2: Supported'
                            ngap.EUTRAencryptionAlgorithms.eea3: '..1. .... .... .... = 128-EEA3: Supported'
                            ngap.EUTRAencryptionAlgorithms.reserved: '...0 0000 0000 0000 = Reserved: 0x0000'
                        ngap.eUTRAintegrityProtectionAlgorithms:
                            ngap.EUTRAintegrityProtectionAlgorithms.eia1: '1... .... .... .... = 128-EIA1: Supported'
                            ngap.EUTRAintegrityProtectionAlgorithms.eia2: '.1.. .... .... .... = 128-EIA2: Supported'
                            ngap.EUTRAintegrityProtectionAlgorithms.eia3: '..1. .... .... .... = 128-EIA3: Supported'
                            ngap.EUTRAintegrityProtectionAlgorithms.reserved: '...0 0000 0000 0000 = Reserved: 0x0000'
            'Item 5: id-SecurityKey':
                ngap.id: 'id: id-SecurityKey (94)'
                per.enum_index: 'Enumerated Index: 0'
                ngap.criticality: 'criticality: reject (0)'
                per.open_type_length: 'Open Type Length: 32'
                ngap.value_element:
                    ngap.SecurityKey: 'SecurityKey: 8e68cf5580d52b0401d886da4a4e86872e4f19023c8cd5ff\xe2\x80\xa6 [bit length 256]'
            'Item 6: id-MaskedIMEISV':
                ngap.id: 'id: id-MaskedIMEISV (34)'
                per.enum_index: 'Enumerated Index: 1'
                ngap.criticality: 'criticality: ignore (1)'
                per.open_type_length: 'Open Type Length: 8'
                ngap.value_element:
                    ngap.MaskedIMEISV: 'MaskedIMEISV: 4370816125ffff51 [bit length 64, 0100 0011  0111 0000  1000 0001  0110 0001  0010 0101  1111 1111  1111 1111  0101 0001 decimal value 4859526252182110033]'
            'Item 7: id-NAS-PDU':
                ngap.id: 'id: id-NAS-PDU (38)'
                per.enum_index: 'Enumerated Index: 1'
                ngap.criticality: 'criticality: ignore (1)'
                per.open_type_length: 'Open Type Length: 47'
                ngap.value_element:
                    per.octet_string_length: 'Octet String Length: 46'
                    ngap.NAS_PDU:
                        nas-5gs:
                            Security protected NAS 5GS message:
                                nas_5gs.epd: 'Extended protocol discriminator: 5G mobility management messages (126)'
                                nas_5gs.spare_half_octet: '0000 .... = Spare Half Octet: 0'
                                nas_5gs.security_header_type: '.... 0010 = Security header type: Integrity protected and ciphered (2)'
                                nas_5gs.msg_auth_code: 'Message authentication code: 0xc7554e75'
                                nas_5gs.seq_no: 'Sequence number: 1'
                            Plain NAS 5GS Message:
                                nas_5gs.epd: 'Extended protocol discriminator: 5G mobility management messages (126)'
                                nas_5gs.spare_half_octet: '0000 .... = Spare Half Octet: 0'
                                nas_5gs.security_header_type: '.... 0000 = Security header type: Plain NAS message, not security protected (0)'
                                nas_5gs.mm.message_type: 'Message type: Registration accept (0x42)'
                                5GS registration result:
                                    gsm_a.len: 'Length: 1'
                                    nas_5gs.mm.reg_res.nssaa_perf: '...0 .... = NSSAA Performed: False'
                                    nas_5gs.mm.reg_res.sms_all: '.... 0... = SMS over NAS: Not Allowed'
                                    nas_5gs.mm.reg_res.res: '.... .001 = 5GS registration result: 3GPP access (1)'
                                5GS mobile identity - 5G-GUTI:
                                    nas_5gs.mm.elem_id: 'Element ID: 0x77'
                                    gsm_a.len: 'Length: 11'
                                    nas_5gs.mm.odd_even: '.... 0... = Odd/even indication: Even number of identity digits'
                                    nas_5gs.mm.type_id: '.... .010 = Type of identity: 5G-GUTI (2)'
                                    e212.mcc: 'Mobile Country Code (MCC): International Mobile, shared code (901)'
                                    e212.mnc: 'Mobile Network Code (MNC): Unknown (70)'
                                    nas_5gs.amf_region_id: 'AMF Region ID: 2'
                                    nas_5gs.amf_set_id: '0000 0000 01.. .... = AMF Set ID: 1'
                                    nas_5gs.amf_pointer: '..00 0000 = AMF Pointer: 0'
                                    nas_5gs.5g_tmsi: '5G-TMSI: 0xe500baea'
                                5GS tracking area identity list:
                                    nas_5gs.mm.elem_id: 'Element ID: 0x54'
                                    gsm_a.len: 'Length: 7'
                                    Partial tracking area list  1:
                                        nas_5gs.mm.tal_t_li: '.01. .... = Type of list: list of TACs belonging to one PLMN, with consecutive TAC values (1)'
                                        nas_5gs.mm.tal_num_e: '...0 0000 = Number of elements: 1 element (0)'
                                        e212.mcc: 'Mobile Country Code (MCC): International Mobile, shared code (901)'
                                        e212.mnc: 'Mobile Network Code (MNC): Unknown (70)'
                                        nas_5gs.tac: 'TAC: 1'
                                NSSAI - Allowed NSSAI:
                                    nas_5gs.mm.elem_id: 'Element ID: 0x15'
                                    gsm_a.len: 'Length: 2'
                                    S-NSSAI 1:
                                        nas_5gs.mm.length: 'Length: 1'
                                        nas_5gs.mm.sst: 'Slice/service type (SST): 1'
                                5GS network feature support:
                                    nas_5gs.mm.elem_id: 'Element ID: 0x21'
                                    gsm_a.len: 'Length: 2'
                                    nas_5gs.nw_feat_sup.mpsi: '0... .... = MPS indicator (MPSI): Access identity 1 not valid in RPLMN or equivalent PLMN'
                                    nas_5gs.nw_feat_sup.iwk_n26: '.0.. .... = Interworking without N26: Not supported'
                                    nas_5gs.nw_feat_sup.emf: '..00 .... = Emergency service fallback indicator (EMF): Emergency services fallback not supported (0)'
                                    nas_5gs.nw_feat_sup.emc: '.... 00.. = Emergency service support indicator (EMC): Emergency services not supported (0)'
                                    nas_5gs.nw_feat_sup.vops_n3gpp: '.... ..0. = IMS voice over PS session over non-3GPP access indicator (IMS-VoPS-N3GPP): Not supported'
                                    nas_5gs.nw_feat_sup.vops_3gpp: '.... ...1 = IMS voice over PS session indicator (IMS VoPS): Supported'
                                    nas_5gs.spare_b7: '0... .... = Spare: 0'
                                    nas_5gs.spare_b6: '.0.. .... = Spare: 0'
                                    nas_5gs.spare_b5: '..0. .... = Spare: 0'
                                    nas_5gs.spare_b4: '...0 .... = Spare: 0'
                                    nas_5gs.spare_b3: '.... 0... = Spare: 0'
                                    nas_5gs.spare_b2: '.... .0.. = Spare: 0'
                                    nas_5gs.nw_feat_sup.mcsi: '.... ..0. = MCS indicator (MCSI): Not supported'
                                    nas_5gs.nw_feat_sup.emcn3: '.... ...0 = Emergency services over non-3GPP access (EMCN3): Not supported'
                                GPRS Timer 3 - T3512 value:
                                    gsm_a.gm.elem_id: 'Element ID: 0x5e'
                                    gsm_a.len: 'Length: 1'
                                    gsm_a.gm.gmm.gprs_timer3:
                                        gsm_a.gm.gmm.gprs_timer3_unit: '001. .... = Unit: value is incremented in multiples of 1 hour (1)'
                                        gsm_a.gm.gmm.gprs_timer3_value: '...0 1001 = Timer value: 9'

end note

"10.0.2.15" -> "10.0.3.1": 2527, NGAP InitialContextSetup (14)

note right #c6ebc6
**10.0.2.15 to 10.0.3.1**
NGAP-PDU: 200e000f000002000a40020013005540020003
ngap.procedureCode: 'procedureCode: id-InitialContextSetup (14)'
per.enum_index: 'Enumerated Index: 0'
ngap.criticality: 'criticality: reject (0)'
per.open_type_length: 'Open Type Length: 15'
ngap.value_element:
-   ngap.InitialContextSetupResponse_element:
        per.extension_bit: '0... .... Extension Bit: False'
        per.sequence_of_length: 'Sequence-Of Length: 2'
        ngap.protocolIEs:
            'Item 0: id-AMF-UE-NGAP-ID':
                ngap.id: 'id: id-AMF-UE-NGAP-ID (10)'
                per.enum_index: 'Enumerated Index: 1'
                ngap.criticality: 'criticality: ignore (1)'
                per.open_type_length: 'Open Type Length: 2'
                ngap.value_element:
                    ngap.AMF_UE_NGAP_ID: 'AMF-UE-NGAP-ID: 19'
            'Item 1: id-RAN-UE-NGAP-ID':
                ngap.id: 'id: id-RAN-UE-NGAP-ID (85)'
                per.enum_index: 'Enumerated Index: 1'
                ngap.criticality: 'criticality: ignore (1)'
                per.open_type_length: 'Open Type Length: 2'
                ngap.value_element:
                    ngap.RAN_UE_NGAP_ID: 'RAN-UE-NGAP-ID: 3'

end note

"10.0.2.15" -> "10.0.3.1": 2531, NGAP UplinkNASTransport (46),\nNAS Registration complete (0x43),\nNAS UL NAS transport (0x67),\nNAS PDU session establishment request (0xc1)

note right #8cd98c
**10.0.2.15 to 10.0.3.1**
NGAP-PDU: 002e4035000004000a000200130055000200030026000b0a7e027cb16979017e0043007940135009f107000000010009f107000001e74c1dd2
ngap.procedureCode: 'procedureCode: id-UplinkNASTransport (46)'
per.enum_index: 'Enumerated Index: 1'
ngap.criticality: 'criticality: ignore (1)'
per.open_type_length: 'Open Type Length: 53'
ngap.value_element:
-   ngap.UplinkNASTransport_element:
        per.extension_bit: '0... .... Extension Bit: False'
        per.sequence_of_length: 'Sequence-Of Length: 4'
        ngap.protocolIEs:
            'Item 0: id-AMF-UE-NGAP-ID':
                ngap.id: 'id: id-AMF-UE-NGAP-ID (10)'
                per.enum_index: 'Enumerated Index: 0'
                ngap.criticality: 'criticality: reject (0)'
                per.open_type_length: 'Open Type Length: 2'
                ngap.value_element:
                    ngap.AMF_UE_NGAP_ID: 'AMF-UE-NGAP-ID: 19'
            'Item 1: id-RAN-UE-NGAP-ID':
                ngap.id: 'id: id-RAN-UE-NGAP-ID (85)'
                per.enum_index: 'Enumerated Index: 0'
                ngap.criticality: 'criticality: reject (0)'
                per.open_type_length: 'Open Type Length: 2'
                ngap.value_element:
                    ngap.RAN_UE_NGAP_ID: 'RAN-UE-NGAP-ID: 3'
            'Item 2: id-NAS-PDU':
                ngap.id: 'id: id-NAS-PDU (38)'
                per.enum_index: 'Enumerated Index: 0'
                ngap.criticality: 'criticality: reject (0)'
                per.open_type_length: 'Open Type Length: 11'
                ngap.value_element:
                    per.octet_string_length: 'Octet String Length: 10'
                    ngap.NAS_PDU:
                        nas-5gs:
                            Security protected NAS 5GS message:
                                nas_5gs.epd: 'Extended protocol discriminator: 5G mobility management messages (126)'
                                nas_5gs.spare_half_octet: '0000 .... = Spare Half Octet: 0'
                                nas_5gs.security_header_type: '.... 0010 = Security header type: Integrity protected and ciphered (2)'
                                nas_5gs.msg_auth_code: 'Message authentication code: 0x7cb16979'
                                nas_5gs.seq_no: 'Sequence number: 1'
                            Plain NAS 5GS Message:
                                nas_5gs.epd: 'Extended protocol discriminator: 5G mobility management messages (126)'
                                nas_5gs.spare_half_octet: '0000 .... = Spare Half Octet: 0'
                                nas_5gs.security_header_type: '.... 0000 = Security header type: Plain NAS message, not security protected (0)'
                                nas_5gs.mm.message_type: 'Message type: Registration complete (0x43)'
            'Item 3: id-UserLocationInformation':
                ngap.id: 'id: id-UserLocationInformation (121)'
                per.enum_index: 'Enumerated Index: 1'
                ngap.criticality: 'criticality: ignore (1)'
                per.open_type_length: 'Open Type Length: 19'
                ngap.value_element:
                    per.choice_index: 'Choice Index: 1'
                    ngap.UserLocationInformation:
                        ngap.userLocationInformationNR_element:
                            per.extension_bit: '..0. .... Extension Bit: False'
                            per.optional_field_bit: '.... 0... Optional Field Bit: False (iE-Extensions is NOT present)'
                            ngap.nR_CGI_element:
                                per.extension_bit: '.... .0.. Extension Bit: False'
                                per.optional_field_bit: '.... ..0. Optional Field Bit: False (iE-Extensions is NOT present)'
                                ngap.pLMNIdentity:
                                    e212.mcc: 'Mobile Country Code (MCC): International Mobile, shared code (901)'
                                    e212.mnc: 'Mobile Network Code (MNC): Unknown (70)'
                                ngap.NRCellIdentity: 'nRCellIdentity: 0x0000000010'
                            ngap.tAI_element:
                                per.extension_bit: '.... 0... Extension Bit: False'
                                per.optional_field_bit: '.... .0.. Optional Field Bit: False (iE-Extensions is NOT present)'
                                ngap.pLMNIdentity:
                                    e212.mcc: 'Mobile Country Code (MCC): International Mobile, shared code (901)'
                                    e212.mnc: 'Mobile Network Code (MNC): Unknown (70)'
                                ngap.tAC: 'tAC: 1 (0x000001)'
                            ngap.timeStamp: 'timeStamp: e74c1dd2 (Dec 20, 2022 11:41:06 UTC)'

NGAP-PDU: 002e405a000004000a00020013005500020003002600302f7e02a1b38867027e00670100152e0101c1ffff91a12801007b000780000a00000d0012018122010125050465646765007940135009f107000000010009f107000001e74c1dd2
ngap.procedureCode: 'procedureCode: id-UplinkNASTransport (46)'
per.enum_index: 'Enumerated Index: 1'
ngap.criticality: 'criticality: ignore (1)'
per.open_type_length: 'Open Type Length: 90'
ngap.value_element:
-   ngap.UplinkNASTransport_element:
        per.extension_bit: '0... .... Extension Bit: False'
        per.sequence_of_length: 'Sequence-Of Length: 4'
        ngap.protocolIEs:
            'Item 0: id-AMF-UE-NGAP-ID':
                ngap.id: 'id: id-AMF-UE-NGAP-ID (10)'
                per.enum_index: 'Enumerated Index: 0'
                ngap.criticality: 'criticality: reject (0)'
                per.open_type_length: 'Open Type Length: 2'
                ngap.value_element:
                    ngap.AMF_UE_NGAP_ID: 'AMF-UE-NGAP-ID: 19'
            'Item 1: id-RAN-UE-NGAP-ID':
                ngap.id: 'id: id-RAN-UE-NGAP-ID (85)'
                per.enum_index: 'Enumerated Index: 0'
                ngap.criticality: 'criticality: reject (0)'
                per.open_type_length: 'Open Type Length: 2'
                ngap.value_element:
                    ngap.RAN_UE_NGAP_ID: 'RAN-UE-NGAP-ID: 3'
            'Item 2: id-NAS-PDU':
                ngap.id: 'id: id-NAS-PDU (38)'
                per.enum_index: 'Enumerated Index: 0'
                ngap.criticality: 'criticality: reject (0)'
                per.open_type_length: 'Open Type Length: 48'
                ngap.value_element:
                    per.octet_string_length: 'Octet String Length: 47'
                    ngap.NAS_PDU:
                        nas-5gs:
                            Security protected NAS 5GS message:
                                nas_5gs.epd: 'Extended protocol discriminator: 5G mobility management messages (126)'
                                nas_5gs.spare_half_octet: '0000 .... = Spare Half Octet: 0'
                                nas_5gs.security_header_type: '.... 0010 = Security header type: Integrity protected and ciphered (2)'
                                nas_5gs.msg_auth_code: 'Message authentication code: 0xa1b38867'
                                nas_5gs.seq_no: 'Sequence number: 2'
                            Plain NAS 5GS Message:
                                nas_5gs.epd: 'Extended protocol discriminator: 5G mobility management messages (126)'
                                nas_5gs.spare_half_octet: '0000 .... = Spare Half Octet: 0'
                                nas_5gs.security_header_type: '.... 0000 = Security header type: Plain NAS message, not security protected (0)'
                                nas_5gs.mm.message_type: 'Message type: UL NAS transport (0x67)'
                                Payload container type:
                                    nas_5gs.mm.pld_cont_type: '.... 0001 = Payload container type: N1 SM information (1)'
                                Payload container:
                                    gsm_a.len: 'Length: 21'
                                    Plain NAS 5GS Message:
                                        nas_5gs.epd: 'Extended protocol discriminator: 5G session management messages (46)'
                                        nas_5gs.pdu_session_id: 'PDU session identity: PDU session identity value 1 (1)'
                                        nas_5gs.proc_trans_id: 'Procedure transaction identity: 1'
                                        nas_5gs.sm.message_type: 'Message type: PDU session establishment request (0xc1)'
                                        Integrity protection maximum data rate:
                                            nas_5gs.sm.int_prot_max_data_rate_ul: 'Integrity protection maximum data rate for uplink: Full data rate (255)'
                                            nas_5gs.sm.int_prot_max_data_rate_dl: 'Integrity protection maximum data rate for downlink: Full data rate (255)'
                                        PDU session type:
                                            gsm_a.common.elem_id: '1001 .... = Element ID: 0x9-'
                                            nas_5gs.sm.pdu_session_type: '.... 0001 = PDU session type: IPv4 (1)'
                                        SSC mode:
                                            gsm_a.common.elem_id: '1010 .... = Element ID: 0xa-'
                                            nas_5gs.sm.sc_mode: '.... 0001 = SSC mode: SSC mode 1 (1)'
                                        5GSM capability:
                                            nas_5gs.sm.elem_id: 'Element ID: 0x28'
                                            gsm_a.len: 'Length: 1'
                                            nas_5gs.spare_b7: '0... .... = Spare: 0'
                                            nas_5gs.spare_b6: '.0.. .... = Spare: 0'
                                            nas_5gs.spare_b5: '..0. .... = Spare: 0'
                                            nas_5gs.spare_b4: '...0 .... = Spare: 0'
                                            nas_5gs.spare_b3: '.... 0... = Spare: 0'
                                            nas_5gs.spare_b2: '.... .0.. = Spare: 0'
                                            nas_5gs.sm.mh6_pdu: '.... ..0. = Multi-homed IPv6 PDU session (MH6-PDU): Not supported'
                                            nas_5gs.sm.rqos: '.... ...0 = Reflective QoS (RqoS): Not supported'
                                        Extended protocol configuration options:
                                            nas_eps.esm.elem_id: 'Element ID: 0x7b'
                                            gsm_a.len: 'Length: 7'
                                            gsm_a.gm.sm.link_dir: 'Link direction: MS to network (0)'
                                            gsm_a.gm.sm.ext: '1... .... = Extension: True'
                                            gsm_a.gm.configuration_protocol: '.... .000 = Configuration Protocol: PPP for use with IP PDP type or IP PDN type (0)'
                                            gsm_a.gm.sm.pco_pid:
                                            -   gsm_a.gm.sm.pco.length: 'Length: 0x00 (0)'
                                            -   gsm_a.gm.sm.pco.length: 'Length: 0x00 (0)'
                                PDU session identity 2 - PDU session ID:
                                    nas_5gs.mm.elem_id: 'Element ID: 0x12'
                                    nas_5gs.pdu_session_id: 'PDU session identity: PDU session identity value 1 (1)'
                                Request type:
                                    gsm_a.common.elem_id: '1000 .... = Element ID: 0x8-'
                                    nas_5gs.mm.req_typ: '.... 0001 = Request type: Initial request (1)'
                                S-NSSAI:
                                    nas_5gs.common.elem_id: 'Element ID: 0x22'
                                    gsm_a.len: 'Length: 1'
                                    nas_5gs.mm.sst: 'Slice/service type (SST): 1'
                                DNN:
                                    nas_5gs.common.elem_id: 'Element ID: 0x25'
                                    gsm_a.len: 'Length: 5'
                                    nas_5gs.cmn.dnn: 'DNN: edge'
            'Item 3: id-UserLocationInformation':
                ngap.id: 'id: id-UserLocationInformation (121)'
                per.enum_index: 'Enumerated Index: 1'
                ngap.criticality: 'criticality: ignore (1)'
                per.open_type_length: 'Open Type Length: 19'
                ngap.value_element:
                    per.choice_index: 'Choice Index: 1'
                    ngap.UserLocationInformation:
                        ngap.userLocationInformationNR_element:
                            per.extension_bit: '..0. .... Extension Bit: False'
                            per.optional_field_bit: '.... 0... Optional Field Bit: False (iE-Extensions is NOT present)'
                            ngap.nR_CGI_element:
                                per.extension_bit: '.... .0.. Extension Bit: False'
                                per.optional_field_bit: '.... ..0. Optional Field Bit: False (iE-Extensions is NOT present)'
                                ngap.pLMNIdentity:
                                    e212.mcc: 'Mobile Country Code (MCC): International Mobile, shared code (901)'
                                    e212.mnc: 'Mobile Network Code (MNC): Unknown (70)'
                                ngap.NRCellIdentity: 'nRCellIdentity: 0x0000000010'
                            ngap.tAI_element:
                                per.extension_bit: '.... 0... Extension Bit: False'
                                per.optional_field_bit: '.... .0.. Optional Field Bit: False (iE-Extensions is NOT present)'
                                ngap.pLMNIdentity:
                                    e212.mcc: 'Mobile Country Code (MCC): International Mobile, shared code (901)'
                                    e212.mnc: 'Mobile Network Code (MNC): Unknown (70)'
                                ngap.tAC: 'tAC: 1 (0x000001)'
                            ngap.timeStamp: 'timeStamp: e74c1dd2 (Dec 20, 2022 11:41:06 UTC)'

end note

"10.0.3.1" -> "10.0.2.15": 2532, NGAP DownlinkNASTransport (4),\nNAS Configuration update command (0x54)

note right #c6ebc6
**10.0.3.1 to 10.0.2.15**
NGAP-PDU: 0004403c000003000a0002001300550002000300260029287e02b979ddd4027e0054430f90004f00700065006e00350047005346404722219261702140490100
ngap.procedureCode: 'procedureCode: id-DownlinkNASTransport (4)'
per.enum_index: 'Enumerated Index: 1'
ngap.criticality: 'criticality: ignore (1)'
per.open_type_length: 'Open Type Length: 60'
ngap.value_element:
-   ngap.DownlinkNASTransport_element:
        per.extension_bit: '0... .... Extension Bit: False'
        per.sequence_of_length: 'Sequence-Of Length: 3'
        ngap.protocolIEs:
            'Item 0: id-AMF-UE-NGAP-ID':
                ngap.id: 'id: id-AMF-UE-NGAP-ID (10)'
                per.enum_index: 'Enumerated Index: 0'
                ngap.criticality: 'criticality: reject (0)'
                per.open_type_length: 'Open Type Length: 2'
                ngap.value_element:
                    ngap.AMF_UE_NGAP_ID: 'AMF-UE-NGAP-ID: 19'
            'Item 1: id-RAN-UE-NGAP-ID':
                ngap.id: 'id: id-RAN-UE-NGAP-ID (85)'
                per.enum_index: 'Enumerated Index: 0'
                ngap.criticality: 'criticality: reject (0)'
                per.open_type_length: 'Open Type Length: 2'
                ngap.value_element:
                    ngap.RAN_UE_NGAP_ID: 'RAN-UE-NGAP-ID: 3'
            'Item 2: id-NAS-PDU':
                ngap.id: 'id: id-NAS-PDU (38)'
                per.enum_index: 'Enumerated Index: 0'
                ngap.criticality: 'criticality: reject (0)'
                per.open_type_length: 'Open Type Length: 41'
                ngap.value_element:
                    per.octet_string_length: 'Octet String Length: 40'
                    ngap.NAS_PDU:
                        nas-5gs:
                            Security protected NAS 5GS message:
                                nas_5gs.epd: 'Extended protocol discriminator: 5G mobility management messages (126)'
                                nas_5gs.spare_half_octet: '0000 .... = Spare Half Octet: 0'
                                nas_5gs.security_header_type: '.... 0010 = Security header type: Integrity protected and ciphered (2)'
                                nas_5gs.msg_auth_code: 'Message authentication code: 0xb979ddd4'
                                nas_5gs.seq_no: 'Sequence number: 2'
                            Plain NAS 5GS Message:
                                nas_5gs.epd: 'Extended protocol discriminator: 5G mobility management messages (126)'
                                nas_5gs.spare_half_octet: '0000 .... = Spare Half Octet: 0'
                                nas_5gs.security_header_type: '.... 0000 = Security header type: Plain NAS message, not security protected (0)'
                                nas_5gs.mm.message_type: 'Message type: Configuration update command (0x54)'
                                Network Name - Full name for network:
                                    gsm_a.dtap.elem_id: 'Element ID: 0x43'
                                    gsm_a.len: 'Length: 15'
                                    gsm_a.extension: '1... .... = Extension: No Extension'
                                    gsm_a.dtap.coding_scheme: '.001 .... = Coding Scheme: UCS2 (16 bit) (1)'
                                    gsm_a.dtap.add_ci: '.... 0... = Add CI: The MS should not add the letters for the Country''s Initials to the text string'
                                    gsm_a.dtap.number_of_spare_bits: '.... .000 = Number of spare bits in last octet: this field carries no information about the number of spare bits in octet n (0)'
                                    gsm_a.dtap.text_string: 'Text String: Open5GS'
                                Time Zone - Local:
                                    gsm_a.dtap.elem_id: 'Element ID: 0x46'
                                    gsm_a.dtap.timezone: 'Timezone: GMT + 1 hours 0 minutes'
                                Time Zone and Time - Universal Time and Local Time Zone:
                                    gsm_a.dtap.elem_id: 'Element ID: 0x47'
                                    gsm_a.dtap.time_zone_time: 'Time: Dec 29, 2022 16:07:12.000000000'
                                    gsm_a.dtap.timezone: 'Timezone: GMT + 1 hours 0 minutes'
                                Daylight Saving Time:
                                    gsm_a.dtap.elem_id: 'Element ID: 0x49'
                                    gsm_a.len: 'Length: 1'
                                    gsm_a.spare_bits: '0000 00.. = Spare bit(s): 0'
                                    gsm_a.dtap.dst_adjustment: '.... ..00 = DST Adjustment: No adjustment for Daylight Saving Time (0)'

end note

"10.0.14.1" -> "10.0.17.1": 2574, PFCP req.\nPFCP Session Establishment Request (50)

note right #80b3ff
**10.0.14.1 to 10.0.17.1**
pfcp.flags:
-   pfcp.version: '001. .... = Version: 1'
    pfcp.spare_b4: '...0 .... = Spare: 0'
    pfcp.spare_b3: '.... 0... = Spare: 0'
    pfcp.spare_b2: '.... .0.. = Spare: 0'
    pfcp.mp_flag: '.... ..0. = Message Priority (MP): False'
    pfcp.s: '.... ...1 = SEID (S): True'
pfcp.msg_type: 'Message Type: PFCP Session Establishment Request (50)'
pfcp.length: 'Length: 553'
pfcp.seid: 'SEID: 0x0000000000000000'
pfcp.seqno: 'Sequence Number: 231'
pfcp.spare_oct: 'Spare: 0'
'Node ID : IPv4 address: 10.0.14.1':
-   pfcp.ie_type: 'IE Type: Node ID (60)'
    pfcp.ie_len: 'IE Length: 5'
    pfcp.spare_h1: '0000 .... = Spare: 0'
    pfcp.node_id_type: '.... 0000 = Node ID Type: IPv4 address (0)'
    pfcp.node_id_ipv4: 'Node ID IPv4: 10.0.14.1'
'F-SEID : SEID: 0x000000000000000b, IPv4 10.0.14.1':
-   pfcp.ie_type: 'IE Type: F-SEID (57)'
    pfcp.ie_len: 'IE Length: 13'
    pfcp.f_seid_flags:
        pfcp.spare_b7: '0... .... = Spare: 0'
        pfcp.spare_b6: '.0.. .... = Spare: 0'
        pfcp.spare_b5: '..0. .... = Spare: 0'
        pfcp.spare_b4: '...0 .... = Spare: 0'
        pfcp.spare_b3: '.... 0... = Spare: 0'
        pfcp.spare_b2: '.... .0.. = Spare: 0'
        pfcp.f_seid_flags.v4: '.... ..1. = V4 (IPv4): Present'
        pfcp.f_seid_flags.v6: '.... ...0 = V6 (IPv6): Not Present'
    pfcp.seid: 'SEID: 0x000000000000000b'
    pfcp.f_seid.ipv4: 'IPv4 address: 10.0.14.1'
'Create PDR : [Grouped IE]':
-   pfcp.ie_type: 'IE Type: Create PDR (1)'
    pfcp.ie_len: 'IE Length: 65'
    'PDR ID : 1':
        pfcp.ie_type: 'IE Type: PDR ID (56)'
        pfcp.ie_len: 'IE Length: 2'
        pfcp.pdr_id: 'Rule ID: 1'
    'Precedence : 255':
        pfcp.ie_type: 'IE Type: Precedence (29)'
        pfcp.ie_len: 'IE Length: 4'
        pfcp.precedence: 'Precedence: 255'
    'PDI : [Grouped IE]':
        pfcp.ie_type: 'IE Type: PDI (2)'
        pfcp.ie_len: 'IE Length: 23'
        'Source Interface : Core':
            pfcp.ie_type: 'IE Type: Source Interface (20)'
            pfcp.ie_len: 'IE Length: 1'
            pfcp.spare_h1: '0000 .... = Spare: 0'
            pfcp.source_interface: '.... 0001 = Source Interface: Core (1)'
        'Network Instance : edge':
            pfcp.ie_type: 'IE Type: Network Instance (22)'
            pfcp.ie_len: 'IE Length: 5'
            pfcp.network_instance: 'Network Instance: edge'
        'UE IP Address : ':
            pfcp.ie_type: 'IE Type: UE IP Address (93)'
            pfcp.ie_len: 'IE Length: 5'
            pfcp.ue_ip_address_flags:
                pfcp.spare_b7_b4: '0000 .... = Spare: 0'
                pfcp.ue_ip_address_flag.v6d: '.... 0... = IPv6D: Source IP address'
                pfcp.ue_ip_address_flag.sd: '.... .1.. = S/D: Destination IP address'
                pfcp.ue_ip_address_flag.v4: '.... ..1. = V4 (IPv4): Present'
                pfcp.ue_ip_address_flag.v6: '.... ...0 = V6 (IPv6): Not Present'
            pfcp.ue_ip_addr_ipv4: 'IPv4 address: 10.45.0.12'
    'FAR ID : Dynamic by CP 1':
        pfcp.ie_type: 'IE Type: FAR ID (108)'
        pfcp.ie_len: 'IE Length: 4'
        pfcp.far_id_flg: '0... .... .... .... .... .... .... .... = Allocation type: Dynamic by CP'
        pfcp.far_id: '.000 0000 0000 0000 0000 0000 0000 0001 = FAR ID: 1'
    'URR ID : Dynamic by CP 1':
        pfcp.ie_type: 'IE Type: URR ID (81)'
        pfcp.ie_len: 'IE Length: 4'
        pfcp.urr_id_flg: '0... .... .... .... .... .... .... .... = Allocation type: Dynamic by CP'
        pfcp.urr_id: '.000 0000 0000 0000 0000 0000 0000 0001 = URR ID: 1'
    'QER ID : Dynamic by CP 1':
        pfcp.ie_type: 'IE Type: QER ID (109)'
        pfcp.ie_len: 'IE Length: 4'
        pfcp.qer_id_flg: '0... .... .... .... .... .... .... .... = Allocation type: Dynamic by CP'
        pfcp.qer_id: '.000 0000 0000 0000 0000 0000 0000 0001 = QER ID: 1'
-   pfcp.ie_type: 'IE Type: Create PDR (1)'
    pfcp.ie_len: 'IE Length: 74'
    'PDR ID : 2':
        pfcp.ie_type: 'IE Type: PDR ID (56)'
        pfcp.ie_len: 'IE Length: 2'
        pfcp.pdr_id: 'Rule ID: 2'
    'Precedence : 255':
        pfcp.ie_type: 'IE Type: Precedence (29)'
        pfcp.ie_len: 'IE Length: 4'
        pfcp.precedence: 'Precedence: 255'
    'PDI : [Grouped IE]':
        pfcp.ie_type: 'IE Type: PDI (2)'
        pfcp.ie_len: 'IE Length: 34'
        'Source Interface : Access':
            pfcp.ie_type: 'IE Type: Source Interface (20)'
            pfcp.ie_len: 'IE Length: 1'
            pfcp.spare_h1: '0000 .... = Spare: 0'
            pfcp.source_interface: '.... 0000 = Source Interface: Access (0)'
        'F-TEID : ':
            pfcp.ie_type: 'IE Type: F-TEID (21)'
            pfcp.ie_len: 'IE Length: 2'
            pfcp.f_teid_flags:
                pfcp.fteid_flg.spare: '0000 .... = Spare: 0'
                pfcp.f_teid_flags.ch_id: '.... 1... = CHID (CHOOSE_ID): True'
                pfcp.f_teid_flags.ch: '.... .1.. = CH (CHOOSE): True'
                pfcp.f_teid_flags.v6: '.... ..1. = V6 (IPv6): Present'
                pfcp.f_teid_flags.v4: '.... ...1 = V4 (IPv4): Present'
            pfcp.f_teid.choose_id: 'Choose Id: 05'
        'Network Instance : edge':
            pfcp.ie_type: 'IE Type: Network Instance (22)'
            pfcp.ie_len: 'IE Length: 5'
            pfcp.network_instance: 'Network Instance: edge'
        'UE IP Address : ':
            pfcp.ie_type: 'IE Type: UE IP Address (93)'
            pfcp.ie_len: 'IE Length: 5'
            pfcp.ue_ip_address_flags:
                pfcp.spare_b7_b4: '0000 .... = Spare: 0'
                pfcp.ue_ip_address_flag.v6d: '.... 0... = IPv6D: Source IP address'
                pfcp.ue_ip_address_flag.sd: '.... .0.. = S/D: Source IP address'
                pfcp.ue_ip_address_flag.v4: '.... ..1. = V4 (IPv4): Present'
                pfcp.ue_ip_address_flag.v6: '.... ...0 = V6 (IPv6): Not Present'
            pfcp.ue_ip_addr_ipv4: 'IPv4 address: 10.45.0.12'
        'QFI : ':
            pfcp.ie_type: 'IE Type: QFI (124)'
            pfcp.ie_len: 'IE Length: 1'
            pfcp.spare_b7_b6: '00.. .... = Spare: 0'
            pfcp.qfi_value: '.000 0001 = QFI: 0x01'
    'Outer Header Removal : GTP-U/UDP/IPv4':
        pfcp.ie_type: 'IE Type: Outer Header Removal (95)'
        pfcp.ie_len: 'IE Length: 2'
        pfcp.out_hdr_desc: 'Outer Header Removal Description: GTP-U/UDP/IPv4 (0)'
        pfcp.gtpu_ext_hdr_del.pdu_sess_cont: '.... ...1 = PDU Session Container to be deleted: True'
    'FAR ID : Dynamic by CP 2':
        pfcp.ie_type: 'IE Type: FAR ID (108)'
        pfcp.ie_len: 'IE Length: 4'
        pfcp.far_id_flg: '0... .... .... .... .... .... .... .... = Allocation type: Dynamic by CP'
        pfcp.far_id: '.000 0000 0000 0000 0000 0000 0000 0010 = FAR ID: 2'
    'QER ID : Dynamic by CP 1':
        pfcp.ie_type: 'IE Type: QER ID (109)'
        pfcp.ie_len: 'IE Length: 4'
        pfcp.qer_id_flg: '0... .... .... .... .... .... .... .... = Allocation type: Dynamic by CP'
        pfcp.qer_id: '.000 0000 0000 0000 0000 0000 0000 0001 = QER ID: 1'
-   pfcp.ie_type: 'IE Type: Create PDR (1)'
    pfcp.ie_len: 'IE Length: 58'
    'PDR ID : 3':
        pfcp.ie_type: 'IE Type: PDR ID (56)'
        pfcp.ie_len: 'IE Length: 2'
        pfcp.pdr_id: 'Rule ID: 3'
    'Precedence : 1000':
        pfcp.ie_type: 'IE Type: Precedence (29)'
        pfcp.ie_len: 'IE Length: 4'
        pfcp.precedence: 'Precedence: 1000'
    'PDI : [Grouped IE]':
        pfcp.ie_type: 'IE Type: PDI (2)'
        pfcp.ie_len: 'IE Length: 19'
        'Source Interface : CP-function':
            pfcp.ie_type: 'IE Type: Source Interface (20)'
            pfcp.ie_len: 'IE Length: 1'
            pfcp.spare_h1: '0000 .... = Spare: 0'
            pfcp.source_interface: '.... 0011 = Source Interface: CP-function (3)'
        'F-TEID : ':
            pfcp.ie_type: 'IE Type: F-TEID (21)'
            pfcp.ie_len: 'IE Length: 1'
            pfcp.f_teid_flags:
                pfcp.fteid_flg.spare: '0000 .... = Spare: 0'
                pfcp.f_teid_flags.ch_id: '.... 0... = CHID (CHOOSE_ID): False'
                pfcp.f_teid_flags.ch: '.... .1.. = CH (CHOOSE): True'
                pfcp.f_teid_flags.v6: '.... ..1. = V6 (IPv6): Present'
                pfcp.f_teid_flags.v4: '.... ...1 = V4 (IPv4): Present'
        'Network Instance : edge':
            pfcp.ie_type: 'IE Type: Network Instance (22)'
            pfcp.ie_len: 'IE Length: 5'
            pfcp.network_instance: 'Network Instance: edge'
    'Outer Header Removal : GTP-U/UDP/IPv4':
        pfcp.ie_type: 'IE Type: Outer Header Removal (95)'
        pfcp.ie_len: 'IE Length: 1'
        pfcp.out_hdr_desc: 'Outer Header Removal Description: GTP-U/UDP/IPv4 (0)'
    'FAR ID : Dynamic by CP 1':
        pfcp.ie_type: 'IE Type: FAR ID (108)'
        pfcp.ie_len: 'IE Length: 4'
        pfcp.far_id_flg: '0... .... .... .... .... .... .... .... = Allocation type: Dynamic by CP'
        pfcp.far_id: '.000 0000 0000 0000 0000 0000 0000 0001 = FAR ID: 1'
    'QER ID : Dynamic by CP 1':
        pfcp.ie_type: 'IE Type: QER ID (109)'
        pfcp.ie_len: 'IE Length: 4'
        pfcp.qer_id_flg: '0... .... .... .... .... .... .... .... = Allocation type: Dynamic by CP'
        pfcp.qer_id: '.000 0000 0000 0000 0000 0000 0000 0001 = QER ID: 1'
-   pfcp.ie_type: 'IE Type: Create PDR (1)'
    pfcp.ie_len: 'IE Length: 106'
    'PDR ID : 4':
        pfcp.ie_type: 'IE Type: PDR ID (56)'
        pfcp.ie_len: 'IE Length: 2'
        pfcp.pdr_id: 'Rule ID: 4'
    'Precedence : 1':
        pfcp.ie_type: 'IE Type: Precedence (29)'
        pfcp.ie_len: 'IE Length: 4'
        pfcp.precedence: 'Precedence: 1'
    'PDI : [Grouped IE]':
        pfcp.ie_type: 'IE Type: PDI (2)'
        pfcp.ie_len: 'IE Length: 75'
        'Source Interface : Access':
            pfcp.ie_type: 'IE Type: Source Interface (20)'
            pfcp.ie_len: 'IE Length: 1'
            pfcp.spare_h1: '0000 .... = Spare: 0'
            pfcp.source_interface: '.... 0000 = Source Interface: Access (0)'
        'F-TEID : ':
            pfcp.ie_type: 'IE Type: F-TEID (21)'
            pfcp.ie_len: 'IE Length: 2'
            pfcp.f_teid_flags:
                pfcp.fteid_flg.spare: '0000 .... = Spare: 0'
                pfcp.f_teid_flags.ch_id: '.... 1... = CHID (CHOOSE_ID): True'
                pfcp.f_teid_flags.ch: '.... .1.. = CH (CHOOSE): True'
                pfcp.f_teid_flags.v6: '.... ..1. = V6 (IPv6): Present'
                pfcp.f_teid_flags.v4: '.... ...1 = V4 (IPv4): Present'
            pfcp.f_teid.choose_id: 'Choose Id: 05'
        'Network Instance : edge':
            pfcp.ie_type: 'IE Type: Network Instance (22)'
            pfcp.ie_len: 'IE Length: 5'
            pfcp.network_instance: 'Network Instance: edge'
        'SDF Filter : ':
            pfcp.ie_type: 'IE Type: SDF Filter (23)'
            pfcp.ie_len: 'IE Length: 46'
            pfcp.sdf_filter_flags:
                pfcp.spare_h1: '0000 .... = Spare: 0'
                pfcp.sdf_filter.bid: '...0 .... = BID (Bidirectional SDF Filter): False'
                pfcp.sdf_filter.fl: '.... 0... = FL (Flow Label): False'
                pfcp.sdf_filter.spi: '.... .0.. = SPI (Security Parameter Index): False'
                pfcp.sdf_filter.ttc: '.... ..0. = TTC (ToS Traffic Class): False'
                pfcp.sdf_filter.fd: '.... ...1 = FD (Flow Description): True'
            pfcp.spare: 'Spare: 0'
            pfcp.flow_desc_len: 'Length of Flow Description: 42'
            pfcp.flow_desc: 'Flow Description: permit out 58 from ff02::2/128 to assigned'
        'QFI : ':
            pfcp.ie_type: 'IE Type: QFI (124)'
            pfcp.ie_len: 'IE Length: 1'
            pfcp.spare_b7_b6: '00.. .... = Spare: 0'
            pfcp.qfi_value: '.000 0001 = QFI: 0x01'
    'Outer Header Removal : GTP-U/UDP/IPv4':
        pfcp.ie_type: 'IE Type: Outer Header Removal (95)'
        pfcp.ie_len: 'IE Length: 1'
        pfcp.out_hdr_desc: 'Outer Header Removal Description: GTP-U/UDP/IPv4 (0)'
    'FAR ID : Dynamic by CP 3':
        pfcp.ie_type: 'IE Type: FAR ID (108)'
        pfcp.ie_len: 'IE Length: 4'
        pfcp.far_id_flg: '0... .... .... .... .... .... .... .... = Allocation type: Dynamic by CP'
        pfcp.far_id: '.000 0000 0000 0000 0000 0000 0000 0011 = FAR ID: 3'
'Create FAR : [Grouped IE]':
-   pfcp.ie_type: 'IE Type: Create FAR (3)'
    pfcp.ie_len: 'IE Length: 19'
    'FAR ID : Dynamic by CP 1':
        pfcp.ie_type: 'IE Type: FAR ID (108)'
        pfcp.ie_len: 'IE Length: 4'
        pfcp.far_id_flg: '0... .... .... .... .... .... .... .... = Allocation type: Dynamic by CP'
        pfcp.far_id: '.000 0000 0000 0000 0000 0000 0000 0001 = FAR ID: 1'
    'Apply Action : ':
        pfcp.ie_type: 'IE Type: Apply Action (44)'
        pfcp.ie_len: 'IE Length: 2'
        pfcp.apply_action_flags:
            pfcp.spare_b7_b5: '000. .... = Spare: 0'
            pfcp.apply_action.dupl: '...0 .... = DUPL (Duplicate): False'
            pfcp.apply_action.nocp: '.... 1... = NOCP (Notify the CP function): True'
            pfcp.apply_action.buff: '.... .1.. = BUFF (Buffer): True'
            pfcp.apply_action.forw: '.... ..0. = FORW (Forward): False'
            pfcp.apply_action.drop: '.... ...0 = DROP (Drop): False'
        IE data not decoded by WS yet:
            _ws.expert:
                pfcp.ie_data_not_decoded: IE data not decoded by WS yet
                _ws.expert.message: 'Message: IE data not decoded by WS yet'
                _ws.expert.severity: 'Severity level: Note'
                _ws.expert.group: 'Group: Undecoded'
    'BAR ID : 1':
        pfcp.ie_type: 'IE Type: BAR ID (88)'
        pfcp.ie_len: 'IE Length: 1'
        pfcp.bar_id: 'BAR ID: 1'
-   pfcp.ie_type: 'IE Type: Create FAR (3)'
    pfcp.ie_len: 'IE Length: 32'
    'FAR ID : Dynamic by CP 2':
        pfcp.ie_type: 'IE Type: FAR ID (108)'
        pfcp.ie_len: 'IE Length: 4'
        pfcp.far_id_flg: '0... .... .... .... .... .... .... .... = Allocation type: Dynamic by CP'
        pfcp.far_id: '.000 0000 0000 0000 0000 0000 0000 0010 = FAR ID: 2'
    'Apply Action : ':
        pfcp.ie_type: 'IE Type: Apply Action (44)'
        pfcp.ie_len: 'IE Length: 2'
        pfcp.apply_action_flags:
            pfcp.spare_b7_b5: '000. .... = Spare: 0'
            pfcp.apply_action.dupl: '...0 .... = DUPL (Duplicate): False'
            pfcp.apply_action.nocp: '.... 0... = NOCP (Notify the CP function): False'
            pfcp.apply_action.buff: '.... .0.. = BUFF (Buffer): False'
            pfcp.apply_action.forw: '.... ..1. = FORW (Forward): True'
            pfcp.apply_action.drop: '.... ...0 = DROP (Drop): False'
        IE data not decoded by WS yet:
            _ws.expert:
                pfcp.ie_data_not_decoded: IE data not decoded by WS yet
                _ws.expert.message: 'Message: IE data not decoded by WS yet'
                _ws.expert.severity: 'Severity level: Note'
                _ws.expert.group: 'Group: Undecoded'
    'Forwarding Parameters : [Grouped IE]':
        pfcp.ie_type: 'IE Type: Forwarding Parameters (4)'
        pfcp.ie_len: 'IE Length: 14'
        'Destination Interface : Core':
            pfcp.ie_type: 'IE Type: Destination Interface (42)'
            pfcp.ie_len: 'IE Length: 1'
            pfcp.spare_h1: '0000 .... = Spare: 0'
            pfcp.dst_interface: '.... 0001 = Interface: Core (1)'
        'Network Instance : edge':
            pfcp.ie_type: 'IE Type: Network Instance (22)'
            pfcp.ie_len: 'IE Length: 5'
            pfcp.network_instance: 'Network Instance: edge'
-   pfcp.ie_type: 'IE Type: Create FAR (3)'
    pfcp.ie_len: 'IE Length: 46'
    'FAR ID : Dynamic by CP 3':
        pfcp.ie_type: 'IE Type: FAR ID (108)'
        pfcp.ie_len: 'IE Length: 4'
        pfcp.far_id_flg: '0... .... .... .... .... .... .... .... = Allocation type: Dynamic by CP'
        pfcp.far_id: '.000 0000 0000 0000 0000 0000 0000 0011 = FAR ID: 3'
    'Apply Action : ':
        pfcp.ie_type: 'IE Type: Apply Action (44)'
        pfcp.ie_len: 'IE Length: 2'
        pfcp.apply_action_flags:
            pfcp.spare_b7_b5: '000. .... = Spare: 0'
            pfcp.apply_action.dupl: '...0 .... = DUPL (Duplicate): False'
            pfcp.apply_action.nocp: '.... 0... = NOCP (Notify the CP function): False'
            pfcp.apply_action.buff: '.... .0.. = BUFF (Buffer): False'
            pfcp.apply_action.forw: '.... ..1. = FORW (Forward): True'
            pfcp.apply_action.drop: '.... ...0 = DROP (Drop): False'
        IE data not decoded by WS yet:
            _ws.expert:
                pfcp.ie_data_not_decoded: IE data not decoded by WS yet
                _ws.expert.message: 'Message: IE data not decoded by WS yet'
                _ws.expert.severity: 'Severity level: Note'
                _ws.expert.group: 'Group: Undecoded'
    'Forwarding Parameters : [Grouped IE]':
        pfcp.ie_type: 'IE Type: Forwarding Parameters (4)'
        pfcp.ie_len: 'IE Length: 28'
        'Destination Interface : CP- Function':
            pfcp.ie_type: 'IE Type: Destination Interface (42)'
            pfcp.ie_len: 'IE Length: 1'
            pfcp.spare_h1: '0000 .... = Spare: 0'
            pfcp.dst_interface: '.... 0011 = Interface: CP- Function (3)'
        'Network Instance : edge':
            pfcp.ie_type: 'IE Type: Network Instance (22)'
            pfcp.ie_len: 'IE Length: 5'
            pfcp.network_instance: 'Network Instance: edge'
        'Outer Header Creation : ':
            pfcp.ie_type: 'IE Type: Outer Header Creation (84)'
            pfcp.ie_len: 'IE Length: 10'
            pfcp.outer_hdr_desc: 'Outer Header Creation Description: GTP-U/UDP/IPv4  (256)'
            pfcp.outer_hdr_creation.teid: 'TEID: 0x0000000b'
            pfcp.outer_hdr_creation.ipv4: 'IPv4 Address: 10.0.14.1'
'Create URR : [Grouped IE]':
-   pfcp.ie_type: 'IE Type: Create URR (6)'
    pfcp.ie_len: 'IE Length: 33'
    'URR ID : Dynamic by CP 1':
        pfcp.ie_type: 'IE Type: URR ID (81)'
        pfcp.ie_len: 'IE Length: 4'
        pfcp.urr_id_flg: '0... .... .... .... .... .... .... .... = Allocation type: Dynamic by CP'
        pfcp.urr_id: '.000 0000 0000 0000 0000 0000 0000 0001 = URR ID: 1'
    'Measurement Method : ':
        pfcp.ie_type: 'IE Type: Measurement Method (62)'
        pfcp.ie_len: 'IE Length: 1'
        pfcp.measurement_method_flags:
            pfcp.spare_b7_b3: '0000 0... = Spare: 0'
            pfcp.measurement_method_flags.event: '.... .0.. = EVENT (Event): False'
            pfcp.measurement_method_flags.volume: '.... ..1. = VOLUM (Volume): True'
            pfcp.measurement_method_flags.durat: '.... ...0 = DURAT (Duration): False'
    'Reporting Triggers : ':
        pfcp.ie_type: 'IE Type: Reporting Triggers (37)'
        pfcp.ie_len: 'IE Length: 3'
        pfcp.reporting_triggers_flags.liusa: '0... .... = LIUSA (Linked Usage Reporting): False'
        pfcp.reporting_triggers_flags.droth: '.0.. .... = DROTH (Dropped DL Traffic Threshold): False'
        pfcp.reporting_triggers_flags.stopt: '..0. .... = STOPT (Stop of Traffic): False'
        pfcp.reporting_triggers_flags.start: '...0 .... = START (Start of Traffic): False'
        pfcp.reporting_triggers_flags.quhti: '.... 0... = QUHTI (Quota Holding Time): False'
        pfcp.reporting_triggers_flags.timth: '.... .0.. = TIMTH (Time Threshold): False'
        pfcp.reporting_triggers_flags.volth: '.... ..1. = VOLTH (Volume Threshold): True'
        pfcp.reporting_triggers_flags.perio: '.... ...0 = PERIO (Periodic Reporting): False'
        pfcp.spare_b7_b5: '000. .... = Spare: 0'
        pfcp.reporting_triggers_flags.evequ: '..0. .... = EVEQU (Event Quota): False'
        pfcp.reporting_triggers_flags.eveth: '...0 .... = EVETH (Event Threshold): False'
        pfcp.reporting_triggers_flags.macar: '.... 0... = MACAR (MAC Addresses Reporting): False'
        pfcp.reporting_triggers_flags.envcl: '.... .0.. = ENVCL (Envelope Closure): False'
        pfcp.reporting_triggers_flags.timqu: '.... ..0. = TIMQU (Time Quota): False'
        pfcp.reporting_triggers_flags.volqu: '.... ...0 = VOLQU (Volume Quota): False'
        IE data not decoded by WS yet:
            _ws.expert:
                pfcp.ie_data_not_decoded: IE data not decoded by WS yet
                _ws.expert.message: 'Message: IE data not decoded by WS yet'
                _ws.expert.severity: 'Severity level: Note'
                _ws.expert.group: 'Group: Undecoded'
    'Volume Threshold : ':
        pfcp.ie_type: 'IE Type: Volume Threshold (31)'
        pfcp.ie_len: 'IE Length: 9'
        pfcp.volume_threshold:
            pfcp.spare_b7_b3: '0000 0... = Spare: 0'
            pfcp.volume_threshold_flags.dlvol: '.... .0.. = DLVOL: False'
            pfcp.volume_threshold_flags.ulvol: '.... ..0. = ULVOL: False'
            pfcp.volume_threshold_flags.tovol: '.... ...1 = TOVOL: True'
        pfcp.volume_threshold.tovol: 'Total Volume: 104857600'
'Create QER : [Grouped IE]':
-   pfcp.ie_type: 'IE Type: Create QER (7)'
    pfcp.ie_len: 'IE Length: 32'
    'QER ID : Dynamic by CP 1':
        pfcp.ie_type: 'IE Type: QER ID (109)'
        pfcp.ie_len: 'IE Length: 4'
        pfcp.qer_id_flg: '0... .... .... .... .... .... .... .... = Allocation type: Dynamic by CP'
        pfcp.qer_id: '.000 0000 0000 0000 0000 0000 0000 0001 = QER ID: 1'
    'Gate Status : ':
        pfcp.ie_type: 'IE Type: Gate Status (25)'
        pfcp.ie_len: 'IE Length: 1'
        pfcp.gate_status:
            pfcp.gate_status.ulgate: '.... ..00 = DL Gate: OPEN (0)'
    'MBR : ':
        pfcp.ie_type: 'IE Type: MBR (26)'
        pfcp.ie_len: 'IE Length: 10'
        pfcp.ul_mbr: 'UL MBR: 1073741'
        pfcp.dl_mbr: 'DL MBR: 1073741'
    'QFI : ':
        pfcp.ie_type: 'IE Type: QFI (124)'
        pfcp.ie_len: 'IE Length: 1'
        pfcp.spare_b7_b6: '00.. .... = Spare: 0'
        pfcp.qfi_value: '.000 0001 = QFI: 0x01'
'Create BAR : [Grouped IE]':
-   pfcp.ie_type: 'IE Type: Create BAR (85)'
    pfcp.ie_len: 'IE Length: 5'
    'BAR ID : 1':
        pfcp.ie_type: 'IE Type: BAR ID (88)'
        pfcp.ie_len: 'IE Length: 1'
        pfcp.bar_id: 'BAR ID: 1'
'PDN Type : IPv4':
-   pfcp.ie_type: 'IE Type: PDN Type (113)'
    pfcp.ie_len: 'IE Length: 1'
    pfcp.pdn_type: '.... .001 = PDN Type: IPv4 (1)'
pfcp.response_in: 'Response In: 2575'

end note

"10.0.17.1" -> "10.0.14.1": 2575, PFCP rsp.\nPFCP Session Establishment Response (51)

note right #cce0ff
**10.0.17.1 to 10.0.14.1**
pfcp.flags:
-   pfcp.version: '001. .... = Version: 1'
    pfcp.spare_b4: '...0 .... = Spare: 0'
    pfcp.spare_b3: '.... 0... = Spare: 0'
    pfcp.spare_b2: '.... .0.. = Spare: 0'
    pfcp.mp_flag: '.... ..0. = Message Priority (MP): False'
    pfcp.s: '.... ...1 = SEID (S): True'
pfcp.msg_type: 'Message Type: PFCP Session Establishment Response (51)'
pfcp.length: 'Length: 112'
pfcp.seid: 'SEID: 0x000000000000000b'
pfcp.seqno: 'Sequence Number: 231'
pfcp.spare_oct: 'Spare: 0'
'Node ID : IPv4 address: 10.0.17.1':
-   pfcp.ie_type: 'IE Type: Node ID (60)'
    pfcp.ie_len: 'IE Length: 5'
    pfcp.spare_h1: '0000 .... = Spare: 0'
    pfcp.node_id_type: '.... 0000 = Node ID Type: IPv4 address (0)'
    pfcp.node_id_ipv4: 'Node ID IPv4: 10.0.17.1'
'Cause : Request accepted(success)':
-   pfcp.ie_type: 'IE Type: Cause (19)'
    pfcp.ie_len: 'IE Length: 1'
    pfcp.cause: 'Cause: Request accepted(success) (1)'
'F-SEID : SEID: 0x000000000000000b, IPv4 10.0.17.1':
-   pfcp.ie_type: 'IE Type: F-SEID (57)'
    pfcp.ie_len: 'IE Length: 13'
    pfcp.f_seid_flags:
        pfcp.spare_b7: '0... .... = Spare: 0'
        pfcp.spare_b6: '.0.. .... = Spare: 0'
        pfcp.spare_b5: '..0. .... = Spare: 0'
        pfcp.spare_b4: '...0 .... = Spare: 0'
        pfcp.spare_b3: '.... 0... = Spare: 0'
        pfcp.spare_b2: '.... .0.. = Spare: 0'
        pfcp.f_seid_flags.v4: '.... ..1. = V4 (IPv4): Present'
        pfcp.f_seid_flags.v6: '.... ...0 = V6 (IPv6): Not Present'
    pfcp.seid: 'SEID: 0x000000000000000b'
    pfcp.f_seid.ipv4: 'IPv4 address: 10.0.17.1'
'Created PDR : [Grouped IE]':
-   pfcp.ie_type: 'IE Type: Created PDR (8)'
    pfcp.ie_len: 'IE Length: 19'
    'PDR ID : 2':
        pfcp.ie_type: 'IE Type: PDR ID (56)'
        pfcp.ie_len: 'IE Length: 2'
        pfcp.pdr_id: 'Rule ID: 2'
    'F-TEID : TEID: 0x0000002a, IPv4 10.0.17.1':
        pfcp.ie_type: 'IE Type: F-TEID (21)'
        pfcp.ie_len: 'IE Length: 9'
        pfcp.f_teid_flags:
            pfcp.fteid_flg.spare: '0000 .... = Spare: 0'
            pfcp.f_teid_flags.ch_id: '.... 0... = CHID (CHOOSE_ID): False'
            pfcp.f_teid_flags.ch: '.... .0.. = CH (CHOOSE): False'
            pfcp.f_teid_flags.v6: '.... ..0. = V6 (IPv6): Not Present'
            pfcp.f_teid_flags.v4: '.... ...1 = V4 (IPv4): Present'
        pfcp.f_teid.teid: 'TEID: 0x0000002a'
        pfcp.f_teid.ipv4_addr: 'IPv4 address: 10.0.17.1'
-   pfcp.ie_type: 'IE Type: Created PDR (8)'
    pfcp.ie_len: 'IE Length: 19'
    'PDR ID : 3':
        pfcp.ie_type: 'IE Type: PDR ID (56)'
        pfcp.ie_len: 'IE Length: 2'
        pfcp.pdr_id: 'Rule ID: 3'
    'F-TEID : TEID: 0x0000002b, IPv4 10.0.17.1':
        pfcp.ie_type: 'IE Type: F-TEID (21)'
        pfcp.ie_len: 'IE Length: 9'
        pfcp.f_teid_flags:
            pfcp.fteid_flg.spare: '0000 .... = Spare: 0'
            pfcp.f_teid_flags.ch_id: '.... 0... = CHID (CHOOSE_ID): False'
            pfcp.f_teid_flags.ch: '.... .0.. = CH (CHOOSE): False'
            pfcp.f_teid_flags.v6: '.... ..0. = V6 (IPv6): Not Present'
            pfcp.f_teid_flags.v4: '.... ...1 = V4 (IPv4): Present'
        pfcp.f_teid.teid: 'TEID: 0x0000002b'
        pfcp.f_teid.ipv4_addr: 'IPv4 address: 10.0.17.1'
-   pfcp.ie_type: 'IE Type: Created PDR (8)'
    pfcp.ie_len: 'IE Length: 19'
    'PDR ID : 4':
        pfcp.ie_type: 'IE Type: PDR ID (56)'
        pfcp.ie_len: 'IE Length: 2'
        pfcp.pdr_id: 'Rule ID: 4'
    'F-TEID : TEID: 0x0000002a, IPv4 10.0.17.1':
        pfcp.ie_type: 'IE Type: F-TEID (21)'
        pfcp.ie_len: 'IE Length: 9'
        pfcp.f_teid_flags:
            pfcp.fteid_flg.spare: '0000 .... = Spare: 0'
            pfcp.f_teid_flags.ch_id: '.... 0... = CHID (CHOOSE_ID): False'
            pfcp.f_teid_flags.ch: '.... .0.. = CH (CHOOSE): False'
            pfcp.f_teid_flags.v6: '.... ..0. = V6 (IPv6): Not Present'
            pfcp.f_teid_flags.v4: '.... ...1 = V4 (IPv4): Present'
        pfcp.f_teid.teid: 'TEID: 0x0000002a'
        pfcp.f_teid.ipv4_addr: 'IPv4 address: 10.0.17.1'
pfcp.response_to: 'Response To: 2574'
pfcp.response_time: 'Response Time: 0.000200397 seconds'

end note

"10.0.3.1" -> "10.0.2.15": 2580, NGAP PDUSessionResourceSetup (29),\nNAS DL NAS transport (0x68),\nNAS PDU session establishment accept (0xc2)

note right #c6ebc6
**10.0.3.1 to 10.0.2.15**
NGAP-PDU: 001d0080aa000004000a00020013005500020003004a008088004001527e02bc790fc7037e00680100432e0101c211000901000631310101ff01060b00010b00012905010a2d000c2201017900060120410101097b000f80000d0408080808000d040808040425050465646765120100202f0000040082000a0c400000003040000000008b000a01f00a0011010000002a00860001000088000700010000091c00006e400a0c400000003040000000
ngap.procedureCode: 'procedureCode: id-PDUSessionResourceSetup (29)'
per.enum_index: 'Enumerated Index: 0'
ngap.criticality: 'criticality: reject (0)'
per.open_type_length: 'Open Type Length: 170'
ngap.value_element:
-   ngap.PDUSessionResourceSetupRequest_element:
        per.extension_bit: '0... .... Extension Bit: False'
        per.sequence_of_length: 'Sequence-Of Length: 4'
        ngap.protocolIEs:
            'Item 0: id-AMF-UE-NGAP-ID':
                ngap.id: 'id: id-AMF-UE-NGAP-ID (10)'
                per.enum_index: 'Enumerated Index: 0'
                ngap.criticality: 'criticality: reject (0)'
                per.open_type_length: 'Open Type Length: 2'
                ngap.value_element:
                    ngap.AMF_UE_NGAP_ID: 'AMF-UE-NGAP-ID: 19'
            'Item 1: id-RAN-UE-NGAP-ID':
                ngap.id: 'id: id-RAN-UE-NGAP-ID (85)'
                per.enum_index: 'Enumerated Index: 0'
                ngap.criticality: 'criticality: reject (0)'
                per.open_type_length: 'Open Type Length: 2'
                ngap.value_element:
                    ngap.RAN_UE_NGAP_ID: 'RAN-UE-NGAP-ID: 3'
            'Item 2: id-PDUSessionResourceSetupListSUReq':
                ngap.id: 'id: id-PDUSessionResourceSetupListSUReq (74)'
                per.enum_index: 'Enumerated Index: 0'
                ngap.criticality: 'criticality: reject (0)'
                per.open_type_length: 'Open Type Length: 136'
                ngap.value_element:
                    per.sequence_of_length: 'Sequence-Of Length: 1'
                    ngap.PDUSessionResourceSetupListSUReq:
                        Item 0:
                            ngap.PDUSessionResourceSetupItemSUReq_element:
                                per.extension_bit: '0... .... Extension Bit: False'
                                per.optional_field_bit: '..0. .... Optional Field Bit: False (iE-Extensions is NOT present)'
                                ngap.pDUSessionID: 'pDUSessionID: 1'
                                per.octet_string_length: 'Octet String Length: 47'
                                ngap.pDUSessionNAS_PDU:
                                    nas-5gs:
                                        Security protected NAS 5GS message:
                                            nas_5gs.epd: 'Extended protocol discriminator: 5G mobility management messages (126)'
                                            nas_5gs.spare_half_octet: '0000 .... = Spare Half Octet: 0'
                                            nas_5gs.security_header_type: '.... 0010 = Security header type: Integrity protected and ciphered (2)'
                                            nas_5gs.msg_auth_code: 'Message authentication code: 0xbc790fc7'
                                            nas_5gs.seq_no: 'Sequence number: 3'
                                        Plain NAS 5GS Message:
                                            nas_5gs.epd: 'Extended protocol discriminator: 5G mobility management messages (126)'
                                            nas_5gs.spare_half_octet: '0000 .... = Spare Half Octet: 0'
                                            nas_5gs.security_header_type: '.... 0000 = Security header type: Plain NAS message, not security protected (0)'
                                            nas_5gs.mm.message_type: 'Message type: DL NAS transport (0x68)'
                                            Payload container type:
                                                nas_5gs.mm.pld_cont_type: '.... 0001 = Payload container type: N1 SM information (1)'
                                            Payload container:
                                                gsm_a.len: 'Length: 67'
                                                Plain NAS 5GS Message:
                                                    nas_5gs.epd: 'Extended protocol discriminator: 5G session management messages (46)'
                                                    nas_5gs.pdu_session_id: 'PDU session identity: PDU session identity value 1 (1)'
                                                    nas_5gs.proc_trans_id: 'Procedure transaction identity: 1'
                                                    nas_5gs.sm.message_type: 'Message type: PDU session establishment accept (0xc2)'
                                                    nas_5gs.sm.sel_sc_mode: '0001 .... = Selected SSC mode: SSC mode 1 (1)'
                                                    PDU session type - Selected PDU session type:
                                                        nas_5gs.sm.pdu_session_type: '.... 0001 = PDU session type: IPv4 (1)'
                                                    QoS rules - Authorized QoS rules:
                                                        gsm_a.len: 'Length: 9'
                                                        QoS rule 1:
                                                            nas_5gs.sm.qos_rule_id: 'QoS rule identifier: 1'
                                                            nas_5gs.sm.length: 'Length: 6'
                                                            nas_5gs.sm.rop: '001. .... = Rule operation code: Create new QoS rule (1)'
                                                            nas_5gs.sm.dqr: '...1 .... = DQR: The QoS rule is the default QoS rule'
                                                            nas_5gs.sm.nof_pkt_filters: '.... 0001 = Number of packet filters: 1'
                                                            Packet filter 1:
                                                                nas_5gs.sm.pkt_flt_dir: '..11 .... = Packet filter direction: Bidirectional (3)'
                                                                nas_5gs.sm.pkt_flt_id: '.... 0001 = Packet filter identifier: 1'
                                                                nas_5gs.sm.pf_len: 'Length: 1'
                                                                Packet filter component 1:
                                                                    nas_5gs.sm.pf_type: 'Packet filter component type: Match-all type (1)'
                                                            nas_5gs.sm.qos_rule_precedence: 'QoS rule precedence: 255'
                                                            nas_5gs.spare_b7: '0... .... = Spare: 0'
                                                            nas_5gs.spare_b6: '.0.. .... = Spare: 0'
                                                            nas_5gs.sm.qfi: '..00 0001 = Qos flow identifier: 1'
                                                    Session-AMBR:
                                                        gsm_a.len: 'Length: 6'
                                                        nas_5gs.sm.unit_for_session_ambr_dl: 'Unit for Session-AMBR for downlink: value is incremented in multiples of 1 Gbps (11)'
                                                        nas_5gs.sm.session_ambr_dl: 'Session-AMBR for downlink: 1 Gbps (1)'
                                                        nas_5gs.sm.unit_for_session_ambr_ul: 'Unit for Session-AMBR for uplink: value is incremented in multiples of 1 Gbps (11)'
                                                        nas_5gs.sm.session_ambr_ul: 'Session-AMBR for uplink: 1 Gbps (1)'
                                                    PDU address:
                                                        nas_5gs.sm.elem_id: 'Element ID: 0x29'
                                                        gsm_a.len: 'Length: 5'
                                                        nas_5gs.sm.pdu_ses_type: '.... 0001 = PDU session type: IPv4 (1)'
                                                        nas_5gs.sm.pdu_addr_inf_ipv4: 'PDU address information: 10.45.0.12'
                                                    S-NSSAI:
                                                        nas_5gs.common.elem_id: 'Element ID: 0x22'
                                                        gsm_a.len: 'Length: 1'
                                                        nas_5gs.mm.sst: 'Slice/service type (SST): 1'
                                                    QoS flow descriptions - Authorized:
                                                        nas_5gs.sm.elem_id: 'Element ID: 0x79'
                                                        gsm_a.len: 'Length: 6'
                                                        QoS flow description 1:
                                                            nas_5gs.sm.qfi: '..00 0001 = Qos flow identifier: 1'
                                                            nas_5gs.sm.hf_nas_5gs_sm_qos_des_flow_opt_code: '001. .... = Operation code: Create new QoS flow description (1)'
                                                            nas_5gs.sm.e: '.1.. .... = E bit: 1'
                                                            nas_5gs.sm.nof_params: '..00 0001 = Number of parameters: 1'
                                                            Parameter 1 - 5QI:
                                                                nas_5gs.sm.param_id: 'Parameter identifier: 5QI (1)'
                                                                nas_5gs.sm.param_len: 'Length: 1'
                                                                nas_5gs.sm.5qi: '5QI: 9'
                                                    Extended protocol configuration options:
                                                        nas_eps.esm.elem_id: 'Element ID: 0x7b'
                                                        gsm_a.len: 'Length: 15'
                                                        gsm_a.gm.sm.link_dir: 'Link direction: Network to MS (1)'
                                                        gsm_a.gm.sm.ext: '1... .... = Extension: True'
                                                        gsm_a.gm.configuration_protocol: '.... .000 = Configuration Protocol: PPP for use with IP PDP type or IP PDN type (0)'
                                                        gsm_a.gm.sm.pco_pid:
                                                        -   gsm_a.gm.sm.pco.length: 'Length: 0x04 (4)'
                                                            gsm_a.gm.sm.pco.dns.ipv4: 'IPv4: 8.8.8.8'
                                                        -   gsm_a.gm.sm.pco.length: 'Length: 0x04 (4)'
                                                            gsm_a.gm.sm.pco.dns.ipv4: 'IPv4: 8.8.4.4'
                                                    DNN:
                                                        nas_5gs.common.elem_id: 'Element ID: 0x25'
                                                        gsm_a.len: 'Length: 5'
                                                        nas_5gs.cmn.dnn: 'DNN: edge'
                                            PDU session identity 2 - PDU session ID:
                                                nas_5gs.mm.elem_id: 'Element ID: 0x12'
                                                nas_5gs.pdu_session_id: 'PDU session identity: PDU session identity value 1 (1)'
                                ngap.s_NSSAI_element:
                                    per.extension_bit: '0... .... Extension Bit: False'
                                    per.optional_field_bit: '..0. .... Optional Field Bit: False (iE-Extensions is NOT present)'
                                    ngap.sST: 'sST: 01'
                                ngap.pDUSessionResourceSetupRequestTransfer:
                                    ngap.PDUSessionResourceSetupRequestTransfer_element:
                                        per.extension_bit: '0... .... Extension Bit: False'
                                        per.sequence_of_length: 'Sequence-Of Length: 4'
                                        ngap.protocolIEs:
                                            'Item 0: id-PDUSessionAggregateMaximumBitRate':
                                                ngap.id: 'id: id-PDUSessionAggregateMaximumBitRate (130)'
                                                per.enum_index: 'Enumerated Index: 0'
                                                ngap.criticality: 'criticality: reject (0)'
                                                per.open_type_length: 'Open Type Length: 10'
                                                ngap.value_element:
                                                    ngap.PDUSessionAggregateMaximumBitRate_element:
                                                        per.extension_bit: '0... .... Extension Bit: False'
                                                        per.optional_field_bit: '.0.. .... Optional Field Bit: False (iE-Extensions is NOT present)'
                                                        per.extension_present_bit: '0... .... Extension Present Bit: False'
                                                        ngap.pDUSessionAggregateMaximumBitRateDL: 'pDUSessionAggregateMaximumBitRateDL: 1073741824bits/s'
                                                        ngap.pDUSessionAggregateMaximumBitRateUL: 'pDUSessionAggregateMaximumBitRateUL: 1073741824bits/s'
                                            'Item 1: id-UL-NGU-UP-TNLInformation':
                                                ngap.id: 'id: id-UL-NGU-UP-TNLInformation (139)'
                                                per.enum_index: 'Enumerated Index: 0'
                                                ngap.criticality: 'criticality: reject (0)'
                                                per.open_type_length: 'Open Type Length: 10'
                                                ngap.value_element:
                                                    per.choice_index: 'Choice Index: 0'
                                                    ngap.UPTransportLayerInformation:
                                                        ngap.gTPTunnel_element:
                                                            per.extension_bit: '.0.. .... Extension Bit: False'
                                                            per.optional_field_bit: '..0. .... Optional Field Bit: False (iE-Extensions is NOT present)'
                                                            per.extension_present_bit: '...0 .... Extension Present Bit: False'
                                                            per.bit_string_length: 'Bit String Length: 32'
                                                            ngap.transportLayerAddress:
                                                                ngap.TransportLayerAddressIPv4: 'TransportLayerAddress (IPv4): 10.0.17.1'
                                                            ngap.gTP_TEID: 'gTP-TEID: 0000002a'
                                            'Item 2: id-PDUSessionType':
                                                ngap.id: 'id: id-PDUSessionType (134)'
                                                per.enum_index: 'Enumerated Index: 0'
                                                ngap.criticality: 'criticality: reject (0)'
                                                per.open_type_length: 'Open Type Length: 1'
                                                ngap.value_element:
                                                    per.extension_present_bit: '0... .... Extension Present Bit: False'
                                                    per.enum_index: 'Enumerated Index: 0'
                                                    ngap.PDUSessionType: 'PDUSessionType: ipv4 (0)'
                                            'Item 3: id-QosFlowSetupRequestList':
                                                ngap.id: 'id: id-QosFlowSetupRequestList (136)'
                                                per.enum_index: 'Enumerated Index: 0'
                                                ngap.criticality: 'criticality: reject (0)'
                                                per.open_type_length: 'Open Type Length: 7'
                                                ngap.value_element:
                                                    per.sequence_of_length: 'Sequence-Of Length: 1'
                                                    ngap.QosFlowSetupRequestList:
                                                        Item 0:
                                                            ngap.QosFlowSetupRequestItem_element:
                                                                per.extension_bit: '.... ..0. Extension Bit: False'
                                                                per.optional_field_bit: '0... .... Optional Field Bit: False (iE-Extensions is NOT present)'
                                                                per.extension_present_bit: '.0.. .... Extension Present Bit: False'
                                                                ngap.qosFlowIdentifier: 'qosFlowIdentifier: 1'
                                                                ngap.qosFlowLevelQosParameters_element:
                                                                    per.extension_bit: '0... .... Extension Bit: False'
                                                                    per.optional_field_bit: '.... 0... Optional Field Bit: False (iE-Extensions is NOT present)'
                                                                    per.choice_index: 'Choice Index: 0'
                                                                    ngap.qosCharacteristics:
                                                                        ngap.nonDynamic5QI_element:
                                                                            per.extension_bit: '.... ...0 Extension Bit: False'
                                                                            per.optional_field_bit: '...0 .... Optional Field Bit: False (iE-Extensions is NOT present)'
                                                                            per.extension_present_bit: '.... 0... Extension Present Bit: False'
                                                                            ngap.fiveQI: 'fiveQI: 9'
                                                                    ngap.allocationAndRetentionPriority_element:
                                                                        per.extension_bit: '0... .... Extension Bit: False'
                                                                        per.optional_field_bit: '.0.. .... Optional Field Bit: False (iE-Extensions is NOT present)'
                                                                        ngap.priorityLevelARP: 'priorityLevelARP: 8'
                                                                        per.extension_present_bit: '0... .... Extension Present Bit: False'
                                                                        per.enum_index: 'Enumerated Index: 0'
                                                                        ngap.pre_emptionCapability: 'pre-emptionCapability: shall-not-trigger-pre-emption (0)'
                                                                        ngap.pre_emptionVulnerability: 'pre-emptionVulnerability: not-pre-emptable (0)'
            'Item 3: id-UEAggregateMaximumBitRate':
                ngap.id: 'id: id-UEAggregateMaximumBitRate (110)'
                per.enum_index: 'Enumerated Index: 1'
                ngap.criticality: 'criticality: ignore (1)'
                per.open_type_length: 'Open Type Length: 10'
                ngap.value_element:
                    ngap.UEAggregateMaximumBitRate_element:
                        per.extension_bit: '0... .... Extension Bit: False'
                        per.optional_field_bit: '.0.. .... Optional Field Bit: False (iE-Extensions is NOT present)'
                        per.extension_present_bit: '0... .... Extension Present Bit: False'
                        ngap.uEAggregateMaximumBitRateDL: 'uEAggregateMaximumBitRateDL: 1073741824bits/s'
                        ngap.uEAggregateMaximumBitRateUL: 'uEAggregateMaximumBitRateUL: 1073741824bits/s'

end note

"10.0.2.15" -> "10.0.3.1": 2585, NGAP PDUSessionResourceSetup (29)

note right #c6ebc6
**10.0.2.15 to 10.0.3.1**
NGAP-PDU: 201d0024000003000a40020013005540020003004b40110000010d0003e00a00020f000000030001
ngap.procedureCode: 'procedureCode: id-PDUSessionResourceSetup (29)'
per.enum_index: 'Enumerated Index: 0'
ngap.criticality: 'criticality: reject (0)'
per.open_type_length: 'Open Type Length: 36'
ngap.value_element:
-   ngap.PDUSessionResourceSetupResponse_element:
        per.extension_bit: '0... .... Extension Bit: False'
        per.sequence_of_length: 'Sequence-Of Length: 3'
        ngap.protocolIEs:
            'Item 0: id-AMF-UE-NGAP-ID':
                ngap.id: 'id: id-AMF-UE-NGAP-ID (10)'
                per.enum_index: 'Enumerated Index: 1'
                ngap.criticality: 'criticality: ignore (1)'
                per.open_type_length: 'Open Type Length: 2'
                ngap.value_element:
                    ngap.AMF_UE_NGAP_ID: 'AMF-UE-NGAP-ID: 19'
            'Item 1: id-RAN-UE-NGAP-ID':
                ngap.id: 'id: id-RAN-UE-NGAP-ID (85)'
                per.enum_index: 'Enumerated Index: 1'
                ngap.criticality: 'criticality: ignore (1)'
                per.open_type_length: 'Open Type Length: 2'
                ngap.value_element:
                    ngap.RAN_UE_NGAP_ID: 'RAN-UE-NGAP-ID: 3'
            'Item 2: id-PDUSessionResourceSetupListSURes':
                ngap.id: 'id: id-PDUSessionResourceSetupListSURes (75)'
                per.enum_index: 'Enumerated Index: 1'
                ngap.criticality: 'criticality: ignore (1)'
                per.open_type_length: 'Open Type Length: 17'
                ngap.value_element:
                    per.sequence_of_length: 'Sequence-Of Length: 1'
                    ngap.PDUSessionResourceSetupListSURes:
                        Item 0:
                            ngap.PDUSessionResourceSetupItemSURes_element:
                                per.extension_bit: '0... .... Extension Bit: False'
                                per.optional_field_bit: '.0.. .... Optional Field Bit: False (iE-Extensions is NOT present)'
                                ngap.pDUSessionID: 'pDUSessionID: 1'
                                per.octet_string_length: 'Octet String Length: 13'
                                ngap.pDUSessionResourceSetupResponseTransfer:
                                    ngap.PDUSessionResourceSetupResponseTransfer_element:
                                        per.extension_bit: '0... .... Extension Bit: False'
                                        per.optional_field_bit: '.... 0... Optional Field Bit: False (iE-Extensions is NOT present)'
                                        ngap.dLQosFlowPerTNLInformation_element:
                                            per.extension_bit: '.... .0.. Extension Bit: False'
                                            per.optional_field_bit: '.... ..0. Optional Field Bit: False (iE-Extensions is NOT present)'
                                            per.choice_index: 'Choice Index: 0'
                                            ngap.uPTransportLayerInformation:
                                                ngap.gTPTunnel_element:
                                                    per.extension_bit: '0... .... Extension Bit: False'
                                                    per.optional_field_bit: '.0.. .... Optional Field Bit: False (iE-Extensions is NOT present)'
                                                    per.extension_present_bit: '..0. .... Extension Present Bit: False'
                                                    per.bit_string_length: 'Bit String Length: 32'
                                                    ngap.transportLayerAddress:
                                                        ngap.TransportLayerAddressIPv4: 'TransportLayerAddress (IPv4): 10.0.2.15'
                                                    ngap.gTP_TEID: 'gTP-TEID: 00000003'
                                            per.sequence_of_length: 'Sequence-Of Length: 1'
                                            ngap.associatedQosFlowList:
                                                Item 0:
                                                    ngap.AssociatedQosFlowItem_element:
                                                        per.extension_bit: '.... ..0. Extension Bit: False'
                                                        per.optional_field_bit: '0... .... Optional Field Bit: False (iE-Extensions is NOT present)'
                                                        per.extension_present_bit: '.0.. .... Extension Present Bit: False'
                                                        ngap.qosFlowIdentifier: 'qosFlowIdentifier: 1'

end note

"10.0.14.1" -> "10.0.17.1": 2589, PFCP req.\nPFCP Session Modification Request (52)

note right #80b3ff
**10.0.14.1 to 10.0.17.1**
pfcp.flags:
-   pfcp.version: '001. .... = Version: 1'
    pfcp.spare_b4: '...0 .... = Spare: 0'
    pfcp.spare_b3: '.... 0... = Spare: 0'
    pfcp.spare_b2: '.... .0.. = Spare: 0'
    pfcp.mp_flag: '.... ..0. = Message Priority (MP): False'
    pfcp.s: '.... ...1 = SEID (S): True'
pfcp.msg_type: 'Message Type: PFCP Session Modification Request (52)'
pfcp.length: 'Length: 62'
pfcp.seid: 'SEID: 0x000000000000000b'
pfcp.seqno: 'Sequence Number: 232'
pfcp.spare_oct: 'Spare: 0'
'Update FAR : [Grouped IE]':
-   pfcp.ie_type: 'IE Type: Update FAR (10)'
    pfcp.ie_len: 'IE Length: 46'
    'FAR ID : Dynamic by CP 1':
        pfcp.ie_type: 'IE Type: FAR ID (108)'
        pfcp.ie_len: 'IE Length: 4'
        pfcp.far_id_flg: '0... .... .... .... .... .... .... .... = Allocation type: Dynamic by CP'
        pfcp.far_id: '.000 0000 0000 0000 0000 0000 0000 0001 = FAR ID: 1'
    'Apply Action : ':
        pfcp.ie_type: 'IE Type: Apply Action (44)'
        pfcp.ie_len: 'IE Length: 2'
        pfcp.apply_action_flags:
            pfcp.spare_b7_b5: '000. .... = Spare: 0'
            pfcp.apply_action.dupl: '...0 .... = DUPL (Duplicate): False'
            pfcp.apply_action.nocp: '.... 0... = NOCP (Notify the CP function): False'
            pfcp.apply_action.buff: '.... .0.. = BUFF (Buffer): False'
            pfcp.apply_action.forw: '.... ..1. = FORW (Forward): True'
            pfcp.apply_action.drop: '.... ...0 = DROP (Drop): False'
        IE data not decoded by WS yet:
            _ws.expert:
                pfcp.ie_data_not_decoded: IE data not decoded by WS yet
                _ws.expert.message: 'Message: IE data not decoded by WS yet'
                _ws.expert.severity: 'Severity level: Note'
                _ws.expert.group: 'Group: Undecoded'
    'Update Forwarding Parameters : [Grouped IE]':
        pfcp.ie_type: 'IE Type: Update Forwarding Parameters (11)'
        pfcp.ie_len: 'IE Length: 28'
        'Destination Interface : Access':
            pfcp.ie_type: 'IE Type: Destination Interface (42)'
            pfcp.ie_len: 'IE Length: 1'
            pfcp.spare_h1: '0000 .... = Spare: 0'
            pfcp.dst_interface: '.... 0000 = Interface: Access (0)'
        'Network Instance : edge':
            pfcp.ie_type: 'IE Type: Network Instance (22)'
            pfcp.ie_len: 'IE Length: 5'
            pfcp.network_instance: 'Network Instance: edge'
        'Outer Header Creation : ':
            pfcp.ie_type: 'IE Type: Outer Header Creation (84)'
            pfcp.ie_len: 'IE Length: 10'
            pfcp.outer_hdr_desc: 'Outer Header Creation Description: GTP-U/UDP/IPv4  (256)'
            pfcp.outer_hdr_creation.teid: 'TEID: 0x00000003'
            pfcp.outer_hdr_creation.ipv4: 'IPv4 Address: 10.0.2.15'
pfcp.response_in: 'Response In: 2590'

end note

"10.0.17.1" -> "10.0.14.1": 2590, PFCP rsp.\nPFCP Session Modification Response (53)

note right #cce0ff
**10.0.17.1 to 10.0.14.1**
pfcp.flags:
-   pfcp.version: '001. .... = Version: 1'
    pfcp.spare_b4: '...0 .... = Spare: 0'
    pfcp.spare_b3: '.... 0... = Spare: 0'
    pfcp.spare_b2: '.... .0.. = Spare: 0'
    pfcp.mp_flag: '.... ..0. = Message Priority (MP): False'
    pfcp.s: '.... ...1 = SEID (S): True'
pfcp.msg_type: 'Message Type: PFCP Session Modification Response (53)'
pfcp.length: 'Length: 17'
pfcp.seid: 'SEID: 0x000000000000000b'
pfcp.seqno: 'Sequence Number: 232'
pfcp.spare_oct: 'Spare: 0'
'Cause : Request accepted(success)':
-   pfcp.ie_type: 'IE Type: Cause (19)'
    pfcp.ie_len: 'IE Length: 1'
    pfcp.cause: 'Cause: Request accepted(success) (1)'
pfcp.response_to: 'Response To: 2589'
pfcp.response_time: 'Response Time: 0.000102543 seconds'

end note

"10.0.2.15" -> "10.0.3.1": 2594, NGAP InitialUEMessage (15),\nNAS Registration request (0x41)

note right #8cd98c
**10.0.2.15 to 10.0.3.1**
NGAP-PDU: 000f40480000050055000200040026001a197e004179000d0109f1070000000000000000402e04f0f0f0f0007900135009f107000000010009f107000001e74c1dd3005a4001180070400100
ngap.procedureCode: 'procedureCode: id-InitialUEMessage (15)'
per.enum_index: 'Enumerated Index: 1'
ngap.criticality: 'criticality: ignore (1)'
per.open_type_length: 'Open Type Length: 72'
ngap.value_element:
-   ngap.InitialUEMessage_element:
        per.extension_bit: '0... .... Extension Bit: False'
        per.sequence_of_length: 'Sequence-Of Length: 5'
        ngap.protocolIEs:
            'Item 0: id-RAN-UE-NGAP-ID':
                ngap.id: 'id: id-RAN-UE-NGAP-ID (85)'
                per.enum_index: 'Enumerated Index: 0'
                ngap.criticality: 'criticality: reject (0)'
                per.open_type_length: 'Open Type Length: 2'
                ngap.value_element:
                    ngap.RAN_UE_NGAP_ID: 'RAN-UE-NGAP-ID: 4'
            'Item 1: id-NAS-PDU':
                ngap.id: 'id: id-NAS-PDU (38)'
                per.enum_index: 'Enumerated Index: 0'
                ngap.criticality: 'criticality: reject (0)'
                per.open_type_length: 'Open Type Length: 26'
                ngap.value_element:
                    per.octet_string_length: 'Octet String Length: 25'
                    ngap.NAS_PDU:
                        nas-5gs:
                            Plain NAS 5GS Message:
                                nas_5gs.epd: 'Extended protocol discriminator: 5G mobility management messages (126)'
                                nas_5gs.spare_half_octet: '0000 .... = Spare Half Octet: 0'
                                nas_5gs.security_header_type: '.... 0000 = Security header type: Plain NAS message, not security protected (0)'
                                nas_5gs.mm.message_type: 'Message type: Registration request (0x41)'
                                5GS registration type:
                                    nas_5gs.mm.for: '.... 1... = Follow-On Request bit (FOR): Follow-on request pending'
                                    nas_5gs.mm.5gs_reg_type: '.... .001 = 5GS registration type: initial registration (1)'
                                NAS key set identifier:
                                    nas_5gs.mm.tsc.h1: '0... .... = Type of security context flag (TSC): Native security context (for KSIAMF)'
                                    nas_5gs.mm.nas_key_set_id.h1: '.111 .... = NAS key set identifier: 7'
                                5GS mobile identity:
                                    gsm_a.len: 'Length: 13'
                                    nas_5gs.spare_b7: '0... .... = Spare: 0'
                                    nas_5gs.mm.suci.supi_fmt: '.000 .... = SUPI format: IMSI (0)'
                                    nas_5gs.spare_b3: '.... 0... = Spare: 0'
                                    nas_5gs.mm.type_id: '.... .001 = Type of identity: SUCI (1)'
                                    e212.mcc: 'Mobile Country Code (MCC): International Mobile, shared code (901)'
                                    e212.mnc: 'Mobile Network Code (MNC): Unknown (70)'
                                    nas_5gs.mm.suci.routing_indicator: 'Routing indicator: 0000'
                                    nas_5gs.mm.suci.scheme_id: '.... 0000 = Protection scheme Id: NULL scheme (0)'
                                    nas_5gs.mm.suci.pki: 'Home network public key identifier: 0'
                                    nas_5gs.mm.suci.supi_null_scheme: 'Scheme output: 0000000004'
                                UE security capability:
                                    nas_5gs.mm.elem_id: 'Element ID: 0x2e'
                                    gsm_a.len: 'Length: 4'
                                    nas_5gs.mm.5g_ea0: '1... .... = 5G-EA0: Supported'
                                    nas_5gs.mm.128_5g_ea1: '.1.. .... = 128-5G-EA1: Supported'
                                    nas_5gs.mm.128_5g_ea2: '..1. .... = 128-5G-EA2: Supported'
                                    nas_5gs.mm.128_5g_ea3: '...1 .... = 128-5G-EA3: Supported'
                                    nas_5gs.mm.5g_ea4: '.... 0... = 5G-EA4: Not supported'
                                    nas_5gs.mm.5g_ea5: '.... .0.. = 5G-EA5: Not supported'
                                    nas_5gs.mm.5g_ea6: '.... ..0. = 5G-EA6: Not supported'
                                    nas_5gs.mm.5g_ea7: '.... ...0 = 5G-EA7: Not supported'
                                    nas_5gs.mm.ia0: '1... .... = 5G-IA0: Supported'
                                    nas_5gs.mm.5g_128_ia1: '.1.. .... = 128-5G-IA1: Supported'
                                    nas_5gs.mm.5g_128_ia2: '..1. .... = 128-5G-IA2: Supported'
                                    nas_5gs.mm.5g_128_ia4: '.... 0... = 5G-IA4: Not supported'
                                    nas_5gs.mm.5g_ia5: '.... .0.. = 5G-IA5: Not supported'
                                    nas_5gs.mm.5g_ia6: '.... ..0. = 5G-IA6: Not supported'
                                    nas_5gs.mm.5g_ia7: '.... ...0 = 5G-IA7: Not supported'
                                    nas_5gs.mm.eea0: '1... .... = EEA0: Supported'
                                    nas_5gs.mm.128eea1: '.1.. .... = 128-EEA1: Supported'
                                    nas_5gs.mm.128eea2: '..1. .... = 128-EEA2: Supported'
                                    nas_5gs.mm.eea3: '...1 .... = 128-EEA3: Supported'
                                    nas_5gs.mm.eea4: '.... 0... = EEA4: Not supported'
                                    nas_5gs.mm.eea5: '.... .0.. = EEA5: Not supported'
                                    nas_5gs.mm.eea6: '.... ..0. = EEA6: Not supported'
                                    nas_5gs.mm.eea7: '.... ...0 = EEA7: Not supported'
                                    nas_5gs.mm.eia0: '1... .... = EIA0: Supported'
                                    nas_5gs.mm.128eia1: '.1.. .... = 128-EIA1: Supported'
                                    nas_5gs.mm.128eia2: '..1. .... = 128-EIA2: Supported'
                                    nas_5gs.mm.eia3: '...1 .... = 128-EIA3: Supported'
                                    nas_5gs.mm.eia4: '.... 0... = EIA4: Not supported'
                                    nas_5gs.mm.eia5: '.... .0.. = EIA5: Not supported'
                                    nas_5gs.mm.eia6: '.... ..0. = EIA6: Not supported'
                                    nas_5gs.mm.eia7: '.... ...0 = EIA7: Not supported'
            'Item 2: id-UserLocationInformation':
                ngap.id: 'id: id-UserLocationInformation (121)'
                per.enum_index: 'Enumerated Index: 0'
                ngap.criticality: 'criticality: reject (0)'
                per.open_type_length: 'Open Type Length: 19'
                ngap.value_element:
                    per.choice_index: 'Choice Index: 1'
                    ngap.UserLocationInformation:
                        ngap.userLocationInformationNR_element:
                            per.extension_bit: '..0. .... Extension Bit: False'
                            per.optional_field_bit: '.... 0... Optional Field Bit: False (iE-Extensions is NOT present)'
                            ngap.nR_CGI_element:
                                per.extension_bit: '.... .0.. Extension Bit: False'
                                per.optional_field_bit: '.... ..0. Optional Field Bit: False (iE-Extensions is NOT present)'
                                ngap.pLMNIdentity:
                                    e212.mcc: 'Mobile Country Code (MCC): International Mobile, shared code (901)'
                                    e212.mnc: 'Mobile Network Code (MNC): Unknown (70)'
                                ngap.NRCellIdentity: 'nRCellIdentity: 0x0000000010'
                            ngap.tAI_element:
                                per.extension_bit: '.... 0... Extension Bit: False'
                                per.optional_field_bit: '.... .0.. Optional Field Bit: False (iE-Extensions is NOT present)'
                                ngap.pLMNIdentity:
                                    e212.mcc: 'Mobile Country Code (MCC): International Mobile, shared code (901)'
                                    e212.mnc: 'Mobile Network Code (MNC): Unknown (70)'
                                ngap.tAC: 'tAC: 1 (0x000001)'
                            ngap.timeStamp: 'timeStamp: e74c1dd3 (Dec 20, 2022 11:41:07 UTC)'
            'Item 3: id-RRCEstablishmentCause':
                ngap.id: 'id: id-RRCEstablishmentCause (90)'
                per.enum_index: 'Enumerated Index: 1'
                ngap.criticality: 'criticality: ignore (1)'
                per.open_type_length: 'Open Type Length: 1'
                ngap.value_element:
                    per.extension_present_bit: '0... .... Extension Present Bit: False'
                    per.enum_index: 'Enumerated Index: 3'
                    ngap.RRCEstablishmentCause: 'RRCEstablishmentCause: mo-Signalling (3)'
            'Item 4: id-UEContextRequest':
                ngap.id: 'id: id-UEContextRequest (112)'
                per.enum_index: 'Enumerated Index: 1'
                ngap.criticality: 'criticality: ignore (1)'
                per.open_type_length: 'Open Type Length: 1'
                ngap.value_element:
                    per.extension_present_bit: '0... .... Extension Present Bit: False'
                    per.enum_index: 'Enumerated Index: 0'
                    ngap.UEContextRequest: 'UEContextRequest: requested (0)'

end note

@enduml
