<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="454px" preserveAspectRatio="none" style="width:629px;height:454px;" version="1.1" viewBox="0 0 629 454" width="629px" zoomAndPan="magnify"><defs/><g><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="59" x2="59" y1="34.2969" y2="414.4219"/><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="142" x2="142" y1="34.2969" y2="414.4219"/><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="443" x2="443" y1="34.2969" y2="414.4219"/><rect fill="#E6E6E6" height="30.2969" style="stroke: #FFFFFF; stroke-width: 1.5;" width="103" x="8" y="3"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="89" x="15" y="22.9951">Malicious_UE</text><rect fill="#E6E6E6" height="30.2969" style="stroke: #FFFFFF; stroke-width: 1.5;" width="103" x="8" y="413.4219"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="89" x="15" y="433.417">Malicious_UE</text><rect fill="#E6E6E6" height="30.2969" style="stroke: #FFFFFF; stroke-width: 1.5;" width="43" x="121" y="3"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="29" x="128" y="22.9951">gNB</text><rect fill="#E6E6E6" height="30.2969" style="stroke: #FFFFFF; stroke-width: 1.5;" width="43" x="121" y="413.4219"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="29" x="128" y="433.417">gNB</text><rect fill="#E6E6E6" height="30.2969" style="stroke: #FFFFFF; stroke-width: 1.5;" width="41" x="423" y="3"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="27" x="430" y="22.9951">UPF</text><rect fill="#E6E6E6" height="30.2969" style="stroke: #FFFFFF; stroke-width: 1.5;" width="41" x="423" y="413.4219"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="27" x="430" y="433.417">UPF</text><polygon fill="#000000" points="431.5,76.5625,441.5,80.5625,431.5,84.5625,435.5,80.5625" style="stroke: #000000; stroke-width: 1.0;"/><line style="stroke: #000000; stroke-width: 1.0;" x1="142.5" x2="437.5" y1="80.5625" y2="80.5625"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="124" x="149.5" y="60.3638">4, GTP&lt;PFCP req.&gt;</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="229" x="149.5" y="75.4966">PFCP Association Setup Request (5)</text><path d="M448,53.8633 L448,78.8633 L554,78.8633 L554,63.8633 L544,53.8633 L448,53.8633 " fill="#03B5AA" style="stroke: #FFFFFF; stroke-width: 1.0;"/><path d="M544,53.8633 L544,63.8633 L554,63.8633 L544,53.8633 " fill="#03B5AA" style="stroke: #FFFFFF; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="85" x="454" y="70.9302">gNB to UPF</text><polygon fill="#000000" points="431.5,120.8281,441.5,124.8281,431.5,128.8281,435.5,124.8281" style="stroke: #000000; stroke-width: 1.0;"/><line style="stroke: #000000; stroke-width: 1.0;" x1="59.5" x2="437.5" y1="124.8281" y2="124.8281"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="77" x="66.5" y="104.6294">5, PFCP req.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="229" x="66.5" y="119.7622">PFCP Association Setup Request (5)</text><path d="M448,98.1289 L448,123.1289 L617,123.1289 L617,108.1289 L607,98.1289 L448,98.1289 " fill="#FFC2D9" style="stroke: #FFFFFF; stroke-width: 1.0;"/><path d="M607,98.1289 L607,108.1289 L617,108.1289 L607,98.1289 " fill="#FFC2D9" style="stroke: #FFFFFF; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="148" x="454" y="115.1958">Malicious_UE to UPF</text><polygon fill="#000000" points="70.5,165.0938,60.5,169.0938,70.5,173.0938,66.5,169.0938" style="stroke: #000000; stroke-width: 1.0;"/><line style="stroke: #000000; stroke-width: 1.0;" x1="64.5" x2="442.5" y1="169.0938" y2="169.0938"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="76" x="76.5" y="148.895">6, PFCP rsp.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="239" x="76.5" y="164.0278">PFCP Association Setup Response (6)</text><path d="M448,142.3945 L448,167.3945 L617,167.3945 L617,152.3945 L607,142.3945 L448,142.3945 " fill="#FFEAC2" style="stroke: #FFFFFF; stroke-width: 1.0;"/><path d="M607,142.3945 L607,152.3945 L617,152.3945 L607,142.3945 " fill="#FFEAC2" style="stroke: #FFFFFF; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="148" x="454" y="159.4614">UPF to Malicious_UE</text><polygon fill="#000000" points="153.5,209.3594,143.5,213.3594,153.5,217.3594,149.5,213.3594" style="stroke: #000000; stroke-width: 1.0;"/><line style="stroke: #000000; stroke-width: 1.0;" x1="147.5" x2="442.5" y1="213.3594" y2="213.3594"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="158" x="159.5" y="193.1606">7, PFCP,GTP&lt;ICMP&gt; rsp.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="239" x="159.5" y="208.2935">PFCP Association Setup Response (6)</text><path d="M448,186.6602 L448,211.6602 L554,211.6602 L554,196.6602 L544,186.6602 L448,186.6602 " fill="#D7FEFC" style="stroke: #FFFFFF; stroke-width: 1.0;"/><path d="M544,186.6602 L544,196.6602 L554,196.6602 L544,186.6602 " fill="#D7FEFC" style="stroke: #FFFFFF; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="85" x="454" y="203.7271">UPF to gNB</text><polygon fill="#000000" points="431.5,253.625,441.5,257.625,431.5,261.625,435.5,257.625" style="stroke: #000000; stroke-width: 1.0;"/><line style="stroke: #000000; stroke-width: 1.0;" x1="142.5" x2="437.5" y1="257.625" y2="257.625"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="124" x="149.5" y="237.4263">8, GTP&lt;PFCP req.&gt;</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="229" x="149.5" y="252.5591">PFCP Association Setup Request (5)</text><path d="M448,230.9258 L448,255.9258 L554,255.9258 L554,240.9258 L544,230.9258 L448,230.9258 " fill="#03B5AA" style="stroke: #FFFFFF; stroke-width: 1.0;"/><path d="M544,230.9258 L544,240.9258 L554,240.9258 L544,230.9258 " fill="#03B5AA" style="stroke: #FFFFFF; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="85" x="454" y="247.9927">gNB to UPF</text><polygon fill="#000000" points="431.5,297.8906,441.5,301.8906,431.5,305.8906,435.5,301.8906" style="stroke: #000000; stroke-width: 1.0;"/><line style="stroke: #000000; stroke-width: 1.0;" x1="59.5" x2="437.5" y1="301.8906" y2="301.8906"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="77" x="66.5" y="281.6919">9, PFCP req.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="267" x="66.5" y="296.8247">PFCP Session Establishment Request (50)</text><path d="M448,275.1914 L448,300.1914 L617,300.1914 L617,285.1914 L607,275.1914 L448,275.1914 " fill="#FFC2D9" style="stroke: #FFFFFF; stroke-width: 1.0;"/><path d="M607,275.1914 L607,285.1914 L617,285.1914 L607,275.1914 " fill="#FFC2D9" style="stroke: #FFFFFF; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="148" x="454" y="292.2583">Malicious_UE to UPF</text><polygon fill="#000000" points="70.5,345.1563,60.5,349.1563,70.5,353.1563,66.5,349.1563" style="stroke: #000000; stroke-width: 1.0;"/><line style="stroke: #000000; stroke-width: 1.0;" x1="64.5" x2="442.5" y1="349.1563" y2="349.1563"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="84" x="76.5" y="328.9575">10, PFCP rsp.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="277" x="76.5" y="344.0903">PFCP Session Establishment Response (51)</text><path d="M448,314.8906 L448,354.8906 L617,354.8906 L617,324.8906 L607,314.8906 L448,314.8906 " fill="#FFEAC2" style="stroke: #FFFFFF; stroke-width: 1.0;"/><path d="M607,314.8906 L607,324.8906 L617,324.8906 L607,314.8906 " fill="#FFEAC2" style="stroke: #FFFFFF; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="148" x="454" y="331.9575">UPF to Malicious_UE</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="44" x="454" y="347.0903">Accept</text><polygon fill="#000000" points="153.5,392.4219,143.5,396.4219,153.5,400.4219,149.5,396.4219" style="stroke: #000000; stroke-width: 1.0;"/><line style="stroke: #000000; stroke-width: 1.0;" x1="147.5" x2="442.5" y1="396.4219" y2="396.4219"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="131" x="159.5" y="376.2231">11, GTP&lt;PFCP rsp.&gt;</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="277" x="159.5" y="391.356">PFCP Session Establishment Response (51)</text><path d="M448,369.7227 L448,394.7227 L554,394.7227 L554,379.7227 L544,369.7227 L448,369.7227 " fill="#D7FEFC" style="stroke: #FFFFFF; stroke-width: 1.0;"/><path d="M544,369.7227 L544,379.7227 L554,379.7227 L544,369.7227 " fill="#D7FEFC" style="stroke: #FFFFFF; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="85" x="454" y="386.7896">UPF to gNB</text><!--MD5=[12cea64b4e51c84c1779b416c3942caf]
@startuml
skinparam shadowing false
skinparam NoteBorderColor white
skinparam sequence {
    ArrowColor black
    LifeLineBorderColor black
    LifeLineBackgroundColor black
    ParticipantBorderColor white
    ParticipantBackgroundColor #e6e6e6
}
participant "Malicious_UE"
participant "gNB"
participant "UPF"


"gNB" -> "UPF": 4, GTP<PFCP req.>\nPFCP Association Setup Request (5)

note right #03B5AA
**gNB to UPF**
end note


"Malicious_UE" -> "UPF": 5, PFCP req.\nPFCP Association Setup Request (5)

note right #FFC2D9
**Malicious_UE to UPF**
end note

"UPF" -> "Malicious_UE": 6, PFCP rsp.\nPFCP Association Setup Response (6)

note right #FFEAC2
**UPF to Malicious_UE**
end note

"UPF" -> "gNB": 7, PFCP,GTP<ICMP> rsp.\nPFCP Association Setup Response (6)

note right #D7FEFC
**UPF to gNB**
end note

"gNB" -> "UPF": 8, GTP<PFCP req.>\nPFCP Association Setup Request (5)

note right #03B5AA
**gNB to UPF**
end note

"Malicious_UE" -> "UPF": 9, PFCP req.\nPFCP Session Establishment Request (50)

note right #FFC2D9
**Malicious_UE to UPF**
end note

"UPF" -> "Malicious_UE": 10, PFCP rsp.\nPFCP Session Establishment Response (51)

note right #FFEAC2
**UPF to Malicious_UE**
Accept
end note

"UPF" -> "gNB": 11, GTP<PFCP rsp.>\nPFCP Session Establishment Response (51)

note right #D7FEFC
**UPF to gNB**
end note
@enduml

PlantUML version 1.2019.12(Sun Nov 03 11:24:54 CET 2019)
(APACHE source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Java Version: 11.0.18+10-post-Ubuntu-0ubuntu120.04.1
Operating System: Linux
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>