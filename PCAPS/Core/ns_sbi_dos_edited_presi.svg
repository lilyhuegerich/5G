<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="615px" preserveAspectRatio="none" style="width:1622px;height:615px;" version="1.1" viewBox="0 0 1622 615" width="1622px" zoomAndPan="magnify"><defs/><g><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="59" x2="59" y1="34.2969" y2="574.9531"/><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="142" x2="142" y1="34.2969" y2="574.9531"/><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="487" x2="487" y1="34.2969" y2="574.9531"/><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="832" x2="832" y1="34.2969" y2="574.9531"/><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1185.5" x2="1185.5" y1="34.2969" y2="574.9531"/><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1496.5" x2="1496.5" y1="34.2969" y2="574.9531"/><rect fill="#E6E6E6" height="30.2969" style="stroke: #FFFFFF; stroke-width: 1.5;" width="103" x="8" y="3"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="89" x="15" y="22.9951">Malicious_UE</text><rect fill="#E6E6E6" height="30.2969" style="stroke: #FFFFFF; stroke-width: 1.5;" width="103" x="8" y="573.9531"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="89" x="15" y="593.9482">Malicious_UE</text><rect fill="#E6E6E6" height="30.2969" style="stroke: #FFFFFF; stroke-width: 1.5;" width="43" x="121" y="3"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="29" x="128" y="22.9951">gNB</text><rect fill="#E6E6E6" height="30.2969" style="stroke: #FFFFFF; stroke-width: 1.5;" width="43" x="121" y="573.9531"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="29" x="128" y="593.9482">gNB</text><rect fill="#E6E6E6" height="30.2969" style="stroke: #FFFFFF; stroke-width: 1.5;" width="193" x="391" y="3"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="179" x="398" y="22.9951">User Plane Function (UPF)</text><rect fill="#E6E6E6" height="30.2969" style="stroke: #FFFFFF; stroke-width: 1.5;" width="193" x="391" y="573.9531"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="179" x="398" y="593.9482">User Plane Function (UPF)</text><rect fill="#E6E6E6" height="30.2969" style="stroke: #FFFFFF; stroke-width: 1.5;" width="271" x="697" y="3"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="257" x="704" y="22.9951">Session Management Function (SMF)</text><rect fill="#E6E6E6" height="30.2969" style="stroke: #FFFFFF; stroke-width: 1.5;" width="271" x="697" y="573.9531"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="257" x="704" y="593.9482">Session Management Function (SMF)</text><rect fill="#E6E6E6" height="30.2969" style="stroke: #FFFFFF; stroke-width: 1.5;" width="212" x="1079.5" y="3"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="198" x="1086.5" y="22.9951">Policy Control Function (PCF)</text><rect fill="#E6E6E6" height="30.2969" style="stroke: #FFFFFF; stroke-width: 1.5;" width="212" x="1079.5" y="573.9531"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="198" x="1086.5" y="593.9482">Policy Control Function (PCF)</text><rect fill="#E6E6E6" height="30.2969" style="stroke: #FFFFFF; stroke-width: 1.5;" width="230" x="1381.5" y="3"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="216" x="1388.5" y="22.9951">Binding Support Function (BSF)</text><rect fill="#E6E6E6" height="30.2969" style="stroke: #FFFFFF; stroke-width: 1.5;" width="230" x="1381.5" y="573.9531"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="216" x="1388.5" y="593.9482">Binding Support Function (BSF)</text><polygon fill="#000000" points="475.5,76.5625,485.5,80.5625,475.5,84.5625,479.5,80.5625" style="stroke: #000000; stroke-width: 1.0;"/><line style="stroke: #000000; stroke-width: 1.0;" x1="142.5" x2="481.5" y1="80.5625" y2="80.5625"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="73" x="149.5" y="60.3638">HTTP/2 req.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="321" x="149.5" y="75.4966">POST  /nsmf-pdusession/v1/sm-contexts/4/release</text><path d="M492,53.8633 L492,78.8633 L598,78.8633 L598,63.8633 L588,53.8633 L492,53.8633 " fill="#5C8001" style="stroke: #FFFFFF; stroke-width: 1.0;"/><path d="M588,53.8633 L588,63.8633 L598,63.8633 L588,53.8633 " fill="#5C8001" style="stroke: #FFFFFF; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="85" x="498" y="70.9302">gNB to UPF</text><polygon fill="#000000" points="820.5,120.8281,830.5,124.8281,820.5,128.8281,824.5,124.8281" style="stroke: #000000; stroke-width: 1.0;"/><line style="stroke: #000000; stroke-width: 1.0;" x1="59.5" x2="826.5" y1="124.8281" y2="124.8281"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="73" x="66.5" y="104.6294">HTTP/2 req.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="321" x="66.5" y="119.7622">POST  /nsmf-pdusession/v1/sm-contexts/4/release</text><path d="M837,98.1289 L837,123.1289 L1008,123.1289 L1008,108.1289 L998,98.1289 L837,98.1289 " fill="#FFC2D9" style="stroke: #FFFFFF; stroke-width: 1.0;"/><path d="M998,98.1289 L998,108.1289 L1008,108.1289 L998,98.1289 " fill="#FFC2D9" style="stroke: #FFFFFF; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="150" x="843" y="115.1958">Malicious_UE to SMF</text><polygon fill="#000000" points="820.5,165.0938,830.5,169.0938,820.5,173.0938,824.5,169.0938" style="stroke: #000000; stroke-width: 1.0;"/><line style="stroke: #000000; stroke-width: 1.0;" x1="487.5" x2="826.5" y1="169.0938" y2="169.0938"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="73" x="494.5" y="148.895">HTTP/2 req.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="321" x="494.5" y="164.0278">POST  /nsmf-pdusession/v1/sm-contexts/4/release</text><path d="M837,142.3945 L837,167.3945 L943,167.3945 L943,152.3945 L933,142.3945 L837,142.3945 " fill="#03B5AA" style="stroke: #FFFFFF; stroke-width: 1.0;"/><path d="M933,142.3945 L933,152.3945 L943,152.3945 L933,142.3945 " fill="#03B5AA" style="stroke: #FFFFFF; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="85" x="843" y="159.4614">UPF to SMF</text><polygon fill="#000000" points="1173.5,209.3594,1183.5,213.3594,1173.5,217.3594,1177.5,213.3594" style="stroke: #000000; stroke-width: 1.0;"/><line style="stroke: #000000; stroke-width: 1.0;" x1="832.5" x2="1179.5" y1="213.3594" y2="213.3594"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="73" x="839.5" y="193.1606">HTTP/2 req.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="329" x="839.5" y="208.2935">POST  /npcf-smpolicycontrol/v1/sm-policies/4/delete</text><path d="M1190,186.6602 L1190,211.6602 L1296,211.6602 L1296,196.6602 L1286,186.6602 L1190,186.6602 " fill="#FFEAC2" style="stroke: #FFFFFF; stroke-width: 1.0;"/><path d="M1286,186.6602 L1286,196.6602 L1296,196.6602 L1286,186.6602 " fill="#FFEAC2" style="stroke: #FFFFFF; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="85" x="1196" y="203.7271">SMF to PCF</text><polygon fill="#000000" points="1173.5,241.4922,1183.5,245.4922,1173.5,249.4922,1177.5,245.4922" style="stroke: #000000; stroke-width: 1.0;"/><line style="stroke: #000000; stroke-width: 1.0;" x1="832.5" x2="1179.5" y1="245.4922" y2="245.4922"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="252" x="839.5" y="240.4263">HTTP/2 req. or rsp. (no HTTP/2 headers)</text><path d="M1190,226.3594 L1190,251.3594 L1296,251.3594 L1296,236.3594 L1286,226.3594 L1190,226.3594 " fill="#FFEAC2" style="stroke: #FFFFFF; stroke-width: 1.0;"/><path d="M1286,226.3594 L1286,236.3594 L1296,236.3594 L1286,226.3594 " fill="#FFEAC2" style="stroke: #FFFFFF; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="85" x="1196" y="243.4263">SMF to PCF</text><polygon fill="#000000" points="1484.5,288.7578,1494.5,292.7578,1484.5,296.7578,1488.5,292.7578" style="stroke: #000000; stroke-width: 1.0;"/><line style="stroke: #000000; stroke-width: 1.0;" x1="1185.5" x2="1490.5" y1="292.7578" y2="292.7578"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="73" x="1192.5" y="272.5591">HTTP/2 req.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="287" x="1192.5" y="287.6919">DELETE  /nbsf-management/v1/pcfBindings/4</text><path d="M1501,266.0586 L1501,291.0586 L1604,291.0586 L1604,276.0586 L1594,266.0586 L1501,266.0586 " fill="#03B5AA" style="stroke: #FFFFFF; stroke-width: 1.0;"/><path d="M1594,266.0586 L1594,276.0586 L1604,276.0586 L1594,266.0586 " fill="#03B5AA" style="stroke: #FFFFFF; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="82" x="1507" y="283.1255">PCF to BSF</text><polygon fill="#000000" points="1196.5,320.8906,1186.5,324.8906,1196.5,328.8906,1192.5,324.8906" style="stroke: #000000; stroke-width: 1.0;"/><line style="stroke: #000000; stroke-width: 1.0;" x1="1190.5" x2="1495.5" y1="324.8906" y2="324.8906"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="100" x="1202.5" y="319.8247">HTTP/2 204 rsp.</text><path d="M1501,305.7578 L1501,330.7578 L1604,330.7578 L1604,315.7578 L1594,305.7578 L1501,305.7578 " fill="#D7FEFC" style="stroke: #FFFFFF; stroke-width: 1.0;"/><path d="M1594,305.7578 L1594,315.7578 L1604,315.7578 L1594,305.7578 " fill="#D7FEFC" style="stroke: #FFFFFF; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="82" x="1507" y="322.8247">BSF to PCF</text><polygon fill="#000000" points="843.5,356.0234,833.5,360.0234,843.5,364.0234,839.5,360.0234" style="stroke: #000000; stroke-width: 1.0;"/><line style="stroke: #000000; stroke-width: 1.0;" x1="837.5" x2="1184.5" y1="360.0234" y2="360.0234"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="100" x="849.5" y="354.9575">HTTP/2 204 rsp.</text><path d="M1190,340.8906 L1190,365.8906 L1296,365.8906 L1296,350.8906 L1286,340.8906 L1190,340.8906 " fill="#D7FEFC" style="stroke: #FFFFFF; stroke-width: 1.0;"/><path d="M1286,340.8906 L1286,350.8906 L1296,350.8906 L1286,340.8906 " fill="#D7FEFC" style="stroke: #FFFFFF; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="85" x="1196" y="357.9575">PCF to SMF</text><polygon fill="#000000" points="498.5,403.2891,488.5,407.2891,498.5,411.2891,494.5,407.2891" style="stroke: #000000; stroke-width: 1.0;"/><line style="stroke: #000000; stroke-width: 1.0;" x1="492.5" x2="831.5" y1="407.2891" y2="407.2891"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="61" x="504.5" y="387.0903">PFCP req.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="229" x="504.5" y="402.2231">PFCP Session Deletion Request (54)</text><path d="M837,380.5898 L837,405.5898 L943,405.5898 L943,390.5898 L933,380.5898 L837,380.5898 " fill="#FFEAC2" style="stroke: #FFFFFF; stroke-width: 1.0;"/><path d="M933,380.5898 L933,390.5898 L943,390.5898 L933,380.5898 " fill="#FFEAC2" style="stroke: #FFFFFF; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="85" x="843" y="397.6567">SMF to UPF</text><polygon fill="#000000" points="820.5,447.5547,830.5,451.5547,820.5,455.5547,824.5,451.5547" style="stroke: #000000; stroke-width: 1.0;"/><line style="stroke: #000000; stroke-width: 1.0;" x1="487.5" x2="826.5" y1="451.5547" y2="451.5547"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="60" x="494.5" y="431.356">PFCP rsp.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="239" x="494.5" y="446.4888">PFCP Session Deletion Response (55)</text><path d="M837,424.8555 L837,449.8555 L943,449.8555 L943,434.8555 L933,424.8555 L837,424.8555 " fill="#D7FEFC" style="stroke: #FFFFFF; stroke-width: 1.0;"/><path d="M933,424.8555 L933,434.8555 L943,434.8555 L933,424.8555 " fill="#D7FEFC" style="stroke: #FFFFFF; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="85" x="843" y="441.9224">UPF to SMF</text><polygon fill="#000000" points="498.5,479.6875,488.5,483.6875,498.5,487.6875,494.5,483.6875" style="stroke: #000000; stroke-width: 1.0;"/><line style="stroke: #000000; stroke-width: 1.0;" x1="492.5" x2="831.5" y1="483.6875" y2="483.6875"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="100" x="504.5" y="478.6216">HTTP/2 204 rsp.</text><path d="M837,464.5547 L837,489.5547 L943,489.5547 L943,474.5547 L933,464.5547 L837,464.5547 " fill="#D7FEFC" style="stroke: #FFFFFF; stroke-width: 1.0;"/><path d="M933,464.5547 L933,474.5547 L943,474.5547 L933,464.5547 " fill="#D7FEFC" style="stroke: #FFFFFF; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="85" x="843" y="481.6216">SMF to UPF</text><polygon fill="#000000" points="153.5,514.8203,143.5,518.8203,153.5,522.8203,149.5,518.8203" style="stroke: #000000; stroke-width: 1.0;"/><line style="stroke: #000000; stroke-width: 1.0;" x1="147.5" x2="486.5" y1="518.8203" y2="518.8203"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="100" x="159.5" y="513.7544">HTTP/2 204 rsp.</text><path d="M492,499.6875 L492,524.6875 L598,524.6875 L598,509.6875 L588,499.6875 L492,499.6875 " fill="#EDFEC2" style="stroke: #FFFFFF; stroke-width: 1.0;"/><path d="M588,499.6875 L588,509.6875 L598,509.6875 L588,499.6875 " fill="#EDFEC2" style="stroke: #FFFFFF; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="85" x="498" y="516.7544">UPF to gNB</text><polygon fill="#000000" points="70.5,549.9531,60.5,553.9531,70.5,557.9531,66.5,553.9531" style="stroke: #000000; stroke-width: 1.0;"/><line style="stroke: #000000; stroke-width: 1.0;" x1="64.5" x2="831.5" y1="553.9531" y2="553.9531"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="100" x="76.5" y="548.8872">HTTP/2 204 rsp.</text><path d="M837,534.8203 L837,559.8203 L1008,559.8203 L1008,544.8203 L998,534.8203 L837,534.8203 " fill="#FFEAC2" style="stroke: #FFFFFF; stroke-width: 1.0;"/><path d="M998,534.8203 L998,544.8203 L1008,544.8203 L998,534.8203 " fill="#FFEAC2" style="stroke: #FFFFFF; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="150" x="843" y="551.8872">SMF to Malicious_UE</text><!--MD5=[baf61f2fe562bce0057a85c386f7b3dd]
@startuml
skinparam shadowing false
skinparam NoteBorderColor white
skinparam sequence {
    ArrowColor black
    LifeLineBorderColor black
    LifeLineBackgroundColor black
    ParticipantBorderColor white
    ParticipantBackgroundColor #e6e6e6
}
participant "Malicious_UE"
participant "gNB"
participant "User Plane Function (UPF)"
participant "Session Management Function (SMF)"
participant "Policy Control Function (PCF)"
participant "Binding Support Function (BSF)"


"gNB" -> "User Plane Function (UPF)": HTTP/2 req.\nPOST  /nsmf-pdusession/v1/sm-contexts/4/release

note right #5C8001
**gNB to UPF**
end note

"Malicious_UE" -> "Session Management Function (SMF)": HTTP/2 req.\nPOST  /nsmf-pdusession/v1/sm-contexts/4/release

note right #FFC2D9
**Malicious_UE to SMF**
end note

"User Plane Function (UPF)" -> "Session Management Function (SMF)": HTTP/2 req.\nPOST  /nsmf-pdusession/v1/sm-contexts/4/release

note right #03B5AA
**UPF to SMF**
end note
"Session Management Function (SMF)" -> "Policy Control Function (PCF)": HTTP/2 req.\nPOST  /npcf-smpolicycontrol/v1/sm-policies/4/delete

note right #FFEAC2
**SMF to PCF**
end note

"Session Management Function (SMF)" -> "Policy Control Function (PCF)": HTTP/2 req. or rsp. (no HTTP/2 headers)

note right #FFEAC2
**SMF to PCF**
end note

"Policy Control Function (PCF)" -> "Binding Support Function (BSF)": HTTP/2 req.\nDELETE  /nbsf-management/v1/pcfBindings/4

note right #03B5AA
**PCF to BSF**
end note

"Binding Support Function (BSF)" -> "Policy Control Function (PCF)": HTTP/2 204 rsp.

note right #D7FEFC
**BSF to PCF**
end note

"Policy Control Function (PCF)" -> "Session Management Function (SMF)": HTTP/2 204 rsp.

note right #D7FEFC
**PCF to SMF**
end note


"Session Management Function (SMF)" -> "User Plane Function (UPF)": PFCP req.\nPFCP Session Deletion Request (54)

note right #FFEAC2
**SMF to UPF**
end note

"User Plane Function (UPF)" -> "Session Management Function (SMF)": PFCP rsp.\nPFCP Session Deletion Response (55)

note right #D7FEFC
**UPF to SMF**
end note


"Session Management Function (SMF)" -> "User Plane Function (UPF)": HTTP/2 204 rsp.

note right #D7FEFC
**SMF to UPF**
end note

"User Plane Function (UPF)" -> "gNB": HTTP/2 204 rsp.

note right #EDFEC2
**UPF to gNB**
end note

"Session Management Function (SMF)" -> "Malicious_UE": HTTP/2 204 rsp.

note right #FFEAC2
**SMF to Malicious_UE**
end note

@enduml

PlantUML version 1.2019.12(Sun Nov 03 11:24:54 CET 2019)
(APACHE source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Java Version: 11.0.18+10-post-Ubuntu-0ubuntu120.04.1
Operating System: Linux
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>