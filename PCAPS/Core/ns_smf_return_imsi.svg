<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="792px" preserveAspectRatio="none" style="width:1178px;height:792px;" version="1.1" viewBox="0 0 1178 792" width="1178px" zoomAndPan="magnify"><defs/><g><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="59" x2="59" y1="34.2969" y2="751.9453"/><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="142" x2="142" y1="34.2969" y2="751.9453"/><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="483" x2="483" y1="34.2969" y2="751.9453"/><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="824" x2="824" y1="34.2969" y2="751.9453"/><rect fill="#E6E6E6" height="30.2969" style="stroke: #FFFFFF; stroke-width: 1.5;" width="103" x="8" y="3"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="89" x="15" y="22.9951">Malicious_UE</text><rect fill="#E6E6E6" height="30.2969" style="stroke: #FFFFFF; stroke-width: 1.5;" width="103" x="8" y="750.9453"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="89" x="15" y="770.9404">Malicious_UE</text><rect fill="#E6E6E6" height="30.2969" style="stroke: #FFFFFF; stroke-width: 1.5;" width="43" x="121" y="3"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="29" x="128" y="22.9951">gNB</text><rect fill="#E6E6E6" height="30.2969" style="stroke: #FFFFFF; stroke-width: 1.5;" width="43" x="121" y="750.9453"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="29" x="128" y="770.9404">gNB</text><rect fill="#E6E6E6" height="30.2969" style="stroke: #FFFFFF; stroke-width: 1.5;" width="41" x="463" y="3"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="27" x="470" y="22.9951">UPF</text><rect fill="#E6E6E6" height="30.2969" style="stroke: #FFFFFF; stroke-width: 1.5;" width="41" x="463" y="750.9453"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="27" x="470" y="770.9404">UPF</text><rect fill="#E6E6E6" height="30.2969" style="stroke: #FFFFFF; stroke-width: 1.5;" width="43" x="803" y="3"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="29" x="810" y="22.9951">SMF</text><rect fill="#E6E6E6" height="30.2969" style="stroke: #FFFFFF; stroke-width: 1.5;" width="43" x="803" y="750.9453"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="29" x="810" y="770.9404">SMF</text><polygon fill="#000000" points="471.5,76.5625,481.5,80.5625,471.5,84.5625,475.5,80.5625" style="stroke: #000000; stroke-width: 1.0;"/><line style="stroke: #000000; stroke-width: 1.0;" x1="142.5" x2="477.5" y1="80.5625" y2="80.5625"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="105" x="149.5" y="60.3638">981, HTTP/2 req.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="317" x="149.5" y="75.4966">POST  /nsmf-pdusession/v1/sm-contexts/3/modify</text><path d="M488,53.8633 L488,78.8633 L594,78.8633 L594,63.8633 L584,53.8633 L488,53.8633 " fill="#5C8001" style="stroke: #FFFFFF; stroke-width: 1.0;"/><path d="M584,53.8633 L584,63.8633 L594,63.8633 L584,53.8633 " fill="#5C8001" style="stroke: #FFFFFF; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="85" x="494" y="70.9302">gNB to UPF</text><polygon fill="#000000" points="812.5,222.1914,822.5,226.1914,812.5,230.1914,816.5,226.1914" style="stroke: #000000; stroke-width: 1.0;"/><line style="stroke: #000000; stroke-width: 1.0;" x1="59.5" x2="818.5" y1="226.1914" y2="226.1914"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="105" x="66.5" y="205.9927">982, HTTP/2 req.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="317" x="66.5" y="221.1255">POST  /nsmf-pdusession/v1/sm-contexts/3/modify</text><path d="M829,93.5625 L829,329.5625 L1166,329.5625 L1166,103.5625 L1156,93.5625 L829,93.5625 " fill="#FFC2D9" style="stroke: #FFFFFF; stroke-width: 1.0;"/><path d="M1156,93.5625 L1156,103.5625 L1166,103.5625 L1156,93.5625 " fill="#FFC2D9" style="stroke: #FFFFFF; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="150" x="835" y="110.6294">Malicious_UE to SMF</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="173" x="835" y="125.7622">10.45.0.3 to 10.0.14.1 (IPs)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="118" x="835" y="140.895">HTTP/2 stream: 13</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="96" x="835" y="156.0278">:method: POST</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="316" x="835" y="171.1606">:path: /nsmf-pdusession/v1/sm-contexts/3/modify</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="89" x="835" y="186.2935">:scheme: http</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="165" x="835" y="201.4263">:authority: 10.0.14.1:7777</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="69" x="835" y="216.5591">accept: */*</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="192" x="835" y="231.6919">accept-encoding: gzip, deflate</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="172" x="835" y="246.8247">user-agent: nghttp2/1.40.0</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="110" x="835" y="261.9575">content-length: 3</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="189" x="835" y="277.0903">content-type: application/json</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="839" y="292.2231"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="168" x="835" y="307.356">HTTP/2 stream 13 payload</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="16" x="835" y="322.4888">{}</text><polygon fill="#000000" points="812.5,367.8203,822.5,371.8203,812.5,375.8203,816.5,371.8203" style="stroke: #000000; stroke-width: 1.0;"/><line style="stroke: #000000; stroke-width: 1.0;" x1="483.5" x2="818.5" y1="371.8203" y2="371.8203"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="105" x="490.5" y="351.6216">983, HTTP/2 req.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="317" x="490.5" y="366.7544">POST  /nsmf-pdusession/v1/sm-contexts/3/modify</text><path d="M829,345.1211 L829,370.1211 L935,370.1211 L935,355.1211 L925,345.1211 L829,345.1211 " fill="#03B5AA" style="stroke: #FFFFFF; stroke-width: 1.0;"/><path d="M925,345.1211 L925,355.1211 L935,355.1211 L925,345.1211 " fill="#03B5AA" style="stroke: #FFFFFF; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="85" x="835" y="362.188">UPF to SMF</text><polygon fill="#000000" points="494.5,399.9531,484.5,403.9531,494.5,407.9531,490.5,403.9531" style="stroke: #000000; stroke-width: 1.0;"/><line style="stroke: #000000; stroke-width: 1.0;" x1="488.5" x2="823.5" y1="403.9531" y2="403.9531"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="132" x="500.5" y="398.8872">994, HTTP/2 400 rsp.</text><path d="M829,384.8203 L829,409.8203 L935,409.8203 L935,394.8203 L925,384.8203 L829,384.8203 " fill="#D7FEFC" style="stroke: #FFFFFF; stroke-width: 1.0;"/><path d="M925,384.8203 L925,394.8203 L935,394.8203 L925,384.8203 " fill="#D7FEFC" style="stroke: #FFFFFF; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="85" x="835" y="401.8872">SMF to UPF</text><polygon fill="#000000" points="494.5,435.0859,484.5,439.0859,494.5,443.0859,490.5,439.0859" style="stroke: #000000; stroke-width: 1.0;"/><line style="stroke: #000000; stroke-width: 1.0;" x1="488.5" x2="823.5" y1="439.0859" y2="439.0859"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="284" x="500.5" y="434.02">996, HTTP/2 req. or rsp. (no HTTP/2 headers)</text><path d="M829,419.9531 L829,444.9531 L935,444.9531 L935,429.9531 L925,419.9531 L829,419.9531 " fill="#03B5AA" style="stroke: #FFFFFF; stroke-width: 1.0;"/><path d="M925,419.9531 L925,429.9531 L935,429.9531 L925,419.9531 " fill="#03B5AA" style="stroke: #FFFFFF; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="85" x="835" y="437.02">SMF to UPF</text><polygon fill="#000000" points="153.5,470.2188,143.5,474.2188,153.5,478.2188,149.5,474.2188" style="stroke: #000000; stroke-width: 1.0;"/><line style="stroke: #000000; stroke-width: 1.0;" x1="147.5" x2="482.5" y1="474.2188" y2="474.2188"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="140" x="159.5" y="469.1528">1005, HTTP/2 400 rsp.</text><path d="M488,455.0859 L488,480.0859 L594,480.0859 L594,465.0859 L584,455.0859 L488,455.0859 " fill="#EDFEC2" style="stroke: #FFFFFF; stroke-width: 1.0;"/><path d="M584,455.0859 L584,465.0859 L594,465.0859 L584,455.0859 " fill="#EDFEC2" style="stroke: #FFFFFF; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="85" x="494" y="472.1528">UPF to gNB</text><polygon fill="#000000" points="70.5,505.3516,60.5,509.3516,70.5,513.3516,66.5,509.3516" style="stroke: #000000; stroke-width: 1.0;"/><line style="stroke: #000000; stroke-width: 1.0;" x1="64.5" x2="823.5" y1="509.3516" y2="509.3516"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="140" x="76.5" y="504.2856">1006, HTTP/2 400 rsp.</text><path d="M829,490.2188 L829,515.2188 L1000,515.2188 L1000,500.2188 L990,490.2188 L829,490.2188 " fill="#D7FEFC" style="stroke: #FFFFFF; stroke-width: 1.0;"/><path d="M990,490.2188 L990,500.2188 L1000,500.2188 L990,490.2188 " fill="#D7FEFC" style="stroke: #FFFFFF; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="150" x="835" y="507.2856">SMF to Malicious_UE</text><polygon fill="#000000" points="153.5,540.4844,143.5,544.4844,153.5,548.4844,149.5,544.4844" style="stroke: #000000; stroke-width: 1.0;"/><line style="stroke: #000000; stroke-width: 1.0;" x1="147.5" x2="482.5" y1="544.4844" y2="544.4844"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="292" x="159.5" y="539.4185">1007, HTTP/2 req. or rsp. (no HTTP/2 headers)</text><path d="M488,525.3516 L488,550.3516 L594,550.3516 L594,535.3516 L584,525.3516 L488,525.3516 " fill="#EDFEC2" style="stroke: #FFFFFF; stroke-width: 1.0;"/><path d="M584,525.3516 L584,535.3516 L594,535.3516 L584,525.3516 " fill="#EDFEC2" style="stroke: #FFFFFF; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="85" x="494" y="542.4185">UPF to gNB</text><polygon fill="#000000" points="70.5,651.2813,60.5,655.2813,70.5,659.2813,66.5,655.2813" style="stroke: #000000; stroke-width: 1.0;"/><line style="stroke: #000000; stroke-width: 1.0;" x1="64.5" x2="823.5" y1="655.2813" y2="655.2813"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="292" x="76.5" y="650.2153">1008, HTTP/2 req. or rsp. (no HTTP/2 headers)</text><path d="M829,560.4844 L829,736.4844 L1080,736.4844 L1080,570.4844 L1070,560.4844 L829,560.4844 " fill="#FFEAC2" style="stroke: #FFFFFF; stroke-width: 1.0;"/><path d="M1070,560.4844 L1070,570.4844 L1080,570.4844 L1070,560.4844 " fill="#FFEAC2" style="stroke: #FFFFFF; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="150" x="835" y="577.5513">SMF to Malicious_UE</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="173" x="835" y="592.6841">10.0.14.1 to 10.45.0.3 (IPs)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="168" x="835" y="607.8169">HTTP/2 stream 13 payload</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="835" y="622.9497">{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="57" x="843" y="638.0825">"error": {</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="156" x="851" y="653.2153">"title": "No UpdateData",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="86" x="851" y="668.3481">"status": 400,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="214" x="851" y="683.481">"detail": "imsi-901700000000003"</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="843" y="698.6138">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="8" x="835" y="713.7466">}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="839" y="728.8794"/><!--MD5=[0c354e968282cb6e2b2ca971faddbf11]
@startuml
skinparam shadowing false
skinparam NoteBorderColor white
skinparam sequence {
    ArrowColor black
    LifeLineBorderColor black
    LifeLineBackgroundColor black
    ParticipantBorderColor white
    ParticipantBackgroundColor #e6e6e6
}
participant "Malicious_UE"
participant "gNB"
participant "UPF"
participant "SMF"

"gNB" -> "UPF": 981, HTTP/2 req.\nPOST  /nsmf-pdusession/v1/sm-contexts/3/modify

note right  #5C8001
**gNB to UPF**
end note

"Malicious_UE" -> "SMF": 982, HTTP/2 req.\nPOST  /nsmf-pdusession/v1/sm-contexts/3/modify

note right #FFC2D9
**Malicious_UE to SMF**
10.45.0.3 to 10.0.14.1 (IPs)
HTTP/2 stream: 13
:method: POST
:path: /nsmf-pdusession/v1/sm-contexts/3/modify
:scheme: http
:authority: 10.0.14.1:7777
accept: */*
accept-encoding: gzip, deflate
user-agent: nghttp2/1.40.0
content-length: 3
content-type: application/json

HTTP/2 stream 13 payload
{}
end note

"UPF" -> "SMF": 983, HTTP/2 req.\nPOST  /nsmf-pdusession/v1/sm-contexts/3/modify

note right #03B5AA
**UPF to SMF**
end note

"SMF" -> "UPF": 994, HTTP/2 400 rsp.

note right #D7FEFC
**SMF to UPF**
end note

"SMF" -> "UPF": 996, HTTP/2 req. or rsp. (no HTTP/2 headers)

note right #03B5AA
**SMF to UPF**
end note

"UPF" -> "gNB": 1005, HTTP/2 400 rsp.

note right #EDFEC2
**UPF to gNB**
end note

"SMF" -> "Malicious_UE": 1006, HTTP/2 400 rsp.

note right #D7FEFC
**SMF to Malicious_UE**
end note

"UPF" -> "gNB": 1007, HTTP/2 req. or rsp. (no HTTP/2 headers)

note right #EDFEC2
**UPF to gNB**
end note

"SMF" -> "Malicious_UE": 1008, HTTP/2 req. or rsp. (no HTTP/2 headers)

note right #FFEAC2
**SMF to Malicious_UE**
10.0.14.1 to 10.45.0.3 (IPs)
HTTP/2 stream 13 payload
{
  "error": {
    "title": "No UpdateData",
    "status": 400,
    "detail": "imsi-901700000000003"
  }
}

end note

@enduml

PlantUML version 1.2019.12(Sun Nov 03 11:24:54 CET 2019)
(APACHE source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Java Version: 11.0.18+10-post-Ubuntu-0ubuntu120.04.1
Operating System: Linux
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>