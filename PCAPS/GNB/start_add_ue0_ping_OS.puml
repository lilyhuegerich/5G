@startuml
skinparam shadowing false
skinparam NoteBorderColor white
skinparam sequence {
    ArrowColor black
    LifeLineBorderColor black
    LifeLineBackgroundColor black
    ParticipantBorderColor white
    ParticipantBackgroundColor #e6e6e6
}
participant "N1\n(10.0.2.15)" as 10.0.2.15
participant "N1\n(10.0.2.4)" as 10.0.2.4

"10.0.2.15" -> "10.0.2.4": 5, NGAP NGSetup (21)

note right #c6ebc6
**10.0.2.15 to 10.0.2.4**
NGAP-PDU: 00150041000004001b00090009f1075000000001005240170a00554552414e53494d2d676e622d3930312d37302d310066000d00000000010009f107000000080015400140
ngap.procedureCode: 'procedureCode: id-NGSetup (21)'
per.enum_index: 'Enumerated Index: 0'
ngap.criticality: 'criticality: reject (0)'
per.open_type_length: 'Open Type Length: 65'
ngap.value_element:
-   ngap.NGSetupRequest_element:
        per.extension_bit: '0... .... Extension Bit: False'
        per.sequence_of_length: 'Sequence-Of Length: 4'
        ngap.protocolIEs:
            'Item 0: id-GlobalRANNodeID':
                ngap.id: 'id: id-GlobalRANNodeID (27)'
                per.enum_index: 'Enumerated Index: 0'
                ngap.criticality: 'criticality: reject (0)'
                per.open_type_length: 'Open Type Length: 9'
                ngap.value_element:
                    per.choice_index: 'Choice Index: 0'
                    ngap.GlobalRANNodeID:
                        ngap.globalGNB_ID_element:
                            per.extension_bit: '..0. .... Extension Bit: False'
                            per.optional_field_bit: '...0 .... Optional Field Bit: False (iE-Extensions is NOT present)'
                            ngap.pLMNIdentity:
                                e212.mcc: 'Mobile Country Code (MCC): International Mobile, shared code (901)'
                                e212.mnc: 'Mobile Network Code (MNC): Unknown (70)'
                            per.choice_index: 'Choice Index: 0'
                            ngap.gNB_ID:
                                per.bit_string_length: 'Bit String Length: 32'
                                ngap.gNB_ID: 'gNB-ID: 00000001 [bit length 32, 0000 0000  0000 0000  0000 0000  0000 0001 decimal value 1]'
            'Item 1: id-RANNodeName':
                ngap.id: 'id: id-RANNodeName (82)'
                per.enum_index: 'Enumerated Index: 1'
                ngap.criticality: 'criticality: ignore (1)'
                per.open_type_length: 'Open Type Length: 23'
                ngap.value_element:
                    per.extension_present_bit: '0... .... Extension Present Bit: False'
                    per.octet_string_length: 'Octet String Length: 21'
                    ngap.RANNodeName: 'RANNodeName: UERANSIM-gnb-901-70-1'
            'Item 2: id-SupportedTAList':
                ngap.id: 'id: id-SupportedTAList (102)'
                per.enum_index: 'Enumerated Index: 0'
                ngap.criticality: 'criticality: reject (0)'
                per.open_type_length: 'Open Type Length: 13'
                ngap.value_element:
                    per.sequence_of_length: 'Sequence-Of Length: 1'
                    ngap.SupportedTAList:
                        Item 0:
                            ngap.SupportedTAItem_element:
                                per.extension_bit: '0... .... Extension Bit: False'
                                per.optional_field_bit: '.0.. .... Optional Field Bit: False (iE-Extensions is NOT present)'
                                ngap.tAC: 'tAC: 1 (0x000001)'
                                per.sequence_of_length: 'Sequence-Of Length: 1'
                                ngap.broadcastPLMNList:
                                    Item 0:
                                        ngap.BroadcastPLMNItem_element:
                                            per.extension_bit: '.... 0... Extension Bit: False'
                                            per.optional_field_bit: '.... .0.. Optional Field Bit: False (iE-Extensions is NOT present)'
                                            ngap.pLMNIdentity:
                                                e212.mcc: 'Mobile Country Code (MCC): International Mobile, shared code (901)'
                                                e212.mnc: 'Mobile Network Code (MNC): Unknown (70)'
                                            per.sequence_of_length: 'Sequence-Of Length: 1'
                                            ngap.tAISliceSupportList:
                                                Item 0:
                                                    ngap.SliceSupportItem_element:
                                                        per.extension_bit: '0... .... Extension Bit: False'
                                                        per.optional_field_bit: '.0.. .... Optional Field Bit: False (iE-Extensions is NOT present)'
                                                        ngap.s_NSSAI_element:
                                                            per.extension_bit: '..0. .... Extension Bit: False'
                                                            per.optional_field_bit: '.... 0... Optional Field Bit: False (iE-Extensions is NOT present)'
                                                            ngap.sST: 'sST: 01'
            'Item 3: id-DefaultPagingDRX':
                ngap.id: 'id: id-DefaultPagingDRX (21)'
                per.enum_index: 'Enumerated Index: 1'
                ngap.criticality: 'criticality: ignore (1)'
                per.open_type_length: 'Open Type Length: 1'
                ngap.value_element:
                    per.extension_present_bit: '0... .... Extension Present Bit: False'
                    per.enum_index: 'Enumerated Index: 2'
                    ngap.PagingDRX: 'PagingDRX: v128 (2)'

end note

"10.0.2.4" -> "10.0.2.15": 7, NGAP NGSetup (21)

note right #c6ebc6
**10.0.2.4 to 10.0.2.15**
NGAP-PDU: 201500320000040001000e05806f70656e3567732d616d663000600008000009f10702004000564001ff005000080009f10700000008
ngap.procedureCode: 'procedureCode: id-NGSetup (21)'
per.enum_index: 'Enumerated Index: 0'
ngap.criticality: 'criticality: reject (0)'
per.open_type_length: 'Open Type Length: 50'
ngap.value_element:
-   ngap.NGSetupResponse_element:
        per.extension_bit: '0... .... Extension Bit: False'
        per.sequence_of_length: 'Sequence-Of Length: 4'
        ngap.protocolIEs:
            'Item 0: id-AMFName':
                ngap.id: 'id: id-AMFName (1)'
                per.enum_index: 'Enumerated Index: 0'
                ngap.criticality: 'criticality: reject (0)'
                per.open_type_length: 'Open Type Length: 14'
                ngap.value_element:
                    per.extension_present_bit: '0... .... Extension Present Bit: False'
                    per.octet_string_length: 'Octet String Length: 12'
                    ngap.AMFName: 'AMFName: open5gs-amf0'
            'Item 1: id-ServedGUAMIList':
                ngap.id: 'id: id-ServedGUAMIList (96)'
                per.enum_index: 'Enumerated Index: 0'
                ngap.criticality: 'criticality: reject (0)'
                per.open_type_length: 'Open Type Length: 8'
                ngap.value_element:
                    per.sequence_of_length: 'Sequence-Of Length: 1'
                    ngap.ServedGUAMIList:
                        Item 0:
                            ngap.ServedGUAMIItem_element:
                                per.extension_bit: '0... .... Extension Bit: False'
                                per.optional_field_bit: '..0. .... Optional Field Bit: False (iE-Extensions is NOT present)'
                                ngap.gUAMI_element:
                                    per.extension_bit: '...0 .... Extension Bit: False'
                                    per.optional_field_bit: '.... 0... Optional Field Bit: False (iE-Extensions is NOT present)'
                                    ngap.pLMNIdentity:
                                        e212.mcc: 'Mobile Country Code (MCC): International Mobile, shared code (901)'
                                        e212.mnc: 'Mobile Network Code (MNC): Unknown (70)'
                                    ngap.aMFRegionID: 'aMFRegionID: 02 [bit length 8, 0000 0010 decimal value 2]'
                                    ngap.aMFSetID: 'aMFSetID: 0040 [bit length 10, 6 LSB pad bits, 0000 0000  01.. .... decimal value 1]'
                                    ngap.aMFPointer: 'aMFPointer: 00 [bit length 6, 2 LSB pad bits, 0000 00.. decimal value 0]'
            'Item 2: id-RelativeAMFCapacity':
                ngap.id: 'id: id-RelativeAMFCapacity (86)'
                per.enum_index: 'Enumerated Index: 1'
                ngap.criticality: 'criticality: ignore (1)'
                per.open_type_length: 'Open Type Length: 1'
                ngap.value_element:
                    ngap.RelativeAMFCapacity: 'RelativeAMFCapacity: 255'
            'Item 3: id-PLMNSupportList':
                ngap.id: 'id: id-PLMNSupportList (80)'
                per.enum_index: 'Enumerated Index: 0'
                ngap.criticality: 'criticality: reject (0)'
                per.open_type_length: 'Open Type Length: 8'
                ngap.value_element:
                    per.sequence_of_length: 'Sequence-Of Length: 1'
                    ngap.PLMNSupportList:
                        Item 0:
                            ngap.PLMNSupportItem_element:
                                per.extension_bit: '.... 0... Extension Bit: False'
                                per.optional_field_bit: '.... .0.. Optional Field Bit: False (iE-Extensions is NOT present)'
                                ngap.pLMNIdentity:
                                    e212.mcc: 'Mobile Country Code (MCC): International Mobile, shared code (901)'
                                    e212.mnc: 'Mobile Network Code (MNC): Unknown (70)'
                                per.sequence_of_length: 'Sequence-Of Length: 1'
                                ngap.sliceSupportList:
                                    Item 0:
                                        ngap.SliceSupportItem_element:
                                            per.extension_bit: '0... .... Extension Bit: False'
                                            per.optional_field_bit: '.0.. .... Optional Field Bit: False (iE-Extensions is NOT present)'
                                            ngap.s_NSSAI_element:
                                                per.extension_bit: '..0. .... Extension Bit: False'
                                                per.optional_field_bit: '.... 0... Optional Field Bit: False (iE-Extensions is NOT present)'
                                                ngap.sST: 'sST: 01'

end note

"10.0.2.15" -> "10.0.2.4": 23, NGAP InitialUEMessage (15),\nNAS Registration request (0x41)

note right #8cd98c
**10.0.2.15 to 10.0.2.4**
NGAP-PDU: 000f40480000050055000200010026001a197e004179000d0109f1070000000000000000102e04f0f0f0f0007900135009f107000000010009f107000001e7155304005a4001180070400100
ngap.procedureCode: 'procedureCode: id-InitialUEMessage (15)'
per.enum_index: 'Enumerated Index: 1'
ngap.criticality: 'criticality: ignore (1)'
per.open_type_length: 'Open Type Length: 72'
ngap.value_element:
-   ngap.InitialUEMessage_element:
        per.extension_bit: '0... .... Extension Bit: False'
        per.sequence_of_length: 'Sequence-Of Length: 5'
        ngap.protocolIEs:
            'Item 0: id-RAN-UE-NGAP-ID':
                ngap.id: 'id: id-RAN-UE-NGAP-ID (85)'
                per.enum_index: 'Enumerated Index: 0'
                ngap.criticality: 'criticality: reject (0)'
                per.open_type_length: 'Open Type Length: 2'
                ngap.value_element:
                    ngap.RAN_UE_NGAP_ID: 'RAN-UE-NGAP-ID: 1'
            'Item 1: id-NAS-PDU':
                ngap.id: 'id: id-NAS-PDU (38)'
                per.enum_index: 'Enumerated Index: 0'
                ngap.criticality: 'criticality: reject (0)'
                per.open_type_length: 'Open Type Length: 26'
                ngap.value_element:
                    per.octet_string_length: 'Octet String Length: 25'
                    ngap.NAS_PDU:
                        nas-5gs:
                            Plain NAS 5GS Message:
                                nas_5gs.epd: 'Extended protocol discriminator: 5G mobility management messages (126)'
                                nas_5gs.spare_half_octet: '0000 .... = Spare Half Octet: 0'
                                nas_5gs.security_header_type: '.... 0000 = Security header type: Plain NAS message, not security protected (0)'
                                nas_5gs.mm.message_type: 'Message type: Registration request (0x41)'
                                5GS registration type:
                                    nas_5gs.mm.for: '.... 1... = Follow-On Request bit (FOR): Follow-on request pending'
                                    nas_5gs.mm.5gs_reg_type: '.... .001 = 5GS registration type: initial registration (1)'
                                NAS key set identifier:
                                    nas_5gs.mm.tsc.h1: '0... .... = Type of security context flag (TSC): Native security context (for KSIAMF)'
                                    nas_5gs.mm.nas_key_set_id.h1: '.111 .... = NAS key set identifier: 7'
                                5GS mobile identity:
                                    gsm_a.len: 'Length: 13'
                                    nas_5gs.spare_b7: '0... .... = Spare: 0'
                                    nas_5gs.mm.suci.supi_fmt: '.000 .... = SUPI format: IMSI (0)'
                                    nas_5gs.spare_b3: '.... 0... = Spare: 0'
                                    nas_5gs.mm.type_id: '.... .001 = Type of identity: SUCI (1)'
                                    e212.mcc: 'Mobile Country Code (MCC): International Mobile, shared code (901)'
                                    e212.mnc: 'Mobile Network Code (MNC): Unknown (70)'
                                    nas_5gs.mm.suci.routing_indicator: 'Routing indicator: 0000'
                                    nas_5gs.mm.suci.scheme_id: '.... 0000 = Protection scheme Id: NULL scheme (0)'
                                    nas_5gs.mm.suci.pki: 'Home network public key identifier: 0'
                                    nas_5gs.mm.suci.supi_null_scheme: 'Scheme output: 0000000001'
                                UE security capability:
                                    nas_5gs.mm.elem_id: 'Element ID: 0x2e'
                                    gsm_a.len: 'Length: 4'
                                    nas_5gs.mm.5g_ea0: '1... .... = 5G-EA0: Supported'
                                    nas_5gs.mm.128_5g_ea1: '.1.. .... = 128-5G-EA1: Supported'
                                    nas_5gs.mm.128_5g_ea2: '..1. .... = 128-5G-EA2: Supported'
                                    nas_5gs.mm.128_5g_ea3: '...1 .... = 128-5G-EA3: Supported'
                                    nas_5gs.mm.5g_ea4: '.... 0... = 5G-EA4: Not supported'
                                    nas_5gs.mm.5g_ea5: '.... .0.. = 5G-EA5: Not supported'
                                    nas_5gs.mm.5g_ea6: '.... ..0. = 5G-EA6: Not supported'
                                    nas_5gs.mm.5g_ea7: '.... ...0 = 5G-EA7: Not supported'
                                    nas_5gs.mm.ia0: '1... .... = 5G-IA0: Supported'
                                    nas_5gs.mm.5g_128_ia1: '.1.. .... = 128-5G-IA1: Supported'
                                    nas_5gs.mm.5g_128_ia2: '..1. .... = 128-5G-IA2: Supported'
                                    nas_5gs.mm.5g_128_ia4: '.... 0... = 5G-IA4: Not supported'
                                    nas_5gs.mm.5g_ia5: '.... .0.. = 5G-IA5: Not supported'
                                    nas_5gs.mm.5g_ia6: '.... ..0. = 5G-IA6: Not supported'
                                    nas_5gs.mm.5g_ia7: '.... ...0 = 5G-IA7: Not supported'
                                    nas_5gs.mm.eea0: '1... .... = EEA0: Supported'
                                    nas_5gs.mm.128eea1: '.1.. .... = 128-EEA1: Supported'
                                    nas_5gs.mm.128eea2: '..1. .... = 128-EEA2: Supported'
                                    nas_5gs.mm.eea3: '...1 .... = 128-EEA3: Supported'
                                    nas_5gs.mm.eea4: '.... 0... = EEA4: Not supported'
                                    nas_5gs.mm.eea5: '.... .0.. = EEA5: Not supported'
                                    nas_5gs.mm.eea6: '.... ..0. = EEA6: Not supported'
                                    nas_5gs.mm.eea7: '.... ...0 = EEA7: Not supported'
                                    nas_5gs.mm.eia0: '1... .... = EIA0: Supported'
                                    nas_5gs.mm.128eia1: '.1.. .... = 128-EIA1: Supported'
                                    nas_5gs.mm.128eia2: '..1. .... = 128-EIA2: Supported'
                                    nas_5gs.mm.eia3: '...1 .... = 128-EIA3: Supported'
                                    nas_5gs.mm.eia4: '.... 0... = EIA4: Not supported'
                                    nas_5gs.mm.eia5: '.... .0.. = EIA5: Not supported'
                                    nas_5gs.mm.eia6: '.... ..0. = EIA6: Not supported'
                                    nas_5gs.mm.eia7: '.... ...0 = EIA7: Not supported'
            'Item 2: id-UserLocationInformation':
                ngap.id: 'id: id-UserLocationInformation (121)'
                per.enum_index: 'Enumerated Index: 0'
                ngap.criticality: 'criticality: reject (0)'
                per.open_type_length: 'Open Type Length: 19'
                ngap.value_element:
                    per.choice_index: 'Choice Index: 1'
                    ngap.UserLocationInformation:
                        ngap.userLocationInformationNR_element:
                            per.extension_bit: '..0. .... Extension Bit: False'
                            per.optional_field_bit: '.... 0... Optional Field Bit: False (iE-Extensions is NOT present)'
                            ngap.nR_CGI_element:
                                per.extension_bit: '.... .0.. Extension Bit: False'
                                per.optional_field_bit: '.... ..0. Optional Field Bit: False (iE-Extensions is NOT present)'
                                ngap.pLMNIdentity:
                                    e212.mcc: 'Mobile Country Code (MCC): International Mobile, shared code (901)'
                                    e212.mnc: 'Mobile Network Code (MNC): Unknown (70)'
                                ngap.NRCellIdentity: 'nRCellIdentity: 0x0000000010'
                            ngap.tAI_element:
                                per.extension_bit: '.... 0... Extension Bit: False'
                                per.optional_field_bit: '.... .0.. Optional Field Bit: False (iE-Extensions is NOT present)'
                                ngap.pLMNIdentity:
                                    e212.mcc: 'Mobile Country Code (MCC): International Mobile, shared code (901)'
                                    e212.mnc: 'Mobile Network Code (MNC): Unknown (70)'
                                ngap.tAC: 'tAC: 1 (0x000001)'
                            ngap.timeStamp: 'timeStamp: e7155304 (Nov  8, 2022 22:13:24 UTC)'
            'Item 3: id-RRCEstablishmentCause':
                ngap.id: 'id: id-RRCEstablishmentCause (90)'
                per.enum_index: 'Enumerated Index: 1'
                ngap.criticality: 'criticality: ignore (1)'
                per.open_type_length: 'Open Type Length: 1'
                ngap.value_element:
                    per.extension_present_bit: '0... .... Extension Present Bit: False'
                    per.enum_index: 'Enumerated Index: 3'
                    ngap.RRCEstablishmentCause: 'RRCEstablishmentCause: mo-Signalling (3)'
            'Item 4: id-UEContextRequest':
                ngap.id: 'id: id-UEContextRequest (112)'
                per.enum_index: 'Enumerated Index: 1'
                ngap.criticality: 'criticality: ignore (1)'
                per.open_type_length: 'Open Type Length: 1'
                ngap.value_element:
                    per.extension_present_bit: '0... .... Extension Present Bit: False'
                    per.enum_index: 'Enumerated Index: 0'
                    ngap.UEContextRequest: 'UEContextRequest: requested (0)'

end note

"10.0.2.4" -> "10.0.2.15": 24, NGAP DownlinkNASTransport (4),\nNAS Authentication request (0x56)

note right #8cd98c
**10.0.2.4 to 10.0.2.15**
NGAP-PDU: 0004403e000003000a0002001e0055000200010026002b2a7e005601020000217b33540808972951c93453879bd1c3af20104fa4a08a802a8000e56f94daba238aab
ngap.procedureCode: 'procedureCode: id-DownlinkNASTransport (4)'
per.enum_index: 'Enumerated Index: 1'
ngap.criticality: 'criticality: ignore (1)'
per.open_type_length: 'Open Type Length: 62'
ngap.value_element:
-   ngap.DownlinkNASTransport_element:
        per.extension_bit: '0... .... Extension Bit: False'
        per.sequence_of_length: 'Sequence-Of Length: 3'
        ngap.protocolIEs:
            'Item 0: id-AMF-UE-NGAP-ID':
                ngap.id: 'id: id-AMF-UE-NGAP-ID (10)'
                per.enum_index: 'Enumerated Index: 0'
                ngap.criticality: 'criticality: reject (0)'
                per.open_type_length: 'Open Type Length: 2'
                ngap.value_element:
                    ngap.AMF_UE_NGAP_ID: 'AMF-UE-NGAP-ID: 30'
            'Item 1: id-RAN-UE-NGAP-ID':
                ngap.id: 'id: id-RAN-UE-NGAP-ID (85)'
                per.enum_index: 'Enumerated Index: 0'
                ngap.criticality: 'criticality: reject (0)'
                per.open_type_length: 'Open Type Length: 2'
                ngap.value_element:
                    ngap.RAN_UE_NGAP_ID: 'RAN-UE-NGAP-ID: 1'
            'Item 2: id-NAS-PDU':
                ngap.id: 'id: id-NAS-PDU (38)'
                per.enum_index: 'Enumerated Index: 0'
                ngap.criticality: 'criticality: reject (0)'
                per.open_type_length: 'Open Type Length: 43'
                ngap.value_element:
                    per.octet_string_length: 'Octet String Length: 42'
                    ngap.NAS_PDU:
                        nas-5gs:
                            Plain NAS 5GS Message:
                                nas_5gs.epd: 'Extended protocol discriminator: 5G mobility management messages (126)'
                                nas_5gs.spare_half_octet: '0000 .... = Spare Half Octet: 0'
                                nas_5gs.security_header_type: '.... 0000 = Security header type: Plain NAS message, not security protected (0)'
                                nas_5gs.mm.message_type: 'Message type: Authentication request (0x56)'
                                NAS key set identifier - ngKSI:
                                    nas_5gs.mm.tsc: '.... 0... = Type of security context flag (TSC): Native security context (for KSIAMF)'
                                    nas_5gs.mm.nas_key_set_id: '.... .001 = NAS key set identifier: 1'
                                ABBA:
                                    gsm_a.len: 'Length: 2'
                                    nas_5gs.mm.abba_contents: 'ABBA Contents: 0x0000'
                                Authentication Parameter RAND - 5G authentication challenge:
                                    gsm_a.dtap.elem_id: 'Element ID: 0x21'
                                    gsm_a.dtap.rand: 'RAND value: 7b33540808972951c93453879bd1c3af'
                                Authentication Parameter AUTN (UMTS and EPS authentication challenge) - 5G authentication challenge:
                                    gsm_a.dtap.elem_id: 'Element ID: 0x20'
                                    gsm_a.len: 'Length: 16'
                                    gsm_a.dtap.autn:
                                        gsm_a.dtap.autn.sqn_xor_ak: 'SQN xor AK: 4fa4a08a802a'
                                        gsm_a.dtap.autn.amf: 'AMF: 8000'
                                        gsm_a.dtap.autn.mac: 'MAC: e56f94daba238aab'

end note

"10.0.2.15" -> "10.0.2.4": 25, NGAP UplinkNASTransport (46),\nNAS Authentication response (0x57)

note right #c6ebc6
**10.0.2.15 to 10.0.2.4**
NGAP-PDU: 002e4040000004000a0002001e00550002000100260016157e00572d1040c3b519755f1bbe63f4c2e6e1f0bfc4007940135009f107000000010009f107000001e7155304
ngap.procedureCode: 'procedureCode: id-UplinkNASTransport (46)'
per.enum_index: 'Enumerated Index: 1'
ngap.criticality: 'criticality: ignore (1)'
per.open_type_length: 'Open Type Length: 64'
ngap.value_element:
-   ngap.UplinkNASTransport_element:
        per.extension_bit: '0... .... Extension Bit: False'
        per.sequence_of_length: 'Sequence-Of Length: 4'
        ngap.protocolIEs:
            'Item 0: id-AMF-UE-NGAP-ID':
                ngap.id: 'id: id-AMF-UE-NGAP-ID (10)'
                per.enum_index: 'Enumerated Index: 0'
                ngap.criticality: 'criticality: reject (0)'
                per.open_type_length: 'Open Type Length: 2'
                ngap.value_element:
                    ngap.AMF_UE_NGAP_ID: 'AMF-UE-NGAP-ID: 30'
            'Item 1: id-RAN-UE-NGAP-ID':
                ngap.id: 'id: id-RAN-UE-NGAP-ID (85)'
                per.enum_index: 'Enumerated Index: 0'
                ngap.criticality: 'criticality: reject (0)'
                per.open_type_length: 'Open Type Length: 2'
                ngap.value_element:
                    ngap.RAN_UE_NGAP_ID: 'RAN-UE-NGAP-ID: 1'
            'Item 2: id-NAS-PDU':
                ngap.id: 'id: id-NAS-PDU (38)'
                per.enum_index: 'Enumerated Index: 0'
                ngap.criticality: 'criticality: reject (0)'
                per.open_type_length: 'Open Type Length: 22'
                ngap.value_element:
                    per.octet_string_length: 'Octet String Length: 21'
                    ngap.NAS_PDU:
                        nas-5gs:
                            Plain NAS 5GS Message:
                                nas_5gs.epd: 'Extended protocol discriminator: 5G mobility management messages (126)'
                                nas_5gs.spare_half_octet: '0000 .... = Spare Half Octet: 0'
                                nas_5gs.security_header_type: '.... 0000 = Security header type: Plain NAS message, not security protected (0)'
                                nas_5gs.mm.message_type: 'Message type: Authentication response (0x57)'
                                Authentication response parameter:
                                    nas_eps.emm.elem_id: 'Element ID: 0x2d'
                                    gsm_a.len: 'Length: 16'
                                    nas_eps.emm.res: 'RES: 40c3b519755f1bbe63f4c2e6e1f0bfc4'
            'Item 3: id-UserLocationInformation':
                ngap.id: 'id: id-UserLocationInformation (121)'
                per.enum_index: 'Enumerated Index: 1'
                ngap.criticality: 'criticality: ignore (1)'
                per.open_type_length: 'Open Type Length: 19'
                ngap.value_element:
                    per.choice_index: 'Choice Index: 1'
                    ngap.UserLocationInformation:
                        ngap.userLocationInformationNR_element:
                            per.extension_bit: '..0. .... Extension Bit: False'
                            per.optional_field_bit: '.... 0... Optional Field Bit: False (iE-Extensions is NOT present)'
                            ngap.nR_CGI_element:
                                per.extension_bit: '.... .0.. Extension Bit: False'
                                per.optional_field_bit: '.... ..0. Optional Field Bit: False (iE-Extensions is NOT present)'
                                ngap.pLMNIdentity:
                                    e212.mcc: 'Mobile Country Code (MCC): International Mobile, shared code (901)'
                                    e212.mnc: 'Mobile Network Code (MNC): Unknown (70)'
                                ngap.NRCellIdentity: 'nRCellIdentity: 0x0000000010'
                            ngap.tAI_element:
                                per.extension_bit: '.... 0... Extension Bit: False'
                                per.optional_field_bit: '.... .0.. Optional Field Bit: False (iE-Extensions is NOT present)'
                                ngap.pLMNIdentity:
                                    e212.mcc: 'Mobile Country Code (MCC): International Mobile, shared code (901)'
                                    e212.mnc: 'Mobile Network Code (MNC): Unknown (70)'
                                ngap.tAC: 'tAC: 1 (0x000001)'
                            ngap.timeStamp: 'timeStamp: e7155304 (Nov  8, 2022 22:13:24 UTC)'

end note

"10.0.2.4" -> "10.0.2.15": 26, NGAP DownlinkNASTransport (4),\nNAS Security mode command (0x5d)

note right #c6ebc6
**10.0.2.4 to 10.0.2.15**
NGAP-PDU: 00044029000003000a0002001e00550002000100260016157e031d22a49c007e005d020104f0f0f0f0e1360102
ngap.procedureCode: 'procedureCode: id-DownlinkNASTransport (4)'
per.enum_index: 'Enumerated Index: 1'
ngap.criticality: 'criticality: ignore (1)'
per.open_type_length: 'Open Type Length: 41'
ngap.value_element:
-   ngap.DownlinkNASTransport_element:
        per.extension_bit: '0... .... Extension Bit: False'
        per.sequence_of_length: 'Sequence-Of Length: 3'
        ngap.protocolIEs:
            'Item 0: id-AMF-UE-NGAP-ID':
                ngap.id: 'id: id-AMF-UE-NGAP-ID (10)'
                per.enum_index: 'Enumerated Index: 0'
                ngap.criticality: 'criticality: reject (0)'
                per.open_type_length: 'Open Type Length: 2'
                ngap.value_element:
                    ngap.AMF_UE_NGAP_ID: 'AMF-UE-NGAP-ID: 30'
            'Item 1: id-RAN-UE-NGAP-ID':
                ngap.id: 'id: id-RAN-UE-NGAP-ID (85)'
                per.enum_index: 'Enumerated Index: 0'
                ngap.criticality: 'criticality: reject (0)'
                per.open_type_length: 'Open Type Length: 2'
                ngap.value_element:
                    ngap.RAN_UE_NGAP_ID: 'RAN-UE-NGAP-ID: 1'
            'Item 2: id-NAS-PDU':
                ngap.id: 'id: id-NAS-PDU (38)'
                per.enum_index: 'Enumerated Index: 0'
                ngap.criticality: 'criticality: reject (0)'
                per.open_type_length: 'Open Type Length: 22'
                ngap.value_element:
                    per.octet_string_length: 'Octet String Length: 21'
                    ngap.NAS_PDU:
                        nas-5gs:
                            Security protected NAS 5GS message:
                                nas_5gs.epd: 'Extended protocol discriminator: 5G mobility management messages (126)'
                                nas_5gs.spare_half_octet: '0000 .... = Spare Half Octet: 0'
                                nas_5gs.security_header_type: '.... 0011 = Security header type: Integrity protected with new 5GS security context (3)'
                                nas_5gs.msg_auth_code: 'Message authentication code: 0x1d22a49c'
                                nas_5gs.seq_no: 'Sequence number: 0'
                            Plain NAS 5GS Message:
                                nas_5gs.epd: 'Extended protocol discriminator: 5G mobility management messages (126)'
                                nas_5gs.spare_half_octet: '0000 .... = Spare Half Octet: 0'
                                nas_5gs.security_header_type: '.... 0000 = Security header type: Plain NAS message, not security protected (0)'
                                nas_5gs.mm.message_type: 'Message type: Security mode command (0x5d)'
                                NAS security algorithms:
                                    nas_5gs.mm.nas_sec_algo_enc: '0000 .... = Type of ciphering algorithm: 5G-EA0 (null ciphering algorithm) (0)'
                                    nas_5gs.mm.nas_sec_algo_ip: '.... 0010 = Type of integrity protection algorithm: 128-5G-IA2 (2)'
                                NAS key set identifier - ngKSI:
                                    nas_5gs.mm.tsc: '.... 0... = Type of security context flag (TSC): Native security context (for KSIAMF)'
                                    nas_5gs.mm.nas_key_set_id: '.... .001 = NAS key set identifier: 1'
                                UE security capability - Replayed UE security capabilities:
                                    gsm_a.len: 'Length: 4'
                                    nas_5gs.mm.5g_ea0: '1... .... = 5G-EA0: Supported'
                                    nas_5gs.mm.128_5g_ea1: '.1.. .... = 128-5G-EA1: Supported'
                                    nas_5gs.mm.128_5g_ea2: '..1. .... = 128-5G-EA2: Supported'
                                    nas_5gs.mm.128_5g_ea3: '...1 .... = 128-5G-EA3: Supported'
                                    nas_5gs.mm.5g_ea4: '.... 0... = 5G-EA4: Not supported'
                                    nas_5gs.mm.5g_ea5: '.... .0.. = 5G-EA5: Not supported'
                                    nas_5gs.mm.5g_ea6: '.... ..0. = 5G-EA6: Not supported'
                                    nas_5gs.mm.5g_ea7: '.... ...0 = 5G-EA7: Not supported'
                                    nas_5gs.mm.ia0: '1... .... = 5G-IA0: Supported'
                                    nas_5gs.mm.5g_128_ia1: '.1.. .... = 128-5G-IA1: Supported'
                                    nas_5gs.mm.5g_128_ia2: '..1. .... = 128-5G-IA2: Supported'
                                    nas_5gs.mm.5g_128_ia4: '.... 0... = 5G-IA4: Not supported'
                                    nas_5gs.mm.5g_ia5: '.... .0.. = 5G-IA5: Not supported'
                                    nas_5gs.mm.5g_ia6: '.... ..0. = 5G-IA6: Not supported'
                                    nas_5gs.mm.5g_ia7: '.... ...0 = 5G-IA7: Not supported'
                                    nas_5gs.mm.eea0: '1... .... = EEA0: Supported'
                                    nas_5gs.mm.128eea1: '.1.. .... = 128-EEA1: Supported'
                                    nas_5gs.mm.128eea2: '..1. .... = 128-EEA2: Supported'
                                    nas_5gs.mm.eea3: '...1 .... = 128-EEA3: Supported'
                                    nas_5gs.mm.eea4: '.... 0... = EEA4: Not supported'
                                    nas_5gs.mm.eea5: '.... .0.. = EEA5: Not supported'
                                    nas_5gs.mm.eea6: '.... ..0. = EEA6: Not supported'
                                    nas_5gs.mm.eea7: '.... ...0 = EEA7: Not supported'
                                    nas_5gs.mm.eia0: '1... .... = EIA0: Supported'
                                    nas_5gs.mm.128eia1: '.1.. .... = 128-EIA1: Supported'
                                    nas_5gs.mm.128eia2: '..1. .... = 128-EIA2: Supported'
                                    nas_5gs.mm.eia3: '...1 .... = 128-EIA3: Supported'
                                    nas_5gs.mm.eia4: '.... 0... = EIA4: Not supported'
                                    nas_5gs.mm.eia5: '.... .0.. = EIA5: Not supported'
                                    nas_5gs.mm.eia6: '.... ..0. = EIA6: Not supported'
                                    nas_5gs.mm.eia7: '.... ...0 = EIA7: Not supported'
                                IMEISV request:
                                    gsm_a.common.elem_id: '1110 .... = Element ID: 0xe-'
                                    nas_eps.spare_bits: '.... 0... = Spare bit(s): 0x00'
                                    nas_eps.emm.imeisv_req: '.... .001 = IMEISV request: IMEISV requested (1)'
                                Additional 5G security information:
                                    nas_5gs.mm.elem_id: 'Element ID: 0x36'
                                    gsm_a.len: 'Length: 1'
                                    nas_5gs.spare_b3: '.... 0... = Spare: 0'
                                    nas_5gs.spare_b2: '.... .0.. = Spare: 0'
                                    nas_5gs.mm.rinmr: '.... ..1. = Retransmission of initial NAS message request(RINMR): Requested'
                                    nas_5gs.mm.hdp: '.... ...0 = Horizontal derivation parameter (HDP): Not required'

end note

"10.0.2.15" -> "10.0.2.4": 27, NGAP UplinkNASTransport (46),\nNAS Security mode complete (0x5e),\nNAS Registration request (0x41)

note right #8cd98c
**10.0.2.15 to 10.0.2.4**
NGAP-PDU: 002e4067000004000a0002001e0055000200010026003d3c7e04b31c2f1a007e005e7700094573806121856151f17100237e004179000d0109f1070000000000000000101001002e04f0f0f0f02f020101530100007940135009f107000000010009f107000001e7155304
ngap.procedureCode: 'procedureCode: id-UplinkNASTransport (46)'
per.enum_index: 'Enumerated Index: 1'
ngap.criticality: 'criticality: ignore (1)'
per.open_type_length: 'Open Type Length: 103'
ngap.value_element:
-   ngap.UplinkNASTransport_element:
        per.extension_bit: '0... .... Extension Bit: False'
        per.sequence_of_length: 'Sequence-Of Length: 4'
        ngap.protocolIEs:
            'Item 0: id-AMF-UE-NGAP-ID':
                ngap.id: 'id: id-AMF-UE-NGAP-ID (10)'
                per.enum_index: 'Enumerated Index: 0'
                ngap.criticality: 'criticality: reject (0)'
                per.open_type_length: 'Open Type Length: 2'
                ngap.value_element:
                    ngap.AMF_UE_NGAP_ID: 'AMF-UE-NGAP-ID: 30'
            'Item 1: id-RAN-UE-NGAP-ID':
                ngap.id: 'id: id-RAN-UE-NGAP-ID (85)'
                per.enum_index: 'Enumerated Index: 0'
                ngap.criticality: 'criticality: reject (0)'
                per.open_type_length: 'Open Type Length: 2'
                ngap.value_element:
                    ngap.RAN_UE_NGAP_ID: 'RAN-UE-NGAP-ID: 1'
            'Item 2: id-NAS-PDU':
                ngap.id: 'id: id-NAS-PDU (38)'
                per.enum_index: 'Enumerated Index: 0'
                ngap.criticality: 'criticality: reject (0)'
                per.open_type_length: 'Open Type Length: 61'
                ngap.value_element:
                    per.octet_string_length: 'Octet String Length: 60'
                    ngap.NAS_PDU:
                        nas-5gs:
                            Security protected NAS 5GS message:
                                nas_5gs.epd: 'Extended protocol discriminator: 5G mobility management messages (126)'
                                nas_5gs.spare_half_octet: '0000 .... = Spare Half Octet: 0'
                                nas_5gs.security_header_type: '.... 0100 = Security header type: Integrity protected and ciphered with new 5GS security context (4)'
                                nas_5gs.msg_auth_code: 'Message authentication code: 0xb31c2f1a'
                                nas_5gs.seq_no: 'Sequence number: 0'
                            Plain NAS 5GS Message:
                                nas_5gs.epd: 'Extended protocol discriminator: 5G mobility management messages (126)'
                                nas_5gs.spare_half_octet: '0000 .... = Spare Half Octet: 0'
                                nas_5gs.security_header_type: '.... 0000 = Security header type: Plain NAS message, not security protected (0)'
                                nas_5gs.mm.message_type: 'Message type: Security mode complete (0x5e)'
                                5GS mobile identity:
                                    nas_5gs.mm.elem_id: 'Element ID: 0x77'
                                    gsm_a.len: 'Length: 9'
                                    nas_5gs.mm.odd_even: '.... 0... = Odd/even indication: Even number of identity digits'
                                    nas_5gs.mm.type_id: '.... .101 = Type of identity: IMEISV (5)'
                                    nas_5gs.mm.imeisv: 'IMEISV: 4370816125816151'
                                NAS message container:
                                    nas_5gs.mm.elem_id: 'Element ID: 0x71'
                                    gsm_a.len: 'Length: 35'
                                    nas-5gs:
                                        Plain NAS 5GS Message:
                                            nas_5gs.epd: 'Extended protocol discriminator: 5G mobility management messages (126)'
                                            nas_5gs.spare_half_octet: '0000 .... = Spare Half Octet: 0'
                                            nas_5gs.security_header_type: '.... 0000 = Security header type: Plain NAS message, not security protected (0)'
                                            nas_5gs.mm.message_type: 'Message type: Registration request (0x41)'
                                            5GS registration type:
                                                nas_5gs.mm.for: '.... 1... = Follow-On Request bit (FOR): Follow-on request pending'
                                                nas_5gs.mm.5gs_reg_type: '.... .001 = 5GS registration type: initial registration (1)'
                                            NAS key set identifier:
                                                nas_5gs.mm.tsc.h1: '0... .... = Type of security context flag (TSC): Native security context (for KSIAMF)'
                                                nas_5gs.mm.nas_key_set_id.h1: '.111 .... = NAS key set identifier: 7'
                                            5GS mobile identity:
                                                gsm_a.len: 'Length: 13'
                                                nas_5gs.spare_b7: '0... .... = Spare: 0'
                                                nas_5gs.mm.suci.supi_fmt: '.000 .... = SUPI format: IMSI (0)'
                                                nas_5gs.spare_b3: '.... 0... = Spare: 0'
                                                nas_5gs.mm.type_id: '.... .001 = Type of identity: SUCI (1)'
                                                e212.mcc: 'Mobile Country Code (MCC): International Mobile, shared code (901)'
                                                e212.mnc: 'Mobile Network Code (MNC): Unknown (70)'
                                                nas_5gs.mm.suci.routing_indicator: 'Routing indicator: 0000'
                                                nas_5gs.mm.suci.scheme_id: '.... 0000 = Protection scheme Id: NULL scheme (0)'
                                                nas_5gs.mm.suci.pki: 'Home network public key identifier: 0'
                                                nas_5gs.mm.suci.supi_null_scheme: 'Scheme output: 0000000001'
                                            5GMM capability:
                                                nas_5gs.mm.elem_id: 'Element ID: 0x10'
                                                gsm_a.len: 'Length: 1'
                                                nas_5gs.spare_b7: '0... .... = Spare: 0'
                                                nas_5gs.spare_b6: '.0.. .... = Spare: 0'
                                                nas_5gs.spare_b5: '..0. .... = Spare: 0'
                                                nas_5gs.spare_b4: '...0 .... = Spare: 0'
                                                nas_5gs.spare_b3: '.... 0... = Spare: 0'
                                                nas_5gs.mm.lpp_cap_b2: '.... .0.. = LTE Positioning Protocol (LPP) capability: Not Requested'
                                                nas_5gs.mm.ho_attach_b1: '.... ..0. = HO attach: Not supported'
                                                nas_5gs.mm.s1_mode_b0: '.... ...0 = S1 mode: Not Requested'
                                            UE security capability:
                                                nas_5gs.mm.elem_id: 'Element ID: 0x2e'
                                                gsm_a.len: 'Length: 4'
                                                nas_5gs.mm.5g_ea0: '1... .... = 5G-EA0: Supported'
                                                nas_5gs.mm.128_5g_ea1: '.1.. .... = 128-5G-EA1: Supported'
                                                nas_5gs.mm.128_5g_ea2: '..1. .... = 128-5G-EA2: Supported'
                                                nas_5gs.mm.128_5g_ea3: '...1 .... = 128-5G-EA3: Supported'
                                                nas_5gs.mm.5g_ea4: '.... 0... = 5G-EA4: Not supported'
                                                nas_5gs.mm.5g_ea5: '.... .0.. = 5G-EA5: Not supported'
                                                nas_5gs.mm.5g_ea6: '.... ..0. = 5G-EA6: Not supported'
                                                nas_5gs.mm.5g_ea7: '.... ...0 = 5G-EA7: Not supported'
                                                nas_5gs.mm.ia0: '1... .... = 5G-IA0: Supported'
                                                nas_5gs.mm.5g_128_ia1: '.1.. .... = 128-5G-IA1: Supported'
                                                nas_5gs.mm.5g_128_ia2: '..1. .... = 128-5G-IA2: Supported'
                                                nas_5gs.mm.5g_128_ia4: '.... 0... = 5G-IA4: Not supported'
                                                nas_5gs.mm.5g_ia5: '.... .0.. = 5G-IA5: Not supported'
                                                nas_5gs.mm.5g_ia6: '.... ..0. = 5G-IA6: Not supported'
                                                nas_5gs.mm.5g_ia7: '.... ...0 = 5G-IA7: Not supported'
                                                nas_5gs.mm.eea0: '1... .... = EEA0: Supported'
                                                nas_5gs.mm.128eea1: '.1.. .... = 128-EEA1: Supported'
                                                nas_5gs.mm.128eea2: '..1. .... = 128-EEA2: Supported'
                                                nas_5gs.mm.eea3: '...1 .... = 128-EEA3: Supported'
                                                nas_5gs.mm.eea4: '.... 0... = EEA4: Not supported'
                                                nas_5gs.mm.eea5: '.... .0.. = EEA5: Not supported'
                                                nas_5gs.mm.eea6: '.... ..0. = EEA6: Not supported'
                                                nas_5gs.mm.eea7: '.... ...0 = EEA7: Not supported'
                                                nas_5gs.mm.eia0: '1... .... = EIA0: Supported'
                                                nas_5gs.mm.128eia1: '.1.. .... = 128-EIA1: Supported'
                                                nas_5gs.mm.128eia2: '..1. .... = 128-EIA2: Supported'
                                                nas_5gs.mm.eia3: '...1 .... = 128-EIA3: Supported'
                                                nas_5gs.mm.eia4: '.... 0... = EIA4: Not supported'
                                                nas_5gs.mm.eia5: '.... .0.. = EIA5: Not supported'
                                                nas_5gs.mm.eia6: '.... ..0. = EIA6: Not supported'
                                                nas_5gs.mm.eia7: '.... ...0 = EIA7: Not supported'
                                            NSSAI - Requested NSSAI:
                                                nas_5gs.mm.elem_id: 'Element ID: 0x2f'
                                                gsm_a.len: 'Length: 2'
                                                S-NSSAI 1:
                                                    nas_5gs.mm.length: 'Length: 1'
                                                    nas_5gs.mm.sst: 'Slice/service type (SST): 1'
                                            5GS update type:
                                                nas_5gs.mm.elem_id: 'Element ID: 0x53'
                                                gsm_a.len: 'Length: 1'
                                                nas_5gs.spare_b3: '.... 0... = Spare: 0'
                                                nas_5gs.spare_b2: '.... .0.. = Spare: 0'
                                                nas_5gs.mm.ng_ran_rcu: '.... ..0. = NG-RAN Radio Capability Update (NG-RAN-RCU): Not Needed'
                                                nas_5gs.mm.sms_requested: '.... ...0 = SMS requested: SMS over NAS not supported'
            'Item 3: id-UserLocationInformation':
                ngap.id: 'id: id-UserLocationInformation (121)'
                per.enum_index: 'Enumerated Index: 1'
                ngap.criticality: 'criticality: ignore (1)'
                per.open_type_length: 'Open Type Length: 19'
                ngap.value_element:
                    per.choice_index: 'Choice Index: 1'
                    ngap.UserLocationInformation:
                        ngap.userLocationInformationNR_element:
                            per.extension_bit: '..0. .... Extension Bit: False'
                            per.optional_field_bit: '.... 0... Optional Field Bit: False (iE-Extensions is NOT present)'
                            ngap.nR_CGI_element:
                                per.extension_bit: '.... .0.. Extension Bit: False'
                                per.optional_field_bit: '.... ..0. Optional Field Bit: False (iE-Extensions is NOT present)'
                                ngap.pLMNIdentity:
                                    e212.mcc: 'Mobile Country Code (MCC): International Mobile, shared code (901)'
                                    e212.mnc: 'Mobile Network Code (MNC): Unknown (70)'
                                ngap.NRCellIdentity: 'nRCellIdentity: 0x0000000010'
                            ngap.tAI_element:
                                per.extension_bit: '.... 0... Extension Bit: False'
                                per.optional_field_bit: '.... .0.. Optional Field Bit: False (iE-Extensions is NOT present)'
                                ngap.pLMNIdentity:
                                    e212.mcc: 'Mobile Country Code (MCC): International Mobile, shared code (901)'
                                    e212.mnc: 'Mobile Network Code (MNC): Unknown (70)'
                                ngap.tAC: 'tAC: 1 (0x000001)'
                            ngap.timeStamp: 'timeStamp: e7155304 (Nov  8, 2022 22:13:24 UTC)'

end note

"10.0.2.4" -> "10.0.2.15": 28, NGAP InitialContextSetup (14),\nNAS Registration accept (0x42)

note right #c6ebc6
**10.0.2.4 to 10.0.2.15**
NGAP-PDU: 000e008090000008000a0002001e005500020001001c00070009f107020040000000020001007700091c000e000700038000005e002024918bb31a38ad0020b91bc6e967f9a2da6a1f7a088aca7a135336f292bfe97f002240084370816125ffff510026402f2e7e021d0ab983017e0042010177000bf209f107020040d50007fc54072009f10700000115020101210201005e0129
ngap.procedureCode: 'procedureCode: id-InitialContextSetup (14)'
per.enum_index: 'Enumerated Index: 0'
ngap.criticality: 'criticality: reject (0)'
per.open_type_length: 'Open Type Length: 144'
ngap.value_element:
-   ngap.InitialContextSetupRequest_element:
        per.extension_bit: '0... .... Extension Bit: False'
        per.sequence_of_length: 'Sequence-Of Length: 8'
        ngap.protocolIEs:
            'Item 0: id-AMF-UE-NGAP-ID':
                ngap.id: 'id: id-AMF-UE-NGAP-ID (10)'
                per.enum_index: 'Enumerated Index: 0'
                ngap.criticality: 'criticality: reject (0)'
                per.open_type_length: 'Open Type Length: 2'
                ngap.value_element:
                    ngap.AMF_UE_NGAP_ID: 'AMF-UE-NGAP-ID: 30'
            'Item 1: id-RAN-UE-NGAP-ID':
                ngap.id: 'id: id-RAN-UE-NGAP-ID (85)'
                per.enum_index: 'Enumerated Index: 0'
                ngap.criticality: 'criticality: reject (0)'
                per.open_type_length: 'Open Type Length: 2'
                ngap.value_element:
                    ngap.RAN_UE_NGAP_ID: 'RAN-UE-NGAP-ID: 1'
            'Item 2: id-GUAMI':
                ngap.id: 'id: id-GUAMI (28)'
                per.enum_index: 'Enumerated Index: 0'
                ngap.criticality: 'criticality: reject (0)'
                per.open_type_length: 'Open Type Length: 7'
                ngap.value_element:
                    ngap.GUAMI_element:
                        per.extension_bit: '0... .... Extension Bit: False'
                        per.optional_field_bit: '.0.. .... Optional Field Bit: False (iE-Extensions is NOT present)'
                        ngap.pLMNIdentity:
                            e212.mcc: 'Mobile Country Code (MCC): International Mobile, shared code (901)'
                            e212.mnc: 'Mobile Network Code (MNC): Unknown (70)'
                        ngap.aMFRegionID: 'aMFRegionID: 02 [bit length 8, 0000 0010 decimal value 2]'
                        ngap.aMFSetID: 'aMFSetID: 0040 [bit length 10, 6 LSB pad bits, 0000 0000  01.. .... decimal value 1]'
                        ngap.aMFPointer: 'aMFPointer: 00 [bit length 6, 2 LSB pad bits, 0000 00.. decimal value 0]'
            'Item 3: id-AllowedNSSAI':
                ngap.id: 'id: id-AllowedNSSAI (0)'
                per.enum_index: 'Enumerated Index: 0'
                ngap.criticality: 'criticality: reject (0)'
                per.open_type_length: 'Open Type Length: 2'
                ngap.value_element:
                    per.sequence_of_length: 'Sequence-Of Length: 1'
                    ngap.AllowedNSSAI:
                        Item 0:
                            ngap.AllowedNSSAI_Item_element:
                                per.extension_bit: '...0 .... Extension Bit: False'
                                per.optional_field_bit: '.... 0... Optional Field Bit: False (iE-Extensions is NOT present)'
                                ngap.s_NSSAI_element:
                                    per.extension_bit: '.... .0.. Extension Bit: False'
                                    per.optional_field_bit: '.... ...0 Optional Field Bit: False (iE-Extensions is NOT present)'
                                    ngap.sST: 'sST: 01'
            'Item 4: id-UESecurityCapabilities':
                ngap.id: 'id: id-UESecurityCapabilities (119)'
                per.enum_index: 'Enumerated Index: 0'
                ngap.criticality: 'criticality: reject (0)'
                per.open_type_length: 'Open Type Length: 9'
                ngap.value_element:
                    ngap.UESecurityCapabilities_element:
                        per.extension_bit: '0... .... Extension Bit: False'
                        per.optional_field_bit: '.0.. .... Optional Field Bit: False (iE-Extensions is NOT present)'
                        per.extension_present_bit: '.... .0.. Extension Present Bit: False'
                        ngap.nRencryptionAlgorithms:
                            ngap.NrencyptionAlgorithms.nea1: '1... .... .... .... = 128-NEA1: Supported'
                            ngap.NrencyptionAlgorithms.nea2: '.1.. .... .... .... = 128-NEA2: Supported'
                            ngap.NrencyptionAlgorithms.nea3: '..1. .... .... .... = 128-NEA3: Supported'
                            ngap.NrencyptionAlgorithms.reserved: '...0 0000 0000 0000 = Reserved: 0x0000'
                        ngap.nRintegrityProtectionAlgorithms:
                            ngap.NrintegrityProtectionAlgorithms.nia1: '1... .... .... .... = 128-NIA1: Supported'
                            ngap.NrintegrityProtectionAlgorithms.nia2: '.1.. .... .... .... = 128-NIA2: Supported'
                            ngap.NrintegrityProtectionAlgorithms.nia3: '..1. .... .... .... = 128-NIA3: Supported'
                            ngap.NrintegrityProtectionAlgorithms.reserved: '...0 0000 0000 0000 = Reserved: 0x0000'
                        ngap.eUTRAencryptionAlgorithms:
                            ngap.EUTRAencryptionAlgorithms.eea1: '1... .... .... .... = 128-EEA1: Supported'
                            ngap.EUTRAencryptionAlgorithms.eea2: '.1.. .... .... .... = 128-EEA2: Supported'
                            ngap.EUTRAencryptionAlgorithms.eea3: '..1. .... .... .... = 128-EEA3: Supported'
                            ngap.EUTRAencryptionAlgorithms.reserved: '...0 0000 0000 0000 = Reserved: 0x0000'
                        ngap.eUTRAintegrityProtectionAlgorithms:
                            ngap.EUTRAintegrityProtectionAlgorithms.eia1: '1... .... .... .... = 128-EIA1: Supported'
                            ngap.EUTRAintegrityProtectionAlgorithms.eia2: '.1.. .... .... .... = 128-EIA2: Supported'
                            ngap.EUTRAintegrityProtectionAlgorithms.eia3: '..1. .... .... .... = 128-EIA3: Supported'
                            ngap.EUTRAintegrityProtectionAlgorithms.reserved: '...0 0000 0000 0000 = Reserved: 0x0000'
            'Item 5: id-SecurityKey':
                ngap.id: 'id: id-SecurityKey (94)'
                per.enum_index: 'Enumerated Index: 0'
                ngap.criticality: 'criticality: reject (0)'
                per.open_type_length: 'Open Type Length: 32'
                ngap.value_element:
                    ngap.SecurityKey: 'SecurityKey: 24918bb31a38ad0020b91bc6e967f9a2da6a1f7a088aca7a\xe2\x80\xa6 [bit length 256]'
            'Item 6: id-MaskedIMEISV':
                ngap.id: 'id: id-MaskedIMEISV (34)'
                per.enum_index: 'Enumerated Index: 1'
                ngap.criticality: 'criticality: ignore (1)'
                per.open_type_length: 'Open Type Length: 8'
                ngap.value_element:
                    ngap.MaskedIMEISV: 'MaskedIMEISV: 4370816125ffff51 [bit length 64, 0100 0011  0111 0000  1000 0001  0110 0001  0010 0101  1111 1111  1111 1111  0101 0001 decimal value 4859526252182110033]'
            'Item 7: id-NAS-PDU':
                ngap.id: 'id: id-NAS-PDU (38)'
                per.enum_index: 'Enumerated Index: 1'
                ngap.criticality: 'criticality: ignore (1)'
                per.open_type_length: 'Open Type Length: 47'
                ngap.value_element:
                    per.octet_string_length: 'Octet String Length: 46'
                    ngap.NAS_PDU:
                        nas-5gs:
                            Security protected NAS 5GS message:
                                nas_5gs.epd: 'Extended protocol discriminator: 5G mobility management messages (126)'
                                nas_5gs.spare_half_octet: '0000 .... = Spare Half Octet: 0'
                                nas_5gs.security_header_type: '.... 0010 = Security header type: Integrity protected and ciphered (2)'
                                nas_5gs.msg_auth_code: 'Message authentication code: 0x1d0ab983'
                                nas_5gs.seq_no: 'Sequence number: 1'
                            Plain NAS 5GS Message:
                                nas_5gs.epd: 'Extended protocol discriminator: 5G mobility management messages (126)'
                                nas_5gs.spare_half_octet: '0000 .... = Spare Half Octet: 0'
                                nas_5gs.security_header_type: '.... 0000 = Security header type: Plain NAS message, not security protected (0)'
                                nas_5gs.mm.message_type: 'Message type: Registration accept (0x42)'
                                5GS registration result:
                                    gsm_a.len: 'Length: 1'
                                    nas_5gs.mm.reg_res.nssaa_perf: '...0 .... = NSSAA Performed: False'
                                    nas_5gs.mm.reg_res.sms_all: '.... 0... = SMS over NAS: Not Allowed'
                                    nas_5gs.mm.reg_res.res: '.... .001 = 5GS registration result: 3GPP access (1)'
                                5GS mobile identity - 5G-GUTI:
                                    nas_5gs.mm.elem_id: 'Element ID: 0x77'
                                    gsm_a.len: 'Length: 11'
                                    nas_5gs.mm.odd_even: '.... 0... = Odd/even indication: Even number of identity digits'
                                    nas_5gs.mm.type_id: '.... .010 = Type of identity: 5G-GUTI (2)'
                                    e212.mcc: 'Mobile Country Code (MCC): International Mobile, shared code (901)'
                                    e212.mnc: 'Mobile Network Code (MNC): Unknown (70)'
                                    nas_5gs.amf_region_id: 'AMF Region ID: 2'
                                    nas_5gs.amf_set_id: '0000 0000 01.. .... = AMF Set ID: 1'
                                    nas_5gs.amf_pointer: '..00 0000 = AMF Pointer: 0'
                                    nas_5gs.5g_tmsi: '5G-TMSI: 0xd50007fc'
                                5GS tracking area identity list:
                                    nas_5gs.mm.elem_id: 'Element ID: 0x54'
                                    gsm_a.len: 'Length: 7'
                                    Partial tracking area list  1:
                                        nas_5gs.mm.tal_t_li: '.01. .... = Type of list: list of TACs belonging to one PLMN, with consecutive TAC values (1)'
                                        nas_5gs.mm.tal_num_e: '...0 0000 = Number of elements: 1 element (0)'
                                        e212.mcc: 'Mobile Country Code (MCC): International Mobile, shared code (901)'
                                        e212.mnc: 'Mobile Network Code (MNC): Unknown (70)'
                                        nas_5gs.tac: 'TAC: 1'
                                NSSAI - Allowed NSSAI:
                                    nas_5gs.mm.elem_id: 'Element ID: 0x15'
                                    gsm_a.len: 'Length: 2'
                                    S-NSSAI 1:
                                        nas_5gs.mm.length: 'Length: 1'
                                        nas_5gs.mm.sst: 'Slice/service type (SST): 1'
                                5GS network feature support:
                                    nas_5gs.mm.elem_id: 'Element ID: 0x21'
                                    gsm_a.len: 'Length: 2'
                                    nas_5gs.nw_feat_sup.mpsi: '0... .... = MPS indicator (MPSI): Access identity 1 not valid in RPLMN or equivalent PLMN'
                                    nas_5gs.nw_feat_sup.iwk_n26: '.0.. .... = Interworking without N26: Not supported'
                                    nas_5gs.nw_feat_sup.emf: '..00 .... = Emergency service fallback indicator (EMF): Emergency services fallback not supported (0)'
                                    nas_5gs.nw_feat_sup.emc: '.... 00.. = Emergency service support indicator (EMC): Emergency services not supported (0)'
                                    nas_5gs.nw_feat_sup.vops_n3gpp: '.... ..0. = IMS voice over PS session over non-3GPP access indicator (IMS-VoPS-N3GPP): Not supported'
                                    nas_5gs.nw_feat_sup.vops_3gpp: '.... ...1 = IMS voice over PS session indicator (IMS VoPS): Supported'
                                    nas_5gs.spare_b7: '0... .... = Spare: 0'
                                    nas_5gs.spare_b6: '.0.. .... = Spare: 0'
                                    nas_5gs.spare_b5: '..0. .... = Spare: 0'
                                    nas_5gs.spare_b4: '...0 .... = Spare: 0'
                                    nas_5gs.spare_b3: '.... 0... = Spare: 0'
                                    nas_5gs.spare_b2: '.... .0.. = Spare: 0'
                                    nas_5gs.nw_feat_sup.mcsi: '.... ..0. = MCS indicator (MCSI): Not supported'
                                    nas_5gs.nw_feat_sup.emcn3: '.... ...0 = Emergency services over non-3GPP access (EMCN3): Not supported'
                                GPRS Timer 3 - T3512 value:
                                    gsm_a.gm.elem_id: 'Element ID: 0x5e'
                                    gsm_a.len: 'Length: 1'
                                    gsm_a.gm.gmm.gprs_timer3:
                                        gsm_a.gm.gmm.gprs_timer3_unit: '001. .... = Unit: value is incremented in multiples of 1 hour (1)'
                                        gsm_a.gm.gmm.gprs_timer3_value: '...0 1001 = Timer value: 9'

end note

"10.0.2.15" -> "10.0.2.4": 29, NGAP InitialContextSetup (14)

note right #c6ebc6
**10.0.2.15 to 10.0.2.4**
NGAP-PDU: 200e000f000002000a4002001e005540020001
ngap.procedureCode: 'procedureCode: id-InitialContextSetup (14)'
per.enum_index: 'Enumerated Index: 0'
ngap.criticality: 'criticality: reject (0)'
per.open_type_length: 'Open Type Length: 15'
ngap.value_element:
-   ngap.InitialContextSetupResponse_element:
        per.extension_bit: '0... .... Extension Bit: False'
        per.sequence_of_length: 'Sequence-Of Length: 2'
        ngap.protocolIEs:
            'Item 0: id-AMF-UE-NGAP-ID':
                ngap.id: 'id: id-AMF-UE-NGAP-ID (10)'
                per.enum_index: 'Enumerated Index: 1'
                ngap.criticality: 'criticality: ignore (1)'
                per.open_type_length: 'Open Type Length: 2'
                ngap.value_element:
                    ngap.AMF_UE_NGAP_ID: 'AMF-UE-NGAP-ID: 30'
            'Item 1: id-RAN-UE-NGAP-ID':
                ngap.id: 'id: id-RAN-UE-NGAP-ID (85)'
                per.enum_index: 'Enumerated Index: 1'
                ngap.criticality: 'criticality: ignore (1)'
                per.open_type_length: 'Open Type Length: 2'
                ngap.value_element:
                    ngap.RAN_UE_NGAP_ID: 'RAN-UE-NGAP-ID: 1'

end note

"10.0.2.15" -> "10.0.2.4": 31, NGAP UplinkNASTransport (46),\nNAS Registration complete (0x43),\nNAS UL NAS transport (0x67),\nNAS PDU session establishment request (0xc1)

note right #8cd98c
**10.0.2.15 to 10.0.2.4**
NGAP-PDU: 002e4035000004000a0002001e0055000200010026000b0a7e02190fa16b017e0043007940135009f107000000010009f107000001e7155304
ngap.procedureCode: 'procedureCode: id-UplinkNASTransport (46)'
per.enum_index: 'Enumerated Index: 1'
ngap.criticality: 'criticality: ignore (1)'
per.open_type_length: 'Open Type Length: 53'
ngap.value_element:
-   ngap.UplinkNASTransport_element:
        per.extension_bit: '0... .... Extension Bit: False'
        per.sequence_of_length: 'Sequence-Of Length: 4'
        ngap.protocolIEs:
            'Item 0: id-AMF-UE-NGAP-ID':
                ngap.id: 'id: id-AMF-UE-NGAP-ID (10)'
                per.enum_index: 'Enumerated Index: 0'
                ngap.criticality: 'criticality: reject (0)'
                per.open_type_length: 'Open Type Length: 2'
                ngap.value_element:
                    ngap.AMF_UE_NGAP_ID: 'AMF-UE-NGAP-ID: 30'
            'Item 1: id-RAN-UE-NGAP-ID':
                ngap.id: 'id: id-RAN-UE-NGAP-ID (85)'
                per.enum_index: 'Enumerated Index: 0'
                ngap.criticality: 'criticality: reject (0)'
                per.open_type_length: 'Open Type Length: 2'
                ngap.value_element:
                    ngap.RAN_UE_NGAP_ID: 'RAN-UE-NGAP-ID: 1'
            'Item 2: id-NAS-PDU':
                ngap.id: 'id: id-NAS-PDU (38)'
                per.enum_index: 'Enumerated Index: 0'
                ngap.criticality: 'criticality: reject (0)'
                per.open_type_length: 'Open Type Length: 11'
                ngap.value_element:
                    per.octet_string_length: 'Octet String Length: 10'
                    ngap.NAS_PDU:
                        nas-5gs:
                            Security protected NAS 5GS message:
                                nas_5gs.epd: 'Extended protocol discriminator: 5G mobility management messages (126)'
                                nas_5gs.spare_half_octet: '0000 .... = Spare Half Octet: 0'
                                nas_5gs.security_header_type: '.... 0010 = Security header type: Integrity protected and ciphered (2)'
                                nas_5gs.msg_auth_code: 'Message authentication code: 0x190fa16b'
                                nas_5gs.seq_no: 'Sequence number: 1'
                            Plain NAS 5GS Message:
                                nas_5gs.epd: 'Extended protocol discriminator: 5G mobility management messages (126)'
                                nas_5gs.spare_half_octet: '0000 .... = Spare Half Octet: 0'
                                nas_5gs.security_header_type: '.... 0000 = Security header type: Plain NAS message, not security protected (0)'
                                nas_5gs.mm.message_type: 'Message type: Registration complete (0x43)'
            'Item 3: id-UserLocationInformation':
                ngap.id: 'id: id-UserLocationInformation (121)'
                per.enum_index: 'Enumerated Index: 1'
                ngap.criticality: 'criticality: ignore (1)'
                per.open_type_length: 'Open Type Length: 19'
                ngap.value_element:
                    per.choice_index: 'Choice Index: 1'
                    ngap.UserLocationInformation:
                        ngap.userLocationInformationNR_element:
                            per.extension_bit: '..0. .... Extension Bit: False'
                            per.optional_field_bit: '.... 0... Optional Field Bit: False (iE-Extensions is NOT present)'
                            ngap.nR_CGI_element:
                                per.extension_bit: '.... .0.. Extension Bit: False'
                                per.optional_field_bit: '.... ..0. Optional Field Bit: False (iE-Extensions is NOT present)'
                                ngap.pLMNIdentity:
                                    e212.mcc: 'Mobile Country Code (MCC): International Mobile, shared code (901)'
                                    e212.mnc: 'Mobile Network Code (MNC): Unknown (70)'
                                ngap.NRCellIdentity: 'nRCellIdentity: 0x0000000010'
                            ngap.tAI_element:
                                per.extension_bit: '.... 0... Extension Bit: False'
                                per.optional_field_bit: '.... .0.. Optional Field Bit: False (iE-Extensions is NOT present)'
                                ngap.pLMNIdentity:
                                    e212.mcc: 'Mobile Country Code (MCC): International Mobile, shared code (901)'
                                    e212.mnc: 'Mobile Network Code (MNC): Unknown (70)'
                                ngap.tAC: 'tAC: 1 (0x000001)'
                            ngap.timeStamp: 'timeStamp: e7155304 (Nov  8, 2022 22:13:24 UTC)'

NGAP-PDU: 002e405e000004000a0002001e00550002000100260034337e02224d771c027e00670100152e0101c1ffff91a12801007b000780000a00000d00120181220101250908696e7465726e6574007940135009f107000000010009f107000001e7155304
ngap.procedureCode: 'procedureCode: id-UplinkNASTransport (46)'
per.enum_index: 'Enumerated Index: 1'
ngap.criticality: 'criticality: ignore (1)'
per.open_type_length: 'Open Type Length: 94'
ngap.value_element:
-   ngap.UplinkNASTransport_element:
        per.extension_bit: '0... .... Extension Bit: False'
        per.sequence_of_length: 'Sequence-Of Length: 4'
        ngap.protocolIEs:
            'Item 0: id-AMF-UE-NGAP-ID':
                ngap.id: 'id: id-AMF-UE-NGAP-ID (10)'
                per.enum_index: 'Enumerated Index: 0'
                ngap.criticality: 'criticality: reject (0)'
                per.open_type_length: 'Open Type Length: 2'
                ngap.value_element:
                    ngap.AMF_UE_NGAP_ID: 'AMF-UE-NGAP-ID: 30'
            'Item 1: id-RAN-UE-NGAP-ID':
                ngap.id: 'id: id-RAN-UE-NGAP-ID (85)'
                per.enum_index: 'Enumerated Index: 0'
                ngap.criticality: 'criticality: reject (0)'
                per.open_type_length: 'Open Type Length: 2'
                ngap.value_element:
                    ngap.RAN_UE_NGAP_ID: 'RAN-UE-NGAP-ID: 1'
            'Item 2: id-NAS-PDU':
                ngap.id: 'id: id-NAS-PDU (38)'
                per.enum_index: 'Enumerated Index: 0'
                ngap.criticality: 'criticality: reject (0)'
                per.open_type_length: 'Open Type Length: 52'
                ngap.value_element:
                    per.octet_string_length: 'Octet String Length: 51'
                    ngap.NAS_PDU:
                        nas-5gs:
                            Security protected NAS 5GS message:
                                nas_5gs.epd: 'Extended protocol discriminator: 5G mobility management messages (126)'
                                nas_5gs.spare_half_octet: '0000 .... = Spare Half Octet: 0'
                                nas_5gs.security_header_type: '.... 0010 = Security header type: Integrity protected and ciphered (2)'
                                nas_5gs.msg_auth_code: 'Message authentication code: 0x224d771c'
                                nas_5gs.seq_no: 'Sequence number: 2'
                            Plain NAS 5GS Message:
                                nas_5gs.epd: 'Extended protocol discriminator: 5G mobility management messages (126)'
                                nas_5gs.spare_half_octet: '0000 .... = Spare Half Octet: 0'
                                nas_5gs.security_header_type: '.... 0000 = Security header type: Plain NAS message, not security protected (0)'
                                nas_5gs.mm.message_type: 'Message type: UL NAS transport (0x67)'
                                Payload container type:
                                    nas_5gs.mm.pld_cont_type: '.... 0001 = Payload container type: N1 SM information (1)'
                                Payload container:
                                    gsm_a.len: 'Length: 21'
                                    Plain NAS 5GS Message:
                                        nas_5gs.epd: 'Extended protocol discriminator: 5G session management messages (46)'
                                        nas_5gs.pdu_session_id: 'PDU session identity: PDU session identity value 1 (1)'
                                        nas_5gs.proc_trans_id: 'Procedure transaction identity: 1'
                                        nas_5gs.sm.message_type: 'Message type: PDU session establishment request (0xc1)'
                                        Integrity protection maximum data rate:
                                            nas_5gs.sm.int_prot_max_data_rate_ul: 'Integrity protection maximum data rate for uplink: Full data rate (255)'
                                            nas_5gs.sm.int_prot_max_data_rate_dl: 'Integrity protection maximum data rate for downlink: Full data rate (255)'
                                        PDU session type:
                                            gsm_a.common.elem_id: '1001 .... = Element ID: 0x9-'
                                            nas_5gs.sm.pdu_session_type: '.... 0001 = PDU session type: IPv4 (1)'
                                        SSC mode:
                                            gsm_a.common.elem_id: '1010 .... = Element ID: 0xa-'
                                            nas_5gs.sm.sc_mode: '.... 0001 = SSC mode: SSC mode 1 (1)'
                                        5GSM capability:
                                            nas_5gs.sm.elem_id: 'Element ID: 0x28'
                                            gsm_a.len: 'Length: 1'
                                            nas_5gs.spare_b7: '0... .... = Spare: 0'
                                            nas_5gs.spare_b6: '.0.. .... = Spare: 0'
                                            nas_5gs.spare_b5: '..0. .... = Spare: 0'
                                            nas_5gs.spare_b4: '...0 .... = Spare: 0'
                                            nas_5gs.spare_b3: '.... 0... = Spare: 0'
                                            nas_5gs.spare_b2: '.... .0.. = Spare: 0'
                                            nas_5gs.sm.mh6_pdu: '.... ..0. = Multi-homed IPv6 PDU session (MH6-PDU): Not supported'
                                            nas_5gs.sm.rqos: '.... ...0 = Reflective QoS (RqoS): Not supported'
                                        Extended protocol configuration options:
                                            nas_eps.esm.elem_id: 'Element ID: 0x7b'
                                            gsm_a.len: 'Length: 7'
                                            gsm_a.gm.sm.link_dir: 'Link direction: MS to network (0)'
                                            gsm_a.gm.sm.ext: '1... .... = Extension: True'
                                            gsm_a.gm.configuration_protocol: '.... .000 = Configuration Protocol: PPP for use with IP PDP type or IP PDN type (0)'
                                            gsm_a.gm.sm.pco_pid:
                                            -   gsm_a.gm.sm.pco.length: 'Length: 0x00 (0)'
                                            -   gsm_a.gm.sm.pco.length: 'Length: 0x00 (0)'
                                PDU session identity 2 - PDU session ID:
                                    nas_5gs.mm.elem_id: 'Element ID: 0x12'
                                    nas_5gs.pdu_session_id: 'PDU session identity: PDU session identity value 1 (1)'
                                Request type:
                                    gsm_a.common.elem_id: '1000 .... = Element ID: 0x8-'
                                    nas_5gs.mm.req_typ: '.... 0001 = Request type: Initial request (1)'
                                S-NSSAI:
                                    nas_5gs.common.elem_id: 'Element ID: 0x22'
                                    gsm_a.len: 'Length: 1'
                                    nas_5gs.mm.sst: 'Slice/service type (SST): 1'
                                DNN:
                                    nas_5gs.common.elem_id: 'Element ID: 0x25'
                                    gsm_a.len: 'Length: 9'
                                    nas_5gs.cmn.dnn: 'DNN: internet'
            'Item 3: id-UserLocationInformation':
                ngap.id: 'id: id-UserLocationInformation (121)'
                per.enum_index: 'Enumerated Index: 1'
                ngap.criticality: 'criticality: ignore (1)'
                per.open_type_length: 'Open Type Length: 19'
                ngap.value_element:
                    per.choice_index: 'Choice Index: 1'
                    ngap.UserLocationInformation:
                        ngap.userLocationInformationNR_element:
                            per.extension_bit: '..0. .... Extension Bit: False'
                            per.optional_field_bit: '.... 0... Optional Field Bit: False (iE-Extensions is NOT present)'
                            ngap.nR_CGI_element:
                                per.extension_bit: '.... .0.. Extension Bit: False'
                                per.optional_field_bit: '.... ..0. Optional Field Bit: False (iE-Extensions is NOT present)'
                                ngap.pLMNIdentity:
                                    e212.mcc: 'Mobile Country Code (MCC): International Mobile, shared code (901)'
                                    e212.mnc: 'Mobile Network Code (MNC): Unknown (70)'
                                ngap.NRCellIdentity: 'nRCellIdentity: 0x0000000010'
                            ngap.tAI_element:
                                per.extension_bit: '.... 0... Extension Bit: False'
                                per.optional_field_bit: '.... .0.. Optional Field Bit: False (iE-Extensions is NOT present)'
                                ngap.pLMNIdentity:
                                    e212.mcc: 'Mobile Country Code (MCC): International Mobile, shared code (901)'
                                    e212.mnc: 'Mobile Network Code (MNC): Unknown (70)'
                                ngap.tAC: 'tAC: 1 (0x000001)'
                            ngap.timeStamp: 'timeStamp: e7155304 (Nov  8, 2022 22:13:24 UTC)'

end note

"10.0.2.4" -> "10.0.2.15": 32, NGAP DownlinkNASTransport (4),\nNAS Configuration update command (0x54)

note right #c6ebc6
**10.0.2.4 to 10.0.2.15**
NGAP-PDU: 0004403c000003000a0002001e00550002000100260029287e02eb9a7b81027e0054430f90004f00700065006e00350047005346404722118022315240490100
ngap.procedureCode: 'procedureCode: id-DownlinkNASTransport (4)'
per.enum_index: 'Enumerated Index: 1'
ngap.criticality: 'criticality: ignore (1)'
per.open_type_length: 'Open Type Length: 60'
ngap.value_element:
-   ngap.DownlinkNASTransport_element:
        per.extension_bit: '0... .... Extension Bit: False'
        per.sequence_of_length: 'Sequence-Of Length: 3'
        ngap.protocolIEs:
            'Item 0: id-AMF-UE-NGAP-ID':
                ngap.id: 'id: id-AMF-UE-NGAP-ID (10)'
                per.enum_index: 'Enumerated Index: 0'
                ngap.criticality: 'criticality: reject (0)'
                per.open_type_length: 'Open Type Length: 2'
                ngap.value_element:
                    ngap.AMF_UE_NGAP_ID: 'AMF-UE-NGAP-ID: 30'
            'Item 1: id-RAN-UE-NGAP-ID':
                ngap.id: 'id: id-RAN-UE-NGAP-ID (85)'
                per.enum_index: 'Enumerated Index: 0'
                ngap.criticality: 'criticality: reject (0)'
                per.open_type_length: 'Open Type Length: 2'
                ngap.value_element:
                    ngap.RAN_UE_NGAP_ID: 'RAN-UE-NGAP-ID: 1'
            'Item 2: id-NAS-PDU':
                ngap.id: 'id: id-NAS-PDU (38)'
                per.enum_index: 'Enumerated Index: 0'
                ngap.criticality: 'criticality: reject (0)'
                per.open_type_length: 'Open Type Length: 41'
                ngap.value_element:
                    per.octet_string_length: 'Octet String Length: 40'
                    ngap.NAS_PDU:
                        nas-5gs:
                            Security protected NAS 5GS message:
                                nas_5gs.epd: 'Extended protocol discriminator: 5G mobility management messages (126)'
                                nas_5gs.spare_half_octet: '0000 .... = Spare Half Octet: 0'
                                nas_5gs.security_header_type: '.... 0010 = Security header type: Integrity protected and ciphered (2)'
                                nas_5gs.msg_auth_code: 'Message authentication code: 0xeb9a7b81'
                                nas_5gs.seq_no: 'Sequence number: 2'
                            Plain NAS 5GS Message:
                                nas_5gs.epd: 'Extended protocol discriminator: 5G mobility management messages (126)'
                                nas_5gs.spare_half_octet: '0000 .... = Spare Half Octet: 0'
                                nas_5gs.security_header_type: '.... 0000 = Security header type: Plain NAS message, not security protected (0)'
                                nas_5gs.mm.message_type: 'Message type: Configuration update command (0x54)'
                                Network Name - Full name for network:
                                    gsm_a.dtap.elem_id: 'Element ID: 0x43'
                                    gsm_a.len: 'Length: 15'
                                    gsm_a.extension: '1... .... = Extension: No Extension'
                                    gsm_a.dtap.coding_scheme: '.001 .... = Coding Scheme: UCS2 (16 bit) (1)'
                                    gsm_a.dtap.add_ci: '.... 0... = Add CI: The MS should not add the letters for the Country''s Initials to the text string'
                                    gsm_a.dtap.number_of_spare_bits: '.... .000 = Number of spare bits in last octet: this field carries no information about the number of spare bits in octet n (0)'
                                    gsm_a.dtap.text_string: 'Text String: Open5GS'
                                Time Zone - Local:
                                    gsm_a.dtap.elem_id: 'Element ID: 0x46'
                                    gsm_a.dtap.timezone: 'Timezone: GMT + 1 hours 0 minutes'
                                Time Zone and Time - Universal Time and Local Time Zone:
                                    gsm_a.dtap.elem_id: 'Element ID: 0x47'
                                    gsm_a.dtap.time_zone_time: 'Time: Nov  8, 2022 22:13:25.000000000'
                                    gsm_a.dtap.timezone: 'Timezone: GMT + 1 hours 0 minutes'
                                Daylight Saving Time:
                                    gsm_a.dtap.elem_id: 'Element ID: 0x49'
                                    gsm_a.len: 'Length: 1'
                                    gsm_a.spare_bits: '0000 00.. = Spare bit(s): 0'
                                    gsm_a.dtap.dst_adjustment: '.... ..00 = DST Adjustment: No adjustment for Daylight Saving Time (0)'

end note

"10.0.2.4" -> "10.0.2.15": 33, NGAP PDUSessionResourceSetup (29),\nNAS DL NAS transport (0x68),\nNAS PDU session establishment accept (0xc2)

note right #c6ebc6
**10.0.2.4 to 10.0.2.15**
NGAP-PDU: 001d0080ae000004000a0002001e005500020001004a00808c004001567e022236b475037e00680100472e0101c211000901000631310101ff01060b00010b00012905010a2d001f2201017900060120410101097b000f80000d0408080808000d0408080404250908696e7465726e6574120100202f0000040082000a0c400000003040000000008b000a01f00a0002040000007600860001000088000700010000091c00006e400a0c400000003040000000
ngap.procedureCode: 'procedureCode: id-PDUSessionResourceSetup (29)'
per.enum_index: 'Enumerated Index: 0'
ngap.criticality: 'criticality: reject (0)'
per.open_type_length: 'Open Type Length: 174'
ngap.value_element:
-   ngap.PDUSessionResourceSetupRequest_element:
        per.extension_bit: '0... .... Extension Bit: False'
        per.sequence_of_length: 'Sequence-Of Length: 4'
        ngap.protocolIEs:
            'Item 0: id-AMF-UE-NGAP-ID':
                ngap.id: 'id: id-AMF-UE-NGAP-ID (10)'
                per.enum_index: 'Enumerated Index: 0'
                ngap.criticality: 'criticality: reject (0)'
                per.open_type_length: 'Open Type Length: 2'
                ngap.value_element:
                    ngap.AMF_UE_NGAP_ID: 'AMF-UE-NGAP-ID: 30'
            'Item 1: id-RAN-UE-NGAP-ID':
                ngap.id: 'id: id-RAN-UE-NGAP-ID (85)'
                per.enum_index: 'Enumerated Index: 0'
                ngap.criticality: 'criticality: reject (0)'
                per.open_type_length: 'Open Type Length: 2'
                ngap.value_element:
                    ngap.RAN_UE_NGAP_ID: 'RAN-UE-NGAP-ID: 1'
            'Item 2: id-PDUSessionResourceSetupListSUReq':
                ngap.id: 'id: id-PDUSessionResourceSetupListSUReq (74)'
                per.enum_index: 'Enumerated Index: 0'
                ngap.criticality: 'criticality: reject (0)'
                per.open_type_length: 'Open Type Length: 140'
                ngap.value_element:
                    per.sequence_of_length: 'Sequence-Of Length: 1'
                    ngap.PDUSessionResourceSetupListSUReq:
                        Item 0:
                            ngap.PDUSessionResourceSetupItemSUReq_element:
                                per.extension_bit: '0... .... Extension Bit: False'
                                per.optional_field_bit: '..0. .... Optional Field Bit: False (iE-Extensions is NOT present)'
                                ngap.pDUSessionID: 'pDUSessionID: 1'
                                per.octet_string_length: 'Octet String Length: 47'
                                ngap.pDUSessionNAS_PDU:
                                    nas-5gs:
                                        Security protected NAS 5GS message:
                                            nas_5gs.epd: 'Extended protocol discriminator: 5G mobility management messages (126)'
                                            nas_5gs.spare_half_octet: '0000 .... = Spare Half Octet: 0'
                                            nas_5gs.security_header_type: '.... 0010 = Security header type: Integrity protected and ciphered (2)'
                                            nas_5gs.msg_auth_code: 'Message authentication code: 0x2236b475'
                                            nas_5gs.seq_no: 'Sequence number: 3'
                                        Plain NAS 5GS Message:
                                            nas_5gs.epd: 'Extended protocol discriminator: 5G mobility management messages (126)'
                                            nas_5gs.spare_half_octet: '0000 .... = Spare Half Octet: 0'
                                            nas_5gs.security_header_type: '.... 0000 = Security header type: Plain NAS message, not security protected (0)'
                                            nas_5gs.mm.message_type: 'Message type: DL NAS transport (0x68)'
                                            Payload container type:
                                                nas_5gs.mm.pld_cont_type: '.... 0001 = Payload container type: N1 SM information (1)'
                                            Payload container:
                                                gsm_a.len: 'Length: 71'
                                                Plain NAS 5GS Message:
                                                    nas_5gs.epd: 'Extended protocol discriminator: 5G session management messages (46)'
                                                    nas_5gs.pdu_session_id: 'PDU session identity: PDU session identity value 1 (1)'
                                                    nas_5gs.proc_trans_id: 'Procedure transaction identity: 1'
                                                    nas_5gs.sm.message_type: 'Message type: PDU session establishment accept (0xc2)'
                                                    nas_5gs.sm.sel_sc_mode: '0001 .... = Selected SSC mode: SSC mode 1 (1)'
                                                    PDU session type - Selected PDU session type:
                                                        nas_5gs.sm.pdu_session_type: '.... 0001 = PDU session type: IPv4 (1)'
                                                    QoS rules - Authorized QoS rules:
                                                        gsm_a.len: 'Length: 9'
                                                        QoS rule 1:
                                                            nas_5gs.sm.qos_rule_id: 'QoS rule identifier: 1'
                                                            nas_5gs.sm.length: 'Length: 6'
                                                            nas_5gs.sm.rop: '001. .... = Rule operation code: Create new QoS rule (1)'
                                                            nas_5gs.sm.dqr: '...1 .... = DQR: The QoS rule is the default QoS rule'
                                                            nas_5gs.sm.nof_pkt_filters: '.... 0001 = Number of packet filters: 1'
                                                            Packet filter 1:
                                                                nas_5gs.sm.pkt_flt_dir: '..11 .... = Packet filter direction: Bidirectional (3)'
                                                                nas_5gs.sm.pkt_flt_id: '.... 0001 = Packet filter identifier: 1'
                                                                nas_5gs.sm.pf_len: 'Length: 1'
                                                                Packet filter component 1:
                                                                    nas_5gs.sm.pf_type: 'Packet filter component type: Match-all type (1)'
                                                            nas_5gs.sm.qos_rule_precedence: 'QoS rule precedence: 255'
                                                            nas_5gs.spare_b7: '0... .... = Spare: 0'
                                                            nas_5gs.spare_b6: '.0.. .... = Spare: 0'
                                                            nas_5gs.sm.qfi: '..00 0001 = Qos flow identifier: 1'
                                                    Session-AMBR:
                                                        gsm_a.len: 'Length: 6'
                                                        nas_5gs.sm.unit_for_session_ambr_dl: 'Unit for Session-AMBR for downlink: value is incremented in multiples of 1 Gbps (11)'
                                                        nas_5gs.sm.session_ambr_dl: 'Session-AMBR for downlink: 1 Gbps (1)'
                                                        nas_5gs.sm.unit_for_session_ambr_ul: 'Unit for Session-AMBR for uplink: value is incremented in multiples of 1 Gbps (11)'
                                                        nas_5gs.sm.session_ambr_ul: 'Session-AMBR for uplink: 1 Gbps (1)'
                                                    PDU address:
                                                        nas_5gs.sm.elem_id: 'Element ID: 0x29'
                                                        gsm_a.len: 'Length: 5'
                                                        nas_5gs.sm.pdu_ses_type: '.... 0001 = PDU session type: IPv4 (1)'
                                                        nas_5gs.sm.pdu_addr_inf_ipv4: 'PDU address information: 10.45.0.31'
                                                    S-NSSAI:
                                                        nas_5gs.common.elem_id: 'Element ID: 0x22'
                                                        gsm_a.len: 'Length: 1'
                                                        nas_5gs.mm.sst: 'Slice/service type (SST): 1'
                                                    QoS flow descriptions - Authorized:
                                                        nas_5gs.sm.elem_id: 'Element ID: 0x79'
                                                        gsm_a.len: 'Length: 6'
                                                        QoS flow description 1:
                                                            nas_5gs.sm.qfi: '..00 0001 = Qos flow identifier: 1'
                                                            nas_5gs.sm.hf_nas_5gs_sm_qos_des_flow_opt_code: '001. .... = Operation code: Create new QoS flow description (1)'
                                                            nas_5gs.sm.e: '.1.. .... = E bit: 1'
                                                            nas_5gs.sm.nof_params: '..00 0001 = Number of parameters: 1'
                                                            Parameter 1 - 5QI:
                                                                nas_5gs.sm.param_id: 'Parameter identifier: 5QI (1)'
                                                                nas_5gs.sm.param_len: 'Length: 1'
                                                                nas_5gs.sm.5qi: '5QI: 9'
                                                    Extended protocol configuration options:
                                                        nas_eps.esm.elem_id: 'Element ID: 0x7b'
                                                        gsm_a.len: 'Length: 15'
                                                        gsm_a.gm.sm.link_dir: 'Link direction: Network to MS (1)'
                                                        gsm_a.gm.sm.ext: '1... .... = Extension: True'
                                                        gsm_a.gm.configuration_protocol: '.... .000 = Configuration Protocol: PPP for use with IP PDP type or IP PDN type (0)'
                                                        gsm_a.gm.sm.pco_pid:
                                                        -   gsm_a.gm.sm.pco.length: 'Length: 0x04 (4)'
                                                            gsm_a.gm.sm.pco.dns.ipv4: 'IPv4: 8.8.8.8'
                                                        -   gsm_a.gm.sm.pco.length: 'Length: 0x04 (4)'
                                                            gsm_a.gm.sm.pco.dns.ipv4: 'IPv4: 8.8.4.4'
                                                    DNN:
                                                        nas_5gs.common.elem_id: 'Element ID: 0x25'
                                                        gsm_a.len: 'Length: 9'
                                                        nas_5gs.cmn.dnn: 'DNN: internet'
                                            PDU session identity 2 - PDU session ID:
                                                nas_5gs.mm.elem_id: 'Element ID: 0x12'
                                                nas_5gs.pdu_session_id: 'PDU session identity: PDU session identity value 1 (1)'
                                ngap.s_NSSAI_element:
                                    per.extension_bit: '0... .... Extension Bit: False'
                                    per.optional_field_bit: '..0. .... Optional Field Bit: False (iE-Extensions is NOT present)'
                                    ngap.sST: 'sST: 01'
                                ngap.pDUSessionResourceSetupRequestTransfer:
                                    ngap.PDUSessionResourceSetupRequestTransfer_element:
                                        per.extension_bit: '0... .... Extension Bit: False'
                                        per.sequence_of_length: 'Sequence-Of Length: 4'
                                        ngap.protocolIEs:
                                            'Item 0: id-PDUSessionAggregateMaximumBitRate':
                                                ngap.id: 'id: id-PDUSessionAggregateMaximumBitRate (130)'
                                                per.enum_index: 'Enumerated Index: 0'
                                                ngap.criticality: 'criticality: reject (0)'
                                                per.open_type_length: 'Open Type Length: 10'
                                                ngap.value_element:
                                                    ngap.PDUSessionAggregateMaximumBitRate_element:
                                                        per.extension_bit: '0... .... Extension Bit: False'
                                                        per.optional_field_bit: '.0.. .... Optional Field Bit: False (iE-Extensions is NOT present)'
                                                        per.extension_present_bit: '0... .... Extension Present Bit: False'
                                                        ngap.pDUSessionAggregateMaximumBitRateDL: 'pDUSessionAggregateMaximumBitRateDL: 1073741824bits/s'
                                                        ngap.pDUSessionAggregateMaximumBitRateUL: 'pDUSessionAggregateMaximumBitRateUL: 1073741824bits/s'
                                            'Item 1: id-UL-NGU-UP-TNLInformation':
                                                ngap.id: 'id: id-UL-NGU-UP-TNLInformation (139)'
                                                per.enum_index: 'Enumerated Index: 0'
                                                ngap.criticality: 'criticality: reject (0)'
                                                per.open_type_length: 'Open Type Length: 10'
                                                ngap.value_element:
                                                    per.choice_index: 'Choice Index: 0'
                                                    ngap.UPTransportLayerInformation:
                                                        ngap.gTPTunnel_element:
                                                            per.extension_bit: '.0.. .... Extension Bit: False'
                                                            per.optional_field_bit: '..0. .... Optional Field Bit: False (iE-Extensions is NOT present)'
                                                            per.extension_present_bit: '...0 .... Extension Present Bit: False'
                                                            per.bit_string_length: 'Bit String Length: 32'
                                                            ngap.transportLayerAddress:
                                                                ngap.TransportLayerAddressIPv4: 'TransportLayerAddress (IPv4): 10.0.2.4'
                                                            ngap.gTP_TEID: 'gTP-TEID: 00000076'
                                            'Item 2: id-PDUSessionType':
                                                ngap.id: 'id: id-PDUSessionType (134)'
                                                per.enum_index: 'Enumerated Index: 0'
                                                ngap.criticality: 'criticality: reject (0)'
                                                per.open_type_length: 'Open Type Length: 1'
                                                ngap.value_element:
                                                    per.extension_present_bit: '0... .... Extension Present Bit: False'
                                                    per.enum_index: 'Enumerated Index: 0'
                                                    ngap.PDUSessionType: 'PDUSessionType: ipv4 (0)'
                                            'Item 3: id-QosFlowSetupRequestList':
                                                ngap.id: 'id: id-QosFlowSetupRequestList (136)'
                                                per.enum_index: 'Enumerated Index: 0'
                                                ngap.criticality: 'criticality: reject (0)'
                                                per.open_type_length: 'Open Type Length: 7'
                                                ngap.value_element:
                                                    per.sequence_of_length: 'Sequence-Of Length: 1'
                                                    ngap.QosFlowSetupRequestList:
                                                        Item 0:
                                                            ngap.QosFlowSetupRequestItem_element:
                                                                per.extension_bit: '.... ..0. Extension Bit: False'
                                                                per.optional_field_bit: '0... .... Optional Field Bit: False (iE-Extensions is NOT present)'
                                                                per.extension_present_bit: '.0.. .... Extension Present Bit: False'
                                                                ngap.qosFlowIdentifier: 'qosFlowIdentifier: 1'
                                                                ngap.qosFlowLevelQosParameters_element:
                                                                    per.extension_bit: '0... .... Extension Bit: False'
                                                                    per.optional_field_bit: '.... 0... Optional Field Bit: False (iE-Extensions is NOT present)'
                                                                    per.choice_index: 'Choice Index: 0'
                                                                    ngap.qosCharacteristics:
                                                                        ngap.nonDynamic5QI_element:
                                                                            per.extension_bit: '.... ...0 Extension Bit: False'
                                                                            per.optional_field_bit: '...0 .... Optional Field Bit: False (iE-Extensions is NOT present)'
                                                                            per.extension_present_bit: '.... 0... Extension Present Bit: False'
                                                                            ngap.fiveQI: 'fiveQI: 9'
                                                                    ngap.allocationAndRetentionPriority_element:
                                                                        per.extension_bit: '0... .... Extension Bit: False'
                                                                        per.optional_field_bit: '.0.. .... Optional Field Bit: False (iE-Extensions is NOT present)'
                                                                        ngap.priorityLevelARP: 'priorityLevelARP: 8'
                                                                        per.extension_present_bit: '0... .... Extension Present Bit: False'
                                                                        per.enum_index: 'Enumerated Index: 0'
                                                                        ngap.pre_emptionCapability: 'pre-emptionCapability: shall-not-trigger-pre-emption (0)'
                                                                        ngap.pre_emptionVulnerability: 'pre-emptionVulnerability: not-pre-emptable (0)'
            'Item 3: id-UEAggregateMaximumBitRate':
                ngap.id: 'id: id-UEAggregateMaximumBitRate (110)'
                per.enum_index: 'Enumerated Index: 1'
                ngap.criticality: 'criticality: ignore (1)'
                per.open_type_length: 'Open Type Length: 10'
                ngap.value_element:
                    ngap.UEAggregateMaximumBitRate_element:
                        per.extension_bit: '0... .... Extension Bit: False'
                        per.optional_field_bit: '.0.. .... Optional Field Bit: False (iE-Extensions is NOT present)'
                        per.extension_present_bit: '0... .... Extension Present Bit: False'
                        ngap.uEAggregateMaximumBitRateDL: 'uEAggregateMaximumBitRateDL: 1073741824bits/s'
                        ngap.uEAggregateMaximumBitRateUL: 'uEAggregateMaximumBitRateUL: 1073741824bits/s'

end note

"10.0.2.15" -> "10.0.2.4": 37, NGAP PDUSessionResourceSetup (29)

note right #c6ebc6
**10.0.2.15 to 10.0.2.4**
NGAP-PDU: 201d0024000003000a4002001e005540020001004b40110000010d0003e00a00020f000000010001
ngap.procedureCode: 'procedureCode: id-PDUSessionResourceSetup (29)'
per.enum_index: 'Enumerated Index: 0'
ngap.criticality: 'criticality: reject (0)'
per.open_type_length: 'Open Type Length: 36'
ngap.value_element:
-   ngap.PDUSessionResourceSetupResponse_element:
        per.extension_bit: '0... .... Extension Bit: False'
        per.sequence_of_length: 'Sequence-Of Length: 3'
        ngap.protocolIEs:
            'Item 0: id-AMF-UE-NGAP-ID':
                ngap.id: 'id: id-AMF-UE-NGAP-ID (10)'
                per.enum_index: 'Enumerated Index: 1'
                ngap.criticality: 'criticality: ignore (1)'
                per.open_type_length: 'Open Type Length: 2'
                ngap.value_element:
                    ngap.AMF_UE_NGAP_ID: 'AMF-UE-NGAP-ID: 30'
            'Item 1: id-RAN-UE-NGAP-ID':
                ngap.id: 'id: id-RAN-UE-NGAP-ID (85)'
                per.enum_index: 'Enumerated Index: 1'
                ngap.criticality: 'criticality: ignore (1)'
                per.open_type_length: 'Open Type Length: 2'
                ngap.value_element:
                    ngap.RAN_UE_NGAP_ID: 'RAN-UE-NGAP-ID: 1'
            'Item 2: id-PDUSessionResourceSetupListSURes':
                ngap.id: 'id: id-PDUSessionResourceSetupListSURes (75)'
                per.enum_index: 'Enumerated Index: 1'
                ngap.criticality: 'criticality: ignore (1)'
                per.open_type_length: 'Open Type Length: 17'
                ngap.value_element:
                    per.sequence_of_length: 'Sequence-Of Length: 1'
                    ngap.PDUSessionResourceSetupListSURes:
                        Item 0:
                            ngap.PDUSessionResourceSetupItemSURes_element:
                                per.extension_bit: '0... .... Extension Bit: False'
                                per.optional_field_bit: '.0.. .... Optional Field Bit: False (iE-Extensions is NOT present)'
                                ngap.pDUSessionID: 'pDUSessionID: 1'
                                per.octet_string_length: 'Octet String Length: 13'
                                ngap.pDUSessionResourceSetupResponseTransfer:
                                    ngap.PDUSessionResourceSetupResponseTransfer_element:
                                        per.extension_bit: '0... .... Extension Bit: False'
                                        per.optional_field_bit: '.... 0... Optional Field Bit: False (iE-Extensions is NOT present)'
                                        ngap.dLQosFlowPerTNLInformation_element:
                                            per.extension_bit: '.... .0.. Extension Bit: False'
                                            per.optional_field_bit: '.... ..0. Optional Field Bit: False (iE-Extensions is NOT present)'
                                            per.choice_index: 'Choice Index: 0'
                                            ngap.uPTransportLayerInformation:
                                                ngap.gTPTunnel_element:
                                                    per.extension_bit: '0... .... Extension Bit: False'
                                                    per.optional_field_bit: '.0.. .... Optional Field Bit: False (iE-Extensions is NOT present)'
                                                    per.extension_present_bit: '..0. .... Extension Present Bit: False'
                                                    per.bit_string_length: 'Bit String Length: 32'
                                                    ngap.transportLayerAddress:
                                                        ngap.TransportLayerAddressIPv4: 'TransportLayerAddress (IPv4): 10.0.2.15'
                                                    ngap.gTP_TEID: 'gTP-TEID: 00000001'
                                            per.sequence_of_length: 'Sequence-Of Length: 1'
                                            ngap.associatedQosFlowList:
                                                Item 0:
                                                    ngap.AssociatedQosFlowItem_element:
                                                        per.extension_bit: '.... ..0. Extension Bit: False'
                                                        per.optional_field_bit: '0... .... Optional Field Bit: False (iE-Extensions is NOT present)'
                                                        per.extension_present_bit: '.0.. .... Extension Present Bit: False'
                                                        ngap.qosFlowIdentifier: 'qosFlowIdentifier: 1'

end note

"10.0.2.15" -> "10.0.2.4": 67, GTP<ICMP>

note right
**10.0.2.15 to 10.0.2.4**
Type: 8 (Echo (ping) request) seq=1/256
end note

"10.0.2.4" -> "10.0.2.15": 68, GTP<ICMP>

note right
**10.0.2.4 to 10.0.2.15**
Type: 0 (Echo (ping) reply) seq=1/256
end note

"10.0.2.15" -> "10.0.2.4": 71, GTP<ICMP>

note right
**10.0.2.15 to 10.0.2.4**
Type: 8 (Echo (ping) request) seq=2/512
end note

"10.0.2.4" -> "10.0.2.15": 72, GTP<ICMP>

note right
**10.0.2.4 to 10.0.2.15**
Type: 0 (Echo (ping) reply) seq=2/512
end note

"10.0.2.15" -> "10.0.2.4": 73, GTP<ICMP>

note right
**10.0.2.15 to 10.0.2.4**
Type: 8 (Echo (ping) request) seq=3/768
end note

"10.0.2.4" -> "10.0.2.15": 74, GTP<ICMP>

note right
**10.0.2.4 to 10.0.2.15**
Type: 0 (Echo (ping) reply) seq=3/768
end note

"10.0.2.15" -> "10.0.2.4": 77, GTP<ICMP>

note right
**10.0.2.15 to 10.0.2.4**
Type: 8 (Echo (ping) request) seq=4/1024
end note

"10.0.2.4" -> "10.0.2.15": 78, GTP<ICMP>

note right
**10.0.2.4 to 10.0.2.15**
Type: 0 (Echo (ping) reply) seq=4/1024
end note

"10.0.2.15" -> "10.0.2.4": 79, GTP<ICMP>

note right
**10.0.2.15 to 10.0.2.4**
Type: 8 (Echo (ping) request) seq=5/1280
end note

"10.0.2.4" -> "10.0.2.15": 80, GTP<ICMP>

note right
**10.0.2.4 to 10.0.2.15**
Type: 0 (Echo (ping) reply) seq=5/1280
end note

@enduml
