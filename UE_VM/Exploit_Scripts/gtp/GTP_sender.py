from scapy.all import sendp, send, sr1,srp1, sniff, Packet, hexdump, Ether, IP, ICMP, UDP , get_if_addr
from scapy.contrib.gtp import *
import os
import time

#iface="enp0s3"
#iface="lo"
iface="uesimtun0"
iface_ip=get_if_addr(iface)

class GTP_sender():
    def __init__(self):
        return
    def request(self):
        pkt= IP(version=4, ihl=5, tos=0, id=33193, flags=2, frag=0, ttl=64, proto=17, chksum=37300, src="10.0.2.15", dst='10.0.17.1')/UDP(sport=2152, dport=2152)/GTP_U_Header(version=1, PT=1, reserved=0, E=1, S=0, PN=0, gtp_type=255, teid=2, seq=3, npdu=0, next_ex=133)/GTPPDUSessionContainer(ExtHdrLen=1, type=1, QMP=0, dlDelayInd=0, ulDelayInd=0, SNP=0, N3N9DelayInd=0, spareUl1=0, QFI=1, NextExtHdr=0)/IP(version=4, ihl=5, tos=0, id=42316, flags=2, frag=0, ttl=64, proto=1, chksum=31515, src='10.45.0.2', dst='10.0.2.4')/ICMP()
        pkt=IP(bytes(pkt))
        sendp(pkt, iface=iface)
        pkt.show()
        
g=GTP_sender()
g.request()


